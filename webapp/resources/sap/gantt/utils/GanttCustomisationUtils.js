sap.ui.define(["sap/ui/model/json/JSONModel","sap/m/Button","sap/m/Dialog","sap/ui/comp/smartform/SmartForm","sap/ui/comp/smartform/Group","sap/ui/comp/smartform/GroupElement","sap/m/SelectDialog","sap/m/CustomListItem","sap/m/Input","sap/ui/core/theming/Parameters","sap/ui/core/Icon","sap/m/HBox","sap/m/Text","sap/m/DateRangeSelection","sap/gantt/misc/Format","sap/gantt/library"],function(J,B,D,S,G,a,b,C,I,P,c,H,T,d,F,l){'use strict';var r=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");var p=l.palette;var e=p.SemanticColors.concat(p.LegendColors).concat(p.AccentColors);var f=function(){var h=e.map(function(i){return{color:i};});return new J({colors:h});};var g={dialogBox:function(o,h){return new Promise(function(j,k){var t="";if(h){t=new d({dateValue:F.abapTimestampToDate(o.getTimeStamp()),secondDateValue:F.abapTimestampToDate(o.getEndTimeStamp()),minDate:(new Date(1900,0,1)),maxDate:(new Date(2100,12,31))});}else{t=new I({placeholder:r.getText("TXT_CH_AL_PH_TIMESTAMP"),value:o.getTimeStamp()});}var s=new S({editable:true,useHorizontalLayout:false,groups:[new G({groupElements:[new a({label:r.getText("TXT_CH_AL_STROKE"),elements:[new I({type:"Text",value:{path:'colors',formatter:function(u){u=e;for(var i=0;i<u.length;i++){if(o.getStroke()===P.get(u[i])){return u[i];}}}},placeholder:r.getText("TXT_CH_AL_PH_STROKE_VALUE"),showValueHelp:true,valueHelpOnly:true,valueHelpRequest:function(){if(this.oSelectDialog){this.oSelectDialog.open();return;}this.oSelectDialog=new b({title:r.getText("TXT_CH_AL_DIALOG_COLOR_SELECTOR"),confirm:function(E){s.getGroups()[0].getGroupElements()[0].getElements()[0].setValue(E.getParameter("selectedItem").getContent()[0].getItems()[1].getText());},items:{growing:false,path:"colors>/colors",template:new C({content:[new H({alignItems:"Center",items:[new c({src:"sap-icon://color-fill",color:{path:'colors>color',formatter:function(i){return P.get(i);}}}).addStyleClass("sapUiTinyMargin"),new T({text:{path:'colors>color',formatter:function(i){return i;}}})]})]}),templateShareable:false,showSecondaryValues:true}});this.oSelectDialog.setModel(f(),"colors");this.oSelectDialog.open();}})]}),new a({label:r.getText("TXT_CH_AL_STROKE_DASHARRAY"),elements:[new I({placeholder:r.getText("TXT_CH_AL_PH_STROKE_DASHARRAY"),value:o.getStrokeDasharray()})]}),new a({label:r.getText("TXT_CH_AL_STROKE_OPACITY"),elements:[new I({placeholder:r.getText("TXT_CH_AL_PH_STROKE_OPACITY"),value:o.getStrokeOpacity()})]}),new a({label:r.getText("TXT_CH_AL_TIMESTAMP"),elements:[t]}),new a({label:r.getText("TXT_CH_AL_DESCRIPTION"),elements:[new I({placeholder:r.getText("TXT_CH_AL_PH_DESCRIPTION"),value:o.getDescription()})]})]})]});s.getGroups()[0].getGroupElements()[0].getElements()[0].setModel(f());var m=new B({text:r.getText("SAVE_BUTTON"),type:"Emphasized"}),n=new B({text:r.getText("CANCEL_BUTTON")});var q=new D({title:h?r.getText("TXT_CH_DL_DIALOG_TITLE"):r.getText("TXT_CH_AL_DIALOG_TITLE"),buttons:[m,n],content:[s]});n.attachPress(function(E){q.close();});m.attachPress(function(E){var i=q.getContent()[0].getGroups()[0].getGroupElements(),u={newChange:{stroke:P.get(i[0].getElements()[0].getValue()),strokeDasharray:i[1].getElements()[0].getValue(),strokeOpacity:parseFloat(i[2].getElements()[0].getValue()),description:i[4].getElements()[0].getValue()},oldChange:{stroke:o.getStroke(),strokeDasharray:o.getStrokeDasharray(),strokeOpacity:o.getStrokeOpacity(),description:o.getDescription()}};if(h){u.newChange["timeStamp"]=F.dateToAbapTimestamp(i[3].getElements()[0].getDateValue());u.newChange["endTimeStamp"]=F.dateToAbapTimestamp(i[3].getElements()[0].getSecondDateValue());u.oldChange["timeStamp"]=o.getTimeStamp();u.oldChange["endTimeStamp"]=o.getEndTimeStamp();}else{u.newChange["timeStamp"]=i[3].getElements()[0].getValue();u.oldChange["timeStamp"]=o.getTimeStamp();}q.close();j(u);});q.open();});},designTimeSettings:function(t,h){return{icon:"sap-icon://edit",name:r.getText(t),isEnabled:true,handler:h};}};return g;},true);
