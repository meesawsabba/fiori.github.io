// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Renderer","sap/ui/core/format/NumberFormat","../../library","./TileBaseRenderer","sap/ushell/resources"],function(R,N,u,T,r){"use strict";var S=u.ui.tile.State;var a=u.ui.tile.StateArrow;var D=R.extend(T);var t=r.i18n;D.renderPart=function(o,c){var n=c.getNumberValue(),b=c.getNumberFactor(),d=n.toString(),m=c.getIcon()?4:5,s=this._shouldProcessDigits(d,c);if(d.length>m||s){var e=this._normalizeNumber(n,m,b,c);b=e.numberFactor;d=e.displayNumber;}else if(d!==""){var f=N.getFloatInstance({maxFractionDigits:m});d=f.format(n);}o.write("<div");o.addClass("sapUshellDynamicTile");o.writeClasses();o.write(">");o.write("<div");o.addClass("sapUshellDynamicTileData");o.addClass(S[c.getNumberState()]?"sapUshellDynamicTileData"+c.getNumberState():"sapUshellDynamicTileData"+S.Neutral);o.writeClasses();o.write(">");o.write("<div class='sapUshellDynamicTileIndication'>");if(a[c.getStateArrow()]){o.write("<div");o.addClass("sapUshellDynamicTileStateArrow");o.addClass("sapUshellDynamicTileData"+a[c.getStateArrow()]);o.writeClasses();o.write(">");o.write("</div>");}o.write("<br><div");o.addClass("sapUshellDynamicTileNumberFactor");o.writeClasses();o.writeAccessibilityState(c,{label:t.getText("TileUnits_lable")+b});o.write(">");o.writeEscaped(b);o.write("</div>");o.write("</div>");o.write("<div");o.addClass("sapUshellDynamicTileNumber");o.writeClasses();if(d&&d!==""){o.writeAccessibilityState(c,{label:t.getText("TileValue_lable")+d});o.write(">");o.writeEscaped(d);}else{o.write(">");o.writeEscaped(c.getNumberValue());}o.write("</div>");o.write("</div>");o.write("</div>");};D._normalizeNumber=function(n,m,b,c){var d;if(isNaN(n)){d=n;}else{var o=N.getFloatInstance({maxFractionDigits:c.getNumberDigits()});if(!b){var e=Math.abs(n);if(e>=1000000000){b="B";n/=1000000000;}else if(e>=1000000){b="M";n/=1000000;}else if(e>=1000){b="K";n/=1000;}}d=o.format(n);}var f=d;var g=f[m-1];m-=(g==="."||g===",")?1:0;f=f.substring(0,m);return{displayNumber:f,numberFactor:b};};D._shouldProcessDigits=function(d,c){var n=c.getNumberDigits(),b;if(d.indexOf(".")!==-1){b=d.split(".")[1].length;if(b>n){return true;}}return false;};D.getInfoPrefix=function(c){return c.getNumberUnit();};return D;},true);
