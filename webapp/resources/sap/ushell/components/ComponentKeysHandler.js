// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/Config","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery","sap/base/Log","sap/ushell/renderers/fiori2/AccessKeysHandler","sap/ushell/bootstrap/common/common.load.model"],function(C,A,K,q,L,a,m){"use strict";var b=function(){};b._instance=undefined;b.getInstance=function(){if(b._instance===undefined){b._instance=new b();return b._instance._init().then(function(){return b._instance;});}return Promise.resolve(b._instance);};b.prototype={keyCodes:K,tileFocusCustomData:new A({key:"tabindex",value:"0",writeToDom:true}),_init:function(){this.oModel=m.getModel();return new Promise(function(r){if(!this.oLaunchPageService){sap.ushell.Container.getServiceAsync("LaunchPage").then(function(l){this.oLaunchPageService=l;r();}.bind(this));}else{r();}}.bind(this));},goToTileContainer:function(){if(this.oModel.getProperty("/tileActionModeActive")){this.goToFirstVisibleTileContainer();}else{this.goToLastVisitedTile();}},goToFirstVisibleTileContainer:function(){var j=q("#dashboardGroups").find(".sapUshellTileContainer").filter(":visible"),t=this.oModel.getProperty("/topGroupInViewPortIndex");if(j.length){var c=q(j.get(t));if(c.length){this._setTileContainerSelectiveFocus(c);}}},goToLastVisitedTile:function(j,l){var c,d,e=q(".sapUshellTile, .sapMGTLineMode, .sapFCard");if(l){var f=q("#dashboardGroups").find(".sapUshellTileContainer").filter(":visible"),t=this.oModel.getProperty("/topGroupInViewPortIndex");var g=j||q(f.get(t));var h=g.find(".sapUshellTile, .sapMGTLineMode, .sapFCard");c=h.filter(":visible").eq(0);d=h.filter("[tabindex=0]:visible").eq(0);if(!c.length){c=e.filter(":visible").eq(0);}}else{c=e.filter(":visible").eq(0);d=e.filter("[tabindex=0]:visible").eq(0);}if(d.length){this.moveScrollDashboard(d);}else if(c.length){c.attr("tabindex","0");this.moveScrollDashboard(c);}else{a.sendFocusBackToShell();}},_goToFirstTileOfNextGroup:function(d,e){this._preventDefault(e);var i=this._getGroupAndTilesInfo();if(i){var n=this._getNextGroup(d,i.oGroup,false,true);if(n){this._goToTileOfGroup("first",n);}}},_goToTileOfGroup:function(p,g){if(g){var c=g.getTiles();if(this.oModel.getProperty("/tileActionModeActive")){c.push(g.oPlusTile);}c=c.concat(g.getLinks());p=p==="first"?0:p;p=p==="last"?c.length-1:p;var t=c[p];if(t&&t.getDomRef()){var j=q(t.getDomRef());if(j.length===1){this.moveScrollDashboard(j);return true;}}}return false;},_moveTile:function(d){var i=this._getGroupAndTilesInfo(),D=this._getNextTile(d,true,i);if(D){var o=D.getParent();if(C.last("/core/home/gridContainer")&&o.getParent().getId()!=="dashboardGroups"){o=o.getParent();}var s=D.getMode?D.getMode():"ContentMode",c=i.oCurTile.getMode?i.oCurTile.getMode():"ContentMode",e=s==="LineMode"?o.getLinks():o.getTiles(),n=0;if(i.oGroup===o){n=e.indexOf(D);if(c==="LineMode"&&s==="ContentMode"&&d==="left"){n=e.length;}}else if(d==="left"||d==="up"){n=e.length;}var E,f,t=this;if(c===s){var g=q(".sapUshellDashboardView").control(0);E="movetile";f={sTileId:g.getController()._getTileUuid(i.oCurTile),toGroupId:o.getGroupId?o.getGroupId():o.groupId,toIndex:n,sToItems:c==="LineMode"?"links":"tiles",sFromItems:c==="LineMode"?"links":"tiles",sTileType:c==="LineMode"?"link":"tile"};if(s==="LineMode"){f.callBack=function(){setTimeout(function(){e=s==="LineMode"?o.getLinks():o.getTiles();t.moveScrollDashboard(e[n].$());},10);};}else{setTimeout(function(){e=s==="LineMode"?o.getLinks():o.getTiles();t.moveScrollDashboard(e[n].$());},10);}}else{E="convertTile";f={toGroupId:o.getGroupId?o.getGroupId():o.groupId,srcGroupId:i.oGroup.getGroupId?i.oGroup.getGroupId():i.oGroup.groupId,toIndex:n,callBack:function(){setTimeout(function(){e=s==="LineMode"?o.getLinks():o.getTiles();t.moveScrollDashboard(e[n].$());},10);},tile:i.oCurTile,longDrop:false};}sap.ui.getCore().getEventBus().publish("launchpad",E,f);}},callbackSetFocus:function(t){var c=this;setTimeout(function(){if(t.oParent&&t.oParent instanceof sap.ushell.ui.launchpad.Tile){c.moveScrollDashboard(q(t.oParent.getDomRef()));}else{c.moveScrollDashboard(t.$());}},0);},_getTileCenter:function(d,t,T){if(!(T instanceof HTMLElement)){var j=T.$().find(".sapMGTLineStyleHelper");if(T.isLink&&j&&j.length>1){if(d==="down"){return t.right;}return t.left;}}return t.right-((t.right-t.left)/2);},_getTileRect:function(d,t){if(t instanceof HTMLElement){return t.getBoundingClientRect();}var j=t.$().find(".sapMGTLineStyleHelper");if(t.isLink&&j&&j.length){if(d==="down"){return j.get(j.length-1).getBoundingClientRect();}return j.get(0).getBoundingClientRect();}if(t.getDomRef()){return t.getDomRef().getBoundingClientRect();}return undefined;},_findClosestTile:function(d,t,c){var o=this._getTileRect(d,c),n=this._getTileCenter(d,o,c);var e,f=Infinity,g=d==="down"?1:-1,h=t.indexOf(c)+g,i;for(;;h+=g){var T=t[h];if(!T){return e;}if(!e){if(d==="down"&&h===t.length-1){return T;}if(d==="up"&&h===0){return T;}}var j=this._getTileRect(d,T);if(!j){return e;}if(d==="down"&&o.bottom+5>=j.bottom){continue;}if(d==="up"&&o.top-5<=j.top){continue;}if(e&&i!==j.top){return e;}i=j.top;var k=Math.min(Math.abs(j.left-n),Math.abs(j.right-n));if(f>k){f=k;e=T;}else{return e;}}},_getNextTile:function(d,M,g){var i=g||this._getGroupAndTilesInfo(),l=true;var n;var N;var G;var c;if(!i||(M&&i.oGroup.getProperty("isGroupLocked"))){return null;}if(M){var t=i.oCurTile.getBindingContext().getObject().object;l=this.oLaunchPageService.isLinkPersonalizationSupported(t);}if(d==="right"||d==="left"){var f=i.oCurTile.isLink?i.aLinks:i.aTiles,e=f.indexOf(i.oCurTile),h=d==="right"?e+1:e-1;if(f[h]&&f[h].getDomRef()){if(M&&f[h]===i.oGroup.oPlusTile){}else{return f[h];}}if(d==="right"&&!i.oCurTile.isLink&&i.aLinks.length&&l){return i.aLinks[0];}if(d==="left"&&i.oCurTile.isLink&&i.aTiles.length){return i.oGroup.getShowPlaceholder()?i.oGroup.oPlusTile:i.aTiles[i.aTiles.length-1];}}var o=this._getNextGroup(d,i.oGroup,M,l);if(o){n=o.getTiles();N=o.getLinks();if(d==="right"){if(n.length===0&&N.length===0){return o.oPlusTile;}else if(n.length===0){return N[0];}return n[0];}if(d==="left"){if(n.length===0&&N.length===0){return o.oPlusTile;}else if(N.length===0){return n[n.length-1];}return N[N.length-1];}}if(d==="down"||d==="up"){G=l?i.aTiles.concat(i.aLinks):i.aTiles;c=[];if(o){var j=o.getTiles(),k=o.getLinks();c=l?j.concat(k):j;if(c.length===0){c.push(o.oPlusTile);}}var J=(d==="down")?G.concat(c):c.concat(G);return this._findClosestTile(d,J,i.oCurTile);}},_getNextGroup:function(d,c,M,l){var n,g=c.getParent().getGroups(),e=g.indexOf(c),f=e;if(d==="down"||d==="right"){n=1;}else{n=-1;}f+=n;while(g[f]){var N=g[f],h=N.getTiles(),i=N.getLinks();var j=l?h.concat(i):h;var I=N.getVisible()&&!(N.getIsGroupLocked()&&M)&&!(N.getIsGroupLocked()&&j.length===0)&&!(j.length===0&&!(M||this.oModel.getProperty("/tileActionModeActive")));if(I){return N;}f+=n;}return undefined;},_getGroupAndTilesInfo:function(){var j=this._getFocusOnTile(q(document.activeElement));if(!j||!j.length){return null;}var c=j.control(0);c.isLink=j.hasClass("sapUshellLinkTile")||j.hasClass("sapMGTLineMode");var g=j.closest(".sapUshellTileContainer").control(0);if(!g){return null;}var t=g.getTiles();if(g.getShowPlaceholder()){t.push(g.oPlusTile);}return{oCurTile:c,oGroup:g,aTiles:t,aLinks:g.getLinks()};},_goToSiblingElementInTileContainer:function(d,j){var c=j.closest(".sapUshellTileContainer"),e,f,g;e=j.closest(".sapUshellTileContainerBeforeContent");if(e.length){if(d==="up"||d==="left"){this._goToNextTileContainer(e,d);}else{g=c.find(".sapUshellTileContainerHeader").eq(0);this._setTabIndexOnTileContainerHeader(g);g.focus();}return;}e=j.closest(".sapUshellTileContainerHeader");if(e.length){if(d==="up"){this._setTabIndexOnTileContainerHeader(g);if(!this._goToTileContainerBeforeContent(c)){this._goToNextTileContainer(e,d);}}else if(d==="down"){f=c.find(".sapUshellTile, .sapUshellLinkTile, .sapFCard").eq(0);if(f.length){this.moveScrollDashboard(f);}else{this._goToNextTileContainer(e,d);}}else if(d==="left"){if(j.hasClass("sapUshellTileContainerHeader")){if(!this._goToTileContainerBeforeContent(c)){this._goToNextTileContainer(e,"left");}}else{g=j.closest(".sapUshellTileContainerHeader");g.focus();}}else if(d==="right"){var h=j.hasClass("sapMInputBaseInner");if(!h){f=c.find(".sapUshellTile, .sapUshellLinkTile, .sapFCard").eq(0);if(f.length){this.moveScrollDashboard(f);}else{this._goToNextTileContainer(e,"down");}}}return;}e=this._getFocusOnTile(j);if(e){this._goFromFocusedTile(d,e,true);return;}e=j.closest(".sapUshellTileContainerAfterContent");if(e.length){if(d==="up"||d==="left"){this._goToTileOfGroup("first",e.control(0));}else{this._goToNextTileContainer(e,d);}}},_goToNextTileContainer:function(j,d){var c=j.closest(".sapUshellTileContainer");if(c.length===1){var e=q(".sapUshellTileContainer").filter(":visible"),n=(d==="down")?1:-1,f=q(e[e.index(c)+n]);if(f.length===1){var g=f.find(".sapUshellTileContainerHeader");if(d==="down"){if(!this._goToTileContainerBeforeContent(f)){this._setTabIndexOnTileContainerHeader(g);this._setTileContainerSelectiveFocus(f);}}else if(!this._goToTileContainerAfterContent(f)){if(d==="up"||d==="left"){var s=d==="up"?"first":"last";if(!this._goToTileOfGroup(s,f.control(0))){this._setTabIndexOnTileContainerHeader(g);g.focus();}}}}}},_goToTileContainerBeforeContent:function(j){var c=j.hasClass("sapUshellTileContainer")?j:j.closest(".sapUshellTileContainer"),d=c.find(".sapUshellTileContainerBeforeContent button").filter(":visible");if(d.length){d.focus();return true;}return false;},_goToTileContainerAfterContent:function(j){var c=j.hasClass("sapUshellTileContainer")?j:j.closest(".sapUshellTileContainer"),d=c.find(".sapUshellTileContainerAfterContent button").filter(":visible");if(d.length){d.focus();return true;}return false;},_goFromFocusedTile:function(d,$,i){var n=this._getNextTile(d);if(n){var N=n.$(),c=$.closest(".sapUshellTileContainer"),e=N.closest(".sapUshellTileContainer");if(i&&(c.get(0).id!==e.get(0).id)){if(d==="down"||d==="right"){if(!this._goToTileContainerAfterContent(c)){this._setTabIndexOnTileContainerHeader(e.find(".sapUshellTileContainerHeader"));this._setTileContainerSelectiveFocus(e);}}else if(d==="up"||d==="left"){var f=c.find(".sapUshellTileContainerHeader");this._setTabIndexOnTileContainerHeader(f);f.focus();}}else{this.moveScrollDashboard(N);}}},_setTabIndexOnTileContainerHeader:function(j){q(".sapUshellTileContainerHeader").attr("tabindex",-1);q(".sapUshellTileContainerHeader .sapUshellContainerTitle").attr("tabindex",-1);q(".sapUshellTileContainerHeader .sapUshellContainerHeaderActions button").attr("tabindex",-1);if(j){var c=j.find(".sapUshellContainerTitle").eq(0),d=j.find(".sapUshellContainerHeaderActions").eq(0);j.attr("tabindex",0);c.attr("tabindex",0);d.find("button").attr("tabindex",0);}},_setTileContainerSelectiveFocus:function(j){var c=q("#dashboardGroups").find(".sapUshellTileContainer").filter(":visible"),d=j.find(".sapUshellTileContainerBeforeContent button"),e=j.find(".sapUshellTileContainerHeader").eq(0),B=d.length&&d.is(":visible");if(B){d.focus();}else if(j.get(0)===c.get(0)){this.goToLastVisitedTile();}else if(e.length){this._setTabIndexOnTileContainerHeader(e);e.focus();}},setTileFocus:function(j){if(!j.hasClass("sapUshellPlusTile")){if(j.parents("#catalogView").length>0){this.setFocusOnCatalogTile(j.find("[tabindex]").eq(0));}}var c=q(".sapUshellTile, .sapMGTLineMode, .sapUshellLinkTile, .sapMGT, .sapFCard").filter("[tabindex=0]").get();for(var i=0;i<c.length;i++){c[i].setAttribute("tabindex","-1");}if(j.length>0){j.attr("tabindex",0);if(j.prop("tagName")==="DIV"&&q(j).hasClass("sapUshellLinkTile")&&j.getMode===undefined){j=j.find("a").length?j.find("a")[0]:j;}j.focus();if(j[0]&&j[0].id){var t=sap.ui.getCore().byId(j[0].id);var d=this.tileFocusCustomData.getParent&&this.tileFocusCustomData.getParent();if(d){d.removeAggregation("customData",this.tileFocusCustomData,true);}if(t&&sap.ui.getCore().byId(t.getId())&&this.tileFocusCustomData&&sap.ui.getCore().byId(this.tileFocusCustomData.getId())){t.addAggregation("customData",this.tileFocusCustomData,true);}}}},setFocusOnCatalogTile:function(j){var p=q(".sapUshellTile[tabindex=0]"),c,v;if(p.length){q(".sapUshellTileContainerContent [tabindex=0]").get().forEach(function(h){q(h).attr("tabindex",-1);});c=p.find("[tabindex], a").addBack().filter("[tabindex], a");c.attr("tabindex",-1);}if(!j){v=q(".sapUshellTile, .sapUshellAppBox").filter(":visible");if(v.length){j=q(v[0]);}else{return;}}j.attr("tabindex",0);j.find("button").attr("tabindex",0);j.focus();},moveScrollDashboard:function(t){if(t.length){this.setTileFocus(t);}},_moveGroupFromDashboard:function(d,j){var c,t=q(".sapUshellDashboardGroupsContainerItem"),i,e;c=j.closest(".sapUshellDashboardGroupsContainerItem");i=t.index(c);e=d==="up"||d==="left"?i-1:i+1;this._moveGroup(i,e);},_moveGroup:function(f,t){if(t<0||t>=q(".sapUshellDashboardGroupsContainerItem").length||t<q(".sapUshellDisableDragAndDrop").length){return;}sap.ui.getCore().getEventBus().publish("launchpad","moveGroup",{fromIndex:f,toIndex:t});var c=this;setTimeout(function(){var d=q(".sapUshellTileContainerHeader")[t];c._setTabIndexOnTileContainerHeader(q(d));q(d).focus();},100);},_getFocusOnTile:function(j){var c;[".sapUshellTile",".sapUshellLinkTile",".sapFCard"].forEach(function(s){var d=j.closest(s);if(d.length){c=d;}});return c;},_renameGroup:function(j){if(j.closest(".sapUshellTileContainerHeader").length===1){j=j[0].tagName==="H2"?j:j.find("h2");j.click();}},_arrowsButtonsHandler:function(d,e,j){this._preventDefault(e);if(j.hasClass("sapUshellAnchorItem")){this._handleAnchorNavigationItemsArrowKeys(d,j);return;}if(j.is("#sapUshellAnchorBarOverflowButton")){this._handleAnchorNavigationOverflowButtonArrowKeys(d);return;}var c=this._getFocusOnTile(j),i=this.oModel.getProperty("/tileActionModeActive");if(e.ctrlKey===true&&this.oModel.getProperty("/personalization")){var f=j.closest(".sapUshellTileContainerHeader");if(c){this._moveTile(d,c);}else if(f.length){var g=f.closest(".sapUshellTileContainerContent");if(!g.hasClass("sapUshellTileContainerDefault")||!g.hasClass("sapUshellTileContainerLocked")){this._moveGroupFromDashboard(d,f);}}}else if(i){this._goToSiblingElementInTileContainer(d,j);}else if(c){this._goFromFocusedTile(d,c,i);}else{this.goToLastVisitedTile();}},_handleAnchorNavigationOverflowButtonArrowKeys:function(d){var c;q("#sapUshellAnchorBarOverflowButton").attr("tabindex",-1);if(["left","up"].indexOf(d)>-1){c=q(".sapUshellAnchorItem").filter(":visible");this._setAnchorItemFocus(c.eq(c.length-1));}},_handleAnchorNavigationItemsArrowKeys:function(d,j){var c=q(".sapUshellAnchorItem").filter(":visible"),n=c.index(j);if(d==="left"||d==="up"){if(n>0){this._setAnchorItemFocus(c.eq(n-1));return;}}if(d==="right"||d==="down"){if(n<c.length-1){this._setAnchorItemFocus(c.eq(n+1));}else if(n===c.length-1){this._setAnchorOverflowButtonFocus();}}},_setAnchorOverflowButtonFocus:function(){var B=q("#sapUshellAnchorBarOverflowButton");q(".sapUshellAnchorItem").get().forEach(function(h){q(h).attr("tabindex",-1);});B.attr("tabindex",0);B.focus();},_setAnchorItemFocus:function(j){q(".sapUshellAnchorItem").get().forEach(function(h){q(h).attr("tabindex",-1);});j.attr("tabindex",0);j.focus();},_appFinderHomeEndButtonsHandler:function(d,e,j){var v=q(".sapUshellTile, .sapUshellAppBox").filter(":visible"),c;if(v.length){if(d==="home"){c=q(v.get(0));}if(d==="end"){c=q(v.get(v.length-1));}}if(c){this._preventDefault(e);this._appFinderFocusAppBox(j,c);}},_homeEndButtonsHandler:function(s,e,j){if(j.hasClass("sapUshellAnchorItem")){this._preventDefault(e);this._setAnchorItemFocus(q(".sapUshellAnchorItem").filter(":visible:"+s));}else if(e.ctrlKey===true){this._preventDefault(e);var c=q(".sapUshellTile, .sapFCard").filter(":visible")[s]();if(c.length){this.setTileFocus(c);}}else{var d=j.closest(".sapUshellTileContainer");if(d){var g=d.control(0);if(g){this._preventDefault(e);this._goToTileOfGroup(s,g);}}}},_deleteButtonHandler:function(j){if(this.oModel.getProperty("/personalization")&&this.oModel.getProperty("/tileActionModeActive")){var c=this._getFocusOnTile(j);if(c&&!c.hasClass("sapUshellLockedTile")&&!c.hasClass("sapUshellPlusTile")){var i=this._getGroupAndTilesInfo();if(i){var d=q(".sapUshellDashboardView").control(0),t=d.getController()._getTileUuid(i.oCurTile),e=this;setTimeout(function(){if(i.oCurTile.getDomRef()){e.moveScrollDashboard(i.oCurTile.$());}else{e.moveScrollDashboard(i.oGroup.oPlusTile.$());}},100);sap.ui.getCore().getEventBus().publish("launchpad","deleteTile",{tileId:t},this);}}}},_ctrlPlusArrowKeyButtonsHandler:function(d){var j=q(document.activeElement),c=j.closest(".sapUshellTileContainerHeader");if(this._getFocusOnTile(j)){this._moveTile(d);}else if(c.length){var e=c.closest(".sapUshellTileContainerContent");if(!e.hasClass("sapUshellTileContainerDefault")||!e.hasClass("sapUshellTileContainerLocked")){this._moveGroupFromDashboard(d,c);}}},_spaceButtonHandler:function(e,j){var c=this._getFocusOnTile(j);if(!c||!c.length){j.click();return;}e.preventDefault();if(c.hasClass("sapFCard")){c.control(0).getCardHeader().firePress();return;}var d=j.find("[role=button]");if(d.length){var B=d.control(0);if(B){B.firePress();return;}}c.control(0).firePress();},goToSelectedAnchorNavigationItem:function(){this._setAnchorItemFocus(q(".sapUshellAnchorItemSelected"));return q(document.activeElement).hasClass("sapUshellAnchorItemSelected");},handleFocusOnMe:function(e,f){var r=sap.ushell.Container.getRenderer("fiori2"),h=b._instance;if(r){var c=r.getCurrentCoreView();if(c==="home"&&!C.last("/core/spaces/enabled")){var t=document.activeElement?document.activeElement.tagName:"";if(t==="INPUT"||t==="TEXTAREA"){if(e.keyCode===h.keyCodes.ENTER){var H=q(document.activeElement).closest(".sapUshellTileContainerHeader");if(H.length){setTimeout(function(){H=q("#"+H[0].id);h._setTabIndexOnTileContainerHeader(H);H.focus();},10);}}}else{h._dashboardKeydownHandler(e);}}if(c==="appFinder"){if(f){if(e.shiftKey){h.setFocusOnCatalogTile();}else{var o=sap.ui.getCore().byId("openCloseButtonAppFinderSubheader");if(o&&o.getVisible()){o.focus();}else{h.appFinderFocusMenuButtons(e);}}}else{h._appFinderKeydownHandler(e);}}}},_groupHeaderNavigation:function(j){var c;if(j.hasClass("sapUshellTileContainerHeader")){c=j.find(".sapUshellContainerTitle");c.focus();}else if(j.closest(".sapUshellTileContainerHeader")){c=j.closest(".sapUshellTileContainerHeader");c.focus();}},_appFinderFocusAppBox:function(j,c){if(j&&c){j.attr("tabindex","-1").find(".sapUshellPinButton").attr("tabindex","-1");c.attr("tabindex","0").focus();c.find(".sapUshellPinButton").attr("tabindex","0");}},_preventDefault:function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();},_getNextCatalog:function(d,j){var c;if(d==="down"||d==="right"){c=j.next();}else if(d==="up"||d==="left"){c=j.prev();}else{L.error("Direction is unkown",d,"sap.ushell.components.ComponentKeysHandler");return null;}if(c.length>0){var n=c.find("li.sapUshellAppBox, li.sapUshellTile").get().length;if(n>0){return c;}return this._getNextCatalog(d,c);}return undefined;},_getNextCatalogItem:function(d,j,p){var c=q(j.parents()[2]),e=c.find("li.sapUshellAppBox, li.sapUshellTile").get();if(d==="right"||d==="left"){var n=e.indexOf(j.get(0)),f=d==="right"?n+1:n-1;if(e[f]){return e[f];}}var g=this._getNextCatalog(d,c),N=g?g.find("li.sapUshellAppBox, li.sapUshellTile").get():[];if(N.length>0&&d==="right"){return N[0];}if(N.length>0&&d==="left"){return N[N.length-1];}if(d==="down"||d==="up"){if(N.length>0&&p){return N[0];}var J=(d==="down")?e.concat(N):N.concat(e);return this._findClosestTile(d,J,j.get(0));}return undefined;},_appFinderKeysHandler:function(d,e,j,p){if(j.is(".sapUshellAppBox, .sapUshellTile")){this._preventDefault(e);var c=q(this._getNextCatalogItem(d,j,p));if(c){this._appFinderFocusAppBox(j,c);}}},appFinderFocusMenuButtons:function(e){var c=q("#catalog-button, #userMenu-button, #sapMenu-button").filter("[tabindex=0]");if(c.length){c.eq(0).focus();this._preventDefault(e);return true;}return false;},_appFinderKeydownHandler:function(e){var j=q(document.activeElement);if(e.srcElement.id!=="appFinderSearch-I"){var p=e.keyCode,i=sap.ui.getCore().getConfiguration().getRTL();if(i&&p===this.keyCodes.ARROW_RIGHT){p=this.keyCodes.ARROW_LEFT;}else if(i&&p===this.keyCodes.ARROW_LEFT){p=this.keyCodes.ARROW_RIGHT;}switch(p){case this.keyCodes.ARROW_UP:this._appFinderKeysHandler("up",e,j);break;case this.keyCodes.ARROW_DOWN:this._appFinderKeysHandler("down",e,j);break;case this.keyCodes.ARROW_RIGHT:this._appFinderKeysHandler("right",e,j);break;case this.keyCodes.ARROW_LEFT:this._appFinderKeysHandler("left",e,j);break;case this.keyCodes.PAGE_UP:this._appFinderKeysHandler("up",e,j,true);break;case this.keyCodes.PAGE_DOWN:this._appFinderKeysHandler("down",e,j,true);break;case this.keyCodes.HOME:this._appFinderHomeEndButtonsHandler("home",e,j);break;case this.keyCodes.END:this._appFinderHomeEndButtonsHandler("end",e,j);break;case this.keyCodes.SPACE:this._spaceButtonHandler(e,j);break;default:return;}}},_dashboardKeydownHandler:function(e){var t=document.activeElement&&document.activeElement.tagName;if(t==="INPUT"||t==="TEXTAREA"){return;}var p=e.keyCode,i=sap.ui.getCore().getConfiguration().getRTL(),j=q(document.activeElement);if(i){if(p===this.keyCodes.ARROW_RIGHT){p=this.keyCodes.ARROW_LEFT;}else if(p===this.keyCodes.ARROW_LEFT){p=this.keyCodes.ARROW_RIGHT;}}switch(p){case this.keyCodes.F2:this._renameGroup(j);break;case this.keyCodes.F7:this._groupHeaderNavigation(j);break;case this.keyCodes.DELETE:case this.keyCodes.BACKSPACE:this._deleteButtonHandler(j);break;case this.keyCodes.ARROW_UP:this._arrowsButtonsHandler("up",e,j);break;case this.keyCodes.ARROW_DOWN:this._arrowsButtonsHandler("down",e,j);break;case this.keyCodes.ARROW_RIGHT:this._arrowsButtonsHandler("right",e,j);break;case this.keyCodes.ARROW_LEFT:this._arrowsButtonsHandler("left",e,j);break;case this.keyCodes.PAGE_UP:this._goToFirstTileOfNextGroup("up",e);break;case this.keyCodes.PAGE_DOWN:this._goToFirstTileOfNextGroup("down",e);break;case this.keyCodes.HOME:this._homeEndButtonsHandler("first",e,j);break;case this.keyCodes.END:this._homeEndButtonsHandler("last",e,j);break;case this.keyCodes.SPACE:this._spaceButtonHandler(e,j);break;case this.keyCodes.ENTER:this._spaceButtonHandler(e,j);break;default:break;}return true;}};return b;});
