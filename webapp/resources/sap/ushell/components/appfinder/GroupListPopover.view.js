// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/m/ResponsivePopover","sap/ushell/resources","sap/m/ScrollContainer","sap/ui/Device","sap/m/StandardListItem","sap/m/List","sap/m/Input","sap/m/Button","sap/ui/core/IconPool","sap/m/Bar","sap/m/Label","sap/m/DisplayListItem","sap/m/library","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(q,R,r,S,D,a,L,I,B,b,c,d,e,m,F,f){"use strict";var g=m.ListMode;var h=m.ListType;sap.ui.jsview("sap.ushell.components.appfinder.GroupListPopover",{getControllerName:function(){return"sap.ushell.components.appfinder.GroupListPopover";},createContent:function(i){this.oPopover=new R({id:"groupsPopover",placement:"Auto",title:r.i18n.getText("addTileToGroups_popoverTitle"),contentWidth:"20rem",beginButton:this._getCloseButton(),content:this._getListContainer(),afterClose:[i._afterCloseHandler,i]}).addStyleClass("sapContrastPlus");this.addDependent(this.oPopover);this.oPopover.setInitialFocus(this._getNewGroupListItem());},open:function(o){if(document.body.clientHeight-o.getDomRef().getBoundingClientRect().bottom>=310){this.oPopover.setPlacement("Bottom");}this.oPopover.openBy(o);if(this.getViewData().singleGroupSelection){this.getController()._setFooterVisibility(false);}this.deferred=q.Deferred();return this.deferred.promise();},_getListContainer:function(){if(!this._oListContainer){var G=this._getGroupList();this._oListContainer=new S({id:"popoverContainer",horizontal:false,vertical:true,content:[G],height:D.system.phone?"100%":"190px"});}return this._oListContainer;},_getNewGroupInput:function(){if(!this._oNewGroupNameInput){this._oNewGroupNameInput=new I("newGroupNameInput",{type:"Text",placeholder:r.i18n.getText("new_group_name")});}return this._oNewGroupNameInput;},_getNewGroupHeader:function(){if(!this._oNewGroupHeader){var C=this.getController();var o=new B({icon:b.getIconURI("nav-back"),press:[C._backButtonHandler,C],tooltip:r.i18n.getText("newGroupGoBackBtn_tooltip")});o.addStyleClass("sapUshellCatalogNewGroupBackButton");this._oNewGroupHeader=new c("oHeadBar",{contentLeft:[o],contentMiddle:[new d({text:r.i18n.getText("newGroup_popoverTitle")})]});}return this._oNewGroupHeader;},_getGroupList:function(){if(!this._oGroupList){var C=this.getController();var l=new e({label:"{oGroup/title}",selected:"{selected}",tooltip:"{oGroup/title}",type:h.Active});var u=[new F("oGroup/isGroupLocked",f.EQ,false)];var v=this.getViewData();if(v.enableHideGroups){u.push(new F("oGroup/isGroupVisible",f.EQ,true));}this._oGroupList=new L({mode:v.singleGroupSelection?g.SingleSelectMaster:g.MultiSelect,items:{path:"/userGroupList",template:l,filters:u,templateShareable:false},itemPress:[C._groupListItemClickHandler,C]});var n=this._getNewGroupListItem();this._oGroupList.addEventDelegate({onBeforeRendering:function(){this._oGroupList.insertAggregation("items",n,0,true);}.bind(this),onAfterRendering:function(){this._oGroupList.removeAggregation("items",n,true);}.bind(this)});}return this._oGroupList;},_getNewGroupListItem:function(){if(!this._oNewGroupItem){this._oNewGroupItem=new a("newGroupItem",{title:r.i18n.getText("newGroup_listItemText"),type:h.Navigation});this._oNewGroupItem.data("newGroupItem",true);this._oNewGroupItem.getList=function(){return this._oGroupList;}.bind(this);this._oNewGroupItem.getModeControl=function(){return null;};this._oNewGroupItem.onsapspace=function(i){i.preventDefault();i.isMarked();};this._oNewGroupItem.addEventDelegate({onsaptabnext:function(E){E.preventDefault();E._bIsStopHandlers=true;this._getCloseButton().focus();}});}return this._oNewGroupItem;},_getCancelButton:function(){if(!this._oCancelButton){var C=this.getController();this._oCancelButton=new B("cancelButton",{press:[C._cancelButtonPress,C],text:r.i18n.getText("cancelBtn")});}return this._oCancelButton;},_getCloseButton:function(){if(!this._oCloseButton){var C=this.getController();this._oCloseButton=new B("closeButton",{press:[C._okayCancelButtonPress,C],text:r.i18n.getText("closeBtn")});}return this._oCloseButton;}});});
