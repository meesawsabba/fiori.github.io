// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/Device","sap/ushell/Config","sap/ushell/UserActivityLog","sap/base/Log","sap/ui/core/Component","sap/ui/thirdparty/jquery"],function(D,C,U,L,a,q){"use strict";var s={PERS_KEY:"flp.settings.FlpSettings",bFlpSettingsAdded:false,toggleUserActivityLog:function(){C.on("/core/extension/SupportTicket").do(function(c){if(c){U.activate();}else{U.deactivate();}});},initializeAccessKeys:function(){if(D.system.desktop){sap.ui.require(["sap/ushell/components/ComponentKeysHandler","sap/ushell/renderers/fiori2/AccessKeysHandler"],function(b,A){b.getInstance().then(function(c){A.registerAppKeysHandler(c.handleFocusOnMe);});});}},getEffectiveHomepageSetting:function(c,b){var p,e=C.last(b)!==false,i=c.split("/").reverse()[0];if(e){p=this._getPersonalization(i);}else{p=Promise.resolve();}return p.then(function(v){v=v||C.last(c);if(v!==undefined){C.emit(c,v);}return v;}).catch(function(){return C.last(c);});},_getPersonalization:function(i){return s.getPersonalizer(i,sap.ushell.Container.getRenderer("fiori2")).then(function(p){return new Promise(function(r,R){p.getPersData().done(r).fail(function(e){L.error("Failed to load "+i+" from the personalization",e,"sap.ushell.components.flp.settings.FlpSettings");R();});});});},getPersonalizer:function(i,c){return sap.ushell.Container.getServiceAsync("Personalization").then(function(p){var o=a.getOwnerComponentFor(c);var S={keyCategory:p.constants.keyCategory.FIXED_KEY,writeFrequency:p.constants.writeFrequency.LOW,clientStorageAllowed:true};var P={container:this.PERS_KEY,item:i};return p.getPersonalizer(P,S,o);}.bind(this));}};return s;});
