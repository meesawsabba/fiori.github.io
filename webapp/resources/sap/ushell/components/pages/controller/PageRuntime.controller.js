//Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/library","sap/ushell/library","sap/ui/core/mvc/Controller","sap/ui/events/KeyCodes","sap/m/GenericTile","sap/ushell/resources","sap/ui/model/json/JSONModel","sap/ushell/Config","sap/m/library","sap/m/MessageToast","sap/ushell/components/pages/StateManager","sap/ushell/EventHub","sap/ushell/utils","sap/m/Button","sap/base/strings/capitalize","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ushell/components/pages/controller/PagesAndSpaceId","sap/ushell/components/pages/MyHomeImport","sap/ui/thirdparty/hasher","sap/base/Log"],function(c,u,C,K,G,r,J,a,l,M,s,E,U,B,b,F,d,P,e,h,L){"use strict";var I=c.InvisibleMessageMode;var f=l.LoadState;var D=u.DisplayFormat;return C.extend("sap.ushell.components.pages.controller.Pages",{onInit:function(){this._oVisualizationInstantiationServicePromise=sap.ushell.Container.getServiceAsync("VisualizationInstantiation");this._oURLParsingService=sap.ushell.Container.getServiceAsync("URLParsing");this._oViewSettingsModel=new J({sizeBehavior:a.last("/core/home/sizeBehavior"),actionModeActive:false,showHideButton:a.last("/core/catalog/enableHideGroups"),showAddButton:a.last("/core/catalog/enabled"),personalizationEnabled:a.last("/core/shell/enablePersonalization"),showPageTitle:false});this.getView().setModel(this._oViewSettingsModel,"viewSettings");this._sMyHomePageId=a.last("/core/spaces/myHome/myHomePageId");this._aConfigListeners=a.on("/core/home/sizeBehavior").do(function(S){this._oViewSettingsModel.setProperty("/sizeBehavior",S);}.bind(this));this._oErrorPageModel=new J({icon:"sap-icon://documents",text:"",description:"",details:""});this.getView().setModel(this._oErrorPageModel,"errorPage");this.oInitFinishedPromise=Promise.all([this._oVisualizationInstantiationServicePromise,this.getOwnerComponent().getPagesService()]).then(function(S){this._oVisualizationInstantiationService=S[0];this.getView().setModel(S[1].getModel());}.bind(this));E.emit("S4MyHomePlugin",this.byId("pagesNavContainer").getId());this.sCurrentTargetPageId="";var R=sap.ushell.Container.getRenderer();this._openFLPPage().then(function(){this.oContainerRouter=R.getRouter();this.oContainerRouter.getRoute("home").attachMatched(this._onPageComponentNavigation,this);this.oContainerRouter.getRoute("openFLPPage").attachMatched(this._onPageComponentNavigation,this);}.bind(this));this.bIsHomeIntentRootIntent=U.isFlpHomeIntent(R.getShellConfig().rootIntent);this.oErrorPage=this.byId("errorPage");this.oPagesNavContainer=this.byId("pagesNavContainer");this.oPagesRuntimeNavContainer=this.byId("pagesRuntimeNavContainer");s.init(this.oPagesRuntimeNavContainer,this.oPagesNavContainer);this.oEventHubListener=E.once("PagesRuntimeRendered").do(this._onFirstPageRendering.bind(this));this._oEventBus=sap.ui.getCore().getEventBus();this._oEventBus.subscribe("launchpad","shellFloatingContainerIsDocked",this._handleUshellContainerDocked,this);this._oEventBus.subscribe("launchpad","shellFloatingContainerIsUnDocked",this._handleUshellContainerDocked,this);this.oVisualizationInstantiationListener=E.on("VizInstanceLoaded").do(function(){this._setPerformanceMark();if(!this.oVisualizationInstantiationListenerTimeout){this.oVisualizationInstantiationListenerTimeout=setTimeout(function(){this.oVisualizationInstantiationListener.off();}.bind(this),5000);}}.bind(this));},_onFirstPageRendering:function(){var p=a.last("/core/shell/enablePersonalization");var m=a.last("/core/spaces/myHome/userEnabled")&&a.last("/core/spaces/myHome/enabled");if(p){this._createActionModeButton();}else if(m){sap.ushell.Container.getServiceAsync("Menu").then(function(o){return o.getMyHomeSpace();}).then(function(H){if(!H||!H.pages.length){return;}var g=H.pages[0].title;this._createActionModeButton(g);}.bind(this));}E.emit("firstSegmentCompleteLoaded",true);},_onPageComponentNavigation:function(){this._removeMyHomePage();this._openFLPPage();var A=sap.ui.getCore().byId("ActionModeBtn");if(A&&!this.bIsHomeIntentRootIntent){var R=sap.ushell.Container.getRenderer("fiori2");if(R.getShellConfig().moveEditHomePageActionToShellHeader){R.showHeaderEndItem(A.getId(),true);}else{R.showActionButton(A.getId(),true);}}},_setPerformanceMark:function(){U.setPerformanceMark("FLP-TTI-Homepage",{bUseUniqueMark:true,bUseLastMark:true});},_openFLPPage:function(){var p,S;return P._getPageAndSpaceId().then(function(i){p=i.pageId;S=i.spaceId;this.sCurrentTargetPageId=p;this.sCurrentTargetSpaceId=S;return Promise.all([this.oInitFinishedPromise,sap.ushell.Container.getServiceAsync("Menu")]).then(function(R){var m=R[1];return m.isSpacePageAssigned(S,p);}).then(function(A){if(!A){return Promise.reject("The combination of space and page is not assgined to the user.");}return this.getOwnerComponent().getPagesService();}.bind(this)).then(function(g){return g.loadPage(p);}).then(function(){this._showActionModeButton();if(this.sCurrentTargetPageId===p){if(this._isMyHomeRouteActive()){this._oViewSettingsModel.setProperty("/personalizationEnabled",true);if(this._isMyHomePageEmpty()){return this._navigateToInitialMyHome();}}else{this._oViewSettingsModel.setProperty("/personalizationEnabled",a.last("/core/shell/enablePersonalization"));}return this._navigate(p,S);}return Promise.resolve();}.bind(this)).then(this._notifyOnPageRuntimeRendered.bind(this)).catch(function(g){if(g instanceof Error){this._oErrorPageModel.setProperty("/text",r.i18n.getText("PageRuntime.GeneralError.Text"));}else{var j=r.i18n.getText("PageRuntime.CannotLoadPage.Description")+JSON.stringify(g);this._oErrorPageModel.setProperty("/icon","sap-icon://documents");this._oErrorPageModel.setProperty("/text",r.i18n.getText("PageRuntime.CannotLoadPage.Text",[p,S]));this._oErrorPageModel.setProperty("/description","");this._oErrorPageModel.setProperty("/details",j);}this.oPagesRuntimeNavContainer.to(this.oErrorPage);this._hideActionModeButton();this._cancelActionMode();this._notifyOnPageRuntimeRendered();}.bind(this));}.bind(this)).catch(this._onError.bind(this));},_onError:function(g){this._oErrorPageModel.setProperty("/icon","sap-icon://documents");this._oErrorPageModel.setProperty("/text",g||"");this._oErrorPageModel.setProperty("/description","");this._oErrorPageModel.setProperty("/details","");this.oPagesRuntimeNavContainer.to(this.oErrorPage);this._hideActionModeButton();this._cancelActionMode();this._notifyOnPageRuntimeRendered();},_navigate:function(t,g,k){var p=this.oPagesNavContainer.getPages().find(function(o){return t===o.data("pageId");});if(!p){return Promise.reject();}var m;return sap.ushell.Container.getServiceAsync("Menu").then(function(S){m=S;return m.hasMultiplePages(g);}).then(function(H){var S=this.oPagesNavContainer.getCurrentPage()===p;this._oViewSettingsModel.setProperty("/showPageTitle",H);this.oPagesNavContainer.to(p);this.oPagesRuntimeNavContainer.to(this.oPagesNavContainer);if(!S&&!k){this._cancelActionMode();}m.getSpaceAndPageTitles(g,t).then(function(T){var o={pageTitle:T.pageTitle,spaceTitle:T.spaceTitle,hash:h.getHash()};a.emit("/core/shell/model/currentSpaceAndPage",o);});}.bind(this));},_navigateToInitialMyHome:function(){if(!this._pLoadMyHomeView){this._pLoadMyHomeView=new Promise(function(g,i){sap.ui.require(["sap/ui/core/mvc/XMLView"],function(X){X.create({id:"sapUshellMyHomePage",viewName:"sap.ushell.components.pages.view.MyHomeStart"}).then(function(p){p.getController().connect({onEdit:this.pressActionModeButton.bind(this),onOpenDialog:this.openMyHomeImportDialog.bind(this)});g(p);}.bind(this)).catch(i);}.bind(this),i);}.bind(this));}return this._pLoadMyHomeView.then(function(p){this._cancelActionMode();this.oPagesNavContainer.insertPage(p,0);this.oPagesNavContainer.to(p);}.bind(this));},_notifyOnPageRuntimeRendered:function(){try{var p;var o=this.oPagesNavContainer.getCurrentPage();p=o&&o.getId();E.emit("S4Plugin_PagesRuntimeRendered",p);}catch(g){L.error("Error while trying to trigger the PagesRuntimeRendered event for the S/4 My Home plugin");}E.emit("PagesRuntimeRendered");if(E.last("AppRendered")!==undefined){E.emit("AppRendered",undefined);}},_pressViewDetailsButton:function(){var g=this._oErrorPageModel.getProperty("/details")||"";this._oErrorPageModel.setProperty("/description",g);},_copyToClipboard:function(){var t=document.createElement("textarea");try{t.contentEditable=true;t.readonly=false;t.textContent=this._oErrorPageModel.getProperty("/description");document.documentElement.appendChild(t);t.select();document.execCommand("copy");M.show(r.i18n.getText("PageRuntime.CannotLoadPage.CopySuccess"),{closeOnBrowserNavigation:false});}catch(o){M.show(r.i18n.getText("PageRuntime.CannotLoadPage.CopyFail"),{closeOnBrowserNavigation:false});}finally{t.parentNode.removeChild(t);}},_visualizationFactory:function(i,g){if(this._oVisualizationInstantiationService){var o=g.getObject();var p=g.getPath();var S=p.replace(/\/visualizations\/\d*\/?$/,"");var j=S.replace(/\/sections\/\d*\/?$/,"");var k=g.getModel().getProperty(S);var m=g.getModel().getProperty(j);var v=this._oVisualizationInstantiationService.instantiateVisualization(o);v.attachPress(this.onVisualizationPress,this);v.bindEditable("viewSettings>/actionModeActive");if(!k.default){this._addTileActions(v,m.id);}var n=g.getPath().split("/")[2];var A=!!s.getPageVisibility("/pages/"+n);v.setActive(A);return v;}return new G({state:f.Failed});},_addTileActions:function(v,p){var A=v.getAvailableDisplayFormats(),m=a.last("/core/spaces/myHome/userEnabled")&&a.last("/core/spaces/myHome/enabled"),g=p===this._sMyHomePageId;for(var i=0;i<A.length;i++){v.addTileAction(new B({text:"{i18n>VisualizationInstance.ConvertTo"+b(A[i])+"Action}",press:[A[i],this._updateVisualizationDisplayFormat,this]}));}v.addTileAction(new B({text:"{i18n>moveTileDialog_action}",press:[v,this._openMoveVisualizationDialog,this]}));if(m&&!g){v.addTileAction(new B({text:"{i18n>addToMyHome_action}",press:[v,this._addToMyHome,this]}));}},_openMoveVisualizationDialog:function(o,v){this._oVizInstanceToBeMoved=v;var V=v.getBindingContext().getPath();var g=V.split("/");var i="/pages/"+g[2]+"/sections";if(!this._oMoveVisualizationDialog){sap.ui.require(["sap/ui/core/Fragment"],function(j){j.load({name:"sap.ushell.components.pages.MoveVisualization",controller:this}).then(function(k){this._oMoveVisualizationDialog=k;this.getView().addDependent(k);k.bindObject({path:i});k.open();}.bind(this));}.bind(this));}else{this._oMoveVisualizationDialog.bindObject({path:i});this._oMoveVisualizationDialog.open();}},_addToMyHome:function(o,v){var V=v.getBindingContext().getObject();return this.getOwnerComponent().getPagesService().then(function(p){return p.copyVisualization(this._sMyHomePageId,null,V);}.bind(this)).then(function(){M.show(r.i18n.getText("PageRuntime.MessageToast.TileAddedToMyHome"));});},_confirmSelect:function(o){var g=new F("default",d.EQ,false);var i=o.getSource().getBinding("items");i.filter([g]);var v=this._oVizInstanceToBeMoved.getBindingContext().getPath();var V=v.split("/");var p=V[2];var j=V[4];var k=V[6];var t=o.getParameter("selectedItem").getBindingContext().getPath();var T=t.split("/");var m=T[4];var S=this._getAncestorControl(this._oVizInstanceToBeMoved,"sap.ushell.ui.launchpad.Section");var n=this._getAncestorControl(this._oVizInstanceToBeMoved,"sap.ushell.ui.launchpad.Page");var q=n.getSections();var w=q[m];var A=S.getItemPosition(this._oVizInstanceToBeMoved).area;this._oVizInstanceToBeMoved=null;var x=this.getOwnerComponent();return x.getPagesService().then(function(y){return y.moveVisualization(p,j,k,m,-1);}).then(function(R){var y=w.getVisualizations()[R.visualizationIndex];if(y){w.focusVisualization(y);}var z=this._getVizMoveAnnouncement(A,A);x.getInvisibleMessageInstance().announce(z,I.Polite);}.bind(this));},_onMoveTileSearch:function(o){var v=o.getParameter("value");var g=new F("title",d.Contains,v);var i=new F("default",d.EQ,false);var j=o.getParameter("itemsBinding");j.filter([g,i]);},_onMoveTileDialogClose:function(o){this._oVizInstanceToBeMoved=null;var g=new F("default",d.EQ,false);o.getSource().getBinding("items").filter([g]);},_updateVisualizationDisplayFormat:function(o,n){var g=o.getSource().getBindingContext();var p=g.getPath();var i=p.split("/");var O;var j=this.getOwnerComponent();return j.getPagesService().then(function(k){O=k.getModel().getProperty(p).displayFormatHint;var v={displayFormatHint:n};return k.updateVisualization(i[2],i[4],i[6],v);}).then(function(){var k=this._getVizMoveAnnouncement(O,n);j.getInvisibleMessageInstance().announce(k,I.Polite);}.bind(this));},onVisualizationPress:function(o){var S=o.getParameter("scope");var A=o.getParameter("action");var v=o.getSource();var g=v.getBindingContext();var p=g.getPath();var i=p.split("/");var j=this._getAncestorControl(v,"sap.ushell.ui.launchpad.Section");if(S==="Actions"&&A==="Remove"){return this.getOwnerComponent().getPagesService().then(function(k){var O=j.getItemPosition(v);k.deleteVisualization(i[2],i[4],i[6]);M.show(r.i18n.getText("PageRuntime.MessageToast.TileRemoved"));j._focusItem(O);});}return Promise.resolve();},onExit:function(){this.oContainerRouter.getRoute("home").detachMatched(this._onPageComponentNavigation,this);this.oContainerRouter.getRoute("openFLPPage").detachMatched(this._onPageComponentNavigation,this);this._aConfigListeners.off();this.oEventHubListener.off();this._oEventBus.unsubscribe("launchpad","shellFloatingContainerIsDocked",this._handleUshellContainerDocked,this);this._oEventBus.unsubscribe("launchpad","shellFloatingContainerIsUnDocked",this._handleUshellContainerDocked,this);s.exit();var A=sap.ui.getCore().byId("ActionModeBtn");if(A){A.destroy();}},_hideActionModeButton:function(){var A=sap.ui.getCore().byId("ActionModeBtn");if(A){A.setVisible(false);}},_showActionModeButton:function(){var A=sap.ui.getCore().byId("ActionModeBtn");if(A){A.setVisible(true);}},_createActionModeButton:function(p){var g=p?r.i18n.getText("PageRuntime.EditModeForPage.Activate",p):r.i18n.getText("PageRuntime.EditMode.Activate");var A={id:"ActionModeBtn",text:g,tooltip:g,icon:"sap-icon://edit",press:[this.pressActionModeButton,this]};var R=sap.ushell.Container.getRenderer("fiori2");var m=R.getShellConfig().moveEditHomePageActionToShellHeader;if(m){this._createHeaderActionModeButton(A);}else{this._createUserActionModeButton(A);}},_createHeaderActionModeButton:function(A){sap.ui.require(["sap/ushell/ui/shell/ShellHeadItem"],function(S){var o=new S(A);if(a.last("/core/extension/enableHelp")){o.addStyleClass("help-id-ActionModeBtn");}var R=sap.ushell.Container.getRenderer("fiori2");if(this.bIsHomeIntentRootIntent){R.showHeaderEndItem(o.getId(),false,["home"]);}else{R.showHeaderEndItem(o.getId(),true);}}.bind(this));},_createUserActionModeButton:function(A){var o={controlType:"sap.ushell.ui.launchpad.ActionItem",oControlProperties:A,bIsVisible:true,aStates:["home"]};if(!this.bIsHomeIntentRootIntent){o.aStates=null;o.bCurrentState=true;}sap.ushell.Container.getRenderer("fiori2").addUserAction(o).done(function(g){if(a.last("/core/extension/enableHelp")){g.addStyleClass("help-id-ActionModeBtn");}});},pressActionModeButton:function(){var v=this.getView().getModel("viewSettings");var A=v.getProperty("/actionModeActive");var p=v.getProperty("/personalizationEnabled");sap.ui.require(["sap/ushell/components/pages/ActionMode"],function(g){if(A){g.cancel();return;}else if(p||this._isMyHomeRouteActive()){g.start(this);}else{this.oPagesNavContainer.attachEventOnce("afterNavigate",function(){g.start(this);}.bind(this));this.oContainerRouter.navTo("home");}}.bind(this));},_cancelActionMode:function(){var A=this.getView().getModel("viewSettings").getProperty("/actionModeActive");if(A){sap.ui.require(["sap/ushell/components/pages/ActionMode"],function(g){g.cancel();});}},handleEditModeAction:function(H,o,S,p){sap.ui.require(["sap/ushell/components/pages/ActionMode"],function(A){A[H](o,S,p);});},_getAncestorControl:function(g,i){if(g&&g.isA&&g.isA(i)){return g;}else if(g&&g.getParent){return this._getAncestorControl(g.getParent(),i);}return null;},moveVisualization:function(o){var g=o.getParameter("draggedControl"),i=o.getParameter("droppedControl"),j=o.getParameter("dropPosition"),k=o.getParameter("browserEvent"),m=k&&k.keyCode,p=this._getAncestorControl(g,"sap.ushell.ui.launchpad.Page"),n=parseInt(g.getBindingContext().getPath().split("/")[2],10),q=this._getAncestorControl(g,"sap.ushell.ui.launchpad.Section"),t=p.indexOfSection(q),v=q.indexOfVisualization(g),w=q.getVisualizations()[v],x=q.getItemPosition(w),T,y,z,A,H;if(!i){var N=o.mParameters.browserEvent.keyCode===K.ARROW_UP,S=p.getSections();y=t;while(true){y=N?--y:++y;T=S[y];if(!T||T.getDefault()){w.invalidate();return Promise.resolve();}if(T.getShowSection()||T.getEditable()){z=T.getClosestCompactItemIndex(g.getDomRef(),N);A=T.getVisualizations()[z];H=T.getItemPosition(A);if(H.area!==x.area){H=x;}break;}}}else{if(i.isA("sap.ushell.ui.launchpad.section.CompactArea")){var O=i.getItems();if(O.length){i=O[O.length-1];j="After";}}T=this._getAncestorControl(i,"sap.ushell.ui.launchpad.Section");y=p.indexOfSection(T);if(T.getDefault()&&!q.getDefault()){w.invalidate();return Promise.resolve();}z=T.indexOfVisualization(i);A=T.getVisualizations()[z];H=T.getItemPosition(A);if(H.index===-1){H.area=x.area;}if(t===y){if(j==="Before"&&v<z){z--;}else if(j==="After"&&v>z){z++;}if(v===z&&H.area===x.area){w.invalidate();return Promise.resolve();}}else if(j==="After"){z++;}}if((t!==y)&&(m===K.ARROW_UP||m===K.ARROW_DOWN)&&(x.index>H.index)){z++;}var Q;var R=this.getOwnerComponent();return R.getPagesService().then(function(V){Q=V;Q.enableImplicitSave(false);return Q.moveVisualization(n,t,v,y,z);}).then(function(V){z=V.visualizationIndex;if(x.area!==H.area){var W={displayFormatHint:H.area};return Q.updateVisualization(n,y,z,W);}return Promise.resolve();}).then(function(){return Q.savePersonalization();}).then(function(){var V=T.getVisualizations()[z];if(V){T.focusVisualization(V);V.invalidate();}var W=this._getVizMoveAnnouncement(x.area,H.area);R.getInvisibleMessageInstance().announce(W,I.Polite);}.bind(this)).finally(function(){Q.enableImplicitSave(true);});},_getVizMoveAnnouncement:function(g,t){if(g===t){if(t===D.Compact){return r.i18n.getText("PageRuntime.Message.LinkMoved");}return r.i18n.getText("PageRuntime.Message.TileMoved");}else if(g===D.Compact){return r.i18n.getText("PageRuntime.Message.LinkConverted");}return r.i18n.getText("PageRuntime.Message.TileConverted");},onDragEnter:function(o){var t=o.getParameter("dragSession").getDropControl();if(t.getDefault()){o.preventDefault();}},onAreaDragEnter:function(o){var S=o.getParameter("sourceArea");var t=o.getParameter("targetArea");if(S===t){return;}var v=o.getParameter("dragControl");var A=v.getAvailableDisplayFormats();if(A.indexOf(t)===-1){if(t===D.Standard&&A.indexOf(D.StandardWide)>-1){return;}if(t===D.Flat&&A.indexOf(D.FlatWide)>-1){return;}o.getParameter("originalEvent").preventDefault();}},_handleUshellContainerDocked:function(g,i){this._oViewSettingsModel.setProperty("/ushellContainerDocked",i==="shellFloatingContainerIsDocked");},_isMyHomeRouteActive:function(){return a.last("/core/spaces/myHome/enabled")&&a.last("/core/spaces/myHome/userEnabled")&&a.last("/core/spaces/myHome/myHomeSpaceId")===this.sCurrentTargetSpaceId;},_getMyHomePageData:function(){var p=this.getView().getModel().getProperty("/pages")||[];for(var i=0;i<p.length;i++){if(p[i]&&p[i].id==="SAP_BASIS_PG_UI_MYHOME"){return p[i];}}return null;},_isMyHomePageEmpty:function(){var p=this._getMyHomePageData();if(p&&p.sections){return p.sections.every(function(S){var v=S.visualizations;return!(v&&v.length);});}return false;},handleMyHomeActionMode:function(g){if(this._isMyHomeRouteActive()){if(g){return this._enterMyHomeActionMode();}else if(this._isMyHomePageEmpty()){return this._navigateToInitialMyHome();}}return Promise.resolve();},_enterMyHomeActionMode:function(){return Promise.all([this._navigate(this.sCurrentTargetPageId,this.sCurrentTargetSpaceId,true),e.isImportEnabled()]).then(function(R){if(!R[1]){if(this._pMessageStrip){this._pMessageStrip.then(function(m){m.setVisible(false);});}return Promise.resolve();}if(!this._pMessageStrip){this._pMessageStrip=new Promise(function(g,i){sap.ui.require(["sap/ui/core/Fragment"],function(j){j.load({name:"sap.ushell.components.pages.view.MessageStrip",controller:this}).then(function(m){E.on("importBookmarksFlag").do(function(v){m.setVisible(!!v);});m.addStyleClass("sapUiSmallMarginBottom");g(m);}).catch(i);}.bind(this),i);}.bind(this));}return this._pMessageStrip.then(function(m){this.oPagesNavContainer.getCurrentPage().getContent()[0].setMessageStrip(m);}.bind(this));}.bind(this));},openMyHomeImportDialog:function(){if(!this._pLoadImportDialog){this._pLoadImportDialog=new Promise(function(g,i){sap.ui.require(["sap/ushell/components/pages/controller/ImportDialog.controller"],function(j){g(new j());},i);});}return this._pLoadImportDialog.then(function(i){return i.open();});},onImportDialogPress:function(){this.openMyHomeImportDialog();},onMessageStripClose:function(){e.setImportEnabled(false);sap.ui.require(["sap/m/MessageBox"],function(g){g.information(r.i18n.getText("MyHome.InitialPage.MessageStrip.Popup"));});},_removeMyHomePage:function(){this.oPagesNavContainer.removePage("sapUshellMyHomePage");},_sectionEnableReset:function(g,p){if(g===a.last("/core/spaces/myHome/presetSectionId")){return false;}return p;},_sectionEnableDelete:function(g,p){if(g===a.last("/core/spaces/myHome/presetSectionId")){return false;}return!p;}});});
