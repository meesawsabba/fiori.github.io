// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/_VisualizationInstantiation/VizInstance","sap/m/library","sap/base/Log","sap/ushell/library","sap/ushell/utils/chipsUtils","sap/ushell/services/_VisualizationInstantiation/VizInstanceRenderer"],function(V,m,L,u,c,a){"use strict";var b=m.LoadState;var D=u.DisplayFormat;var d=V.extend("sap.ushell.ui.launchpad.VizInstanceAbap",{metadata:{library:"sap.ushell"},renderer:a});d.prototype.init=function(){V.prototype.init.apply(this,arguments);this._oChipInstancePromise=sap.ushell.Container.getServiceAsync("PageBuilding").then(function(p){var f=p.getFactory();var i=this.getInstantiationData();var r;var B;if(!i.simplifiedChipFormat){r={chipId:i.chip.id,chip:i.chip};}else{var s=i.chip||{};B=s.bags;r={chipId:s.chipId,configuration:s.configuration?JSON.stringify(s.configuration):"{}"};}var C=f.createChipInstance(r);c.addBagDataToChipInstance(C,B);return C;}.bind(this));};d.prototype.load=function(i){return this._oChipInstancePromise.then(function(r){this._oChipInstance=r;return new Promise(this._oChipInstance.load);}.bind(this)).then(function(){if(this.getPreview()){var p=this._oChipInstance.getContract("preview");if(p){p.setEnabled(true);}}var v=this._oChipInstance.getImplementationAsSapui5();this._setChipInstanceType();this._setContent(v);return Promise.resolve();}.bind(this)).catch(function(e){this.setState(b.Failed);return Promise.reject(e);}.bind(this));};d.prototype._setChipInstanceType=function(){var t=this._oChipInstance.getContract("types");if(t){t.setType(this._mapDisplayFormatToChip(this.getDisplayFormat()));}};d.prototype._mapDisplayFormatToChip=function(s){var o={};o[D.Standard]="tile";o[D.StandardWide]="tile";o[D.Compact]="link";o[D.Flat]="flat";o[D.FlatWide]="flatwide";return o[s];};d.prototype._setVisible=function(v){var o=this._oChipInstance&&!this._oChipInstance.isStub()&&this._oChipInstance.getContract("visible");if(o){o.setVisible(v);}};d.prototype.refresh=function(){if(this._oChipInstance){this._oChipInstance.refresh();}};d.prototype.setActive=function(e,r){this._setVisible(e);if(r){this.refresh();}return this.setProperty("active",e,false);};return d;});
