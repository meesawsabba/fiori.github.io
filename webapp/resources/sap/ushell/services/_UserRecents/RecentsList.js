// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["./UserRecentsBase"],function(U){"use strict";var R=U.extend("sap.ushell.services.RecentsList");R.prototype._updateIfAlreadyIn=function(i,t){return this.aRecents.some(function(r){var f;if(this._compareItems(r.oItem,i)){r.oItem=i;r.iTimestamp=t;r.iCount=r.iCount+1;f=true;}else{f=false;}return f;}.bind(this));};R.prototype._insertNew=function(i,t){var n={oItem:i,iTimestamp:t,iCount:1};if(this.aRecents.length===this.iMaxItems){this.aRecents.sort(U._itemSorter);this.aRecents.pop();}this.aRecents.push(n);};R.prototype.clearAllActivities=function(){return this._save([]);};R.prototype.newItem=function(i){var d=new jQuery.Deferred();var t=Date.now();var a;this._load().done(function(l){this.aRecents=l||[];a=this._updateIfAlreadyIn(i,t);if(!a){this._insertNew(i,t);}this._save(this.aRecents).done(function(){d.resolve();}).fail(function(){d.reject();});}.bind(this));return d.promise();};R.prototype.getRecentItems=function(){var d=new jQuery.Deferred();this._load().done(function(l){l=l||[];l.sort(U._itemSorter);this.aRecents=l.slice(0,this.iMaxItems);d.resolve(jQuery.map(this.aRecents,function(r){return r.oItem;}));}.bind(this));return d.promise();};return R;});
