// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/service/ServiceFactory","sap/ui/core/service/Service","sap/base/Log","sap/base/util/ObjectPath","sap/base/util/isPlainObject"],function(S,a,L,O,b){"use strict";var A;function s(i){A=i;}function g(){return A;}function c(m){return!!/^[^_].+/.test(m);}function d(o){var p,P=[];for(p in o){P.push(p);}return P;}function e(p,P,m){var o=P[m];P[m]=function(){var i,n,C=g();if(!p||p.scopeObject.getId()!==C){L.warning("Call to "+m+" is not allowed","This may be caused by an app component other than the active '"+C+"' that tries to call the method","sap.ushell.Ui5ServiceFactory");return undefined;}n=new Array(arguments.length);for(i=0;i<n.length;++i){n[i]=arguments[i];}return o.apply(P,n);};}function f(u,p,P,i){d(u).filter(c).filter(function(n){var v=u[n];p[n]=v;return typeof v==="function";}).forEach(function(F){p[F]=p[F].bind(u);if(i){e(P,p,F);}});}function h(C){var G;if(typeof C==="undefined"){return true;}if(!b(C)){return false;}if(!C.scopeType){return false;}G=O.get("scopeObject.getId",C);if(typeof G!=="function"){return false;}return true;}function j(p,u,i){var P={};if(i){i=typeof p==="object";}f(u,P,p,i);if(i&&p.scopeType==="component"&&p.scopeObject&&p.scopeObject.getId){s(p.scopeObject.getId());}return P;}function k(u){return sap.ushell.Container.getServiceAsync(u);}function l(u,i){var U=S.extend("sap.ushell.ui5service."+u+"Factory",{createInstance:function(p){return new Promise(function(r,R){k(u).then(function(o){var m,n,q;if(!h(p)){L.error("Invalid context for "+u+" service interface","The context must be empty or an object like { scopeType: ..., scopeObject: ... }","sap.ushell.Ui5ServiceFactory");R("Invalid Context for "+u+" service");return;}n=j(p,o,i);q=a.extend("sap.ushell.ui5service."+u,{getInterface:function(){return n;}});m=new q(p);r(m);},function(G){R(G);});});}});return new U();}return{createServiceFactory:l};});
