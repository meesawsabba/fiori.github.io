/*!
 * SAPUI5
  (c) Copyright 2009-2020 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/zen/commons/utils/jQuery","sap/zen/commons/utils/Utilities","sap/zen/commons/Format","sap/ui/core/Icon","sap/m/Input","sap/m/Link","sap/ui/core/CustomData","sap/zen/commons/utils/ResourceBundle","sap/zen/commons/thirdparty/lodash","sap/zen/commons/utils/jQuery"],function(L,q,U,F,I,a,b,C,R,_){"use strict";var K={Tab:9,Up:38,Down:40,Left:37,Right:39};function r(o,$){$.find(".sapUiZenCommonsGridOuterTable").css("width","");$.find(".sapUiZenCommonsGridVsb").remove();return o;}function c(o,$){var n=Math.min(o.getMaxColumns()-o.getFixedColumns(),o.getHash().maxColumns-o.getHash().minColumns+1);var i=o.getVirtualColumns()-n;var j=$.find(".sapUiZenCommonsGridHsbII").width()-$.find(".sapUiZenCommonsGridHsbI").width();return sap.ui.getCore().getConfiguration().getRTL()?j-Math.round(o.getOffsetColumn()*j/i):Math.round(o.getOffsetColumn()*j/i);}function d(o,$){var n=o.getVirtualRows()-Math.min(o.getHash().maxRows+1,o.getMaxRows())+o.getFixedColumns();var i=$.find(".sapUiZenCommonsGridVsbII").height()-$.find(".sapUiZenCommonsGridVsbI").height();return Math.round(o.getOffsetRow()*i/n);}function g(n){return!n.getVisible||n.getVisible()&&(n.getParent()?g(n.getParent()):true);}function e(n){return!n.getBusy||n.getBusy()&&(n.getParent()?e(n.getParent()):false);}function f(o){var H=o.getHash();H.rowRange=_.take(_.concat(_.range(o.getFixedRows()),_.range(o.getFixedRows()+o.getOffsetRow(),H.maxRows+1)),o.getMaxRows());H.colRange=_.take(_.concat(_.range(o.getFixedColumns()),_.range(o.getFixedColumns()+o.getOffsetColumn(),H.maxColumns+1)),o.getMaxColumns());}function h($,n){return $.find(["td[data-grid-column=",n,"]"].join(""));}function s($,n,i){if(!Number.isFinite(i)){throw new Error("Invalid width for column:"+n+" width:"+i);}var j=$.find(["td[data-grid-column=",n,"]"].join(""));if(!j.length){return;}var k=$.find(["td[data-grid-column=",n,"]>div"].join(""));k.width("100%");j.width(i);j.css("max-width",i+"px");j.css("min-width",i+"px");if(i!==j.width()){L.info("Failed to set width for column "+n+" to: "+i+" width: "+j.width());}k.css("width","");}function G(){var t=this;t.getDrillIconSize=_.constant(21);t.getScrollbarWidth=_.constant(16);var i={Title:{td:_.constant("sapUiZenCommonsGridTitleCellTd"),div:_.constant("sapUiZenCommonsGridTitleCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInner")},Header:{td:_.constant("sapUiZenCommonsGridHeaderCellTd"),div:_.constant("sapUiZenCommonsGridHeaderCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInner")},ResultHeader:{td:_.constant("sapUiZenCommonsGridHeaderResultCellTd"),div:_.constant("sapUiZenCommonsGridHeaderResultCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInner")},Result:{td:_.constant("sapUiZenCommonsGridStandardResultCellTd"),div:_.constant("sapUiZenCommonsGridStandardResultCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInner")},ResultCritical:{td:_.constant("sapUiZenCommonsGridStandardResultCellTd"),div:_.constant("sapUiZenCommonsGridStandardResultCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInnerCritical")},ResultPositive:{td:_.constant("sapUiZenCommonsGridStandardResultCellTd"),div:_.constant("sapUiZenCommonsGridStandardResultCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInnerPositive")},ResultNegative:{td:_.constant("sapUiZenCommonsGridStandardResultCellTd"),div:_.constant("sapUiZenCommonsGridStandardResultCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInnerNegative")},Standard:{td:function(){return"sapUiZenCommonsGridStandardCellTd";},div:_.constant("sapUiZenCommonsGridStandardCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInner")},Positive:{td:function(){return"sapUiZenCommonsGridStandardCellTd";},div:_.constant("sapUiZenCommonsGridStandardCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInnerPositive")},Negative:{td:function(){return"sapUiZenCommonsGridStandardCellTd";},div:_.constant("sapUiZenCommonsGridStandardCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInnerNegative")},Critical:{td:function(){return"sapUiZenCommonsGridStandardCellTd";},div:_.constant("sapUiZenCommonsGridStandardCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInnerCritical")},Empty:{td:function(){return"sapUiZenCommonsGridStandardCellTd";},div:_.constant("sapUiZenCommonsGridStandardCellDiv"),inner:_.constant("sapUiZenCommonsGridCellInner")}};function j(o,$){var n=o.getVirtualRows()-Math.min(o.getHash().maxRows+1,o.getMaxRows())+o.getFixedRows();o._bScrollV=true;var M=$.find(".sapUiZenCommonsGridVsbI");var N=$.find(".sapUiZenCommonsGridVsbII").height()-M.height();var O=M.scrollTop();var P=Math.round(n*O/N);if(P>n){L.warning("Invalid offset ");P=n;}$.find(".sapUiZenCommonsGridVTooltip").text(R.getText("VPOS",[P+1,P+Math.min(o.getHash().maxRows+1,o.getMaxRows())-o.getFixedRows(),o.getVirtualRows()]));}function k(o,$){var n=o.getVirtualColumns()-Math.min(o.getHash().maxColumns+1,o.getMaxColumns())+o.getFixedColumns();o._bScrollH=true;var M=$.find(".sapUiZenCommonsGridHsbI");var N=$.find(".sapUiZenCommonsGridHsbII").width()-M.width();var O=null;var P=M.scrollLeft();if(sap.ui.getCore().getConfiguration().getRTL()){O=Math.round(n*(N-P)/N);}else{O=Math.round(n*P/N);}if(O>n){L.warning("Invalid offset ");O=n;}var Q=Math.min(o.getMaxColumns()-o.getFixedColumns(),o.getHash().maxColumns-o.getHash().minColumns+1);$.find(".sapUiZenCommonsGridHTooltip").text(R.getText("HPOS",[O+1,O+Q,o.getVirtualColumns()]));}function l(o,$){if(!o._bScrollV){return;}delete o._bScrollV;var n=o.getVirtualRows()-Math.min(o.getHash().maxRows+1,o.getMaxRows())+o.getFixedRows();var M=$.find(".sapUiZenCommonsGridVsbI");M.off("mouseup");M.off("mouseleave");M.off("scroll");var N=$.find(".sapUiZenCommonsGridVsbII").height()-M.height();var O=M.scrollTop();var P=Math.round(n*O/N);if(o.getOffsetRow()!==P){if(P>n){L.warning("Invalid offset ");}if(Math.min(o.getHash().maxRows+1,o.getMaxRows())>o.getFixedRows()){u(o,$,Math.min(P,n));}}M.on("mouseup",l.bind(t,o,$));M.on("mouseleave",l.bind(t,o,$));M.on("scroll",j.bind(t,o,$));}function m(o,$){if(!o._bScrollH){return;}delete o._bScrollH;var n=o.getVirtualColumns()-Math.min(o.getHash().maxColumns-1,o.getMaxColumns())+o.getFixedColumns();var M=$.find(".sapUiZenCommonsGridHsbI");M.off("mouseup");M.off("mouseleave");M.off("scroll");var N=$.find(".sapUiZenCommonsGridHsbII").width()-M.width();var O=null;var P=M.scrollLeft();if(sap.ui.getCore().getConfiguration().getRTL()){O=Math.round(n*(N-P)/N);}else{O=Math.round(n*P/N);}if(o.getOffsetColumn()!==O){if(O>n){L.warning("Invalid offset ");}if(o.getMaxColumns()>o.getFixedColumns()){v(o,$,Math.min(O,n));}}M.on("mouseup",m.bind(t,o,$));M.on("mouseleave",m.bind(t,o,$));M.on("scroll",k.bind(t,o,$));}function p(o,$){if(!o._adjustVsbThumCtr){o._adjustVsbThumCtr=1;}else{return;}$.find(".sapUiZenCommonsGridVsbI").scrollTop(d(o,$));--o._adjustVsbThumCtr;}function u(o,$,n){if(isNaN(n)){throw new Error("Invalid offsetRow:"+n);}o.setOffsetRow(n);if(!x(o,$)){f(o);t.insertContentToGrid(o,$);p(o,$);}}function v(o,$,n,M,N){o.setOffsetColumn(n);if(!y(o,$,M,N)){f(o);t.insertContentToGrid(o,$);B(o,$);}}t.getStyle=function(S){return i[S];};t.clearButtonControls=function(n){_.forEach(n.getButtonControls?n.getButtonControls():[],function(o){o.destroy();});return t;};t.calcButtonControls=function(o){var n=o.getFixedRows();var M=o.getFixedColumns();t.clearButtonControls(o);var N=o.getHash();var O;if(o.getButtonControls){O=o.getButtonControls();}else{O={};o.getButtonControls=_.constant(O);}function P(Q){Q.preventDefault();Q.cancelBubble();var S=q(Q.getSource().getDomRef()).parent().parent().attr("data-grid-coord");var T=o.getHash()[S];if(!T){L.error("Cell: "+S+" not found");}else{o.fireDrill({cell:T});}}(function(Q,S){_.forEach(N.rowRange,function(T,V){_.forEach(N.colRange,function(W,X){if(W<M||T<n){var Y=new I([Q,"button",T,W].join("-"),S);O[V+":"+X]=Y;}});});}(o.getId(),{visible:false,press:P}));return t;};t.clearCellControls=function(n){_.forEach(n.getCellControls?n.getCellControls():[],function(o){o.destroy();},{});return t;};t.ensureResisable=function(n,$){var M=n.getId();_.forEach($.find(".sapUiZenCommonsGridRow>td"),function(o){var N=q(o);var O=N.attr("data-grid-column");var P=["sapUiZenCommonsGridAlsoResize",O,M].join("_");var T=$.find(["td[data-grid-column=",O,"]"].join(""));var Q=$.find(["td[data-grid-column=",N.attr("data-grid-column"),"]>div"].join(""));Q.addClass(P);N.resizable({handles:"e",alsoResize:"."+P,start:function(){n.bInResize=true;T.css("width","");H($);$.find(".sapUiZenCommonsGridVsb").css("visibility","hidden");$.find(".sapUiZenCommonsGridHsb").css("visibility","hidden");},stop:function(){if(n.getVirtualRows()>n.getMaxRows()){$.find(".sapUiZenCommonsGridVsb").css("visibility","visible");}if(n.getVirtualColumns()>n.getMaxColumns()){$.find(".sapUiZenCommonsGridVsb").css("visibility","visible");}var S=_.max(_.map(Q,function(o){return q(o).width();}));E(n,$);J($);Q.width(S);E(n,$);J($);var V=$.find(".sapUiZenCommonsGridInnerTable").width();$.find(".sapUiZenCommonsGridOuterTable").width(V+(n.getVirtualRows()>n.getMaxRows()?t.getScrollbarWidth():0));n.bInResize=false;var W=n.getParent();while(W&&!(W instanceof sap.m.VBox)){W=W.getParent();}var X=W?q(W.getDomRef()):q(n.getParent()&&n.getParent().getDomRef?n.getParent().getDomRef():$);if(X.length){t.doResize(n,$,{width:X.width(),height:X.height()});}D(n,$);}});});};t.doResize=function(M,$,P){if(!g(M)){return false;}if(!$.length){return false;}var N=$.find(".sapUiZenCommonsGridFirstRow");if(!N.length){L.error("FirstRow not found");return false;}var O=N.height();var Q=P.height-60;var S=U.trunc(Q/O);S=Math.min(S,M.getVirtualRows()+M.getFixedRows());if(S>M.getFixedRows()&&M.getMaxRows()!==S){M.setMaxRows(S);var T=M.getMaxRows()-M.getFixedRows();if(M.getOffsetRow()+T>M.getVirtualRows()){u(M,$,M.getVirtualRows()-T);}}var V=P.width;var W=V-2*t.getScrollbarWidth();if(W){var o=_.reduce(_.range(N.children().length),function(c1,n){var d1=h($,n);if(c1.end){return c1;}else{c1.consumedWidth+=d1.outerWidth();c1.mw.push(d1.outerWidth());if(c1.consumedWidth<W-5){c1.cols++;}else{c1.end=true;}return c1;}},{cols:0,end:false,mw:[],consumedWidth:0});o.mw=M._ColumnWidth2&&M._ColumnWidth2[o.cols-1]?M._ColumnWidth2[o.cols-1]+40:150;if(!o.end&&o.consumedWidth){if(W>o.consumedWidth+o.mw&&M._ColumnWidth2.length<=o.cols){o.cols=o.cols+Math.ceil((W-o.consumedWidth)/o.mw);}else if(W>o.consumedWidth){while(M._ColumnWidth2.length>o.cols&&W>o.consumedWidth+M._ColumnWidth2[o.cols]){o.consumedWidth+=M._ColumnWidth2[o.cols];++o.cols;}}}var X=Math.min(M.getMaxColumns()-M.getFixedColumns(),M.getHash().maxColumns-M.getHash().minColumns+1);var Y=Math.min(o.cols,Math.min(M.getVirtualColumns(),M.getColumnLimit())+M.getFixedColumns());if(M._maxFailedCol&&Y>=o._maxFailedCol){--Y;}else if($.width()<N.width()+2*t.getScrollbarWidth()){if(M._maxFailedCol){M._maxFailedCol=Math.min(M._maxFailedCol,M.getMaxColumns());Y=Math.min(Y,M._maxFailedCol-1);}else{M._maxFailedCol=M.getMaxColumns();Y=Math.min(Y,M._maxFailedCol-1);}if(Y>=M._maxFailedCol){Y=M._maxFailedCol-1;}}if(M._maxFailedCol&&Y>=M._maxFailedCol){Y=M._maxFailedCol-1;}if(Y&&Y>=M.getFixedColumns()&&M.getMaxColumns()!==Y){L.info("Set mc: "+Y);if(M.getMaxColumns()>Y){if(!M._maxFailedCol||M._maxFailedCol>M.getMaxColumns()){M._maxFailedCol=M.getMaxColumns();}}M.setMaxColumns(Y);var Z=M.getMaxColumns()-M.getFixedColumns();if(M.getOffsetColumn()+Z>M.getVirtualColumns()){v(M,$,M.getVirtualColumns()-Z);}}}var a1=M.getMaxColumns()-M.getFixedColumns()>=M.getVirtualColumns()?"hidden":"visible";$.find(".sapUiZenCommonsGridHsb").css("visibility",a1);var b1=M.getMaxRows()-M.getFixedRows()>M.getVirtualRows()?"hidden":"visible";$.find(".sapUiZenCommonsGridVsb").css("visibility",b1);return true;};t.calcCellControls=function(o){function n(O){o.fireRightClick({cell:sap.ui.getCore().byId(O.getSource().data()["data-cmid"]),link:O.getSource()});}var M;if(o.getCellControls){M=o.getCellControls();}else{M={};o.getCellControls=_.constant(M);}t.clearCellControls(o);var N=o.getHash();_.forEach(N.rowRange,function(O,P){_.forEach(N.colRange,function(Q,S){var T=[O+":"+Q];var V=[P+":"+S];if(o.getInput()&&o.getFixedColumns()<=Q&&o.getFixedRows()<=O){M[V]=new a({valueState:sap.ui.core.ValueState.None,width:"95%"});M[V].attachChange(function(W){var X=o.getHash()[T];if(X){X.setDisplayValue(W.getParameter("value"));}else{L.error("No cell found at:"+O+":"+Q);}});}else{M[V]=new b({subtle:true,width:"100%",wrapping:false,});M[V].onAfterRendering=function(){if(this.getText()===""){q(this.getDomRef()).attr("tabindex",0);}};M[V].attachPress(n);}M[V].addStyleClass("sapUiZenCommonsGridDown").addStyleClass("sapUiZenCommonsGridSelect");});});return t;};t.calcHash=function(M){M.getHash=_.constant(M.getCells().length?M.getCells().reduce(function(o,n){var N=n.getColumn();var O=n.getRow();if(isNaN(N)||isNaN(O)){return o;}var P=O+":"+N;o[P]=n;return o;},{maxRows:_.max(_.map(M.getCells(),function(o){return o.getRow();})),maxColumns:_.max(_.map(M.getCells(),function(o){return o.getColumn();})),maxDisplayLevel:_.max(_.map(M.getCells(),function(o){return o.getDisplayLevel();})),minRows:_.min(_.filter(_.map(M.getCells(),function(o){return o.getRow();}),function(n){return n>=M.getFixedRows();})),minColumns:_.min(_.filter(_.map(M.getCells(),function(o){return o.getColumn();}),function(n){return n>=M.getFixedColumns();}))}):{maxRows:-1,maxColumns:-1,minRows:-1,minColumns:-1,maxDisplayLevel:0});f(M);return t;};function w(o,$){if($.find(".sapUiZenCommonsGridOuterCell12").children().length===0){$.find(".sapUiZenCommonsGridOuterCell12").append(["<table><tbody><tr><td><div class=\"sapUiZenCommonsGridVsbIHeaderRow\"></div></td></tr><tr><td><div id=\"",o.getId(),"-oGrid\" class=\"sapUiZenCommonsGridVsb\"><div id=\"",o.getId(),"-vsb-i\" class=\"sapUiZenCommonsGridVsbI\"><span class=\"sapUiZenCommonsGridVTooltip\"></span><div id=\"",o.getId(),"-vsb-ii\" class=\"sapUiZenCommonsGridVsbII\" ></div></div></td></tr></tbody></table>"].join(""));}var n=_.reduce($.find(".sapUiZenCommonsGridFixedRow"),function(N,O){return N+q(O).height();},0);var M=$.find(".sapUiZenCommonsGridInnerTable").height();$.find(".sapUiZenCommonsGridVsbII").height((M-n)*o.getVirtualRows()/Math.max(1,o.getMaxRows()-o.getFixedRows()));$.find(".sapUiZenCommonsGridVsbIHeaderRow").height(n);}function x(o,$){if(!e(o)&&(o.getMaxRows()-o.getFixedRows()+o.getOffsetRow()>o.getHash().maxRows||o.getMaxRows()-o.getFixedRows()+o.getOffsetRow()<o.getHash().minRows)){$.off("mousewheel").off("mouseup").off("mouseleave");$.find(".sapUiZenCommonsGridVsbI").off("scroll");o.fireRequestMoreRows({currentRow:o.getOffsetRow()});return true;}return false;}function y(o,$,n,M){if(!e(o)&&((o.getMaxColumns()-o.getFixedColumns()+o.getOffsetColumn()>o.getHash().maxColumns+1)||(o.getOffsetColumn()<o.getHash().minColumns+1))){$.off("mousewheel").off("mouseup").off("mouseleave");o._nFocusRow=n;o._nFocusColumn=M;o.fireRequestMoreColumns({currentColumn:o.getOffsetColumn()});return true;}return false;}function z(o,$,n){var M=sap.ui.getCore().getConfiguration().getRTL();var N=o.getOffsetColumn();if(n<0&&!M||n>0&&M){if(!M){N++;if(N>o.getVirtualColumns()+o.getFixedColumns()-o.getMaxColumns()){N=o.getVirtualColumns()+o.getFixedColumns()-o.getMaxColumns();}}else{N--;if(N<0){N=0;}}}else{if(M){N++;if(N>o.getVirtualColumns()+o.getFixedColumns()-o.getMaxColumns()){N=o.getVirtualColumns()+o.getFixedColumns()-o.getMaxColumns();}}else{N--;if(N<0){N=0;}}}v(o,$,N);}function A(o,$,n){var M=o.getOffsetRow();if(n<0){M++;if(M>o.getVirtualRows()+o.getFixedRows()-o.getMaxRows()){M=o.getVirtualRows()+o.getFixedRows()-o.getMaxRows();}}else{M--;if(M<0){M=0;}}if(M!==o.getOffsetRow()){u(o,$,M);}}function B(o,$){var n=$.find(".sapUiZenCommonsGridHsbI");n.off("scroll");n.scrollLeft(c(o,$));delete o._bScrollH;if(n&&n.length){n.on("mouseup",m.bind(t,o,$));n.on("mouseleave",m.bind(t,o,$));n.on("scroll",k.bind(t,o,$));}}function D(M,$){var N=Math.min(M.getMaxColumns(),M.getFixedColumns());var O=_.sum(_.map(_.filter($.find(".sapUiZenCommonsGridFirstRow").find(".sapUiZenCommonsGridFixCol"),function(o,n){return n<N;}),function(o){return q(o).width();}))+4*N;$.find(".sapUiZenCommonsGridHsbHTdDiv").width(O);$.find(".sapUiZenCommonsGridHsbI").width($.find(".sapUiZenCommonsGridFirstRow").width()-O);var P=$.find(".sapUiZenCommonsGridHsbI").width();var Q=Math.min(M.getMaxColumns()-M.getFixedColumns(),M.getHash().maxColumns-M.getHash().minColumns+1);var n=P*M.getVirtualColumns()/Math.max(1,Q);$.find(".sapUiZenCommonsGridHsbII").width(n);B(M,$);}t.adjustHsbThumbPosition=B;t.adjustVsbThumbPosition=p;t.prepareOuterTableForResize=function(o,$){o.getVirtualRows()>o.getMaxRows()-o.getFixedRows()?w(o,$):r(o,$);var n=_.reduce($.find(".sapUiZenCommonsGridFixedRow"),function(Q,S){return Q+q(S).height();},0);var M=$.find(".sapUiZenCommonsGridInnerTable").outerWidth();$.find(".sapUiZenCommonsGridOuterTable").width(M+t.getScrollbarWidth());$.find(".sapUiZenCommonsGridVsbI").height($.find(".sapUiZenCommonsGridInnerTable").height()-n);$.find(".sapUiZenCommonsGridOuterCell11").width($.find(".sapUiZenCommonsGridFirstRow").width());D(o,$);var N=Math.max($.find(".sapUiZenCommonsGridHsbII").width(),1);var O=$.find(".sapUiZenCommonsGridVsbII").height();var P=null;$.on("mousewheel",function(Q){if(Q.ctrlKey){return;}if(o.getMaxRows()-o.getFixedRows()<o.getVirtualRows()){A(o,$,Q.originalEvent.wheelDelta,O);}else if(o.getMaxColumns()-o.getFixedColumns()<o.getVirtualColumns()){z(o,$,Q.originalEvent.wheelDelta,N);}else{return;}Q.preventDefault();});P=$.find(".sapUiZenCommonsGridVsbI");if(P&&P.length){P.on("mouseup",l.bind(t,o,$));P.on("mouseleave",l.bind(t,o,$));P.on("scroll",j.bind(t,o,$));}};t.insertContentToGrid=function(M,$){if(e(M)){return;}var N=M.getHash();var O=M.getCellControls();var P=M.getButtonControls();if(!M._kdSet){$.on("keydown",function(o){delete M._nFocusColumn;delete M._nFocusRow;var n=q(o.target);if(n.prop("tagName")!=="A"){return;}var V=q(o.target).parent().parent();var W=parseInt(V.attr("data-grid-row"),10);var X=parseInt(V.attr("data-grid-column"),10);switch(o.which){case K.Tab:if(o.shiftKey){if(X===M.getFixedColumns()&&M.getOffsetRow()>0){u(M,$,M.getOffsetRow()-1);$.find("td[data-grid-column="+M.getMaxColumns()+"][data-grid-row="+W+"]>div>a").focus();o.preventDefault();}else if(X===M.getFixedColumns()&&M.getOffsetColumn()>0){v(M,$,M.getOffsetColumn()-1,W,X);o.preventDefault();}}else{if($.find(".sapUiZenCommonsGridFirstRow>td").length===X+1){if(M.getFixedColumns()+M.getVirtualColumns()>M.getOffsetColumn()+M.getMaxColumns()){v(M,$,M.getOffsetColumn()+1,W,X);o.preventDefault();}else if(M.getMaxRows()===W+1){if(M.getVirtualRows()>M.getMaxRows()-M.getFixedRows()){u(M,$,M.getOffsetRow()+1);o.preventDefault();$.find("td[data-grid-column=0][data-grid-row="+W+"]>div>a").focus();}}}else if(X+1===M.getFixedColumns()&&M.getOffsetColumn()>0){v(M,$,0,W,X);}}break;case K.Up:if(M.getFixedRows()===W&&M.getOffsetRow()>0){u(M,$,M.getOffsetRow()-1);o.preventDefault();return;}else{$.find("td[data-grid-column="+X+"][data-grid-row="+(W-1)+"]>div>a").focus();}break;case K.Down:if(M.getMaxRows()===W+1&&M.getOffsetRow()+M.getMaxRows()-M.getFixedRows()<M.getVirtualRows()){u(M,$,M.getOffsetRow()+1);return;}else{$.find("td[data-grid-column="+X+"][data-grid-row="+(W+1)+"]>div>a").focus();}break;case K.Left:if(X===M.getFixedColumns()&&M.getOffsetRow()>0){u(M,$,M.getOffsetRow()-1,W,X);$.find("td[data-grid-column="+M.getMaxColumns()+"][data-grid-row="+W+"]>div>a").focus();o.preventDefault();}else if(X===M.getFixedColumns()&&M.getOffsetColumn()>0){v(M,$,M.getOffsetColumn()-1,W,X);o.preventDefault();}else{$.find("td[data-grid-column="+(X-1)+"][data-grid-row="+W+"]>div>a").focus();}break;case K.Right:if(M.getMaxColumns()===X+1){if(M.getOffsetColumn()<M.getVirtualColumns()-M.getMaxColumns()+M.getFixedColumns()){v(M,$,M.getOffsetColumn()+1,W,X);o.preventDefault();$.find("td[data-grid-column=0][data-grid-row="+W+"]>div>a").focus();}else if(M.getMaxRows()===W+1){if(M.getVirtualRows()>M.getMaxRows()-M.getFixedRows()){u(M,$,M.getOffsetRow()+1);o.preventDefault();$.find("td[data-grid-column=0][data-grid-row="+W+"]>div>a").focus();}}}else if(X+1===M.getFixedColumns()&&M.getOffsetColumn()>0){v(M,$,0,W,X);}else{$.find("td[data-grid-column="+(X+1)+"][data-grid-row="+W+"]>div>a").focus();}break;}});M._kdSet=true;}function Q(n,o,V,W){var X=P[[V,W].join(":")];var Y=null;if(o){Y=o.getIcon();n.attr("data-level",o.getDisplayLevel());if(X){if(M.getFormat()!==F.BusinessStyleFormular){n.find("span").first().css("padding-left",o.getDisplayLevel()>0?o.getDisplayLevel()+"em":"");}if(o.getIcon()){n.addClass("sapUiZenCommonsGridHierLevel");}if(M.getFormat()!==F.BusinessStyleFormular&&Y){if(!X.getVisible()){X.setVisible(true);}if(X.getSrc()!==Y){X.setSrc(Y);X.setTooltip(Y==="sap-icon://slim-arrow-down"?R.getText("ARROW_DOWN"):R.getText("ARROW_RIGHT"));}}else{if(X.getVisible()){X.setVisible(false);}}X.rerender();}}}function S(n,o,V,W,X,Y){var Z=[Y,X].join(":");var a1=o?o.getDisplayValue():"";var b1=(o?o.getCellType():"Empty")||"Empty";n.removeClass("sapUiZenCommonsGridHeaderResultCellTd").removeClass("sapUiZenCommonsGridHierLevel");n.attr("data-sap-semanticClass",null);Q(n,o,Y,X);if(b1){var c1=t.getStyle(b1);var oC=O[Z];if(!oC){L.error("Invalid coord: "+Z);}else{oC.removeStyleClass("sapUiZenCommonsGridHeaderResultCellTd").addStyleClass(t.getStyle(b1).inner());n.attr("data-sap-semanticClass",o&&o.getSemanticClass());}n.addClass(t.getStyle(b1).td());}else{throw new Error("Failed to find style for "+b1);}if(o){n.attr("data-help-id",o.getHelpId());}n.on("mouseenter",function(){M.fireCellEnter({cell:o,element:O[Z]});}).on("mouseleave",function(){M.fireCellLeave({cell:o});});var e1=O[Z];if(e1 instanceof b){e1.setText(a1);}else if(e1 instanceof a){e1.setValue(a1).setValueState(o?o.getValueState():sap.ui.core.ValueState.None).setEditable(o&&o.getInputEnabled()||true);}if(e1){e1.setTooltip(o?o.getTooltip():"").rerender();if(o&&e1){var f1=q(e1.getDomRef());var g1=o.getAlertLevel();f1.removeClass(function(d1,i1){return i1.match(/sapUiCommonsZenAlert.*/);});if(g1){f1.addClass("sapUiZenCommonsGridAlertLevel"+g1);}}q(e1.getDomRef()).attr("aria-label",R.getText("CELL_ARIA",[W+1,V+1,a1]));if(o){e1.removeAllCustomData();e1.addCustomData(new C({key:"data-cmid",value:o.getId()}));}}var h1=n.find(".sapUiZenCommonsGridCellDiv");if(c1){h1.addClass(c1.div(W%2===0));}h1.css("display","inline-block");}N.rowRange.forEach(function(n,o){N.colRange.forEach(function(V,W){var X=n+":"+V;S($.find("td[data-grid-coord=\""+X+"\"]"),N[X],V,n,W,o);});});if(M._ColumnWidth2){_.forEach(q($).find(".sapUiZenCommonsGridFirstRow").children(),function(o,n){var V=q(o);V.width(M._ColumnWidth2[n]);});}q($).find(".sapMInputBaseInner").addClass("sapUiZenCommonsGridInput");q($).find(".sapMInputBaseContentWrapper").height(18).addClass("sapUiZenCommonsGridInput");q($).find(".sapMInput").height(18);var T=Math.min(M.getMaxColumns()-M.getFixedColumns(),M.getHash().maxColumns-M.getHash().minColumns+1);$.find(".sapUiZenCommonsGridHTooltip").text(R.getText("HPOS",[M.getOffsetColumn()+1,M.getOffsetColumn()+T,M.getVirtualColumns()]));$.find(".sapUiZenCommonsGridVTooltip").text(R.getText("VPOS",[M.getOffsetRow()+1,M.getOffsetRow()+Math.min(M.getMaxRows(),M.getHash().maxRows+1)-M.getFixedRows(),M.getVirtualRows()]));};function E(o,$){var M=$.find(".sapUiZenCommonsGridFirstRow").children();var N=_.map(_.range(M.length),function(n){return h($,n).width();});if(!o._ColumnWidth2||o._ColumnWidth2.length<=N.length){o._ColumnWidth2=N;}else{_.forEach(N,function(n,O){o._ColumnWidth2[O]=n;});}}function H($){var n=$.find(".sapUiZenCommonsGridFirstRow").children();_.forEach(_.range(n.length),function(o){var M=$.find(["td[data-grid-column=",o,"]"].join(""));M.css("max-width","").css("min-width","");});}function J($){var n=$.find(".sapUiZenCommonsGridFirstRow").children();_.forEach(_.range(n.length),function(o){var M=$.find(["td[data-grid-column=",o,"]"].join(""));M.css("max-width",M.width()+"px").css("min-width",M.width()+"px");});}t.handleColWidth=function(o,$,M){var N=$.find(".sapUiZenCommonsGridFirstRow").children();if(M){_.forEach(_.range(N.length),function(n){s($,n,Math.round(M*h($,n).width()));});}var O=_.map(_.range(N.length),function(n){return h($,n).width();});if(!o._ColumnWidth2||o._ColumnWidth2.length<=O.length){o._ColumnWidth2=O;}else{_.forEach(O,function(n,P){o._ColumnWidth2[P]=n;});}_.forEach(o._ColumnWidth2,function(n,P){s($,P,n);});};}return new G();});
