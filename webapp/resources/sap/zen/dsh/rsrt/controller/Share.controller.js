/*!
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define("sap/zen/dsh/rsrt/controller/Share.controller",["sap/base/Log","sap/ui/model/resource/ResourceModel","sap/ui/core/mvc/Controller","sap/zen/dsh/utils/ErrorHandler","sap/m/MessageToast"],function(L,R,C,E,M){"use strict";C.extend("sap.zen.dsh.rsrt.controller.Share",{onInit:function(){var t=this;t.getView().loaded().then(function(){var b=t.getView().byId("bookmarkButton");t.getView().setModel(new R({bundle:sap.ui.getCore().getLibraryResourceBundle("sap.m")}),"share");b.setBeforePressHandler(function(){var c=t.getOwnerComponent();c.getRootControl().setBusy(true);var d=c.getModel("om").getDataProvider("0");c.Utilities.saveAppState(true).then(function(k){b.setCustomUrl(["#Report-anaylzeData?",encodeURIComponent(d.QueryName),"&/sap-iapp-state=",encodeURIComponent(k)].join(""));if(!b.getInfo()){b.setInfo(sap.ui.core.format.DateFormat.getDateTimeInstance().format(new Date()));}c.getRootControl().setBusy(false);}).catch(function(e){L.error(e);c.getRootControl().setBusy(false);});});if(t.getView().getModel()){t.getView().getModel().setProperty("/isBusy",false);}});},shareEmailPressed:function(){var t=this;var c=t.getOwnerComponent();c.getRootControl().setBusy(true);c.Utilities.saveAppState(true).then(function(i){var d=c.getModel("om").getDataProvider("0");var m=document.URL.match(/(.*)#(.+)-(.+)\?/);sap.m.URLHelper.triggerEmail(null,d.QueryTitle||d.QueryName,[document.URL.match(/(.*)#/)[1],"#",m[2],"-",m[3],"?name=",encodeURIComponent(d.QueryName),"&type=",encodeURIComponent(d.QueryType),"&systemName=",encodeURIComponent(d.SystemName),"&/sap-iapp-state=",encodeURIComponent(i)].join(""),null,null,true);}).catch(E.handleWithPopUp).then(function(){c.getRootControl().setBusy(false);});t.getView().getParent().close();},shareJamPressed:function(){M.show("Not yet implemented");}});return sap.zen.dsh.rsrt.controller.Share;});
