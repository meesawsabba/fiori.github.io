/*!
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define("sap/zen/dsh/dialogs/Restriction",["sap/base/Log","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/zen/dsh/utils/ResourceBundle","sap/zen/dsh/utils/ResourceModel","sap/zen/dsh/Axis","sap/zen/dsh/DimensionType","sap/zen/commons/thirdparty/lodash"],function(L,F,J,R,a,A,D,_){"use strict";L.info("Load restriction Dialog");var r,f;function h(b,c){r=b;f=c;}var d=null;var s="";function g(c){return c.runAsOwner(function(){return Promise.resolve(F.load({name:"sap.zen.dsh.fragment.RestrictionDialog",controller:{onOk:function(){d.setBusy(true);var o=d.getModel("om");Promise.resolve(null).then(function(){return o.getDataProvider(s).addRestriction(d.getModel("Restriction").getData());}).then(function(){d.setBusy(false);d.close();r(true);}).catch(function(e){d.setBusy(false);f(e);d.close();});},beforeClose:function(){d.setBusy(false);},onCancel:function(){d.close();r(false);}}}).then(function(o){d=o;o.setModel(new J(),"Restriction");var O=o.open;o.open=function(e,i,j,m){o.setModel(a,"i18n");s=i;o.setTitle(R.getText("SELECTION_SETTINGS"));var C=o.getModel("Restriction");C.setData({changeMode:true,dataProviderName:s,displayMode:false,Description:R.getText("RESTRICTION_DESCR",1),Keyfigure:m,KFDescription:e.getDataProvider(s).getMemberDescription(j,m),Dimension:j,Dimensions:_.map(_.filter(e.getDataProvider(i).Dimensions,function(k){var b=!k.IsStructure&&(k.Axis===A.Columns||k.Axis===A.Rows||k.Axis===A.Free);return b;}),function(b){return{Name:b.Name,Description:b.Description,ConstantSelection:false,Values:[]};})});o.setModel(e,"om");O.call(o);return new Promise(h);};return o;}));});}return g;});
