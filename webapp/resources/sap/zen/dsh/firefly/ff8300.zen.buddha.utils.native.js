/*
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/base/Log","sap/zen/commons/thirdparty/xlsx-protobi","sap/base/i18n/ResourceBundle","sap/ui/thirdparty/URI","sap/zen/dsh/utils/dispatcher","sap/zen/dsh/firefly/ff4330.olap.catalog.impl","sap/zen/dsh/firefly/ff4340.olap.reference","sap/zen/dsh/firefly/ff4410.olap.ip.providers","sap/zen/dsh/firefly/ff8010.olap.ui","sap/zen/dsh/firefly/ff8110.studio.ui","sap/ui/thirdparty/jszip"],function(jQuery,Log,XLSX,ResourceBundle,URI,Dispatcher){jQuery.sap.declare("sap.zen.dsh");var $Firefly={createByPrototype:function(t){var F=function(){};F.prototype=t;return new F();},createClass:function(f,s,c){var n;if(Object.prototype.toString.call(f)==="[object Array]"){n=f;}else{n=f.split(".");}var p=window;var a;var b;var i;var e;var d=n.length-1;for(i=0;i<d;i++){a=n[i];b=p[a];if(b===undefined){p[a]={};b=p[a];}p=b;}a=n[d];var g=function(){};g.prototype={};if(s!==null){if(s===undefined){e="$Firefly.createClass "+a+" failed due to missing superClass";Log.error(e);return;}g=function(){s.call(this);};var S=s;g.prototype=new S();g.$superclass=s.prototype;}var m=g.prototype;var h;var j;var k;for(h in c){if(c.hasOwnProperty(h)){if(h==="$statics"){k=c[h];for(j in k){if(k.hasOwnProperty(j)){g[j]=k[j];}}}else{m[h]=c[h];}}}g.clazzName=a;p[a]=g;}};$Firefly.createClass("sap.buddha.XWindow",sap.firefly.XObject,{$statics:{create:function(){var w=new sap.buddha.XWindow();w.initBase();return w;}},oPage:null,bSFinMode:false,globalVarMap:null,toString:function(){return"[???]";},m_booleanValue:false,initBase:function(){if(!sap.zen.dsh.wnd){sap.zen.dsh.wnd={};}this.context={};this.globalVarMap=sap.firefly.XHashMapByString.create();var that=this;sap.zen.dsh.buddhaHasSendLock=0;sap.zen.dsh.buddhaDispatchQueue=sap.zen.dsh.buddhaDispatchQueue?sap.zen.dsh.buddhaDispatchQueue:[];var bDebugMode=jQuery.sap.debug();if(bDebugMode){var myFunction=function(e){if(e.ctrlKey&&e.altKey&&e.which===90){that.oPage.getSupportZip();}};jQuery(document).unbind("keydown.dssupportzip").bind("keydown.dssupportzip",myFunction);}this.context.exec=function(s){try{with(this){eval(s);}}catch(e){Log.error(e);Log.error(e.stack);if(that.oPage){var s1="Error during script execution of ("+s+")";if(e.message){s1+=": "+e.message;that.oPage.createErrorMessage(e.message);}else{that.oPage.createErrorMessage("Error during script execution");}var logging=that.oPage.getLogging();if((logging!=null)&&logging.isLoggable(sap.buddha.XLogging.XDEBUG,null)){Log.error("XWindow: exception during script execution",s1,null);}else{Log.error("XWindow: exception during script execution",s1);}}return false;}return true;};this.context.putScript=function(name,script){try{with(this){that.context[name]=eval(script);}}catch(e){Log.error(e);Log.error(e.stack);if(that.oPage){var s="Error during script execution of ("+s+")";if(e.message){s+=": "+e.message;}that.oPage.createErrorMessage(s);}return false;}return true;};},putInContext:function(n,o){this.context[n]=o;},setEnumContext:function(n,o){var a=o.getNativeElement();this.context[n]=a;},getContext:function(n){return this.context[n];},execute:function(s){if(s){try{this.context.exec(s);}catch(e){if(this.oPage){this.oPage.createErrorMessage(e.message);}return false;}}this.captureGlobalVariables();return true;},setPage:function(p){this.oPage=p;},setSFinMode:function(s){this.bSFinMode=s;sap.zen.dsh.getLoadingIndicator(this.bSFinMode);},dispatchJsonString:function(z,i){z=unescape(z);var d=jQuery.parseJSON(z);if(i==false){d=d.delta;if(!(d instanceof Array)){var a=[];a.push(d);d=a;}if(d.length>0){setTimeout(function(){Dispatcher.dispatchDelta(d);},1);}}else{sap.zen.dsh.sapbi_phxObj=Dispatcher.dispatchCreateControl(d.component,function(r){r.placeAt("sapbi_snippet_ROOT","only");});}},showLoadingIndicator:function(){var l=sap.zen.dsh.getLoadingIndicator();if(l){l.show();}},showImmediatelyLoadingIndicator:function(){var l=sap.zen.dsh.getLoadingIndicator();if(l){l.showImmediately();}},hideLoadingIndicator:function(){var l=sap.zen.dsh.getLoadingIndicator();if(l){l.hideAsync();}},setExecuteShowHideLoadingIndicator:function(e){var l=sap.zen.dsh.getLoadingIndicator();if(l){l.setExecuteShowHide(e);}},dispatchJsonObject:function(j,i,p){var t=this;var l=setInterval(function(){if(t.oPage.hasRootControlBeenRendered()&&(sap.zen.dsh.buddhaDispatchQueue[0]&&sap.zen.dsh.buddhaDispatchQueue[0].oInterval===l)){clearInterval(l);t._dispatchJsonObject(j,i,p,sap.zen.dsh.buddhaDispatchQueue[0]);}},1);var a={initialRequest:i,pageId:p,queueId:l.toString(),inProcess:false,oInterval:l,};sap.zen.dsh.buddhaDispatchQueue.push(a);},_dispatchJsonObject:function(j,i,p,q){q.inProcess=true;var l=Dispatcher;if(j.content.bInterComponentDragDropEnabled){l.setInterComponentDragDropEnabled(true);}else{l.setInterComponentDragDropEnabled(false);}l.dshPrefix=this.oPage.getDshControlId();var a=j.content.pageContent;if(i===false){a=a.delta;if(!(a instanceof Array)){var b=[];b.push(a);a=b;}a={"delta":a};}if(j.content.requiredModules&&j.content.requiredModules.length){Log.info("Load required Modules: \n"+j.content.requiredModules.join("\n"));}sap.zen.dsh.buddhaDispatchQueue.shift();sap.zen.dsh.sapbi_registerHandlers(arguments);sap.zen.dsh.sapbi_phx(p+"sapbi_snippet_ROOT",a);},getPageObject:function(o){if(o&&o.getPageObject){return o.getPageObject();}return null;},getLocale:function(){var l="en-GB";if(navigator.userLanguage){l=navigator.browserLanguage;}else if(navigator.language){l=navigator.language;}return l;},setLocale:function(){},unwrapXObject:function(o){if(o){if(o.getString){return o.getString();}if(o.getBoolean){return o.getBoolean();}if(o.getDouble){return o.getDouble();}if(o.getInteger){return o.getInteger();}if(o.size){var r=[];for(var i=0;i<o.size();i++){r.push(this.unwrapXObject(o.get(i)));}return r;}}return undefined;},setContextForGlobalVariable:function(k,v){this.putInContext(k,this.unwrapXObject(v));},addUrlParam:function(){},createJSArray:function(l){var j=[];var i=0;for(i=0;i<l.size();i++){j.push(l.get(i));}return j;},createJSArrayOfStrings:function(l){var j=[];var i=0;for(i=0;i<l.size();i++){j.push(l.get(i));}return j;},wrapAndPutInContext:function(i,o){var j=o.getJavaScriptWrapperName();this.putInContext(i,o);this.execute("sap.zen.dsh.utils.Wrapper.origObjects[\""+i+"\"] = "+i+";");this.execute(i+"= sap.zen.dsh.utils.Wrapper.wrap(\""+j+"\","+i+");");},getGlobalVariables:function(u){if(u){this.captureGlobalVariables();}return this.globalVarMap;},captureGlobalVariables:function(){if(this.context.APPLICATION_PROPERTIES!=null){var n=this.context.APPLICATION_PROPERTIES.getGlobalVariableNames();this.globalVarMap.clear();for(var i=0;i<n.size();i++){var a=n.get(i);var v=this.getContext(a);this.globalVarMap.put(a,v);}}},putGlobalScriptInContext:function(n,s){this.context.putScript(n,s);},resetLock:function(){sap.zen.dsh.buddhaHasSendLock=0;Log.info("xwindow resetLock: "+sap.zen.dsh.buddhaHasSendLock);},increaseLock:function(){sap.zen.dsh.buddhaHasSendLock++;Log.info("xwindow increaseLock: "+sap.zen.dsh.buddhaHasSendLock);},decreaseLock:function(){sap.zen.dsh.buddhaHasSendLock--;if(sap.zen.dsh.buddhaHasSendLock<0){sap.zen.dsh.buddhaHasSendLock=0;}Log.info("xwindow decreaseLock: "+sap.zen.dsh.buddhaHasSendLock);},log:function(m){Log.info(m);},setMainMode:function(m){Dispatcher.setMainMode(m);},setCompactMode:function(c){if(Dispatcher.isMainMode()){Dispatcher.setCompactMode(c);}},parseJSON:function(j){return JSON.parse(j);},stringifyJSON:function(o){return JSON.stringify(o);}});$Firefly.createClass("sap.buddha.XJSAndCSSLoader",sap.firefly.XObject,{$statics:{create:function(){var w=new sap.buddha.XJSAndCssLoader();return w;}},loadJS:function(){return null;},loadBuildInJS:function(v){return window[v];},loadCSS:function(l,u,p){jQuery("head").append("<link rel=\"stylesheet\" href=\""+p+l+"/"+u+"\" type=\"text/css\" />");}});$Firefly.createClass("sap.buddha.XXmlNode",sap.firefly.XObject,{$statics:{create:function(r){var n=new sap.buddha.XXmlNode();n.setObject(r);return n;},toStringInternal:function(n){var x=(new window.XMLSerializer()).serializeToString(n);return x;}},toString:function(){var x=(new window.XMLSerializer()).serializeToString(this.root);return x;},root:null,setObject:function(n){this.root=n;},getAttribute:function(n){var a=this.root.attributes;var o=a[n];if(o==null){return null;}var v=o.value;return v;},getText:function(){return this.root.textContent;},getChildren:function(n){var l=sap.firefly.XList.create();var c=this.root.childNodes;var a="bi:"+n;for(var i=0,b=c.length;i<b;i++){var d=c[i];if(d.nodeName.toLowerCase()===a){var x=sap.buddha.XXmlNode.create(d);l.add(x);}}return l;},getChildrenWoBiNameSpace:function(n){var l=sap.firefly.XList.create();var c=this.root.childNodes;for(var i=0,a=c.length;i<a;i++){var b=c[i];if(b.nodeName===n){var x=sap.buddha.XXmlNode.create(b);l.add(x);}}return l;},getFirstChild:function(n){return this.getFirstChildWithAttributeValue("bi:"+n,null,null,false);},getFirstChildWoBiNameSpace:function(n){return this.getFirstChildWithAttributeValue(n,null,null,false);},getFirstChildWithNameTag:function(n){return this.getFirstChildWithAttributeValue(null,"name",n,false);},getFirstChildWithAttributeValue:function(t,a,b,r){var c=this.root.childNodes;var x=null;for(var i=0,l=c.length;i<l;i++){var e=c[i];if(r){x=sap.buddha.XXmlNode.create(e).getFirstChildWithAttributeValue(t,a,b,r);if(x!==null){return x;}}if(t==null||t===e.nodeName){var d=e.attributes;if(d!=null){if(b==null){x=sap.buddha.XXmlNode.create(e);return x;}var n=d[a];if(n!=null&&n.value===b){x=sap.buddha.XXmlNode.create(e);return x;}}}}return null;},setAttribute:function(n,v){if(v!=null){this.root.setAttribute(n,v);}else{if(this.root.hasOwnProperty(n)){this.root.removeAttribute(v);}}},setCData:function(v){var c=this.root.firstChild;if(c!=null){this.root.removeChild(c);}var n=this.root.ownerDocument.createCDATASection(v);this.root.appendChild(n);},createChild:function(n){var a=document.createElement("bi:"+n);this.root.appendChild(a);var x=sap.buddha.XXmlNode.create(a);return x;},createChildWithNameTag:function(n){var a=document.createElement("bi:property");this.root.appendChild(a);a.setAttribute("name",n);var x=sap.buddha.XXmlNode.create(a);return x;},setProperty:function(n,v,a){var f=this.getFirstChildWithNameTag(n);if(f==null){f=this.createChildWithNameTag(n);}if(a){var b=f.getFirstChild("value");if(b==null){b=f.createChild("value");}b.setCData(v);}else{f.setAttribute("value",v);}},asBookmarkString:function(){var c=this.root.cloneNode(false);var a=this.root.childNodes;for(var i=0,l=a.length;i<l;i++){var b=a[i];var n=b.nodeName;var d=!(n==="bi:component");var e=b.attributes;if(e!=null){d=false;var f=e["name"];if(f!=null){var g=f.value.toUpperCase();if(g==="DATA_SOURCE_DEFINITION"||g==="GLOBALVARIABLES"){d=true;}}}if(d){var h=b.cloneNode(true);c.appendChild(h);}}var s=sap.buddha.XXmlNode.toStringInternal(c);return s;},asDeltaBookmarkString:function(a){var c;var b;if(a==null){c=this.root.cloneNode(false);b=this.root.childNodes;}else{c=a;c=c.cloneNode(false);b=a.childNodes;}var t="";for(var i=0,l=b.length;i<l;i++){var d=b[i];var n=d.nodeName;var e=!(n==="bi:component");if(e){var f=d.cloneNode(true);c.appendChild(f);}else{var g=d.cloneNode(true);var u=this.asDeltaBookmarkString(g);t=sap.firefly.XString.concatenate2(t,u);}}var s=sap.buddha.XXmlNode.toStringInternal(c);s=sap.firefly.XString.concatenate2(s,t);return s;},getAllChildren:function(){var l=sap.firefly.XList.create();var c=this.root.childNodes;for(var i=0,a=c.length;i<a;i++){var x=sap.buddha.XXmlNode.create(c[i]);l.add(x);}return l;},getNode:function(){return this.root;},removeChild:function(c){this.root.removeChild(c.getNode());},getNodeName:function(){return this.root.nodeName;},appendChild:function(n){this.root.appendChild(n.getNode());},cloneNode:function(d){return sap.buddha.XXmlNode.create(this.root.cloneNode(d));}});var JXG;$Firefly.createClass("sap.buddha.XXmlUtils",null,{$statics:{decompress:function(b){var r=JXG.decompress(b);return r;},decodeBase64ToByteArray:function(b){return atob(b);},getRootNode:function(x){if(!x){return null;}var a=$.parseXML(x);var b=sap.buddha.XXmlNode.create();var c=a.childNodes;for(var i=0,l=c.length;i<l;i++){var n=c[i];if(n.nodeType===1){b.setObject(n);break;}}return b;}},toString:function(){return"[???]";}});JXG={exists:(function(u){return function(v){return!(v===u||v===null);}})()};JXG.decompress=function(s){var a=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(s));var b=a.unzip();return unescape(b[0][0]);};
/*
 * Copyright 2008-2012 Matthias Ehmann, Michael Gerhaeuser, Carsten Miller,
 * Bianca Valentin, Alfred Wassermann, Peter Wilfahrt
 * 
 * This file is part of JSXGraph.
 * 
 * Dual licensed under the Apache License Version 2.0, or LGPL Version 3
 * licenses.
 * 
 * You should have received a copy of the GNU Lesser General Public License
 * along with JSXCompressor. If not, see <http://www.gnu.org/licenses/>.
 * 
 * You should have received a copy of the Apache License along with
 * JSXCompressor. If not, see <http://www.apache.org/licenses/>.
 * 
 */
JXG.Util={};JXG.Util.Unzip=function(d){var o=[],e=false,g,f=0,u=[];var h=new Array(32768),I=0,m=false;var k=[0x00,0x80,0x40,0xc0,0x20,0xa0,0x60,0xe0,0x10,0x90,0x50,0xd0,0x30,0xb0,0x70,0xf0,0x08,0x88,0x48,0xc8,0x28,0xa8,0x68,0xe8,0x18,0x98,0x58,0xd8,0x38,0xb8,0x78,0xf8,0x04,0x84,0x44,0xc4,0x24,0xa4,0x64,0xe4,0x14,0x94,0x54,0xd4,0x34,0xb4,0x74,0xf4,0x0c,0x8c,0x4c,0xcc,0x2c,0xac,0x6c,0xec,0x1c,0x9c,0x5c,0xdc,0x3c,0xbc,0x7c,0xfc,0x02,0x82,0x42,0xc2,0x22,0xa2,0x62,0xe2,0x12,0x92,0x52,0xd2,0x32,0xb2,0x72,0xf2,0x0a,0x8a,0x4a,0xca,0x2a,0xaa,0x6a,0xea,0x1a,0x9a,0x5a,0xda,0x3a,0xba,0x7a,0xfa,0x06,0x86,0x46,0xc6,0x26,0xa6,0x66,0xe6,0x16,0x96,0x56,0xd6,0x36,0xb6,0x76,0xf6,0x0e,0x8e,0x4e,0xce,0x2e,0xae,0x6e,0xee,0x1e,0x9e,0x5e,0xde,0x3e,0xbe,0x7e,0xfe,0x01,0x81,0x41,0xc1,0x21,0xa1,0x61,0xe1,0x11,0x91,0x51,0xd1,0x31,0xb1,0x71,0xf1,0x09,0x89,0x49,0xc9,0x29,0xa9,0x69,0xe9,0x19,0x99,0x59,0xd9,0x39,0xb9,0x79,0xf9,0x05,0x85,0x45,0xc5,0x25,0xa5,0x65,0xe5,0x15,0x95,0x55,0xd5,0x35,0xb5,0x75,0xf5,0x0d,0x8d,0x4d,0xcd,0x2d,0xad,0x6d,0xed,0x1d,0x9d,0x5d,0xdd,0x3d,0xbd,0x7d,0xfd,0x03,0x83,0x43,0xc3,0x23,0xa3,0x63,0xe3,0x13,0x93,0x53,0xd3,0x33,0xb3,0x73,0xf3,0x0b,0x8b,0x4b,0xcb,0x2b,0xab,0x6b,0xeb,0x1b,0x9b,0x5b,0xdb,0x3b,0xbb,0x7b,0xfb,0x07,0x87,0x47,0xc7,0x27,0xa7,0x67,0xe7,0x17,0x97,0x57,0xd7,0x37,0xb7,0x77,0xf7,0x0f,0x8f,0x4f,0xcf,0x2f,0xaf,0x6f,0xef,0x1f,0x9f,0x5f,0xdf,0x3f,0xbf,0x7f,0xff];var p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99];var r=[0x0001,0x0002,0x0003,0x0004,0x0005,0x0007,0x0009,0x000d,0x0011,0x0019,0x0021,0x0031,0x0041,0x0061,0x0081,0x00c1,0x0101,0x0181,0x0201,0x0301,0x0401,0x0601,0x0801,0x0c01,0x1001,0x1801,0x2001,0x3001,0x4001,0x6001];var s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var A=d;var v=0,w=1,x=0;var N=256;var y=[];var B;function C(){x+=8;if(v<A.length){return A[v++];}else return-1;}function D(){w=1;}function E(){var c;x++;c=(w&1);w>>=1;if(w==0){w=C();c=(w&1);w=(w>>1)|0x80;}return c;}function F(a){var b=0,i=a;while(i--){b=(b<<1)|E();}if(a){b=k[b]>>(8-a);}return b;}function G(){I=0;}function H(a){h[I++]=a;o.push(String.fromCharCode(a));if(I==0x8000){I=0;}}function J(){this.b0=0;this.b1=0;this.jump=null;this.jumppos=-1;}var L=288;var K=new Array(L);var M=new Array(32);var O=0;var P=null;var Q=0;var R=new Array(17);R[0]=0;var S;var T;function U(){for(;;){if(R[Q]>=T)return-1;if(S[R[Q]]==Q)return R[Q]++;R[Q]++;}}function V(){var c=P[O];var a;if(e)document.write("<br>len:"+Q+" treepos:"+O);if(Q==17){return-1;}O++;Q++;a=U();if(e)document.write("<br>IsPat "+a);if(a>=0){c.b0=a;if(e)document.write("<br>b0 "+c.b0);}else{c.b0=0x8000;if(e)document.write("<br>b0 "+c.b0);if(V())return-1;}a=U();if(a>=0){c.b1=a;if(e)document.write("<br>b1 "+c.b1);c.jump=null;}else{c.b1=0x8000;if(e)document.write("<br>b1 "+c.b1);c.jump=P[O];c.jumppos=O;if(V())return-1;}Q--;return 0;}function W(c,n,l,b){var i;if(e)document.write("currentTree "+c+" numval "+n+" lengths "+l+" show "+b);P=c;O=0;S=l;T=n;for(i=0;i<17;i++)R[i]=0;Q=0;if(V()){if(e)alert("invalid huffman tree\n");return-1;}if(e){document.write("<br>Tree: "+P.length);for(var a=0;a<32;a++){document.write("Places["+a+"].b0="+P[a].b0+"<br>");document.write("Places["+a+"].b1="+P[a].b1+"<br>");}}return 0;}function Y(c){var Q,i,a=0,X=c[a],b;for(;;){b=E();if(e)document.write("b="+b);if(b){if(!(X.b1&0x8000)){if(e)document.write("ret1");return X.b1;}X=X.jump;Q=c.length;for(i=0;i<Q;i++){if(c[i]===X){a=i;break;}}}else{if(!(X.b0&0x8000)){if(e)document.write("ret2");return X.b0;}a++;X=c[a];}}if(e)document.write("ret3");return-1;}function Z(){var b,c,X,i,Q;do{b=E();X=F(2);switch(X){case 0:if(e)alert("Stored\n");break;case 1:if(e)alert("Fixed Huffman codes\n");break;case 2:if(e)alert("Dynamic Huffman codes\n");break;case 3:if(e)alert("Reserved block type!!\n");break;default:if(e)alert("Unexpected value %d!\n",X);break;}if(X==0){var b1,c1;D();b1=C();b1|=(C()<<8);c1=C();c1|=(C()<<8);if(((b1^~c1)&0xffff)){document.write("BlockLen checksum mismatch\n");}while(b1--){c=C();H(c);}}else if(X==1){var j;for(;;){j=(k[F(7)]>>1);if(j>23){j=(j<<1)|E();if(j>199){j-=128;j=(j<<1)|E();}else{j-=48;if(j>143){j=j+136;}}}else{j+=256;}if(j<256){H(j);}else if(j==256){break;}else{var d1;j-=256+1;Q=F(q[j])+p[j];j=k[F(5)]>>3;if(s[j]>8){d1=F(8);d1|=(F(s[j]-8)<<8);}else{d1=F(s[j]);}d1+=r[j];for(j=0;j<Q;j++){c=h[(I-d1)&0x7fff];H(c);}}}}else if(X==2){var n,e1,f1,g1;var ll=new Array(288+32);e1=257+F(5);f1=1+F(5);g1=4+F(4);for(j=0;j<19;j++){ll[j]=0;}for(j=0;j<g1;j++){ll[t[j]]=F(3);}Q=M.length;for(i=0;i<Q;i++)M[i]=new J();if(W(M,19,ll,0)){G();return 1;}if(e){document.write("<br>distanceTree");for(var a=0;a<M.length;a++){document.write("<br>"+M[a].b0+" "+M[a].b1+" "+M[a].jump+" "+M[a].jumppos);}}n=e1+f1;i=0;var z=-1;if(e)document.write("<br>n="+n+" bits: "+x+"<br>");while(i<n){z++;j=Y(M);if(e)document.write("<br>"+z+" i:"+i+" decode: "+j+"    bits "+x+"<br>");if(j<16){ll[i++]=j;}else if(j==16){var l;j=3+F(2);if(i+j>n){G();return 1;}l=i?ll[i-1]:0;while(j--){ll[i++]=l;}}else{if(j==17){j=3+F(3);}else{j=11+F(7);}if(i+j>n){G();return 1;}while(j--){ll[i++]=0;}}}Q=K.length;for(i=0;i<Q;i++)K[i]=new J();if(W(K,e1,ll,0)){G();return 1;}Q=K.length;for(i=0;i<Q;i++)M[i]=new J();var i1=new Array();for(i=e1;i<ll.length;i++){i1[i-e1]=ll[i];}if(W(M,f1,i1,0)){G();return 1;}if(e)document.write("<br>literalTree");for(;;){j=Y(K);if(j>=256){j-=256;if(j==0){break;}j--;Q=F(q[j])+p[j];j=Y(M);if(s[j]>8){d1=F(8);d1|=(F(s[j]-8)<<8);}else{d1=F(s[j]);}d1+=r[j];while(Q--){c=h[(I-d1)&0x7fff];H(c);}}else{H(j);}}}}while(!b);G();D();return 0;}JXG.Util.Unzip.prototype.unzipFile=function(n){var i;this.unzip();for(i=0;i<u.length;i++){if(u[i][1]==n){return u[i][0];}}return null;};JXG.Util.Unzip.prototype.unzip=function(){if(e)alert(A);_();return u;};function _(){if(e)alert("NEXTFILE");o=[];var a=[];m=false;a[0]=C();a[1]=C();if(e)alert("type: "+a[0]+" "+a[1]);if(a[0]==parseInt("78",16)&&a[1]==parseInt("da",16)){if(e)alert("GEONExT-GZIP");Z();if(e)alert(o.join(""));u[f]=new Array(2);u[f][0]=o.join("");u[f][1]="geonext.gxt";f++;}if(a[0]==parseInt("1f",16)&&a[1]==parseInt("8b",16)){if(e)alert("GZIP");a1();if(e)alert(o.join(""));u[f]=new Array(2);u[f][0]=o.join("");u[f][1]="file";f++;}if(a[0]==parseInt("50",16)&&a[1]==parseInt("4b",16)){m=true;a[2]=C();a[3]=C();if(a[2]==parseInt("3",16)&&a[3]==parseInt("4",16)){a[0]=C();a[1]=C();if(e)alert("ZIP-Version: "+a[1]+" "+a[0]/10+"."+a[0]%10);g=C();g|=(C()<<8);if(e)alert("gpflags: "+g);var b=C();b|=(C()<<8);if(e)alert("method: "+b);C();C();C();C();var j=C();j|=(C()<<8);j|=(C()<<16);j|=(C()<<24);var l=C();l|=(C()<<8);l|=(C()<<16);l|=(C()<<24);var n=C();n|=(C()<<8);n|=(C()<<16);n|=(C()<<24);if(e)alert("local CRC: "+j+"\nlocal Size: "+n+"\nlocal CompSize: "+l);var z=C();z|=(C()<<8);var X=C();X|=(C()<<8);if(e)alert("filelen "+z);i=0;y=[];while(z--){var c=C();if(c=="/"|c==":"){i=0;}else if(i<N-1)y[i++]=String.fromCharCode(c);}if(e)alert("nameBuf: "+y);if(!B)B=y;var i=0;while(i<X){c=C();i++;}if(n==0&&B.charAt(B.length-1)=="/"){if(e)alert("skipdir");}if(b==8){Z();if(e)alert(o.join(""));u[f]=new Array(2);u[f][0]=o.join("");u[f][1]=y.join("");f++;}a1();}}}function a1(){var a=[],i,c;if((g&8)){a[0]=C();a[1]=C();a[2]=C();a[3]=C();if(a[0]==parseInt("50",16)&&a[1]==parseInt("4b",16)&&a[2]==parseInt("07",16)&&a[3]==parseInt("08",16)){C();C();C();C();}C();C();C();C();C();C();C();C();if(e)alert("CRC:");}if(m)_();a[0]=C();if(a[0]!=8){if(e)alert("Unknown compression method!");return 0;}g=C();if(e){if((g&~(parseInt("1f",16))))alert("Unknown flags set!");}C();C();C();C();C();C();if((g&4)){a[0]=C();a[2]=C();Q=a[0]+256*a[1];if(e)alert("Extra field size: "+Q);for(i=0;i<Q;i++)C();}if((g&8)){i=0;y=[];while(c=C()){if(c=="7"||c==":")i=0;if(i<N-1)y[i++]=c;}if(e)alert("original file name: "+y);}if((g&16)){while(c=C()){}}if((g&2)){C();C();}Z();C();C();C();C();C();C();C();C();if(m)_();return null;}};JXG.Util.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var o=[],c,b,d,e,f,g,h,i=0;a=JXG.Util.Base64._utf8_encode(a);while(i<a.length){c=a.charCodeAt(i++);b=a.charCodeAt(i++);d=a.charCodeAt(i++);e=c>>2;f=((c&3)<<4)|(b>>4);g=((b&15)<<2)|(d>>6);h=d&63;if(isNaN(b)){g=h=64;}else if(isNaN(d)){h=64;}o.push([this._keyStr.charAt(e),this._keyStr.charAt(f),this._keyStr.charAt(g),this._keyStr.charAt(h)].join(""));}return o.join("");},decode:function(a,u){var o=[],c,b,d,e,f,g,h,i=0;a=a.replace(new RegExp("[^A-Za-z0-9+/=]","g"),"");while(i<a.length){e=this._keyStr.indexOf(a.charAt(i++));f=this._keyStr.indexOf(a.charAt(i++));g=this._keyStr.indexOf(a.charAt(i++));h=this._keyStr.indexOf(a.charAt(i++));c=(e<<2)|(f>>4);b=((f&15)<<4)|(g>>2);d=((g&3)<<6)|h;o.push(String.fromCharCode(c));if(g!=64){o.push(String.fromCharCode(b));}if(h!=64){o.push(String.fromCharCode(d));}}o=o.join("");if(u){o=JXG.Util.Base64._utf8_decode(o);}return o;},_utf8_encode:function(s){s=s.replace(new RegExp("\r\n","g"),"\n");var u="";for(var n=0;n<s.length;n++){var c=s.charCodeAt(n);if(c<128){u+=String.fromCharCode(c);}else if((c>127)&&(c<2048)){u+=String.fromCharCode((c>>6)|192);u+=String.fromCharCode((c&63)|128);}else{u+=String.fromCharCode((c>>12)|224);u+=String.fromCharCode(((c>>6)&63)|128);u+=String.fromCharCode((c&63)|128);}}return u;},_utf8_decode:function(u){var s=[],i=0,c=0,a=0,b=0;while(i<u.length){c=u.charCodeAt(i);if(c<128){s.push(String.fromCharCode(c));i++;}else if((c>191)&&(c<224)){a=u.charCodeAt(i+1);s.push(String.fromCharCode(((c&31)<<6)|(a&63)));i+=2;}else{a=u.charCodeAt(i+1);b=u.charCodeAt(i+2);s.push(String.fromCharCode(((c&15)<<12)|((a&63)<<6)|(b&63)));i+=3;}}return s.join("");},_destrip:function(s,w){var l=[],a,i;if(w==null)w=76;s.replace(new RegExp(" ","g"),"");a=s.length/w;for(i=0;i<a;i++)l[i]=s.substr(i*w,w);if(a!=s.length/w)l[l.length]=s.substr(a*w,s.length-(a*w));var d=[];for(i=0;i<l.length;i++)d.push(l[i]);return d.join("\n");},decodeAsArray:function(a){var d=this.decode(a),b=[],i;for(i=0;i<d.length;i++){b[i]=d.charCodeAt(i);}return b;},decodeGEONExT:function(i){return JXG.Util.Base64.decodeAsArray(JXG.Util.Base64._destrip(i),false);}};JXG.Util.asciiCharCodeAt=function(s,i){var c=s.charCodeAt(i);if(c>255){switch(c){case 8364:c=128;break;case 8218:c=130;break;case 402:c=131;break;case 8222:c=132;break;case 8230:c=133;break;case 8224:c=134;break;case 8225:c=135;break;case 710:c=136;break;case 8240:c=137;break;case 352:c=138;break;case 8249:c=139;break;case 338:c=140;break;case 381:c=142;break;case 8216:c=145;break;case 8217:c=146;break;case 8220:c=147;break;case 8221:c=148;break;case 8226:c=149;break;case 8211:c=150;break;case 8212:c=151;break;case 732:c=152;break;case 8482:c=153;break;case 353:c=154;break;case 8250:c=155;break;case 339:c=156;break;case 382:c=158;break;case 376:c=159;break;default:break;}}return c;};JXG.Util.utf8Decode=function(u){var s=[];var i=0;var c=0,a=0,b;if(!JXG.exists(u))return"";while(i<u.length){c=u.charCodeAt(i);if(c<128){s.push(String.fromCharCode(c));i++;}else if((c>191)&&(c<224)){a=u.charCodeAt(i+1);s.push(String.fromCharCode(((c&31)<<6)|(a&63)));i+=2;}else{a=u.charCodeAt(i+1);b=u.charCodeAt(i+2);s.push(String.fromCharCode(((c&15)<<12)|((a&63)<<6)|(b&63)));i+=3;}}return s.join("");};
/**
 * Generate a random uuid. http://www.broofa.com mailto:robert@broofa.com
 *
 * Copyright (c) 2010 Robert Kieffer Dual licensed under the MIT and GPL
 * licenses.
 *
 * EXAMPLES: >>> Math.uuid() "92329D39-6F5C-4520-ABFC-AAB64544E172"
 */
JXG.Util.genUUID=function(){var c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),u=new Array(36),a=0,r;for(var i=0;i<36;i++){if(i==8||i==13||i==18||i==23){u[i]="-";}else if(i==14){u[i]="4";}else{if(a<=0x02)a=0x2000000+(Math.random()*0x1000000)|0;r=a&0xf;a=a>>4;u[i]=c[(i==19)?(r&0x3)|0x8:r];}}return u.join("");};$Firefly.createClass("sap.buddha.XJsonObject",sap.firefly.XObject,{$statics:{xWindow:null,create:function(o){var j=new sap.buddha.XJsonObject();j.setObject(o);return j;},createFromString:function(o){var j=new sap.buddha.XJsonObject();j.setObject(o);return j;},createFromJSonString:function(o){var j=new sap.buddha.XJsonObject();j.setObject(JSON.parse(o));return j;},setXWindow:function(x){sap.buddha.XJsonObject.xWindow=x;}},toString:function(){return"[???]";},obj:null,setObject:function(o){this.obj=o;},isString:function(){return(typeof this.obj==="string");},getString:function(){if(this.isString()){return this.obj;}else if(this.isScriptableMember()){return this.obj.getKey();}return this.getAsJsonString();},getAsJsonString:function(){return JSON.stringify(this.obj);},isArray:function(){return((typeof(this.obj)==="object")&&(this.obj instanceof Array));},isDefined:function(){if(typeof(this.obj)==="undefined"){return false;}return true;},getArray:function(){return sap.buddha.XJsonArray.create(this.obj);},isJSON:function(){return((typeof(this.obj)==="object")&&!this.isArray()&&!this.isPageObject()&&!this.isScriptableMember());},getJSON:function(){var c=sap.firefly.XHashMapByString.create();if(!this.isJSON()){return c;}for(var k in this.obj){if(this.obj.hasOwnProperty(k)){var v=this.obj[k];if(typeof(v)==="object"){v=JSON.stringify(v);}c.put(k,v);}}return c;},replace:function(s,r){return this.getString().replace(new RegExp(s,"g"),r);},isScriptableMember:function(){return(typeof(this.obj.clazzName)!=="undefined")&&(this.obj.clazzName==="ScriptableMember");},isPageObject:function(){var t=this.obj.getPageObject;return(t!=null);},getPageObject:function(){if(!this.isPageObject()){return null;}var t=this.obj.getPageObject();return t;}});$Firefly.createClass("sap.buddha.XJsonArray",sap.firefly.XObject,{$statics:{create:function(o){var j=new sap.buddha.XJsonArray();j.setObject(o);return j;}},toString:function(){return"[???]";},obj:null,setObject:function(o){this.obj=o;},size:function(){return this.obj.length;},get:function(i){return sap.buddha.XJsonObject.create(this.obj[i]);}});$Firefly.createClass("sap.buddha.XJSonRenderSerializer",sap.firefly.XObject,{$statics:{create:function(){var j=new sap.buddha.XJSonRenderSerializer();j.level=0;j.obj={};j.currentObjStack=[];j.currentObjStack.push(j.obj);j.inArrayStack=[];j.inArrayStack.push(false);return j;}},writeOpenObject:function(){var o={};this.currentObjStack.push(o);this.inArrayStack.push(false);this.level++;},setWriter:function(w){this.writer=w;},openTag:function(t){var o={};if(this.inArrayStack[this.inArrayStack.length-1]===true){var a={};this.currentObjStack[this.currentObjStack.length-1].push(a);a[t]=o;}else{this.currentObjStack[this.currentObjStack.length-1][t]=o;}this.currentObjStack.push(o);this.inArrayStack.push(false);this.level++;},addText:function(t){this.addAttribute("_v",t);},closeTag:function(){this.currentObjStack.pop();this.inArrayStack.pop();this.level--;this.checkAndWrite();},addNullAttribute:function(n){this.currentObjStack[this.currentObjStack.length-1][n]=null;},addAttribute:function(n,v){if(v===null){v="";}this.currentObjStack[this.currentObjStack.length-1][n]=v;},addAttributeAsNotString:function(name,value){if(value===null){value="";}Object.defineProperty(this.currentObjStack[this.currentObjStack.length-1],name,{get:function(){return eval(value);}});},addAttribute2:function(n,v){if(v===null){v="";}this.currentObjStack[this.currentObjStack.length-1][n]=v;},addIntegerAttribute:function(n,v){this.currentObjStack[this.currentObjStack.length-1][n]=v;},addDoubleAttribute:function(n,v){this.currentObjStack[this.currentObjStack.length-1][n]=v;},addBooleanAttribute:function(n,v){this.currentObjStack[this.currentObjStack.length-1][n]=v;},openArray:function(a){var o=[];if(this.inArrayStack[this.inArrayStack.length-1]===true){var b={};this.currentObjStack[this.currentObjStack.length-1].push(b);b[a]=o;}else{this.currentObjStack[this.currentObjStack.length-1][a]=o;}this.currentObjStack.push(o);this.inArrayStack.push(true);this.level++;},closeArray:function(){this.currentObjStack.pop();this.inArrayStack.pop();this.level--;this.checkAndWrite();},isCurrentWriter:function(w){return true;},openJsonArray:function(){var o=[];if(this.inArrayStack[this.inArrayStack.length-1]===true){this.currentObjStack[this.currentObjStack.length-1].push(o);}else{throw"invalid state";}this.currentObjStack.push(o);this.inArrayStack.push(true);this.level++;},closeJsonArray:function(){this.currentObjStack.pop();this.inArrayStack.pop();this.level--;this.checkAndWrite();},openJsonTag:function(){var o={};if(this.inArrayStack[this.inArrayStack.length-1]===true){this.currentObjStack[this.currentObjStack.length-1].push(o);}else{throw"invalid state";}this.currentObjStack.push(o);this.inArrayStack.push(false);this.level++;},closeJsonTag:function(){this.currentObjStack.pop();this.inArrayStack.pop();this.level--;this.checkAndWrite();},addDoubleToArray:function(v){this.currentObjStack[this.currentObjStack.length-1].push(v.getDouble());},addIntegerToArray:function(v){this.currentObjStack[this.currentObjStack.length-1].push(v.getInteger());},addSimpleValueToArray:function(v){this.currentObjStack[this.currentObjStack.length-1].push(v);},addNullToArray:function(){this.currentObjStack[this.currentObjStack.length-1].push(null);},checkAndWrite:function(){if(this.writer!=null){if(this.level===0){var s=JSON.stringify(this.obj);this.writer.append(s);}}},getRenderedObject:function(){return this.obj;}});$Firefly.createClass("sap.buddha.XObjectConverter",sap.firefly.XObject,{$statics:{getStringArrayFromIXListForSelection:function(l){var r=[];var a=l.getIterator();while(a.hasNext()){var o=a.next();r.push(o);}return r;},getIXListOfStringForSelectionFromStringArray:function(s){var r=sap.firefly.XListOfString.create();for(var j=0;j<s.length;j++){r.add(s[j]);}return r;},isString:function(s){if(s==null){return true;}return typeof s==="string";},isObjectString:function(o){return sap.buddha.XObjectConverter.isString(o);},convertObjectToString:function(o){return o;},convertObjectToInt:function(o){return o;},isBoolean:function(b){if(b==null){return true;}return typeof b==="boolean";},isInteger:function(i){if(i==null){return true;}return typeof i==="number";},isDouble:function(d){if(d==null){return true;}return typeof d==="number";}}});$Firefly.createClass("sap.buddha.XSSEncoder",sap.firefly.XObject,{$statics:{encodeJavaScript:function(s){var r=new RegExp("'","g");s=s.replace(r,"\\x27");return s;},encodeHtml:function(s){return s;},encodeXml:function(s){var r=new RegExp("[<>&'\"]","g");return s.replace(r,function(c){if(c=="<"){return"&lt;";}else if(c==">"){return"&gt;";}else if(c=="&"){return"&amp;";}else if(c=="'"){return"&apos;";}else if(c=="\""){return"&quot;";};});}}});$Firefly.createClass("sap.buddha.XMathZen",sap.firefly.XObject,{$statics:{create:function(o){var j=new sap.buddha.XMathZen();j.setObject(o);return j;},roundDouble:function(v){return v.toLocaleString(undefined,{"maximumFractionDigits":2,"minimumFractionDigits":2});},getDigitsOfNumber:function(n){return Math.max(Math.floor(Math.log10(Math.abs(n))),0)+1;},getDigitsOfNumberAsString:function(n){return sap.buddha.XMathZen.getDigitsOfNumber(parseFloat(n));}},obj:null,toString:function(){return"[???]";},setObject:function(o){this.obj=o;},size:function(){return this.obj.length;},get:function(i){return sap.buddha.XJsonObject.create(this.obj[i]);}});$Firefly.createClass("sap.buddha.XJsonMap",sap.firefly.XObject,{getJsonFromMapObject:function(o){return JSON.stringify(o);}});$Firefly.createClass("sap.buddha.XJsUI5Utils",null,{$statics:{formatDateTimeValue:function(v,d,i,f){var l=v;var a=sap.buddha.XJsUI5Utils.getDateTimeValueObject(v,d,i);var b={style:f};d=sap.buddha.XJsUI5Utils.translateDataType(d);var c=null;if(d==="DATE"){loDataTypeFormatter=sap.ui.core.format.DateFormat.getDateInstance(b,sap.ui.getCore().getConfiguration().getLocale());}else if(d==="TIME"){loDataTypeFormatter=sap.ui.core.format.DateFormat.getTimeInstance(b,sap.ui.getCore().getConfiguration().getLocale());}else if(d==="DATETIME"){loDataTypeFormatter=sap.ui.core.format.DateFormat.getDateTimeInstance(b,sap.ui.getCore().getConfiguration().getLocale());}if(a&&loDataTypeFormatter){l=loDataTypeFormatter.format(a);}return l;},getDateTimeValue:function(v,d,i){var l=v;var a=sap.buddha.XJsUI5Utils.getDateTimeValueObject(v,d,i);var b=sap.buddha.XJsUI5Utils.getDateTimeValueFormatter(v,d);if(a&&b){l=b.format(a);}return l;},getDateTimeValueObject:function(v,d,i){var l=null;var a=sap.buddha.XJsUI5Utils.getDateTimeValueFormatter(v,d);if(a){l=a.parse(v);}if(i&&l){l.setUTCDate(l.getDate());l.setUTCFullYear(l.getFullYear());l.setUTCMonth(l.getMonth());l.setUTCHours(l.getHours());l.setUTCMinutes(l.getMinutes());l.setUTCSeconds(l.getSeconds());l.setUTCMilliseconds(l.getMilliseconds());}return l;},getDateTimeValueFormatter:function(v,d){var l=null;d=sap.buddha.XJsUI5Utils.translateDataType(d);if(d==="DATE"){l=sap.buddha.XJsUI5Utils.getDateFormatter(v);}else if(d==="TIME"){l=sap.buddha.XJsUI5Utils.getTimeFormatter(v);}else if(d==="DATETIME"){l=sap.buddha.XJsUI5Utils.getDateTimeFormatter(v);}return l;},getDateFormatter:function(d){var l=null;var a;var b=-1;b=d.search("([0-9]{8})");if(b===0){a="yyyyMMdd";}if(!a){b=d.search("([0-9]{4}-[0-9]{2}-[0-9]{2})");if(b===0){a="yyyy-MM-dd";}}var c;if(a){l=sap.ui.core.format.DateFormat.getInstance({pattern:a});}return l;},getTimeFormatter:function(t){var l=null;var a;var b=-1;b=t.search("([0-9]{6})");if(b===0){a="HHmmss";}if(!a){b=t.search("([0-9]{2}:[0-9]{2}:[0-9]{2})");if(b===0){a="HH:mm:ss";}}var c;if(a){l=sap.ui.core.format.DateFormat.getInstance({pattern:a});}return l;},getDateTimeFormatter:function(d){var l=null;var a;var b=-1;b=d.search("^([0-9]{8})");if(b===0){a="yyyyMMdd";b=d.substr(8).search("^([0-9]{6})");if(b===0){a="yyyyMMddHHmmss";}}if(!a){b=d.search("^([0-9]{4}-[0-9]{2}-[0-9]{2})");if(b===0){a="yyyy-MM-dd";b=d.substr(10).search("^T([0-9]{2}:[0-9]{2}:[0-9]{2})");if(b===0){a="yyyy-MM-ddTHH:mm:ss";}}}if(a){l=sap.ui.core.format.DateFormat.getInstance({pattern:a});}return l;},translateDataType:function(d){var l=d.toUpperCase();if(l==="DATE"){l="DATE";}else if(l==="TIME"){l="TIME";}else if(l==="DATETIME"||l==="DATE_TIME"){l="DATETIME";}return l;}},toString:function(){return"[???]";}});$Firefly.createClass("sap.buddha.XJsUtils",null,{$statics:{createProperty:function(instance,name,createGetter,createSetter){var funcName=name.substring(0,1).toUpperCase()+name.substring(1);if(createGetter===true){Object.defineProperty(instance,name,{get:function(){return eval("instance.get"+funcName+"()");}});}if(createSetter===true){Object.defineProperty(instance,name,{set:function(value){return eval("instance.set"+funcName+"("+value+")");}});}},createJsIdentifier:function(i){return i.replace(/\W/g,"_").replace(/^(\d)/g,"_$1");}},toString:function(){return"[???]";}});$Firefly.createClass("sap.buddha.XlsWorkbook",sap.firefly.XObject,{$statics:{create:function(o,a){function W(){if(!(this instanceof W)){return new W();}this.SheetNames=[];this.Sheets={};return this;}var l=new sap.buddha.XlsWorkbook();l.allowStyles=a;l.wb=new W();return l;}},allowStyles:true,formatIndexMap:{},formatIndex:164,addWorksheet:function(s){var l={};this.wb.SheetNames.push(s);this.wb.Sheets[s]=l;l.curRow=-1;l.maxRow=-1;l.maxCol=-1;l["!merges"]=[];return l;},closeWorkSheet:function(x){var l=this.getRange(0,0,x.maxRow+1,x.maxCol+1);x["!ref"]=XLSX.utils.encode_range(l);},getRow:function(x,r){var l={};l.ws=x;l.row=r;l.curCol=-1;return l;},createRow:function(x){x.curRow++;var l=this.getRow(x,x.curRow);if(x.curRow>x.maxRow){x.maxRow=x.curRow;}return l;},getCell:function(x,c){var l={};l.ws=x.ws;l.row=x.row;l.column=c;var a=this.getCellRef(l.row,l.column);x.ws[a]=l;return l;},getCellRef:function(r,c){var l=XLSX.utils.encode_cell({r:r,c:c});return l.toString();},addCell:function(x){x.curCol++;var l=this.getCell(x,x.curCol);if(x.curCol>x.ws.maxCol){x.ws.maxCol=x.curCol;}return l;},copyCell:function(x,X){if(x.s){X.s=x.s;}if(x.v){X.v=x.v;}if(x.t){X.t=x.t;}if(x.f){X.f=x.f;}if(x.z){X.z=x.z;}if(x.w){X.w=x.w;}},mergeCell:function(x,r,c){var l=r,a=c;if(l<1){l=1;}if(a<1){a=1;}var b=this.getRange(x.row,x.column,x.row+l-1,x.column+a-1);if(l>1||a>1){x.ws["!merges"].push(b);}var d=null,e=null,i=0;for(i=1;i<l;i++){d=this.getRow(x.ws,x.row+i);e=this.getCell(d,x.column);this.copyCell(x,e);}for(i=1;i<a;i++){d=this.getRow(x.ws,x.row);e=this.getCell(d,x.column+i);this.copyCell(x,e);}},getRange:function(f,a,t,b){var l={s:{r:f,c:a},e:{r:t,c:b}};return l;},setCell:function(x,c){if(x.row>x.ws.maxRow){x.ws.maxRow=x.row;}if(x.column>x.ws.maxCol){x.ws.maxCol=x.column;}var l="FFDCE6F0";var a="FFCCCCCC";var b="FFE5E5E5";var d="FFFFFF00";var e="Calibri";var f=11;var g="top";var h="left";var i={style:"medium",color:{rgb:a}};var j={top:i,bottom:i,left:i,right:i};var k={font:{name:e,sz:f,bold:false},alignment:{vertical:g,horizontal:h,wrapText:false,indent:0}};var m={font:{name:e,sz:f,bold:false},alignment:{vertical:g,horizontal:h,wrapText:false,indent:0},border:j};var n={font:{name:e,sz:f,bold:false},fill:{fgColor:{rgb:l}},alignment:{vertical:g,horizontal:h,wrapText:false,indent:0},border:j};var o={font:{name:e,sz:f,bold:false},fill:{fgColor:{rgb:b}},alignment:{vertical:g,horizontal:h,wrapText:false,indent:0},border:j};var p={font:{name:e,sz:f,bold:false},fill:{fgColor:{rgb:d}},alignment:{vertical:g,horizontal:h,wrapText:false,indent:0},border:j};if(c.getStyle().toString()!=="NONE"&&this.allowStyles===true){if(c.getStyle().toString()==="GROUP"){x.s=n;}else if(c.getStyle().toString()==="HEADER"){x.s=o;}else if(c.getStyle().toString()==="TOTAL"){x.s=p;}else{x.s=m;}}else{x.s=k;}x.v=c.getFormattedValue();x.t="s";x.s.alignment.horizontal="left";if(c.getValueType().toString()==="NUMBER"||c.getValueType().toString()==="NUMBER_AS_STRING"){x.s.alignment.horizontal="right";if(c.getValueType().toString()==="NUMBER"){x.v=c.getValue();x.t="n";}}else if(c.getValueType().toString()==="DATE"){x.v=c.getValue();x.t="d";}if(c.getFormula()){x.f=c.getFormula();}if(c.getValueType().toString()==="NUMBER_AS_STRING"){c.setFormatString(null);}if(c.getValueType().toString()==="NUMBER"){x.s.numFmt=c.getFormatString();}if(c.getFormatString()!=null&&c.getFormatString().length>0){x.z=c.getFormatString();var q=this.formatIndexMap[c.getFormatString()];if(!q){while(XLSX.SSF.get_table()[this.formatIndex]){this.formatIndex++;}q=this.formatIndex;this.formatIndexMap[c.getFormatString()]=q;this.formatIndex++;XLSX.SSF.load(c.getFormatString(),q);}x.z=XLSX.SSF.get_table()[q];XLSX.utils.format_cell(x);}else{x.w=c.getFormattedValue();}this.mergeCell(x,c.getRowSpan(),c.getColSpan());},save:function(a){var l=this.getAsBinary();var b=new Blob([l],{type:"application/octet-stream"});var c=URL.createObjectURL(b);var s=(function(){var d=document.createElement("a");document.body.appendChild(d);d.style="display: none";return function(c,a){d.href=c;d.download=a;d.click();};}());if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(b,a);}else{s(c,a);}var f=function(){window.URL.revokeObjectURL(c);};setTimeout(f,1);},getAsBinary:function(){var l=XLSX.write(this.wb,{bookType:"xlsx",bookSST:true,compression:"DEFLATE",type:"binary",cellDates:true});function s(b){var a=new ArrayBuffer(b.length);var c=new Uint8Array(a);for(var i=0;i!=b.length;++i){c[i]=b.charCodeAt(i)&0xFF;}return a;}var a=s(l);return a;}});$Firefly.createClass("sap.buddha.LogEntry",sap.firefly.XObject,{$statics:{create:function(l){var a=new sap.buddha.LogEntry();a.le=l;return a;}},getTime:function(){return this.le.time;},getDate:function(){return this.le.date;},getTimeStamp:function(){return this.le.timestamp;},getLevel:function(){return this.le.level;},getMessage:function(){return this.le.message;},getDetails:function(){return this.le.details;},getComponent:function(){return this.le.component;}});$Firefly.createClass("sap.buddha.LogEntryIterator",sap.firefly.XObject,{$statics:{create:function(l){var i=new sap.buddha.LogEntryIterator();i.logEntries=l;i.ix=0;return i;}},logEntries:null,hasNext:function(){if(this.logEntries==null){return false;}return(this.ix<this.logEntries.length);},next:function(){if(!this.hasNext()){return null;}var l=sap.buddha.LogEntry.create(this.logEntries[this.ix]);this.ix++;return l;}});$Firefly.createClass("sap.buddha.XLogging",null,{$statics:{create:function(){var l=new sap.buddha.XLogging();var d=jQuery.sap.debug();l.jQueryLogger=new jQuery.sap.log.getLogger("DSH",d?4:-1);l.entries=[];jQuery.sap.log.addLogListener(l);l.components={},l.components["DSH"]=true;return l;},XALL:6,XDEBUG:4,XERROR:1,XFATAL:0,XINFO:3,XNONE:-1,XTRACE:5,XWARNING:2},onLogEntry:function(l){if(this.components[l.component]){this.entries.push(l);}},setLogLevelInternal:function(c){if(c){this.components[c]=true;this.jQueryLogger.setLevel(4,c);}},debug:function(m,d,c){this.setLogLevelInternal(c);this.jQueryLogger.debug(m,d,c);},error:function(m,d,c){this.setLogLevelInternal(c);this.jQueryLogger.error(m,d,c);},fatal:function(m,d,c){this.setLogLevelInternal(c);this.jQueryLogger.fatal(m,d,c);},info:function(m,d,c){this.setLogLevelInternal(c);this.jQueryLogger.info(m,d,c);},isLoggable:function(l){return this.jQueryLogger.isLoggable(l,"DSH");},trace:function(m,d,c){this.setLogLevelInternal(c);this.jQueryLogger.trace(m,d,c);},warning:function(m,d,c){this.setLogLevelInternal(c);this.jQueryLogger.warning(m,d,c);},toString:function(){return"[???]";},getLogs:function(){return sap.buddha.LogEntryIterator.create(this.entries);}});$Firefly.createClass("sap.buddha.XZip",sap.firefly.XObject,{$statics:{create:function(){var x=new sap.buddha.XZip();x.zip=new window.jszip();return x;}},saveToFile:function(f,c){this.zip.file(f,c,{binary:true});},saveStringToFile:function(f,c){this.zip.file(f,c);},getZipAsBinary:function(){var b=this.zip.generate({type:"uint8array"});return b;},saveZip:function(b){var c=this.zip.generate({type:"uint8array"});var d=new Blob([c],{type:"application/zip"});var u=window.URL.createObjectURL(d);var s=(function(){var a=document.createElement("a");document.body.appendChild(a);a.style="display: none";return function(u,b){a.href=u;a.download=b;a.click();};}());if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(d,b);}else{s(u,b);}var f=function(){window.URL.revokeObjectURL(u);};setTimeout(f,1);}});$Firefly.createClass("sap.buddha.XLocalization",null,{$statics:{createForUrl:function(u){var l=new sap.buddha.XLocalization();l.resourceBundle=ResourceBundle.create({url:u,async:false});return l;},create:function(){if(sap.ui.getCore().getLoadedLibraries().hasOwnProperty("sap.zen.dsh")){return sap.buddha.XLocalization.createForUrl(URI(sap.ui.resource("sap.zen.dsh","i18n/localization/localization.properties")).absoluteTo(window.location.pathname).toString());}else{return sap.buddha.XLocalization.createForUrl("/aad/buddha/localization/localization.properties");}}},propertyMap:null,hasText:function(k){return this.resourceBundle.hasText(k);},getText:function(k){return this.resourceBundle.getText(k);},getText1:function(k,a){return this.resourceBundle.getText(k,[a]);},getText2:function(k,a,A){return this.resourceBundle.getText(k,[a,A]);},getText3:function(k,a,A,s){return this.resourceBundle.getText(k,[a,A,s]);},getText4:function(k,a,A,s,b){return this.resourceBundle.getText(k,[a,A,s,b]);},getText5:function(k,a,A,s,b,c){return this.resourceBundle.getText(k,[a,A,s,b,c]);},getText6:function(k,a,A,s,b,c,d){return this.resourceBundle.getText(k,[a,A,s,b,c,d]);},getTranslationMap:function(){if(this.propertyMap===null){var j=this.resourceBundle.aPropertyFiles&&this.resourceBundle.aPropertyFiles.length>0&&this.resourceBundle.aPropertyFiles[0]&&this.resourceBundle.aPropertyFiles[0].mProperties;this.propertyMap=sap.firefly.XHashMapOfStringByString.create();if(typeof j==="object"){for(var k in j){if(j.hasOwnProperty(k)){this.propertyMap.put(k,j[k]);}}}}return this.propertyMap;},toString:function(){return"[???]";}});});
