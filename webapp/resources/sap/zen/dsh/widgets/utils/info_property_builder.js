/*
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/zen/commons/thirdparty/lodash","sap/zen/dsh/utils/BaseHandler"],function(q,_){"use strict";function I(c,a){this._properties=q.extend(true,{},c);this._chartType=a;}I.prototype.getPropertyValue=function(p){var a=p.split(".");return _.reduce(a,function(b,c){return b&&b[c];},this._properties);};I.prototype.getPropertyDefaultValue=function(p){var a=p.split(".");var d;try{var b=sap.viz.api.metadata.Viz.get(this._chartType).properties;var f=a.shift();d=_.reduce(a,function(c,g){return c.children[g];},b[f]).defaultValue;}catch(e){}return d;};I.prototype.setPropertyValue=function(p,v){var a=p.split(".");var l=a.pop();var b=_.reduce(a,function(b,c){b[c]=b[c]||{};return b[c]||{};},this._properties);b[l]=v;};I.prototype._handleNoneAndDefaultFormatStringProperties=function(p){p=p||this._properties;for(var k in p){if(!Object.prototype.hasOwnProperty.call(p,k)){continue;}if(k==="formatString"){if(p[k]==="Default"){delete p[k];}else if(p[k]==="None"){p[k]="";}}else if(_.isObject(p[k])){this._handleNoneAndDefaultFormatStringProperties(p[k]);}}};I.prototype.mapFormatStrings=function(d){d=f(d);d=g(d);this._handleNoneAndDefaultFormatStringProperties();var t=this.getPropertyValue("tooltip.formatString");if(_.isUndefined(t)&&d){var c=this.getPropertyDefaultValue("tooltip.formatString");if(!(c&&c.charAt(c.length-1)==="%")){this.setPropertyValue("tooltip.formatString",d);}}var a=this.getPropertyValue("plotArea.dataLabel.formatString");if(_.isUndefined(a)){var b=this.getPropertyValue("plotArea.dataLabel.type")||this.getPropertyDefaultValue("plotArea.dataLabel.type");if(b&&b.indexOf("value")!==-1){var e=s(_.clone(d));this.setPropertyValue("plotArea.dataLabel.formatString",e);}}function f(h){if(_.isString(h)){var r,i;r="#(?![#|"+sap.common.globalization.NumericFormatManager.getThousandSeparator()+"]).(?=#)";i=new RegExp(r,"g");h=h.replace(i,"#"+sap.common.globalization.NumericFormatManager.getThousandSeparator());r="0(?![0|"+sap.common.globalization.NumericFormatManager.getDecimalSeparator()+"]).(?=0)";i=new RegExp(r,"g");h=h.replace(i,"0"+sap.common.globalization.NumericFormatManager.getDecimalSeparator());r="\\ ";i=new RegExp(r,"g");h=h.replace(i,"\\ ");}else if(_.isObject(h)){_.each(_.keys(h),function(j){h[j]=f(h[j]);});}return h;}function g(h){if(_.isString(h)){h=h.replace("'-'","-");}else if(_.isObject(h)){_.each(_.keys(h),function(i){h[i]=g(h[i]);});}return h;}function s(h){var r="[^#\\"+sap.common.globalization.NumericFormatManager.getThousandSeparator()+"0\\"+sap.common.globalization.NumericFormatManager.getDecimalSeparator()+";-]";var i=new RegExp(r,"g");if(_.isString(h)){h=h.replace(i,"");}else if(_.isObject(h)){_.each(_.keys(h),function(j){h[j]=s(h[j]);});}return h;}return this;};I.prototype.setDefaultColorPalette=function(){var d=this.getPropertyDefaultValue("plotArea.colorPalette");if(d&&d.length){this._properties.plotArea=this._properties.plotArea||{};this._properties.plotArea.colorPalette=this._properties.plotArea.colorPalette||I.DEFAULT_COLOR_PALETTE;}return this;};I.prototype.getProperties=function(){return this._properties;};I.prototype.applyScalingFactor=function(s,f){var m=s._measureMembers;var a=f.metadata.fields;for(var i=0;i<m.length;i++){if(m[i].scalingFactor>0){var b=this.getScalingDisplayString(m[i].scalingFactor);for(var j=0;j<a.length;j++){if(a[j].id===m[i].key){a[j].name=a[j].name+b;}}}}};I.prototype.getScalingDisplayString=function(s){var a="1";for(var i=0;i<s;i++){a+=("0");}var r="$1"+sap.common.globalization.NumericFormatManager.getThousandSeparator()+"";var f=a.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,r);f=" (\u200b*"+f+")";return f;};I.DEFAULT_COLOR_PALETTE=["#748CB2","#9CC677","#EACF5E","#F9AD79","#D16A7C","#8873A2","#3A95B3","#B6D949","#FDD36C","#F47958","#A65084","#0063B1","#0DA841","#FCB71D","#F05620"];return I;});
