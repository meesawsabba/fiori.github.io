/*
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/base/Log","sap/zen/commons/thirdparty/lodash","sap/zen/dsh/utils/BaseHandler","sap/zen/dsh/utils/request"],function(q,L,_,B,R){"use strict";var H=function(){B.apply(this,arguments);var I=false;function c(s){return s.charAt(0).toUpperCase()+s.slice(1);}this.updateProperty=function(C,p,P){if(p==="type"||p==="handler_name"||p==="id")return;var u=c(p);var s=C["set"+u];if(s){var n=P[p];try{s.call(C,n);}catch(e){L.error(e);}}};this.dispatchProperties=function(C,o,d){C.oComponentProperties=d;if(o){if(C.beforeDesignStudioUpdate){C.beforeDesignStudioUpdate();}I=true;for(var p in o){C.oControlProperties[p]=o[p];this.updateProperty(C,p,o);}I=false;if(C.afterDesignStudioUpdate){C.afterDesignStudioUpdate();}}};function b(n){var d=new sap.zen.dsh.sapbi_Command("UPDATE_PROPERTIES");d.addParameter(new sap.zen.dsh.sapbi_Parameter("TARGET_ITEM_REF",this.oComponentProperties.id));var e=new sap.zen.dsh.sapbi_Parameter("CHANGES","");var f=new sap.zen.dsh.sapbi_ParameterList();for(var i=0;i<n.length;i++){var p=n[i];var v=this["get"+c(p)]();if(Array.isArray(v)||(typeof v=="object")){v=JSON.stringify(v);}f.addParameter(new sap.zen.dsh.sapbi_Parameter(p,v));}e.setChildList(f);d.addParameter(e);return d;}function r(C){if(!C)return undefined;var p=C.split(".");var o=window;for(var i=0;i<p.length;i++){var O=p[i];o=o[O];if(!o){break;}}return o;}this.create=function(C,o,d){var e=o["id"];var f=r(o["handler_name"]);if(f){var g=new f(e,{dsControlProperties:o,dsComponentProperties:d});g.oControlProperties={};g.fireDesignStudioEvent=function(n){if(!I){if(typeof(sap.zen.dsh.DSH_deployment)=="undefined"){var h=[["EVENT_NAME",n,0],["BI_COMMAND_TYPE","",0],["COMPONENT_NAME",this.oComponentProperties.id,0],["COMMAND_INTERPRETER","BIAL",0]];R.zenSendCommandArrayWoEventWZenPVT(h);}else{var i=this.oComponentProperties.id;var j="Buddha";if(this.oControlProperties.pureId){j=this.oControlProperties.buddhaId;i=this.oControlProperties.pureId;}var s=i+".runScript\x28\x27"+n+"\x27\x29\x3b";sap.zen.dsh.putInQueue(function(){if(!sap.zen.dsh.wnd){L.error("No wnd");}else{sap.zen.dsh.wnd[j].exec(s);}});}}};g.fireDesignStudioPropertiesChanged=function(n){if(!I){if(typeof(sap.zen.dsh.DSH_deployment)=="undefined"){var h=b.call(this,n);R.zenSendCommandArrayWoEventWZenPVT(h,false,true);}else{var t=[];for(var i=0;i<n.length;i++){var p=n[i];var v=this["get"+c(p)]();t.push(p);t.push(v);}var j=this.oComponentProperties.id;var k="Buddha";if(this.oControlProperties.pureId){k=this.oControlProperties.buddhaId;j=this.oControlProperties.pureId;}sap.zen.dsh.putInQueue(function(){if(!sap.zen.dsh.wnd){L.error("No wnd");}else{sap.zen.dsh.wnd[k].exec(j+".doSDKPVT("+JSON.stringify(t)+");");}});}}};g.fireDesignStudioPropertiesChangedAndEvent=function(n,E,N){if(!I&&typeof(sap.zen.dsh.DSH_deployment)=="undefined"){var h=b.call(this,n);if(N){h.addParameter(new sap.zen.dsh.sapbi_Parameter("PREVENT_UNDO","X"));}var s=new sap.zen.dsh.sapbi_CommandSequence();s.addCommand(h);var i=[["EVENT_NAME",E,0],["BI_COMMAND_TYPE","",0],["COMPONENT_NAME",this.oComponentProperties.id,0],["COMMAND_INTERPRETER","BIAL",0]];var j=sap.zen.dsh.sapbi_createParameterList(i);if(N){j.addParameter(new sap.zen.dsh.sapbi_Parameter("PREVENT_UNDO","X"));}s.addCommand(j);R.zenSendCommandArrayWoEventWZenPVT(s,false,true);}else{this.fireDesignStudioPropertiesChanged(n);this.fireDesignStudioEvent(E);}};g.getZtlCallFunction=function(){return this._ztlFunction;};g.setZtlCallFunction=function(v){this._ztlFunction=v;return this;};g.getZtlCallPayload=function(){return this._ztlPayload;};g.setZtlCallPayload=function(v){this._ztlPayload=v;return this;};g.setZtlCallResult=function(v){if(v!==undefined&&this._ztlCallCallback){this._ztlCallCallback.call(this,JSON.parse(v));return this;}};g.callZTLFunction=function(n,h){var i=Array.prototype.slice.apply(arguments);i=i.slice(2);this.setZtlCallPayload(JSON.stringify(i)).setZtlCallFunction(n);this._ztlCallCallback=h;this.fireDesignStudioPropertiesChangedAndEvent(["ztlCallPayload","ztlCallFunction"],"onZtlCall");};g.callZTLFunctionNoUndo=function(n,h){var i=Array.prototype.slice.apply(arguments);i=i.slice(2);this.setZtlCallPayload(JSON.stringify(i)).setZtlCallFunction(n);this._ztlCallCallback=h;this.fireDesignStudioPropertiesChangedAndEvent(["ztlCallPayload","ztlCallFunction"],"onZtlCall",true);};if(g.initDesignStudio){g.initDesignStudio();}this.dispatchProperties(g,o,d);return g;}return null;};this.update=function(C,o,d){this.dispatchProperties(C,o,d);return C;};this.advancedPropertyCall=function(C){var f=arguments[1];var d=C[f];if(d){var e=Array.prototype.slice.apply(arguments);e=e.slice(2);return d.apply(C,e);}return null;};this.getType=function(){return"sdkui5";};this.getDecorator=function(){return"SdkControlDecorator";};};var a=new H();B.dispatcher.addHandlers(a.getType(),a);return a;});
