/*!
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/zen/commons/thirdparty/lodash","sap/ui/core/Control","sap/zen/dsh/utils/BaseHandler","sap/zen/dsh/widgets/utilities/SDKUtilsHelper"],function(q,_,C,B,S){"use strict";function D(){this.getPlotAreaDataSeriesByMeasure=function(){this.createDataMapper();var p=q.extend(true,{},this.getProperty("plotObjectType"));var d={};if(!this.getData()){p.dataByInitialView={};p.dataByInitialView.errorMessage="There are no additional properties for the selected chart.";return p;}var u=new S();var m=u.getMeasureKeyArr(this.getData());var a=[];if(!m||m.length==0){d.errorMessage="Cannot display \"Measures\" properties. \u00A0In the \"Edit Initial View\" window of the data source, in the \"Columns\" area, you included measures. In this data structure, lines cannot appear. If you want to display lines, move the measures to the \"Rows\" area.";}else{if(p.data){var b=true;var c={"axis1":false,"axis2":false};for(var e=0;e<m.length;e++){var f=u.plotObjectContainsMeasure(p.data,m[e].key,true);if(f>-1){b=false;a.push(p.data[f]);}else if(f===-2){b=false;a.push([p.data[e][0],p.data[e][1],m[e].key]);}else{a.push(["line","axis2",m[e].key]);}c[a[a.length-1][1]]=true;}if(b||!c.axis1||!c.axis2)a=this.setDefaultValues(m,p.defaultSingleValue);p.data=a;}else if(p.changedData!=undefined&&p.dataByInitialView!=undefined&&!this.allMeasuresInObject(m,p.dataByInitialView)){a=this.setDefaultValues(m,p.defaultSingleValue);delete p.changedData;}else if(p.changedData!=undefined&&p.data!=undefined)a=p.changedData;else if(p.dataByInitialView!=undefined&&this.allMeasuresInObject(m,p.dataByInitialView))a=this.getByInitialView(m,p.dataByInitialView);else{a=this.setDefaultValues(m,p.defaultSingleValue);}p.defaultValues=this.setDefaultValues(m,p.defaultSingleValue);d.data={};for(var i=0;i<m.length;i++){d.data[m[i].text+"#KEY#"+m[i].key]=a[i];}}p.dataByInitialView=d;return p;};this.getByInitialView=function(m,d){var a=[];for(var i=0;i<m.length;i++){a[i]=[];a[i].push(d.data[m[i]][0]);a[i].push(d.data[m[i]][1]);}return a;};this.setDefaultValues=function(m,d){var a=[];for(var i=0;i<m.length;i++){a[i]=[];if(i==0){a[i].push("bar");}else{a[i].push(d);}if(i<Math.ceil(m.length/2))a[i].push("axis1");else a[i].push("axis2");a[i].push(m[i].key);}return a;};this.setPlotObjectType=function(n){var p=q.extend(true,{},this.getProperty("plotObjectType"));if(n.changedData==undefined){if(p.data)delete p.data;if(p.dataByInitialView){delete p.dataByInitialView;}}q.extend(true,p,n);this.setProperty("plotObjectType",p);};this.getPlotObjectType=function(){var p=this.getPlotAreaDataSeriesByMeasure();this.setProperty("plotObjectType",p,true);return p;};this.allMeasuresInObject=function(m,o){for(var i=0;i<m.length;i++){if(o.data==undefined||o.data[m[i].text]==undefined)return false;}for(o in o.data){if(o){if(!this.containsMeasure(m,o))return false;}}return true;};this.containsMeasure=function(m,a){for(var i=0;i<m.length;i++){if(m[i].key===a)return true;}return false;};}D.prototype.updateCvomDataOnPropertyChangeHelper=function(){var p=q.extend(true,{},this.getProperty("plotObjectType"));if(p.defaultValues)p.data=q.parseJSON(JSON.stringify(p.defaultValues));this.setProperty("plotObjectType",p);};return D;});
