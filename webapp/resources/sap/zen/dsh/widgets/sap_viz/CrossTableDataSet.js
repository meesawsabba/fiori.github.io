/*
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/zen/dsh/widgets/sap_viz/typeUtils","sap/zen/dsh/widgets/sap_viz/objectUtils","sap/zen/dsh/widgets/sap_viz/AnalysisAxis","sap/zen/dsh/widgets/sap_viz/MeasureValuesGroup"],function(L,T,O,A,M){"use strict";L.info("Load CrossTableDataSet");var a="analysisAxis";var b="measureValuesGroup";function c(){this._analysisAxis=[];this._measureValuesGroup=[];this._dataSet={};this._measures=[];this._dimensions=[];this._emptyDataset=false;this._infos={};}c.prototype.data=function(e){if(!arguments.length){var f=O.clone(this._dataSet);if(this._emptyDataset){this.cleanDataset(f);}return f;}this._analysisAxis=[];this._measureValuesGroup=[];this._measures=[];this._dimensions=[];this._dataSet=O.clone(e);this.init(this._dataSet);this._measures=this.getMetaNames(e,b);this._dimensions=this.getMetaNames(e,a);this._infos={};return this;};c.prototype.setData=function(i){this.data(i);};c.prototype.getMetaNames=function(e,f){if(e==undefined){return;}var g=[];f=e[f];if(f===undefined||!T.isArray(f)){return g;}for(var i=0;i<f.length;i++){var h=f[i].data;if(h===undefined||!T.isArray(h)){continue;}for(var j=0;j<h.length;j++){if(h[j].name!==undefined){var o={name:h[j].name,index:i,location:j};g.push(o);}}}return g;};c.prototype.init=function(e){if(!e||(!e[a]&&!e[b])){return;}var f=[1,1];var g=false;d(e);var h=e[a];var i=0;var m,j,k;if(h){if(h.length>2){L.error("Crosstable error");}for(;i<h.length;i++){var l=h[i];var n=l["index"];if(n!==1&&n!==2){L.error("Crosstable error");}if(this._analysisAxis[n-1]){L.error("Crosstable error");}var o=new A(l["data"]);f[n-1]=o.validate();this._analysisAxis[n-1]=o;}if(f[0]===0){f[1]=0;g=true;}m=e[b];if(m){for(i=0;i<m.length;i++){j=m[i];var p=j["index"];if(this._measureValuesGroup[p-1]){L.error("Crosstable error");}k=new M(j["data"]);k.validate(f);this._measureValuesGroup[p-1]=k;}}}else{m=e[b];for(i=0;i<m.length;i++){j=m[i];k=new M(j["data"]);if(i===0){f=k.validate();}else{k.validate(f);}this._measureValuesGroup[j["index"]-1]=k;}}this._emptyDataset=g;};var r=function(e){for(var i=0;i<e.length;i++){if(e[i].values==null){e[i].values=[];}}};var d=function(e){if(e[a]){var f=e[a];for(var i=0;i<f.length;i++){r(f[i].data);}}if(e[b]){var m=e[b];for(i=0;i<m.length;i++){r(m[i].data);}}};return c;});
