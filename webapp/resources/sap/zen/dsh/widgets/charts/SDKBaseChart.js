/*!
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/zen/commons/thirdparty/lodash","sap/ui/core/Control","sap/m/TextArea","sap/zen/dsh/utils/BaseHandler","sap/zen/dsh/widgets/dataMappers/SDKGenericDataMapper","sap/zen/dsh/widgets/utilities/SDKUtilsHelper","sap/zen/dsh/widgets/charts/helpers/SDKChartDataFeedingHelper","sap/zen/dsh/widgets/charts/ChartException"],function(q,_,C,T,B,S,a,b){"use strict";C.extend("sap.zen.SDKBaseChart",{metadata:{properties:{"imageVisibility":{type:"boolean",defaultValue:false},"cvomError":{type:"string",defaultValue:null},"width":{type:"sap.ui.core.CSSSize"},"height":{type:"sap.ui.core.CSSSize"},"onSelect":{type:"string"},"dataLabel":{type:"boolean",defaultValue:false},"animation":{type:"boolean",defaultValue:true},"chartValuesFull":{type:"object",defaultValue:{visible:false,position:"inside"}},"background":{type:"object",defaultValue:{selectedValidValues:["Solid Fill","No Fill"],selectedValue:"Solid Fill",colorValidValues:[null,"transparent"],colorValue:null}},"presentation":{type:"object",defaultValue:{label:"When displaying dimension values use:",selectedValidValues:["defaults","text","key"],selectedValidValuesText:["Initial View Definitions","Text","Key"],selectedValue:"defaults"}},"axisScaling":{type:"object",defaultValue:{axisSingle:{fixedRange:false,minValue:"",maxValue:""},axisDual:{fixedRange:false,minValue:"",maxValue:""}}}},aggregations:{"errorLayoutControl":{type:"sap.zen.commons.layout.AbsoluteLayout",multiple:false},"imageControl":{type:"sap.ui.core.Control",multiple:false}}},_onInitilized:null,_measureFormat:null,_tooltipFormat:null,_alreadySwapped:false,_utilsHelper:null,_formattingHelper:null,_colourHelper:null,_chartDataFeedingHelper:null,_chartAdditionalPropertiesHelper:null,_lastError:null,ADDITIONAL_PROPERTIES_SEPARATOR:".",INTERNAL_ERROR:"Internal error",getChartDataFeedingHelper:function(){if(this._chartDataFeedingHelper==null)this._chartDataFeedingHelper=new b();return this._chartDataFeedingHelper;},setData:function(d){this.data=d;},getAxesSwapped:function(){return this.axesSwapped;},getData:function(){return this.data;},getMessages:function(){return this.messages;},getDataMapper:function(){return new S();},registerHelper:function(h){if(!this.helpers){this.helpers={};}if(!this.helpers[h]){this.helpers[h]=h;}},init:function(){this.data=null;this.locale=null;this.axisFormat=null;this.chartFormatType=null;this.chartThemes=null;this.createImage(this.getId());this.createErrorLayout(this.getId());this.initCvomChartType();this.bOnAfterRendering=true;this._updateCvomDataNeeded=false;this._oldProps={};},initCvomChartType:function(){},createImage:function(){},createErrorLayout:function(){if(sap.ui.getCore().byId(this.getId()+"_error")){sap.ui.getCore().byId(this.getId()+"_error").destroy();}var m=new sap.zen.commons.layout.AbsoluteLayout(this.getId()+"_error");var i=B.dispatcher.isMainMode();var M=(i)?new T(this.getId()+"_errormessage"):new sap.ui.commons.TextView(this.getId()+"_errormessage");M.setTextAlign("Center");if(i){M.setValueState(sap.ui.core.ValueState.Error);}else{M.setDesign("Bold");M.setSemanticColor("Critical");}m.addContent(M,{left:"5px",top:"5px",right:"5px"});if(q.support.opacity){m.addStyleClass("zenMessageWithOpacity");}else{m.addStyleClass("zenMessageWithFilter");}this.setErrorLayoutControl(m);},createDataMapper:function(){var d=this.getDataMapper();d.setMessages(this.getMessages());return d;},getDataDualFeeding:function(k,c,r,d){var e=this.getChartDataFeedingHelper();var f=e.getDataDualFeedingColor(c,r,d);var g=[];g.push(e.getAnalysisAxisIndex1());var h=[{"feedId":"primaryValues","binding":[{"type":"measureValuesGroup","index":1}]},{"feedId":"secondaryValues","binding":[{"type":"measureValuesGroup","index":2}]},{"feedId":"regionColor","binding":f},{"feedId":"axisLabels","binding":g}];return h;},getDataFeeding:function(m,c,n,d){var e=this.getChartDataFeedingHelper();var f=e.getDataFeedingAxis(m,c,d,n);var g=function(j){var k=_.chain(j&&j.dimensions).find({"containsMeasures":true}).value();return k&&k.axis_index;};var h=g(this.data);if(h===undefined){h=c;}var r=e.getDataFeedingColor(m,h,d,n);var i=[{"feedId":"axisLabels","binding":f},{"feedId":"regionColor","binding":r},{"feedId":"primaryValues","binding":[{"type":"measureValuesGroup","index":1}]}];return i;}});return sap.zen.SDKBaseChart;});
