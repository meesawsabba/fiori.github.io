/*!
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define("sap/zen/dsh/controller/DimensionInput.controller",["sap/ui/core/mvc/Controller","sap/base/Log","sap/zen/commons/thirdparty/lodash"],function(C,L,_){"use strict";C.extend("sap.zen.dsh.controller.DimensionInput",{onInit:function(){var t=this;var v=t.getView();v.setBusy(true);v.loaded().then(function(){v.setBusy(false);});},onExit:function(){var t=this;t.getView().removeAllDependents();},tokenUpdate:function(e){var t=this;var n=e.getSource().data("name");var d=_.find(t.getView().getModel("Restriction").getProperty("/Dimensions"),function(o){return o.Name===n;});if(!d){throw new Error("Dimension Not Found");}var r=t.getView().getModel("Restriction");var D=r.getProperty("/dataProviderName");var a=t.getView().getModel("om").getProperty(["/dataProvider/"+D+"/Dimensions",encodeURIComponent(d.Name)].join("/"));if(!a){throw new Error("Dimension Not Found");}var h=_.reduce(e.getParameter("removedTokens"),function(R,T){R[T.getKey()]=true;return R;},{});d.Values=_.filter(d.Values,function(v){return!h[v.key];});d.Values=_.concat(d.Values,_.map(e.getParameter("addedTokens"),function(T){return T.data();}));r.checkUpdate();},handleValueHelp:function(e){var t=this;var d=e.getSource().data().name;var r=t.getView().getModel("Restriction");var D=r.getProperty("/dataProviderName");t.getView().getModel("om").getDataProvider(D).openSelector(d,true).then(function(l){if(l){var n=_.findIndex(r.getProperty("/Dimensions"),function(o){return o.Name===d;});r.setProperty(["/Dimensions",n,"Values"].join("/"),l);}}).catch(L.error);}});return sap.zen.dsh.controller.DimensionInput;});
