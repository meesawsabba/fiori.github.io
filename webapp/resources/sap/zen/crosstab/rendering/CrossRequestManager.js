/*!
 * (c) Copyright 2010-2019 SAP SE or an SAP affiliate company.
 */
sap.ui.define(["jquery.sap.global","sap/zen/crosstab/rendering/ScrollManager","sap/zen/crosstab/rendering/PixelScrollManager","sap/zen/crosstab/rendering/HeaderScrollManager","sap/zen/crosstab/utils/Utils"],function(q,S,P,H){"use strict";q.sap.declare("sap.zen.crosstab.rendering.CrossRequestManager");sap.zen.crosstab.rendering.CrossRequestManager=function(c,r){var s=null;var h=null;var i=0;var a="";var v=0;var V="";var b=false;var C=null;var d=null;var D=null;var R=null;var e=false;var f="";var g="";var t=0;var T=0;var j=0;var k=0;var A=false;var l=false;var m=false;var n=undefined;var o=undefined;var p=null;var u=c.getDataArea();var w=c.getRowHeaderArea();var x=c.getColumnHeaderArea();var y=false;var z=false;this.reset=function(){if(s){s.destroy();}s=null;if(h){h.destroy();}h=null;};this.clearSavedColWidths=function(){C=null;d=null;D=null;R=null;};this.clearSavedData=function(){s=null;h=null;i=0;a="";v=0;V="";b=false;this.clearSavedColWidths();e=false;f="";g="";t=0;T=0;p=null;y=false;z=false;};this.saveTableDimensions=function(){if(c.getPropertyBag().isPixelScrolling()){var G=q(document.getElementById(c.getId()+"_dataArea"));j=G.outerHeight();k=G.outerWidth();}t=c.getTotalRows();T=c.getTotalCols();};function B(G){if(g==="expanded"){return(G<0);}else if(g==="collapsed"){return(G>0);}else{return false;}}this.handleRootCause=function(){var O=v;var G=i;var I=n;var J=o;if(f==="plan"){if(a!=="plan"&&V!=="plan"){this.clearSavedData();}}else if(f==="sorting"){if(a!=="sort"){this.clearSavedData();}else{v=0;o=false;}}else if(f==="hierarchy"){if(a==="hier"&&V==="hier"){var K=t-c.getTotalRows();var L=T-c.getTotalCols();if(K!==0){if(B(K)){if(!e){if(c.getPropertyBag().isPixelScrolling()){l=true;}else{v=Math.max(0,v-K);}}}else{this.clearSavedData();}}else if(L!==0){if(B(L)){if(!e){if(c.getPropertyBag().isPixelScrolling()){A=true;}else{i=Math.max(0,i-L);}}}else{this.clearSavedData();}}}else{this.clearSavedData();}}e=false;f="";g="";t=0;T=0;if(G!==i||O!==v||I!==n||J!==o){c.getUtils().sendScrollPosUpdate(i,n,v,o);}m=true;};this.getHPixelScrollPosAfterRendering=function(){var G=-1;if(c.getPropertyBag().isPixelScrolling()){var I=q(document.getElementById(c.getId()+"_dataArea"));if(A){var J=I.outerWidth()-k;G=i+J;A=false;}}return G;};this.getVPixelScrollPosAfterRendering=function(){var G=-1;if(c.getPropertyBag().isPixelScrolling()){var I=q(document.getElementById(c.getId()+"_dataArea"));if(l){var J=I.outerHeight()-j;G=v+J;l=false;}}return G;};this.setRootCause=function(G){f=G;};this.setHierarchyAction=function(G){g=G;};this.setIsHierarchyDirectionDown=function(I){e=I;};this.getScrollManager=function(){if(!s){if(c.getPropertyBag().isPixelScrolling()){s=new P(c,r);}else{s=new S(c,r);}if(b){s.setHScrollPos(i);s.setVScrollPos(v);}}return s;};this.getHeaderScrollManager=function(){if(!h){h=new H(c,r);if(b){h.setHScrollData(p);}}return h;};this.saveHScrollInfo=function(G,I){if(c.getPropertyBag().isPixelScrolling()){var s=c.getRenderEngine().getScrollManager();i=0;if(s){i=s.getCurrentHScrollPos();}}else{i=c.getColumnHeaderArea().getRenderStartCol();if(s&&s.isHScrolledToEnd()){i++;n=true;}}if(I){v=0;}a=G;b=true;y=true;};this.saveVScrollInfo=function(G,I){if(c.getPropertyBag().isPixelScrolling()){var J=q(document.getElementById(c.getId()+"_lowerRight_scrollDiv"));v=0;if(J&&J.length>0){v=J.scrollTop();}}else{v=c.getRowHeaderArea().getRenderStartRow();if(s&&s.isVScrolledToEnd()){v++;o=true;}}if(I){i=0;}V=G;b=true;z=true;};this.savedInfoHandled=function(){if(m===true){i=0;a="";v=0;V="";b=false;C=null;d=null;D=null;R=null;m=false;n=undefined;o=undefined;p=null;y=false;z=false;}};this.hasSavedInfo=function(){return b;};this.getSavedHScrollInfo=function(){var G={};G.iPos=i;G.sAction=a;G.bScrolledToEnd=n;return G;};this.getSavedVScrollInfo=function(){var G={};G.iPos=v;G.sAction=V;G.bScrolledToEnd=o;return G;};this.saveColWidths=function(){var x=c.getColumnHeaderArea();var G=c.getDimensionHeaderArea();var w=c.getRowHeaderArea();var u=c.getDataArea();if(!x.hasLoadingPages()){C=x.getColWidths();b=true;}if(!u.hasLoadingPages()){D=u.getColWidths();b=true;}if(!G.hasLoadingPages()){d=G.getColWidths();b=true;}if(!w.hasLoadingPages()){R=w.getColWidths();b=true;}};this.restoreColWidths=function(){var x=c.getColumnHeaderArea();var G=c.getDimensionHeaderArea();var w=c.getRowHeaderArea();var u=c.getDataArea();if(C){x.setColWidths(C);C=null;}if(D){u.setColWidths(D);D=null;}if(d){G.setColWidths(d);d=null;}if(R){w.setColWidths(R);R=null;}};function E(G,I,J,K){var L={iHScrollPos:G,bHScrolledToEnd:I,iVScrollPos:J,bVScrolledToEnd:K};if(L.iHScrollPos<0){L.iHScrollPos=0;L.bHScrolledToEnd=false;}if(L.iVScrollPos<0){L.iVScrollPos=0;L.bVScrolledToEnd=false;}if(!c.getPropertyBag().isPixelScrolling()){var M=u?u:x;var N=M.getColCnt()-1;if(L.iHScrollPos>N){L.iHScrollPos=0;L.bHScrolledToEnd=false;}M=u?u:w;var O=M.getRowCnt()-1;if(L.iVScrollPos>O){L.iVScrollPos=0;L.bVScrolledToEnd=false;}}if((L.iHScrollPos!==G)||(L.iVScrollPos!==J)){c.getUtils().sendScrollPosUpdate(0,false,0,false);}return L;}this.setHScrollInfo=function(G,I){i=G;n=I;b=true;y=true;};this.setVScrollInfo=function(G,I){v=G;o=I;b=true;z=true;};this.setScrollData=function(G,I,J,K){var L=E(G,I,J,K);i=L.iHScrollPos;v=L.iVScrollPos;n=L.bHScrolledToEnd;o=L.bVScrolledToEnd;b=true;y=true;z=true;};function F(G){var I=G;if(I.iHPos<0){I.iHPos=0;}if(I.iHPos!==G.iHPos){c.getUtils().sendScrollPosUpdate(I.iHPos,undefined,undefined,undefined,true);}return I;}this.setHeaderScrollData=function(G){var I=F(G);b=true;p=I;};this.getHeaderScrollData=function(){return p;};this.hasSavedHScrollInfo=function(){return y;};this.hasSavedVScrollInfo=function(){return z;};};return sap.zen.crosstab.rendering.CrossRequestManager;});
