/*!
 * (c) Copyright 2010-2019 SAP SE or an SAP affiliate company.
 */
sap.ui.define(["jquery.sap.global","sap/base/Log","sap/zen/crosstab/rendering/RenderingConstants"],function(q,L,R){"use strict";q.sap.declare("sap.zen.crosstab.utils.Utils");sap.zen.crosstab.utils.Utils=function(c){var t=this;var Q=null;var p={};var s=null;this.beginProfiling=function(k,T){var i=Date.now();p[k]={"iTsBegin":i,"sText":T};};this.endProfiling=function(k){var T=Date.now();var P=p[k];if(P){L.error("CROSSTAB PERF: "+k+": "+P.sText+": DURATION: "+(T-P.iTsBegin)+"ms");}};this.getModelCoordinates=function(a,A,b){var m={};m.iRow=a;m.iCol=A;var C=c.getColumnHeaderArea().getRowCnt();var r=c.getRowHeaderArea().getColCnt();if(b===R.TYPE_DATA_AREA){m.iRow+=C;m.iCol+=r;}else if(b===R.TYPE_COLUMN_HEADER_AREA){m.iCol+=r;}else if(b===R.TYPE_ROW_HEADER_AREA){m.iRow+=C;}return m;};this.selectTextInInputField=function(i,S,a){if(S===-1&&a===-1){i.select();}else{var d=i[0];if(c.isIE8Mode()){if(d.createTextRange!=="undefined"){var r=d.createTextRange();r.collapse(true);r.moveEnd("character",a+1);r.moveStart("character",S);r.select();}}else if(d.selectionStart!=="undefined"){d.selectionStart=S;d.selectionEnd=a;}}};this.getSelectionParams=function(d){var S=-1;var e=-1;if(c.isIE8Mode()){if(document.selection!=="undefined"&&document.selection.type==="Text"){var r=document.selection.createRange();if(r&&r.text.length>0){var b=document.body.createTextRange();b.moveToElementText(d);b.setEndPoint("EndToStart",r);S=b.text.length;e=S+r.text.length-1;}}}else if(window.getSelection){var a=window.getSelection().toString();if(a&&a.length>0){S=window.getSelection().anchorOffset;e=window.getSelection().focusOffset;}}return{iSelectionStartPos:S,iSelectionEndPos:e};};this.sendClientScrollPosUpdate=function(C,h,i,v,I){var o=c.getRenderEngine().getCrossRequestManager();if(o){if(I===true){o.setHeaderScrollData({"iHPos":C});}else{o.setScrollData(C,h,i,v);}}t.sendScrollPosUpdate(C,h,i,v,I);};this.saveScrollPosData=function(a,b,d,e,i){if(!s){s={};}s.iHScrollPos=a;s.bHScrolledToEnd=b;s.iVScrollPos=d;s.bVScrolledToEnd=e;s.bIsHeaderData=i;};this.compareScrollPosData=function(a,b,d,e,i){if(s){if(s.iHScrollPos===a&&s.iVScrollPos===d&&s.bHScrolledToEnd===b&&s.bVScrolledToEnd===e&&s.bIsHeaderData===i){return true;}}return false;};this.sendScrollPosUpdate=function(a,b,d,e,i){b=b||false;e=e||false;i=i||false;var C=c.getScrollNotifyCommand();if(C&&!this.compareScrollPosData(a,b,d,e,i)){C=C.replace("__CLIENT_VPOS__",d);C=C.replace("__CLIENT_VPOS_END__",e?"X":" ");C=C.replace("__CLIENT_HPOS__",(i?"H"+a:a));C=C.replace("__CLIENT_HPOS_END__",b?"X":" ");this.saveScrollPosData(a,b,d,e,i);t.executeCommandAction(C);}};this.executeCommandAction=function(C,i,I){if(c.getPropertyBag().isBookmarkProcessing()&&!I){return;}if(i===true){if(c.isQueueHeaderWidthRequest()===true){Q=C;return;}}var a;if(Q&&Q.length>0){a=new Function(Q);a();c.setQueueHeaderWidthRequest(false);Q=null;}a=new Function(C);a();};this.translateCellCoordinatesForBackend=function(C,d){var h=c.getHeaderInfo();var a=C.getArea();var o={"row":C.getRow(),"col":C.getCol(),"axisName":a.getAxisName()};var r=0;if(c.getNewLinesPos()==="TOP"){r=c.getNewLinesCnt();}if(a.isRowHeaderArea()){if(!d||d&&d.length===0){d=h.getDimensionNameByCol(C.getCol());}if(d){o.col=h.getAbsoluteColIndexForDimension(d);}o.row=o.row-r;}else if(a.isColHeaderArea()){if(!d||d&&d.length===0){d=h.getDimensionNameByRow(C.getRow()-r);}if(d){o.row=h.getAbsoluteRowIndexForDimension(d);}}return o;};this.getCellIdFromContenDivId=function(I){var i=I.indexOf("_contentDiv");if(i>-1){I=I.slice(0,i);}else{i=I.indexOf("_textContentDiv");if(i>-1){I=I.slice(0,i);}}return I;};this.isMsIE=function(){var r=q.browser.msie||false;var m=window.navigator.userAgent.match(/Trident\/7\./);r=r||(m?true:false);return r;};this.isMozilla=function(){var r=q.browser.mozilla||false;var m=window.navigator.userAgent.match(/Trident\/7\./);r=r&&(m?false:true);return r;};this.translateScrollLeft=function(d,S){var a=S;if(c.getPropertyBag().isRtl()){if(q.browser.webkit){a=d.scrollWidth-d.clientWidth-S;}else if(this.isMozilla()){a=-S;}}return a;};this.getRtlAwareBoundingClientRect=function(d){var r=d.getBoundingClientRect();r.begin=r.left;r.end=r.right;if(c.getPropertyBag().isRtl()){r.begin=q(window).width()-r.right;r.end=q(window).width()-r.left;}return r;};};sap.zen.crosstab.utils.Utils.isCozyMode=function(){var i=false;if(sap.zen.crosstab.utils.Utils.isDispatcherAvailable()===true){i=sap.zen.Dispatcher.instance.isMainMode()&&!sap.zen.Dispatcher.instance.isCompactMode();}return i;};sap.zen.crosstab.utils.Utils.isMainMode=function(){return true;};sap.zen.crosstab.utils.Utils.unEscapeDisplayString=function(h){var u=h.replace(/<br\/>/g,"\r\n");u=u.replace(/&nbsp;/g,"&#x20;");u=q("<div></div>").html(u).text();return u;};sap.zen.crosstab.utils.Utils.prepareStringForRendering=function(t){var p=t.replace(/(\r\n)|(\n\r)|\r|\n/g,"<br/>");var P=p.replace(/(&#xd;&#xa;)|(&#xa;&#xd;)|&#xd;|&#xa;/g,"<br/>");var n=sap.zen.crosstab.utils.Utils.getNumberOfLineBreaks(P);P=P.replace(/&#x20;/g,"&nbsp;");return{"text":P,"iNumberOfLineBreaks":n};};sap.zen.crosstab.utils.Utils.cancelEvent=function(e){if(e){if(e.preventDefault){e.preventDefault();}sap.zen.crosstab.utils.Utils.stopEventPropagation(e);}};sap.zen.crosstab.utils.Utils.stopEventPropagation=function(e){if(e){if(e.stopPropagation){e.stopPropagation();}if(e.cancelBubble){e.cancelBubble=true;}}};sap.zen.crosstab.utils.Utils.hasEntries=function(a){var h=false;if(a){for(var k in a){if(Object.prototype.hasOwnProperty.call(a,k)){h=true;break;}}}return h;};sap.zen.crosstab.utils.Utils.padWithZeroes=function(n,l){var s=n.toString();if(s.length<l){s=("0000000000"+s).slice(-l);}return s;};sap.zen.crosstab.utils.Utils.selectTextInElement=function(d){var r;var s;if(d.innerHTML){if(document.createRange&&window.getSelection){r=document.createRange();s=window.getSelection();try{s.removeAllRanges();}catch(e){}try{r.selectNodeContents(d);s.addRange(r);}catch(e){r.selectNode(d);s.addRange(r);}}else if(document.body.createTextRange){r=document.body.createTextRange();r.moveToElementText(d);r.select();}}};sap.zen.crosstab.utils.Utils.getWidthFromStyle=function(j){var i=0;var s="";var S=null;var w=null;var a=j.attr("style");if(a){var b=a.split(";");if(b){for(i=0;i<b.length;i++){s=b[i];if(s){S=s.split(":");if(S[0]==="width"){w=S[1];break;}}}}}if(w){w=q.trim(w);}return w;};sap.zen.crosstab.utils.Utils.sign=function(x){return x>0?1:x<0?-1:0;};sap.zen.crosstab.utils.Utils.getCssIntProperty=function(j,c){var C=0;if(j&&j.length>0){C=parseInt(j.css(c),10);if(isNaN(C)){C=0;}}return C;};sap.zen.crosstab.utils.Utils.getWidthOfMarginBorderPadding=function(j){var m=sap.zen.crosstab.utils.Utils.getCssIntProperty(j,"margin-left")+sap.zen.crosstab.utils.Utils.getCssIntProperty(j,"margin-right");var b=sap.zen.crosstab.utils.Utils.getCssIntProperty(j,"border-left")+sap.zen.crosstab.utils.Utils.getCssIntProperty(j,"border-right");var p=sap.zen.crosstab.utils.Utils.getCssIntProperty(j,"padding-left")+sap.zen.crosstab.utils.Utils.getCssIntProperty(j,"padding-right");var t=m+b+p;return t;};sap.zen.crosstab.utils.Utils.getNumberOfLineBreaks=function(e){var c=0;if(e&&e.length>0){var r=/<br\/>/g;while(r.exec(e)!=null){c++;}}return c;};sap.zen.crosstab.utils.Utils.getSizeOf=function(o){var s=0;for(var k in o){if(Object.prototype.hasOwnProperty.call(o,k)){s++;}}return s;};sap.zen.crosstab.utils.Utils.isDispatcherAvailable=function(){var d=false;if(typeof sap!=="undefined"&&sap){if(typeof sap.zen!=="undefined"&&sap.zen){if(typeof sap.zen.Dispatcher!=="undefined"&&sap.zen.Dispatcher){if(typeof sap.zen.Dispatcher.instance!=="undefined"&&sap.zen.Dispatcher.instance){d=true;}}}}return d;};sap.zen.crosstab.utils.Utils.swapText=function(t,s){var T;var i;var n="";if(t.indexOf(s)>-1){T=t.split(s);for(i=T.length-1;i>=0;i--){n=n+T[i];if(i>=1){n=n+s;}}}else{n=t;}return n;};sap.zen.crosstab.utils.Utils.swapPivotKeyText=function(t){var n;n=sap.zen.crosstab.utils.Utils.swapText(t,"&nbsp;&#x7c;&nbsp;");return n;};return sap.zen.crosstab.utils.Utils;});
