/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/formatters/ValueFormatter","sap/fe/core/templating/UIFormatters","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/helpers/BindingExpression","sap/fe/core/templating/PropertyHelper","sap/ui/model/odata/v4/AnnotationHelper"],function(v,U,D,B,P,A){"use strict";var _={};var g=P.getAssociatedUnitPropertyPath;var u=B.unresolveableExpression;var b=B.bindingExpression;var c=B.compileBinding;var f=B.formatResult;var a=B.annotationExpression;var d=D.getPathRelativeLocation;var e=D.enhanceDataModelPath;var h=U.getBindingWithUnitOrCurrency;var E=U.EDM_TYPE_MAPPING;var j=U.getDisplayMode;function o(i,C){var F=Object.keys(i);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(i);if(C){G=G.filter(function(H){return Object.getOwnPropertyDescriptor(i,H).enumerable;});}F.push.apply(F,G);}return F;}function k(C){for(var i=1;i<arguments.length;i++){var F=arguments[i]!=null?arguments[i]:{};if(i%2){o(Object(F),true).forEach(function(G){l(C,G,F[G]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(C,Object.getOwnPropertyDescriptors(F));}else{o(Object(F)).forEach(function(G){Object.defineProperty(C,G,Object.getOwnPropertyDescriptor(F,G));});}}return C;}function l(i,C,F){if(C in i){Object.defineProperty(i,C,{value:F,enumerable:true,configurable:true,writable:true});}else{i[C]=F;}return i;}var m=function(i){return i!==null&&i!==void 0&&i.TargetValue?a(i.TargetValue):u;};var r=sap.ui.getCore().getLibraryResourceBundle("sap.fe.macros");var p=function(i){var C;var F=(i===null||i===void 0?void 0:(C=i.targetObject)===null||C===void 0?void 0:C.Value)||"";var G=d(i.contextLocation,i.navigationProperties).map(function(O){return O.name;});var H=a(F,G);var T=m(i.targetObject);if(H&&T){var I=F!==null&&F!==void 0&&F.$target?g(F===null||F===void 0?void 0:F.$target):undefined;if(!I){var J,K,L,M;var N=(J=F.$target)===null||J===void 0?void 0:(K=J.annotations)===null||K===void 0?void 0:(L=K.Measures)===null||L===void 0?void 0:(M=L.Unit)===null||M===void 0?void 0:M.charAt(0);if(N==="%"){return c(H)+" %";}else{return r.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[c(H),c(T)]);}}else{return r.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[c(H),c(T)])+" "+c(b(I));}}return undefined;};_.progressIndicatorDisplayValue=p;var n=function(C,S){if(S){return q(A.value(S,{context:C}));}};var q=function(S){if(S){var i=S>1?r.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):r.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL");return r.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE",[String(S),i]);}};var s=function(C,i){if(i&&i.SampleSize){return n(C,i.SampleSize);}else if(i&&i.Description){var M=A.value(i.Description,{context:C});return"${path:"+M+"}";}};s.requiresIContext=true;_.getHeaderRatingIndicatorText=s;var t=function(i){var C,F,G;if(i!==null&&i!==void 0&&(C=i.$target)!==null&&C!==void 0&&(F=C.annotations)!==null&&F!==void 0&&(G=F.Common)!==null&&G!==void 0&&G.Text){var H,I,J;var T=a(i===null||i===void 0?void 0:(H=i.$target)===null||H===void 0?void 0:(I=H.annotations)===null||I===void 0?void 0:(J=I.Common)===null||J===void 0?void 0:J.Text);T.parameters={"$$noPatch":true};return T;}return undefined;};var w=function(i,C,N){if(!i.constraints){i.constraints={};}i.constraints=Object.assign(i.constraints,{precision:C.$target.precision,scale:N?N:C.$target.scale});return i;};var x=function(i,C,F,N){var G;var H;var I=(C===null||C===void 0?void 0:(G=C.path)===null||G===void 0?void 0:G.indexOf("/"))===-1?d(i.contextLocation,i.navigationProperties).map(function(K){return K.name;}):[];H=a(C,I);if(F){var J;H.type=(J=E[F])===null||J===void 0?void 0:J.type;}switch(F){case"Edm.Decimal":H=w(H,C,N);break;case"Edm.String":if(!H.formatOptions){H.formatOptions={};}if(!H.constraints){H.constraints={};}H.formatOptions.parseKeepsEmptyString=true;break;default:}return H;};var y=function(i,C,F,M){var G,H,I,J,K,L,N;var O=i.targetObject;var Q=(O===null||O===void 0?void 0:O.Value)||"";var R=C.formatOptions;var S=t(Q);var T=Q===null||Q===void 0?void 0:(G=Q.$target)===null||G===void 0?void 0:G.type;var V;if(T==="Edm.Decimal"&&O.ValueFormat){if(O.ValueFormat.NumberOfFractionalDigits){V=O.ValueFormat.NumberOfFractionalDigits;}}var W=e(i,Q.path);var X=x(W,Q,T,V);var Y=S?R.displayMode||j(Q,W):"Value";var Z;switch(Y){case"Description":Z=S;break;case"ValueDescription":Z=f([X,S],v.formatWithBrackets);break;case"DescriptionValue":Z=f([S,X],v.formatWithBrackets);break;default:if((H=W.targetObject)!==null&&H!==void 0&&(I=H.annotations)!==null&&I!==void 0&&(J=I.Measures)!==null&&J!==void 0&&J.Unit||(K=W.targetObject)!==null&&K!==void 0&&(L=K.annotations)!==null&&L!==void 0&&(N=L.Measures)!==null&&N!==void 0&&N.ISOCurrency){Z=h(W,X);if(Z&&M&&(F===null||F===void 0?void 0:F.measureDisplayMode)!=="ReadOnly"){Z.formatOptions=k(k({},Z.formatOptions),{},{showMeasure:false});}}else{Z=X;}}return c(Z);};_.buildFieldBindingExpression=y;var z=function(i){var C;var F=(i===null||i===void 0?void 0:(C=i.targetObject)===null||C===void 0?void 0:C.Value)||"";var G=d(i.contextLocation,i.navigationProperties).map(function(L){return L.name;});var H=a(F,G);var T=m(i.targetObject);var I=F!==null&&F!==void 0&&F.$target?g(F.$target):undefined;var J=I?b(I):"";var K=f([H,T,J],v.computePercentage);return c(K);};_.buildExpressionForProgressIndicatorPercentValue=z;return _;},false);
