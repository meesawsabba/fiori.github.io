/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/XMLTemplateProcessor","sap/ui/model/json/JSONModel","sap/ui/core/util/XMLPreprocessor","sap/ui/core/Fragment","sap/ui/mdc/field/InParameter","sap/ui/mdc/field/OutParameter","sap/base/Log","sap/ui/dom/units/Rem","sap/fe/core/BusyLocker","sap/fe/core/actions/messageHandling","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType","sap/fe/core/helpers/ModelHelper","sap/fe/core/CommonUtils","sap/ui/mdc/odata/v4/ODataMetaModelUtil"],function(q,X,J,a,F,I,O,L,R,B,m,b,c,d,M,C,e){"use strict";var w={};var f=[];var s=[];function _(v){return v.Parameters.some(function(P){return(P["@com.sap.vocabularies.UI.v1.Importance"]&&P["@com.sap.vocabularies.UI.v1.Importance"].$EnumMember==="com.sap.vocabularies.UI.v1.ImportanceType/High");});}function g(v){var i=v.valueListInfo.$model.getMetaModel().getObject("/"+v.valueListInfo.CollectionPath+"@")||{},S=i["@Org.OData.Capabilities.V1.SearchRestrictions"]&&i["@Org.OData.Capabilities.V1.SearchRestrictions"].Searchable;return S===undefined?true:S;}function h(v){return f.find(function(i){return i.sVHId===v;});}function j(v){return s.find(function(i){return i.sVHId===v;});}function k(v,i,r){var t=v.$model.getMetaModel(),P,D,u,x,y;var z=t.getObject("/"+v.CollectionPath+"/"+i.ValueListProperty+"@com.sap.vocabularies.UI.v1.Hidden")===true?false:true;var A=z&&!r&&_(v)&&i["@com.sap.vocabularies.UI.v1.Importance"]&&i["@com.sap.vocabularies.UI.v1.Importance"].$EnumMember==="com.sap.vocabularies.UI.v1.ImportanceType/High"?true:false;if(z){x=v.Parameters.filter(function(E){if(E.ValueListProperty!==i.ValueListProperty&&i.$Type!=="com.sap.vocabularies.Common.v1.ValueListParameterInOut"){P=t.getObject("/"+v.CollectionPath+"/"+E.ValueListProperty+"@");D=P&&P["@com.sap.vocabularies.Common.v1.Text"]&&P["@com.sap.vocabularies.Common.v1.Text"].$Path;}return D&&D===i.ValueListProperty;});x.forEach(function(E){if(E.ValueListProperty!==i.ValueListProperty){P=t.getObject("/"+v.CollectionPath+"/"+E.ValueListProperty+"@");if(r){if(P["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]&&P["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"].$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"){y=undefined;}else{y=t.getObject("/"+v.CollectionPath+"/"+E.ValueListProperty+"@com.sap.vocabularies.UI.v1.Hidden")!==true&&"{_VHUI>/hideColumn}";}}else{u=P["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]&&P["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"].$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly";if(u){y=t.getObject("/"+v.CollectionPath+"/"+E.ValueListProperty+"@com.sap.vocabularies.UI.v1.Hidden")!==true&&"{_VHUI>/hideColumn}";}if(!E["@com.sap.vocabularies.UI.v1.Importance"]){if(!u){y=undefined;}else{y=A?"{_VHUI>/showColumnInTypeAhead}":"{_VHUI>/hideColumn}";}}}}});return y;}}function l(v){var S,i=v.$model.getMetaModel();var E=i.getObject("/"+v.CollectionPath+"@")||{};var r=E["@Org.OData.Capabilities.V1.SortRestrictions"]||{};var t=e.getSortRestrictionsInfo(r);v.Parameters.find(function(u){if(i.getObject("/"+v.CollectionPath+"/"+u.ValueListProperty+"@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement/$EnumMember")==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){S=i.getObject("/"+v.CollectionPath+"/"+u.ValueListProperty+"@com.sap.vocabularies.Common.v1.Text/$Path");}else{S=u.ValueListProperty;}return((u.$Type=="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||u.$Type=="com.sap.vocabularies.Common.v1.ValueListParameterOut"||u.$Type=="com.sap.vocabularies.Common.v1.ValueListParameterDisplayOnly")&&!(i.getObject("/"+v.CollectionPath+"/"+u.ValueListProperty+"@com.sap.vocabularies.UI.v1.Hidden")===true));});if(S&&(!t[S]||t[S].sortable)){return S;}else{return undefined;}}function n(i){var v=i.getModel("viewData");if(v){var D=v.getData();if(D){var r=D.columns;if(r){return r.reduce(function(Q,P){if(P.path&&P.path.indexOf("/")===-1){Q=Q?Q+","+P.path:P.path;}return Q;},undefined);}}}return undefined;}function o(i,E,P){var r=P.split("/"),t,u="";while(r.length){var v=r.shift();t=t?t+"/"+v:v;var x=i.getObject(E+"/"+t);if(x&&x.$kind==="NavigationProperty"&&x.$isCollection){v+="*";}u=u?u+"/"+v:v;}return u;}function p(i,E){var r=[],S=i.getObject(E+"/@com.sap.vocabularies.UI.v1.SelectionFields");if(S){S.forEach(function(t){var u=E+"/"+t.$PropertyPath,v=o(i,E,t.$PropertyPath),P=i.getObject(u+"@"),x={path:v,label:P["@com.sap.vocabularies.Common.v1.Label"]||u,sortable:true,filterable:C.isPropertyFilterable(i,E,t.$PropertyPath,false),$Type:i.getObject(u).$Type};r.push(x);});}return r;}var V={initializeCachedValueHelp:function(){f.forEach(function(v){if(!v.oVHFilterBar.isDestroyed()){v.oVHFilterBar.destroy();}if(!v.oVHDialogTable.isDestroyed()){v.oVHDialogTable.destroy();}});f=[];s=[];},getColumnVisibility:function(v,i,S){var r=S&&!!S.valueHelpWithFixedValues,t=k(v,i,r);if(t){return t;}if(r||!_(v)){return undefined;}else if(i&&i["@com.sap.vocabularies.UI.v1.Importance"]&&i["@com.sap.vocabularies.UI.v1.Importance"].$EnumMember==="com.sap.vocabularies.UI.v1.ImportanceType/High"){return undefined;}else{return"{_VHUI>/showAllColumns}";}},getDialogTableColumnVisibility:function(v,i){var r=v.$model.getMetaModel(),P,D,t,u=false;var H=r.getObject("/"+v.CollectionPath+"/"+i.ValueListProperty+"@com.sap.vocabularies.UI.v1.Hidden")===true&&true;if(!H){t=v.Parameters.filter(function(x){if(x.ValueListProperty!==i.ValueListProperty&&i.$Type!=="com.sap.vocabularies.Common.v1.ValueListParameterInOut"){P=r.getObject("/"+v.CollectionPath+"/"+x.ValueListProperty+"@");D=P&&P["@com.sap.vocabularies.Common.v1.Text"]&&P["@com.sap.vocabularies.Common.v1.Text"].$Path;}return D&&D===i.ValueListProperty;});t.forEach(function(x){if(x.ValueListProperty!==i.ValueListProperty){P=r.getObject("/"+v.CollectionPath+"/"+x.ValueListProperty+"@");if(P["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]&&P["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"].$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){u=r.getObject("/"+v.CollectionPath+"/"+x.ValueListProperty+"@com.sap.vocabularies.UI.v1.Hidden")!==true&&true;}}});}return H?false:!u;},getValueHelpTableSortConditions:function(v,S){var P=v.PresentationVariantQualifier===""?"":"#"+v.PresentationVariantQualifier,i="/"+v.CollectionPath+"/@com.sap.vocabularies.UI.v1.PresentationVariant"+P;var r=v.$model.getMetaModel().getObject(i);if(r&&r.SortOrder){var t={sorters:[]};if(S){r.SortOrder.forEach(function(x){var u={};u.path=x.Property.$PropertyPath;if(!!x.Descending){u.descending=true;}else{u.ascending=true;}t.sorters.push(u);});return"sorter: "+JSON.stringify(t.sorters);}else{r.SortOrder.forEach(function(x){var u={};u.name=x.Property.$PropertyPath;if(!!x.Descending){u.descending=true;}else{u.ascending=true;}t.sorters.push(u);});return JSON.stringify(t);}}else if(!S){var u={},t={sorters:[]};u.name=l(v);if(u.name!==undefined){u.ascending=true;t.sorters.push(u);}return JSON.stringify(t);}return undefined;},hasImportance:function(v){return _(v.getObject())?"Importance/High":"None";},getMinScreenWidth:function(v){return _(v)?"{= ${_VHUI>/minScreenWidth}}":"416px";},getTableItemsParameters:function(v,r,S,i){var t,P="";var u=v.Parameters.some(function(D){return S||D.$Type==="com.sap.vocabularies.Common.v1.ValueListParameterIn";});if(r){P=", parameters: {$$groupId: '"+r+"'";}var x=n(this);if(x){if(P.length>0){P=P+", '"+x+"'";}else{P=", parameters: {$select: '"+x+"'";}}if(P.length>0){P=P+" }";}var y=V.getValueHelpTableSortConditions(v,S);var z=i?"":", length: 10";if(y){return("{path: '/"+v.CollectionPath+"'"+P+", suspended : "+u+z+", "+y+"}");}else{t=l(v);var A="{path: '/"+v.CollectionPath+"'"+P+", suspended : "+u+z;if(!S&&t!==undefined){A+=", sorter: {path: '"+t+"', ascending: true}";}A+="}";return A;}},getTableDelegate:function(v){return("{name: 'sap/fe/macros/internal/valuehelp/TableDelegate', payload: {collectionName: '"+v.CollectionPath+"'}}");},getPropertyPath:function(P){return!P.UnboundAction?P.EntityTypePath+"/"+P.Action+"/"+P.Property:"/"+P.Action.substring(P.Action.lastIndexOf(".")+1)+"/"+P.Property;},getWaitForPromise:function(){return w;},getValueListCollectionEntitySet:function(v){var i=v.getObject();return i.$model.getMetaModel().createBindingContext("/"+i.CollectionPath);},getValueListProperty:function(P){var v=P.getModel();var i=v.getObject("/");return i.$model.getMetaModel().createBindingContext("/"+i.CollectionPath+"/"+P.getObject());},getValueListInfo:function(r,t,u,v,P){var K,D,x=t.getObject(u+"@sapui.name"),y,z=[],A=[],E="";return t.requestValueListInfo(u,true,r.getBindingContext()).then(function(G){var H=r.getInParameters().length+r.getOutParameters().length===0,N=r.getModel("_VHUI"),Q=N.getProperty("/qualifierForValidation"),S=N.getProperty("/isSuggestion"),T=N.getProperty("/hasValueListRelevantQualifiers"),U=r.getAggregation("collectiveSearchItems"),W=Object.keys(G),Y=W.indexOf(""),Z=W[0],$,a1=r.getModel().getMetaModel().getObject(u+"@")["@com.sap.vocabularies.Common.v1.ValueListWithFixedValues"];if(Y&&Y>0){W.unshift(W[Y]);W.splice(Y+1,1);}if(Z===undefined){return r.getModel("_VHUI").setProperty("/noValidValueHelp",true);}if(T||W.length>1||U.length>1){if(a1){$=G[""].$qualifier===""?r.getId()+"::non-qualifier":r.getId()+"::qualifier::"+G[""].$qualifier;N.setProperty("/valueHelpId",$);G=G[""];}else if(S&&W.indexOf(Q)>-1){$=Q===""?r.getId()+"::non-qualifier":r.getId()+"::qualifier::"+Q;N.setProperty("/valueHelpId",$);N.setProperty("/collectiveSearchKey",Q);G=G[Q];r.setProperty("validateInput",true);}else{U.forEach(function(k1){if(!W.includes(k1.getKey())){r.removeAggregation("collectiveSearchItems",k1);}});if(W.length===1){r.removeAllAggregation("collectiveSearchItems");P.collectiveSearchKey=undefined;}else{W.forEach(function(k1){if(U.filter(function(l1){return l1.getKey()===k1;}).length===0){r.addAggregation("collectiveSearchItems",new sap.ui.core.Item({key:k1,text:G[k1].Label,enabled:true}));}});}if(P&&P.collectiveSearchKey!==undefined){Z=P.collectiveSearchKey;}else if(P&&P.collectiveSearchKey===undefined){Z=W[0];P.collectiveSearchKey=W[0];}$=Z===""?r.getId()+"::non-qualifier":r.getId()+"::qualifier::"+Z;r.getModel("_VHUI").setProperty("/valueHelpId",$);r.getModel("_VHUI").setProperty("/collectiveSearchKey",Z);G=G[Z];if(!r.getParent().isA("sap.ui.mdc.FilterBar")&&S&&Q!==Z){r.setProperty("validateInput",false);}}}else{G=G[Z];}var b1="";if(r.data("useMultiValueField")==="true"&&r.getBindingContext()&&r.getBindingContext().getPath()){var c1=r.getBindingContext().getPath().split("/");var d1=u.split("/");if(d1.length-c1.length>1){var e1=[];for(var i=c1.length;i<d1.length-1;i++){e1.push(d1[i]);}b1=e1.join("/")+"/";}}var t=G.$model.getMetaModel(),f1="/"+G.CollectionPath,g1=p(t,f1),h1;if(r.getParent().isA("sap.ui.mdc.filterbar.vh.FilterBar")){var i1=r.getParent();var j1=i1.getFilterItems();h1=j1.map(function(k1){return k1.getFieldPath();});}G.Parameters.forEach(function(k1){y="/"+G.CollectionPath+"/"+k1.ValueListProperty;var l1=G.$model.getMetaModel().getObject(y),m1=G.$model.getMetaModel().getObject(y+"@")||{};if(l1){if(!K&&k1.$Type.indexOf("Out")>48&&k1.LocalDataProperty.$PropertyPath===x){E=y;K=k1.ValueListProperty;D=m1["@com.sap.vocabularies.Common.v1.Text"]&&m1["@com.sap.vocabularies.Common.v1.Text"].$Path;}if(H&&k1.$Type!=="com.sap.vocabularies.Common.v1.ValueListParameterDisplayOnly"&&k1.$Type!=="com.sap.vocabularies.Common.v1.ValueListParameterConstant"&&k1.LocalDataProperty&&k1.LocalDataProperty.$PropertyPath!==x){var n1="";if(v&&v.length>0){if(r.getParent().isA("sap.ui.mdc.Table")&&r.getBindingContext()&&k1.$Type==="com.sap.vocabularies.Common.v1.ValueListParameterIn"){var o1=k1.LocalDataProperty.$PropertyPath.split("/");if(o1.length>1){var p1=o1[0];var q1=r.getModel().getMetaModel().getMetaContext(r.getBindingContext().getPath());var r1=r.getParent().getRowBinding().getPath();if(q1.getObject(r1+"/$Partner")===p1){n1="{"+k1.LocalDataProperty.$PropertyPath.replace(p1+"/","")+"}";}}}if(!n1){n1="{"+v+">/conditions/"+k1.LocalDataProperty.$PropertyPath+"}";}}else{n1="{"+b1+k1.LocalDataProperty.$PropertyPath+"}";}if(k1.$Type.indexOf("Out")>48){if(!h1||h1.indexOf(k1.LocalDataProperty.$PropertyPath)>-1){A.push(new O({value:n1,helpPath:k1.ValueListProperty}));}}if(k1.$Type.indexOf("In")>48){z.push(new I({value:n1,helpPath:k1.ValueListProperty,initialValueFilterEmpty:k1.InitialValueIsSignificant}));}}if(k1.$Type==="com.sap.vocabularies.Common.v1.ValueListParameterConstant"){z.push(new I({value:k1.Constant,helpPath:k1.ValueListProperty}));}var s1=k1.ValueListProperty,t1=m1["@com.sap.vocabularies.Common.v1.Label"]||s1,u1=l1.$Type;if(m1["@com.sap.vocabularies.Common.v1.Text"]&&m1["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]&&m1["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"].$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){s1=m1["@com.sap.vocabularies.Common.v1.Text"].$Path;var v1="/"+G.CollectionPath+"/"+s1;u1=G.$model.getMetaModel().getObject(v1).$Type;}var w1=g1.findIndex(function(y1){return y1.path===s1;})===-1;if(w1){var x1={path:s1,label:t1,sortable:true,filterable:!m1["@com.sap.vocabularies.UI.v1.HiddenFilter"],$Type:u1};g1.push(x1);}}});return{keyValue:K,descriptionValue:D,fieldPropertyPath:E,inParameters:z,outParameters:A,valueListInfo:G,columnDefs:g1};}).catch(function(i){var G=i.status&&i.status===404?"Metadata not found ("+i.status+") for value help of property "+u:i.message;L.error(G);r.destroyContent();});},_templateFragment:function(i,v,S,r){var t=X.loadTemplate(i,"fragment"),u=v.valueListInfo,x=new J(u),y=u.$model.getMetaModel(),z=new J({converterType:"ListReport",columns:v.columnDefs||null});return Promise.resolve(a.process(t,{name:i},{bindingContexts:{valueList:x.createBindingContext("/"),contextPath:y.createBindingContext("/"+u.CollectionPath+"/"),source:S.createBindingContext("/")},models:{valueList:x,contextPath:y,source:S,metaModel:y,viewData:z}})).then(function(t){var A={path:r,fragmentName:i,fragment:t};if(L.getLevel()===L.Level.DEBUG){V.ALLFRAGMENTS=V.ALLFRAGMENTS||[];V.ALLFRAGMENTS.push(A);}if(V.logFragment){setTimeout(function(){V.logFragment(A);},0);}return F.load({definition:t});});},createValueHelpDialog:function(i,r,t,u,v,S){var x=r.getMetadata().getName(),W=r.getDialogContent&&r.getDialogContent(),y=W&&W.getId(),z=r.getModel("_VHUI").getProperty("/valueHelpId"),A=this;if((!t||z!==undefined)&&x.indexOf("FieldValueHelp")>-1){r.setTitle(v.valueListInfo.Label);r.setKeyPath(v.keyValue);r.setDescriptionPath(v.descriptionValue);r.setFilterFields(g(v)?"$search":"");}var D=new J({id:z||r.getId(),groupId:r.data("requestGroupId")||undefined,bSuggestion:S,valueHelpWithFixedValues:r.getModel().getMetaModel().getObject(i+"@")["@com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]});t=t||V._templateFragment("sap.fe.macros.internal.valuehelp.ValueListDialogTable",v,D,i);u=u||V._templateFragment("sap.fe.macros.internal.valuehelp.ValueListFilterBar",v,D,i);return Promise.all([t,u]).then(function(E){var z=r.getModel("_VHUI").getProperty("/valueHelpId"),T,t=E[0],u=E[1];if(t){t.setModel(v.valueListInfo.$model);L.info("Value List - Dialog Table - XML content created ["+i+"]",t.getMetadata().getName(),"MDC Templating");}if(u){u.setModel(v.valueListInfo.$model);L.info("Value List- Filterbar - XML content created ["+i+"]",u.getMetadata().getName(),"MDC Templating");}if((u&&u!==r.getFilterBar())||(u&&z!==undefined)){r.setFilterBar(u);}else{r.addDependent(u);}if(t!==W.getTable()||z!==undefined){W.setTable(t);if(u){t.setFilter(u.getId());}t.initialized();delete w[y];}T=A.getTableWidth(t,A._getWidthInRem(r._getField()));r.getModel("_VHUI").setProperty("/tableWidth",T);t.setWidth("100%");if(z!==undefined){var G=h(z);if(!G){f.push({sVHId:z,oVHDialogTable:t,oVHFilterBar:u});}else if(G&&G.oVHFilterBar===false){f[f.indexOf(G)].oVHFilterBar=u;}}});},createValueHelpSuggest:function(i,r,t,v,S){var W=r.getSuggestContent&&r.getSuggestContent(),u=W&&W.getId(),x=r.getMetadata().getName(),y=r.getModel("_VHUI").getProperty("/valueHelpId"),z=this;if((!t||y!==undefined)&&x.indexOf("FieldValueHelp")>-1){r.setTitle(v.valueListInfo.Label);r.setKeyPath(v.keyValue);r.setDescriptionPath(v.descriptionValue);r.setFilterFields(g(v)?"$search":"");}var A=new J({id:y||r.getId(),groupId:r.data("requestGroupId")||undefined,bSuggestion:S,valueHelpWithFixedValues:r.getModel().getMetaModel().getObject(i+"@")["@com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]});t=t||V._templateFragment("sap.fe.macros.internal.valuehelp.ValueListTable",v,A,i);return Promise.all([t]).then(function(D){var T,t=D[0];if(t){t.setModel(v.valueListInfo.$model);var E=t.getBinding("items");E.attachEventOnce("dataRequested",function(){B.lock(t);});E.attachEvent("dataReceived",function(N){if(B.isLocked(t)){B.unlock(t);}if(N.getParameter("error")){setTimeout(m.showUnboundMessages,0);}});if(M.isDraftSupported(E.getModel().getMetaModel(),E.getPath())){E.filter(new b("IsActiveEntity",c.EQ,true),d.Control);}L.info("Value List- suggest Table XML content created ["+i+"]",t.getMetadata().getName(),"MDC Templating");}if(t!==W.getTable()||y!==undefined){W.setTable(t);t.attachEventOnce("updateFinished",function(){W.invalidate(t);});delete w[u];}var G=r.data("sourcePath")!==r.data("originalPropertyPath");var H=r._getField();if(H.isA("sap.ui.mdc.FilterField")||H.isA("sap.ui.mdc.Field")){T=z.getTableWidth(t,z._getWidthInRem(H,G));r.getModel("_VHUI").setProperty("/tableWidth",T);t.setWidth(T);}else{r.getModel("_VHUI").setProperty("/tableWidth",undefined);}if(y!==undefined){var K=j(y);if(!K){s.push({sVHId:y,oVHSuggestTable:t});}}});},_getWidthInRem:function(i,r){var $=i.$().width();if(r&&$){$=0.3*$;}var W=$?parseFloat(R.fromPx($)):0;return isNaN(W)?0:W;},getTableWidth:function(t,i){var W,r=t.getColumns(),v=(r&&r.filter(function(u){return u&&u.getVisible&&u.getVisible();}))||[],S=v.reduce(function(u,x){W=x.getWidth();if(W&&W.endsWith("px")){W=R.fromPx(W);}var y=parseFloat(W);return u+(isNaN(y)?9:y);},v.length);return Math.max(S,i)+"em";},showValueListInfo:function(i,r,S,t,P){var u=r.getModel(),v=u.getMetaModel(),W=r.getDialogContent&&r.getDialogContent(),x=r.getSuggestContent&&r.getSuggestContent(),y,D,z,A,E,G=r.getProperty("noDialog"),H,Q,K;if(S){y=x&&x.getId();A=x&&x.getTable&&x.getTable();E=A;}else{D=W&&W.getTable&&W.getTable();z=r&&r.getFilterBar&&r.getFilterBar();y=W&&W.getId();E=D&&z;}H=r.getModel("_VHUI");if(!H){H=new J({});r.setModel(H,"_VHUI");H.setProperty("/hasValueListRelevantQualifiers",!!v.getObject(i+"@")["@com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"]);if(r.getProperty("validateInput")){Q=v.getObject(i+"@")["@com.sap.vocabularies.Common.v1.ValueListForValidation"];Q=Q&&Q.replace(/\s/g,"");H.setProperty("/qualifierForValidation",Q);}}H.setProperty("/isSuggestion",S);H.setProperty("/showAllColumns",G?true:!S);H.setProperty("/hideColumn",false);H.setProperty("/showColumnInTypeAhead",S);H.setProperty("/minScreenWidth",!S?"418px":undefined);K=r.getModel("_VHUI").getProperty("/valueHelpId");if(D){D.setWidth("100%");}if(A){var T=H.getProperty("/tableWidth");if(!T){var N=r.data("sourcePath")!==r.data("originalPropertyPath");T=this.getTableWidth(A,this._getWidthInRem(r._getField(),N));r.getModel("_VHUI").setProperty("/tableWidth",T);A.setWidth(T);}}if((K!==undefined&&r.getBindingContext())||(r.getModel("_VHUI").getProperty("/collectiveSearchKey")!==undefined&&r.getModel("_VHUI").getProperty("/collectiveSearchKey")!==P.collectiveSearchKey)){D=undefined;z=undefined;A=undefined;E=undefined;delete w[y];}if(!S&&!z&&r.getDependents().length>0){var U=r.getDependents()[0];if(U.isA("sap.ui.mdc.filterbar.vh.FilterBar")){z=U;}}if(w[y]||E){return w["promise"+y];}else{if((S&&!A)||(!S&&!D)){w[y]=true;}var Y=V.getValueListInfo(r,v,i,t,P).then(function(Z){var K=r.getModel("_VHUI").getProperty("/valueHelpId");if(r.getModel("_VHUI").getProperty("/noValidValueHelp")){L.error("Context dependent value help not found");return r.close();}var $=Z&&Z.inParameters,a1=Z&&Z.outParameters;if(r.getOutParameters().length!==a1.length){a1.forEach(function(d1){r.addOutParameter(d1);});}if(r.getInParameters().length!==$.length){$.forEach(function(d1){r.addInParameter(d1);});}if(S){var b1=j(K);var A=b1?b1.oVHSuggestTable:undefined;return(Z&&V.createValueHelpSuggest(i,r,A,Z,S));}else{var c1=h(K);if(c1){D=c1.oVHDialogTable;z=c1.oVHFilterBar;}return(Z&&V.createValueHelpDialog(i,r,D,z,Z,S));}}).catch(function(Z){var $=Z.status&&Z.status===404?"Metadata not found ("+Z.status+") for value help of property "+i:Z.message;L.error($);r.destroyContent();});w["promise"+y]=Y;return Y;}},setValueListFilterFields:function(i,r,S,t){var u=r.getModel(),v=u.getMetaModel();if(r.getBindingContext()&&r.getModel().getMetaModel().getObject(i+"@")["@com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"]){return;}return V.getValueListInfo(r,v,i,t).then(function(x){x&&r.setFilterFields(g(x)?"$search":"");});},getColumnWidth:function(D,v){if(v&&v.Parameters&&v.Parameters.length===1){return"auto";}switch(D){case"Edm.Stream":return"7em";case"Edm.Boolean":return"8em";case"Edm.Date":case"Edm.TimeOfDay":return"9em";case"Edm.DateTimeOffset":return"12em";default:return"auto";}},fetchValuesOnInitialLoad:function(v){if(v.FetchValues&&v.FetchValues==2){return false;}return true;},getOutParameterPaths:function(P){var i="";P.forEach(function(r){if(r.$Type.endsWith("Out")){i+="{"+r.ValueListProperty+"}";}});return i;}};return V;},true);
