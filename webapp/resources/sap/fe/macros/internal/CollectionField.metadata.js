/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/macros/MacroMetadata","sap/fe/core/converters/MetaModelConverter","sap/fe/core/templating/UIFormatters","sap/fe/core/converters/helpers/BindingHelper","sap/fe/macros/field/FieldTemplating","sap/fe/core/helpers/BindingExpression","sap/fe/core/templating/DataModelPathHelper"],function(M,a,U,B,F,b,D){"use strict";var c=b.compileBinding;var d=b.constant;var e=b.annotationExpression;var i=b.ifElse;var f=b.and;var g=F.getValueBinding;var h=F.getVisibleExpression;var j=B.UI;var k=U.getDisplayMode;var C=M.extend("sap.fe.macros.internal.CollectionField",{name:"CollectionField",namespace:"sap.fe.macros.internal",fragment:"sap.fe.macros.internal.CollectionField",metadata:{stereotype:"xmlmacro",properties:{idPrefix:{type:"string"},vhIdPrefix:{type:"string",defaultValue:"FieldValueHelp"},_vhFlexId:{type:"string",computed:true},metaPath:{type:"sap.ui.model.Context",required:true,$kind:"Property"},ariaLabelledBy:{type:"string"},formatOptions:{type:"object",properties:{}},contextPath:{type:"sap.ui.model.Context",required:true,$kind:["EntitySet","NavigationProperty"]}}},create:function(p){var o=a.getInvolvedDataModelObjects(p.metaPath,p.contextPath);var l=a.convertMetaModelContext(p.metaPath);var P=l.Value.$target;var E=l.Value.path;p.visible=h(o,p.formatOptions);if(E&&E.length>0){o=D.enhanceDataModelPath(o,E);}var I=D.isPathInsertable(o);var m=D.isPathDeletable(o);p.editMode=c(i(f(I,m,j.IsEditable),d("Editable"),d("Display")));p.displayMode=k(P,o);var n=C._getMultiInputSettings(o,p.formatOptions);p.text=n.text;p.collection=n.collection;p.key=n.key;return p;},_getMultiInputSettings:function(p,l){var _,m;var n="{path:'"+D.getTargetEntitySetPath(p,true)+"',  parameters : { $$groupId : '$auto.Workers' } , templateShareable: false}";var o=D.getTargetEntitySetNavigation(p);var r=Object.assign({},p);if(r.contextLocation){r.contextLocation.navigationProperties=o;}var P=p.targetObject.type==="PropertyPath"?p.targetObject.$target:p.targetObject;var q=(_=P.annotations)===null||_===void 0?void 0:(m=_.Common)===null||m===void 0?void 0:m.Text;var s=D.getPathRelativeLocation(p.contextLocation,p.navigationProperties).map(function(u){return u.name;});var t=q?c(e(q,s)):g(r,l,true);return{text:t,collection:n,key:g(r,l,true)};}});return C;},false);
