/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/fe/macros/CommonHelper","sap/base/Log","sap/m/library"],function(C,L,m){"use strict";var V=m.ValueColor;var M={getThresholdColor:function(v,c){var o=c.context;var p=o.getPath();var t=V.Neutral;if(p.indexOf("DeviationRange")>-1){t=V.Error;}else if(p.indexOf("ToleranceRange")>-1){t=V.Critical;}return t;},getMeasurePropertyPaths:function(c,e,s){var p=[];if(!e){L.warning("FE:Macro:MicroChart : Couldn't find annotations for the DataPoint.");return;}c.Measures.forEach(function(a,i){var b=C.getMeasureAttributeIndex(i,c),o=b>-1&&c.MeasureAttributes&&c.MeasureAttributes[b],d=o&&e&&e[o.DataPoint.$AnnotationPath];if(d&&d.Value&&d.Value.$Path){p.push(d.Value.$Path);}else{L.warning("FE:Macro:MicroChart : Couldn't find DataPoint(Value) measure for the measureAttribute "+s+" MicroChart.");}});return p.join(",");},getHiddenPathExpression:function(){if(!arguments[0]&&!arguments[1]){return true;}else if(arguments[0]===true||arguments[1]===true){return false;}else{var h=[];[].forEach.call(arguments,function(a){if(a&&a.$Path){h.push("%{"+a.$Path+"}");}});return"{= "+h.join(" || ")+" === true ? false : true }";}},isNotAlwaysHidden:function(c,v,s,a,b){if(a===true){this.logError(c,v);}if(b===true){this.logError(c,s);}if(a===undefined&&b===undefined){return true;}else{return((!a||a.$Path)&&a!==undefined)||((!b||b.$Path)&&b!==undefined)?true:false;}},logError:function(c,v){L.error("Measure Property "+v.$Path+" is hidden for the "+c+" Micro Chart");},formatDecimal:function(p,P,f){var c=[],F=["style: 'short'"],s=f||(P&&P.$Scale)||1,b;if(p){if(P.$Nullable!=undefined){c.push("nullable: "+P.$Nullable);}if(P.$Precision!=undefined){F.push("precision: "+(P.$Precision?P.$Precision:"1"));}c.push("scale: "+(s==="variable"?"'"+s+"'":s));b="{ path: '"+p+"'"+", type: 'sap.ui.model.odata.type.Decimal', constraints: { "+c.join(",")+" }, formatOptions: { "+F.join(",")+" } }";}return b;},getSelectParameters:function(){var p=[],c=arguments[1],P=[];if(arguments[0]){P.push("$$groupId : '"+arguments[0]+"'");}if(arguments[2]){p.push(arguments[2]);}else if(c){for(var k in c){if(!c[k].$EnumMember&&c[k].$Path){p.push(c[k].$Path);}}}for(var i=3;i<arguments.length;i++){if(arguments[i]){p.push(arguments[i]);}}if(p.length){P.push("$select : '"+p.join(",")+"'");}return P.join(",");},getDataPointQualifiersForMeasures:function(c,e,s){var q=[],a=c.MeasureAttributes,A=function(o){var b=o.$PropertyPath,Q;a.forEach(function(d){if(e&&(d&&d.Measure&&d.Measure.$PropertyPath)===b&&d.DataPoint&&d.DataPoint.$AnnotationPath){var f=d.DataPoint.$AnnotationPath;if(e[f]){Q=f.indexOf("#")?f.split("#")[1]:"";q.push(Q);}}});if(Q===undefined){L.warning("FE:Macro:MicroChart : Couldn't find DataPoint(Value) measure for the measureAttribute for "+s+" MicroChart.");}};if(!e){L.warning("FE:Macro:MicroChart : Couldn't find annotations for the DataPoint "+s+" MicroChart.");}c.Measures.forEach(A);return q.join(",");},logWarning:function(c,e){for(var k in e){var v=e[k];if(!v){L.warning(k+" parameter is missing for the "+c+" Micro Chart");}}},getDisplayValueForMicroChart:function(d,p,v,o){var s=d.ValueFormat&&d.ValueFormat.NumberOfFractionalDigits,r;if(p){r=M.formatDecimal(p["$Path"],v,s);}else{r=M.formatDecimal(d.Value["$Path"],o,s);}return r;},shouldMicroChartRender:function(c,d,D,o,a){var b=["Area","Column","Comparison"],s=d&&d.Value,h=D&&D["com.sap.vocabularies.UI.v1.Hidden"],e=o&&o.Dimensions&&o.Dimensions[0],f=b.indexOf(c)>-1?s&&e:s;if(c==="Harvey"){var g=d&&d.MaximumValue,i=a&&a["com.sap.vocabularies.UI.v1.Hidden"];return(s&&g&&M.isNotAlwaysHidden("Bullet",s,g,h,i));}return f&&M.isNotAlwaysHidden(c,s,undefined,h);},getdataPointQualifiersForMicroChart:function(u){if(u.indexOf("com.sap.vocabularies.UI.v1.DataPoint")===-1){return undefined;}if(u.indexOf("#")>-1){return u.split("#")[1];}return"";},getcolorPaletteForMicroChart:function(d){return d.Criticality?undefined:"sapUiChartPaletteQualitativeHue1, sapUiChartPaletteQualitativeHue2, sapUiChartPaletteQualitativeHue3,          sapUiChartPaletteQualitativeHue4, sapUiChartPaletteQualitativeHue5, sapUiChartPaletteQualitativeHue6, sapUiChartPaletteQualitativeHue7,          sapUiChartPaletteQualitativeHue8, sapUiChartPaletteQualitativeHue9, sapUiChartPaletteQualitativeHue10, sapUiChartPaletteQualitativeHue11";},getMeasureScaleForMicroChart:function(d){if(d.ValueFormat&&d.ValueFormat.NumberOfFractionalDigits){return d.ValueFormat.NumberOfFractionalDigits;}if(d.Value&&d.Value["$Path"]&&d.Value["$Path"]["$Scale"]){return d.Value["$Path"]["$Scale"];}return 1;},getBindingExpressionForMicrochart:function(c,o,t,a,u,d){var b=a["$isCollection"]||a["$kind"]==="EntitySet",p=b?"":u,s=M.getCurrencyOrUnit(o),D="";switch(c){case"Radial":s="";break;case"Harvey":D=d.Criticality?d.Criticality["$Path"]:"";break;}var f=M.getSelectParameters(t.batchGroupId,"",D,s),B="{ path: '"+p+"'"+", parameters : {"+f+"} }";return B;},getUOMPathForMicrochart:function(s,o){var r;if(o&&!s){r=(o["@Org.OData.Measures.V1.ISOCurrency"]&&o["@Org.OData.Measures.V1.ISOCurrency"].$Path)||(o["@Org.OData.Measures.V1.Unit"]&&o["@Org.OData.Measures.V1.Unit"].$Path);}return r?r:"";},getAggregationForMicrochart:function(a,c,d,u,D,o,s){var p=c["$kind"]==="EntitySet"?"/":"",p=p+u,g="",b="",e=d.Criticality?d.Criticality["$Path"]:"",f=M.getUOMPathForMicrochart(false,o),t="",h="";if(D&&D.$PropertyPath&&D.$PropertyPath["@com.sap.vocabularies.Common.v1.Text"]){h=D.$PropertyPath["@com.sap.vocabularies.Common.v1.Text"].$Path;}else{h=D.$PropertyPath;}switch(a){case"Points":b=d&&d.CriticalityCalculation;t=d&&d.TargetValue&&d.TargetValue["$Path"];e="";break;case"Columns":b=d&&d.CriticalityCalculation;break;case"LinePoints":e="";break;case"Bars":h="";break;}var F=M.getSelectParameters(g,b,e,f,t,h,s),A="{path:'"+p+"'"+", parameters : {"+F+"} }";return A;},getCurrencyOrUnit:function(o){if(o["@Org.OData.Measures.V1.ISOCurrency"]){return o["@Org.OData.Measures.V1.ISOCurrency"].$Path||o["@Org.OData.Measures.V1.ISOCurrency"];}else if(o["@Org.OData.Measures.V1.Unit"]){return o["@Org.OData.Measures.V1.Unit"].$Path||o["@Org.OData.Measures.V1.Unit"];}else{return"";}}};return M;},true);
