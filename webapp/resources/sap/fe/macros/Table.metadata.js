/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
    
 */
sap.ui.define(["./MacroMetadata","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/converters/ConverterContext","sap/fe/core/converters/MetaModelConverter","sap/fe/core/converters/controls/Common/DataVisualization","sap/fe/core/helpers/StableIdHelper","sap/fe/macros/internal/helpers/TableTemplating"],function(M,D,C,a,b,S,T){"use strict";var c=M.extend("sap.fe.macros.Table",{name:"Table",namespace:"sap.fe.macros.internal",publicNamespace:"sap.fe.macros",publicName:"Table",fragment:"sap.fe.macros.Table",metadata:{stereotype:"xmlmacro",properties:{tableDefinition:{type:"sap.ui.model.Context"},metaPath:{type:"sap.ui.model.Context",isPublic:true},contextPath:{type:"sap.ui.model.Context",isPublic:true},collection:{type:"sap.ui.model.Context",required:true,$kind:["EntitySet","NavigationProperty"]},parentEntitySet:{type:"sap.ui.model.Context"},id:{type:"string",isPublic:true},_apiId:{type:"string"},rowsBindingInfo:{type:"object"},navigationPath:{type:"string"},readOnly:{type:"boolean",isPublic:true},disableAddRowButtonForEmptyData:{type:"boolean"},customValidationFunction:{type:"string"},useCondensedTableLayout:{type:"boolean"},rowAction:{type:"string",defaultValue:undefined},selectionMode:{type:"string",isPublic:true},busy:{type:"boolean",isPublic:true},enableFullScreen:{type:"boolean",isPublic:true},showDelete:{type:"boolean"},header:{type:"string",isPublic:true},headerVisible:{type:"boolean",isPublic:true},noDataText:{type:"string"},creationMode:{type:"string"},createAtEnd:{type:"boolean"},createOutbound:{type:"string"},createOutboundDetail:{type:"string"},createNewAction:{type:"string"},personalization:{type:"string|boolean",isPublic:true},type:{type:"string",isPublic:true},tableType:{type:"string"},enableExport:{type:"boolean",isPublic:true},enablePaste:{type:"boolean",isPublic:true},_pasteVisible:{type:"boolean"},selectionLimit:{type:"string"},multiSelectMode:{type:"string"},filterBarId:{type:"string"},create:{type:"sap.ui.model.Context"},tableDelegate:{type:"string"},enableAutoScroll:{type:"boolean"},visible:{type:"string"},isAlp:{type:"boolean",defaultValue:false},variantManagement:{type:"string",isPublic:true},columnEditMode:{type:"string",computed:true},tabTitle:{type:"string",defaultValue:""},enableAutoColumnWidth:{type:"boolean"}},events:{variantSaved:{type:"function"},variantSelected:{type:"function"},onChange:{type:"function"},rowPress:{type:"function",isPublic:true},onContextChange:{type:"function"},onSegmentedButtonPressed:{type:"function"}},aggregations:{actions:{type:"sap.fe.macros.internal.table.Action",isPublic:true},columns:{type:"sap.fe.macros.internal.table.Column",isPublic:true}}},create:function(p,o,s,A){var t;var d=a.getInvolvedDataModelObjects(p.metaPath,p.contextPath);var e=this.parseAggregation(A.actions,function(h,i){var j=h.getAttribute("key")||"InlineXMLAction_"+i;return{key:j,text:h.getAttribute("text"),position:{placement:h.getAttribute("placement"),anchor:h.getAttribute("anchor")},__noWrap:true,press:h.getAttribute("press")};});var E=this.parseAggregation(A.columns,function(h,i){var j=h.getAttribute("key")||"InlineXMLColumn_"+i;A[j]=h;return{key:j,header:h.getAttribute("header"),position:{placement:h.getAttribute("placement"),anchor:h.getAttribute("anchor")},type:"Slot"};});if(p.tableDefinition===undefined||p.tableDefinition===null){var v=D.getContextRelativeTargetObjectPath(d);var f={};f[v]={actions:e,columns:E};var g=this.getConverterContext(d,p.contextPath,s,f);var V=b.getDataVisualizationConfiguration(v,p.useCondensedLayout,g);t=V.visualizations[0];p.tableDefinition=this.createBindingContext(t,s);}else{t=p.tableDefinition.getObject();}t.path=p.tableDefinition.getPath();this.setDefaultValue(p,"enableFullScreen",t.control.enableFullScreen);this.setDefaultValue(p,"useCondensedTableLayout",t.control.useCondensedTableLayout);this.setDefaultValue(p,"disableAddRowButtonForEmptyData",t.control.disableAddRowButtonForEmptyData);this.setDefaultValue(p,"customValidationFunction",t.control.customValidationFunction);this.setDefaultValue(p,"enableExport",t.control.enableExport);this.setDefaultValue(p,"enablePaste",t.annotation.show.paste);this.setDefaultValue(p,"headerVisible",t.control.headerVisible);this.setDefaultValue(p,"searchable",t.annotation.searchable);this.setDefaultValue(p,"showRowCount",t.control.showRowCount);this.setDefaultValue(p,"header",t.annotation.title);this.setDefaultValue(p,"selectionLimit",t.control.selectionLimit);this.setDefaultValue(p,"type",t.control.type);if(p.id){p._apiId=p.id;p.id=p.id+"-content";}else{this.setDefaultValue(p,"id",t.annotation.id);p._apiId=t.annotation.id+"::Table";}this.setDefaultValue(p,"selectionMode",t.annotation.selectionMode);this.setDefaultValue(p,"creationMode",t.annotation.create.mode);this.setDefaultValue(p,"createAtEnd",t.annotation.create.append);this.setDefaultValue(p,"createOutbound",t.annotation.create.outbound);this.setDefaultValue(p,"createNewAction",t.annotation.create.newAction);this.setDefaultValue(p,"createOutboundDetail",t.annotation.create.outboundDetail);this.setDefaultValue(p,"showDelete",t.annotation.show.delete);this.setDefaultValue(p,"personalization",t.annotation.p13nMode);this.setDefaultValue(p,"variantManagement",t.annotation.variantManagement);this.setDefaultValue(p,"enableAutoColumnWidth",t.control.enableAutoColumnWidth);if(p.readOnly==="false"){p.readOnly=false;}else if(p.readOnly==="true"){p.readOnly=true;}if(p.readOnly===undefined&&t.annotation.displayMode===true){p.readOnly=true;}if(p.rowPress){p.rowAction="Navigation";}this.setDefaultValue(p,"rowPress",t.annotation.row.press);this.setDefaultValue(p,"rowAction",t.annotation.row.action);if(p.personalization==="false"){p.personalization=undefined;}else if(p.personalization==="true"){p.personalization="Sort,Column,Filter";}var u=false;if(!p.filterBarId&&p.searchable){p.filterBarId=S.generate([p.id,"StandardAction","BasicSearch"]);u=true;}p.useBasicSearch=u;p._pasteVisible=t.annotation.show.paste;p.massEditVisible=t.annotation.show.massEdit.visible;p.massEditEnabled=t.annotation.show.massEdit.enabled;p.tableType=p.type;p.showCreate=t.annotation.show.create||true;p.autoBindOnInit=t.annotation.autoBindOnInit;p.parentEntityDeleteEnabled=t.annotation.parentEntityDeleteEnabled;p.navigationPath=t.annotation.navigationPath;p.parentEntitySet=s.models.metaModel.createBindingContext("/"+(d.contextLocation.targetEntitySet?d.contextLocation.targetEntitySet.name:d.startingEntitySet.name));p.collection=s.models.metaModel.createBindingContext(t.annotation.collection);p.columnEditMode=undefined;if(p.readOnly===true){p.columnEditMode="Display";}else if(p.readOnly===false){p.columnEditMode="Editable";}p.headerBindingExpression=T.buildExpressionForHeaderVisible(p);return p;}});return c;});
