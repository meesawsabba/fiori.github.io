/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/templating/UIFormatters","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/helpers/BindingExpression","sap/fe/core/templating/PropertyHelper","sap/fe/core/formatters/ValueFormatter","sap/fe/core/templating/FieldControlHelper"],function(U,D,B,a,P,v,F){"use strict";var _={};var b=F.isReadOnlyExpression;var g=P.getAssociatedTextPropertyPath;var h=P.hasValueHelp;var c=P.getAssociatedCurrencyPropertyPath;var d=P.getAssociatedUnitPropertyPath;var e=P.isProperty;var f=P.getAssociatedCurrencyProperty;var j=P.getAssociatedUnitProperty;var k=P.isPathExpression;var n=a.not;var l=a.equal;var m=a.ifElse;var o=a.or;var p=a.and;var q=a.bindingExpression;var r=a.constant;var s=a.compileBinding;var t=a.transformRecursively;var u=a.formatResult;var w=a.annotationExpression;var x=B.UI;var y=D.getContextRelativeTargetObjectPath;var z=D.getPathRelativeLocation;var A=D.enhanceDataModelPath;var C=U.formatWithTypeInformation;var E=U.getBindingWithUnitOrCurrency;var G=U.getDisplayMode;function H(i,Z){var $=Object.keys(i);if(Object.getOwnPropertySymbols){var a1=Object.getOwnPropertySymbols(i);if(Z){a1=a1.filter(function(b1){return Object.getOwnPropertyDescriptor(i,b1).enumerable;});}$.push.apply($,a1);}return $;}function I(Z){for(var i=1;i<arguments.length;i++){var $=arguments[i]!=null?arguments[i]:{};if(i%2){H(Object($),true).forEach(function(a1){J(Z,a1,$[a1]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(Z,Object.getOwnPropertyDescriptors($));}else{H(Object($)).forEach(function(a1){Object.defineProperty(Z,a1,Object.getOwnPropertyDescriptor($,a1));});}}return Z;}function J(i,Z,$){if(Z in i){Object.defineProperty(i,Z,{value:$,enumerable:true,configurable:true,writable:true});}else{i[Z]=$;}return i;}var K=function(q,i){return t(q,"Binding",function(Z){var $=Z;if(Z.modelName===undefined){var a1=A(i,Z.path);$=L(a1,Z);}return $;});};_.addTextArrangementToBindingExpression=K;var L=function(i,Z,$){var a1,b1;var c1=$===null||$===void 0?void 0:$.displayMode;var d1=Z;var e1=i.targetObject.type==="PropertyPath"?i.targetObject.$target:i.targetObject;var f1=c1||G(e1,i);var g1=(a1=e1.annotations)===null||a1===void 0?void 0:(b1=a1.Common)===null||b1===void 0?void 0:b1.Text;var h1=z(i.contextLocation,i.navigationProperties).map(function(np){return np.name;});Z=C(e1,Z);if(f1!=="Value"&&g1){switch(f1){case"Description":d1=w(g1,h1);break;case"DescriptionValue":d1=u([w(g1,h1),Z],v.formatWithBrackets);break;case"ValueDescription":d1=u([Z,w(g1,h1)],v.formatWithBrackets);break;}}return d1;};_.getBindingWithTextArrangement=L;var M=function(q,i){return t(q,"Binding",function(Z){var $=Z;if(Z.modelName===undefined){var a1=A(i,Z.path);$=C(a1.targetObject,Z);}return $;});};_.formatValueRecursively=M;var N=function(i,Z){var $,a1,b1,c1,d1,e1,f1,g1,h1,i1;var j1=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if((($=i.targetObject)===null||$===void 0?void 0:$.$Type)==="com.sap.vocabularies.UI.v1.DataField"||((a1=i.targetObject)===null||a1===void 0?void 0:a1.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"||((b1=i.targetObject)===null||b1===void 0?void 0:b1.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"||((c1=i.targetObject)===null||c1===void 0?void 0:c1.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){var k1=i.targetObject.Value||"";return s(r(k1));}if(k(i.targetObject)&&i.targetObject.$target){var l1=i.targetEntityType.resolvePath(i.targetObject.path,true);i.targetObject=l1.target;l1.visitedObjects.forEach(function(o1){if((o1===null||o1===void 0?void 0:o1._type)==="NavigationProperty"){i.navigationProperties.push(o1);}});}var m1=q(y(i));var n1;if((d1=i.targetObject)!==null&&d1!==void 0&&(e1=d1.annotations)!==null&&e1!==void 0&&(f1=e1.Measures)!==null&&f1!==void 0&&f1.Unit||(g1=i.targetObject)!==null&&g1!==void 0&&(h1=g1.annotations)!==null&&h1!==void 0&&(i1=h1.Measures)!==null&&i1!==void 0&&i1.ISOCurrency){n1=E(i,m1);if((Z===null||Z===void 0?void 0:Z.measureDisplayMode)==="Hidden"){n1.formatOptions=I(I({},n1.formatOptions),{},{showMeasure:false});}}else{n1=L(i,m1,Z);}if(j1){return n1;}return s(n1);};_.getTextBinding=N;var O=function(i,Z){var $=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var a1=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var b1=arguments.length>4?arguments[4]:undefined;var c1=arguments.length>5?arguments[5]:undefined;var d1=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;if(k(i.targetObject)&&i.targetObject.$target){var e1=i.targetEntityType.resolvePath(i.targetObject.path,true);i.targetObject=e1.target;e1.visitedObjects.forEach(function(l1){if(l1&&l1._type==="NavigationProperty"){i.navigationProperties.push(l1);}});}var f1=i.targetObject;if(e(f1)){var g1,h1;var i1=q(y(i));if((g1=f1.annotations)!==null&&g1!==void 0&&(h1=g1.Communication)!==null&&h1!==void 0&&h1.IsEmailAddress){i1.type="sap.fe.core.type.Email";}else{var j1=j(i.targetObject);var k1=f(i.targetObject);if(!$&&(j1||k1)){i1=E(i,i1);if(j1&&!h(j1)||k1&&!h(k1)||(Z===null||Z===void 0?void 0:Z.measureDisplayMode)==="Hidden"){if(!i1.formatOptions){i1.formatOptions={};}if(d1){i1.formatOptions.showNumber=false;}else{i1.formatOptions.showMeasure=false;}}}else{i1=C(f1,i1);if(i1.type==="sap.ui.model.odata.type.String"){i1.formatOptions={parseKeepsEmptyString:true};}}}if(a1){delete i1.formatOptions;delete i1.constraints;delete i1.type;}if(b1){i1.parameters=b1;}if(c1){i1.targetType="any";}return s(i1);}else{if((f1===null||f1===void 0?void 0:f1.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||(f1===null||f1===void 0?void 0:f1.$Type)==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){return s(w(f1.Value));}else{return"";}}};_.getValueBinding=O;var Q=function(i,Z){var $=d(i.targetObject);var a1=c(i.targetObject);if($||a1){var b1=$||a1;var c1=A(i,b1);return O(c1,Z);}return undefined;};_.getUnitBinding=Q;var R=function(i,Z){var $=g(i.targetObject);if($){var a1=A(i,$);var b1=O(a1,Z,true,true,{$$noPatch:true});return b1;}return undefined;};_.getAssociatedTextBinding=R;var S=function(i,Z,$,a1,b1){var c1,d1,e1,f1,g1,h1,i1,j1,k1,l1,m1,n1,o1,p1,q1,r1,s1,t1,u1,v1,w1,x1,y1,z1,A1,B1;var C1=k(i)&&i.$target||i;if(b1&&!((c1=C1.annotations)!==null&&c1!==void 0&&(d1=c1.UI)!==null&&d1!==void 0&&d1.IsImageURL)&&!(C1.type==="Edm.Stream")&&!((e1=C1.annotations)!==null&&e1!==void 0&&(f1=e1.Communication)!==null&&f1!==void 0&&f1.IsEmailAddress||(g1=C1.annotations)!==null&&g1!==void 0&&(h1=g1.Communication)!==null&&h1!==void 0&&h1.IsPhoneNumber)){return"LinkWithQuickViewForm";}if(!i||typeof i==="string"){return"Text";}if(C1.type==="Edm.Stream"){return"File";}if((i1=C1.annotations)!==null&&i1!==void 0&&(j1=i1.UI)!==null&&j1!==void 0&&j1.IsImageURL){return"Avatar";}switch(Z.$Type){case"com.sap.vocabularies.UI.v1.DataPointType":return"DataPoint";case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(((k1=Z.Target)===null||k1===void 0?void 0:(l1=k1.$target)===null||l1===void 0?void 0:l1.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"){return"DataPoint";}else if(((m1=Z.Target)===null||m1===void 0?void 0:(n1=m1.$target)===null||n1===void 0?void 0:n1.$Type)==="com.sap.vocabularies.Communication.v1.ContactType"){return"Contact";}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":return"Button";case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":return"Link";}if($!==null&&$!==void 0&&(o1=$.targetEntityType)!==null&&o1!==void 0&&(p1=o1.annotations)!==null&&p1!==void 0&&(q1=p1.Common)!==null&&q1!==void 0&&q1.SemanticKey){var D1=$.targetEntityType.annotations.Common.SemanticKey;var E1=!D1.every(function(K1){var L1;return(K1===null||K1===void 0?void 0:(L1=K1.$target)===null||L1===void 0?void 0:L1.name)!==C1.name;});if(E1&&a1.semanticKeyStyle){var F1,G1,H1;if((F1=$.targetEntitySet)!==null&&F1!==void 0&&(G1=F1.annotations)!==null&&G1!==void 0&&(H1=G1.Common)!==null&&H1!==void 0&&H1.DraftRoot){return"SemanticKeyWithDraftIndicator";}return a1.semanticKeyStyle==="ObjectIdentifier"?"ObjectIdentifier":"LabelSemanticKey";}}if(Z.Criticality){return"ObjectStatus";}if((r1=C1.annotations)!==null&&r1!==void 0&&(s1=r1.Measures)!==null&&s1!==void 0&&s1.ISOCurrency){if(a1.measureDisplayMode==="Hidden"){return"Text";}return"AmountWithCurrency";}if((t1=C1.annotations)!==null&&t1!==void 0&&(u1=t1.Communication)!==null&&u1!==void 0&&u1.IsEmailAddress||(v1=C1.annotations)!==null&&v1!==void 0&&(w1=v1.Communication)!==null&&w1!==void 0&&w1.IsPhoneNumber){return"Link";}if((x1=C1.annotations)!==null&&x1!==void 0&&(y1=x1.UI)!==null&&y1!==void 0&&y1.MultiLineText){return"ExpandableText";}var I1=($===null||$===void 0?void 0:(z1=$.targetEntityType)===null||z1===void 0?void 0:z1.navigationProperties)||[];var J1=false;I1.forEach(function(K1){if(K1.referentialConstraint&&K1.referentialConstraint.length){K1.referentialConstraint.forEach(function(L1){if((L1===null||L1===void 0?void 0:L1.sourceProperty)===C1.name){var M1,N1,O1;if(K1!==null&&K1!==void 0&&(M1=K1.targetType)!==null&&M1!==void 0&&(N1=M1.annotations)!==null&&N1!==void 0&&(O1=N1.UI)!==null&&O1!==void 0&&O1.QuickViewFacets){J1=true;}}});}});if(J1){return"LinkWithQuickViewForm";}if((A1=C1.annotations)!==null&&A1!==void 0&&(B1=A1.Common)!==null&&B1!==void 0&&B1.SemanticObject){return"LinkWrapper";}if(Z.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return"Link";}return"Text";};_.getDisplayStyle=S;var T=function(i,Z,$){var a1,b1,c1,d1,e1,f1,g1,h1,i1,j1,k1;if(!i||typeof i==="string"){return null;}var l1=k(i)&&i.$target||i;if(l1.type==="Edm.Stream"){return"File";}switch(Z.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(((a1=Z.Target)===null||a1===void 0?void 0:(b1=a1.$target)===null||b1===void 0?void 0:b1.$Type)==="com.sap.vocabularies.Communication.v1.ContactType"){return null;}else if(((c1=Z.Target)===null||c1===void 0?void 0:(d1=c1.$target)===null||d1===void 0?void 0:d1.Visualization)==="UI.VisualizationType/Rating"){return"RatingIndicator";}break;case"com.sap.vocabularies.UI.v1.DataPointType":if((Z===null||Z===void 0?void 0:Z.Visualization)==="UI.VisualizationType/Rating"){return"RatingIndicator";}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":return null;}var m1=j(l1);var n1=f(l1);if(P.hasValueHelp(l1)&&l1.type!=="Edm.Boolean"||m1&&P.hasValueHelp(m1)||n1&&P.hasValueHelp(n1)){if(($===null||$===void 0?void 0:$.measureDisplayMode)==="Hidden"){return"Input";}return"InputWithValueHelp";}if((e1=l1.annotations)!==null&&e1!==void 0&&(f1=e1.UI)!==null&&f1!==void 0&&(g1=f1.MultiLineText)!==null&&g1!==void 0&&g1.valueOf()&&l1.type==="Edm.String"){return"TextArea";}switch(l1.type){case"Edm.Date":return"DatePicker";case"Edm.Time":case"Edm.TimeOfDay":return"TimePicker";case"Edm.DateTime":case"Edm.DateTimeOffset":return"DateTimePicker";case"Edm.Boolean":return"CheckBox";}if((h1=l1.annotations)!==null&&h1!==void 0&&(i1=h1.Measures)!==null&&i1!==void 0&&i1.ISOCurrency||(j1=l1.annotations)!==null&&j1!==void 0&&(k1=j1.Measures)!==null&&k1!==void 0&&k1.Unit){return"InputWithUnit";}return"Input";};_.getEditStyle=T;var V=function(i,Z){var $,a1,b1,c1,d1,e1;var f1=i.targetObject;var g1;if(f1){switch(f1.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":case"com.sap.vocabularies.UI.v1.DataPointType":g1=f1.Value.$target;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if((f1===null||f1===void 0?void 0:($=f1.Target)===null||$===void 0?void 0:(a1=$.$target)===null||a1===void 0?void 0:a1.$Type)==="com.sap.vocabularies.UI.v1.DataPointType"){var h1;g1=(h1=f1.Target.$target)===null||h1===void 0?void 0:h1.Value.$target;break;}case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldForAction":default:g1=undefined;}}var i1=Z!==null&&Z!==void 0&&Z.isAnalytics?x.IsExpanded:r(false);var j1=Z!==null&&Z!==void 0&&Z.isAnalytics?l(x.NodeLevel,0):r(false);return s(p.apply(void 0,[n(l(w(f1===null||f1===void 0?void 0:(b1=f1.annotations)===null||b1===void 0?void 0:(c1=b1.UI)===null||c1===void 0?void 0:c1.Hidden),true)),m(!!g1,g1&&n(l(w((d1=g1.annotations)===null||d1===void 0?void 0:(e1=d1.UI)===null||e1===void 0?void 0:e1.Hidden),true)),true),o(n(i1),j1)]));};_.getVisibleExpression=V;var W=function(i,Z){var $=k(i)&&i.$target||i;var a1=f($)||j($);if(!a1){return s("");}var b1=p(n(b(a1)),n(P.isComputed(a1)));return s(m(b1,"",Z));};_.getInputDescription=W;var X=function(i,Z,$){var a1=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var b1=O(i,$,a1);if(b1===""){b1=N(Z,$,a1);}return b1;};_.QVTextBinding=X;var Y=function(i){var Z,$,a1,b1,c1,d1;var e1=i.targetObject;if(e1!==null&&e1!==void 0&&(Z=e1.$target)!==null&&Z!==void 0&&($=Z.annotations)!==null&&$!==void 0&&(a1=$.Communication)!==null&&a1!==void 0&&a1.IsEmailAddress){return"email";}if(e1!==null&&e1!==void 0&&(b1=e1.$target)!==null&&b1!==void 0&&(c1=b1.annotations)!==null&&c1!==void 0&&(d1=c1.Communication)!==null&&d1!==void 0&&d1.IsPhoneNumber){return"phone";}return"text";};_.getQuickViewType=Y;return _;},false);
