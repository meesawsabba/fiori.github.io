/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/templating/UIFormatters", "sap/fe/core/templating/DataModelPathHelper", "sap/fe/core/converters/MetaModelConverter"], function (UIFormatters, DataModelPathHelper, MetaModelConverter) {
  "use strict";

  var _exports = {};
  var getInvolvedDataModelObjects = MetaModelConverter.getInvolvedDataModelObjects;
  var enhanceDataModelPath = DataModelPathHelper.enhanceDataModelPath;
  var getConverterContext = UIFormatters.getConverterContext;

  var getDataField = function (oContext, oInterface) {
    var sPath = oInterface.context.getPath();

    if (!oContext) {
      throw new Error("Unresolved context path " + sPath);
    }

    var isPath = false;

    if (typeof oContext === "object" && (oContext.hasOwnProperty("$Path") || oContext.hasOwnProperty("$AnnotationPath"))) {
      isPath = true;
    } else if (typeof oContext === "object" && oContext.hasOwnProperty("$kind") && oContext.$kind !== "Property") {
      throw new Error("Context does not resolve to a DataField object but to a " + oContext.$kind);
    }

    var oConverterContext = getConverterContext(oContext, oInterface);

    if (isPath) {
      oConverterContext = oConverterContext.$target;
    }

    return oConverterContext;
  };

  _exports.getDataField = getDataField;

  var getDataFieldObjectPath = function (oContext, oInterface) {
    var sPath = oInterface.context.getPath();

    if (!oContext) {
      throw new Error("Unresolved context path " + sPath);
    }

    if (typeof oContext === "object" && oContext.hasOwnProperty("$kind") && oContext.$kind !== "Property") {
      throw new Error("Context does not resolve to a Property object but to a " + oContext.$kind);
    }

    var involvedDataModelObjects = getInvolvedDataModelObjects(oInterface.context);

    if (involvedDataModelObjects.targetObject && involvedDataModelObjects.targetObject.type === "Path") {
      involvedDataModelObjects = enhanceDataModelPath(involvedDataModelObjects, involvedDataModelObjects.targetObject.path);
    }

    if (involvedDataModelObjects.targetObject && involvedDataModelObjects.targetObject.type === "AnnotationPath") {
      involvedDataModelObjects = enhanceDataModelPath(involvedDataModelObjects, involvedDataModelObjects.targetObject);
    }

    if (sPath.endsWith("$Path") || sPath.endsWith("$AnnotationPath")) {
      involvedDataModelObjects = enhanceDataModelPath(involvedDataModelObjects, oContext);
    }

    return involvedDataModelObjects;
  };

  _exports.getDataFieldObjectPath = getDataFieldObjectPath;

  var isSemanticallyConnectedFields = function (oContext, oInterface) {
    var oDataField = getDataField(oContext, oInterface);
    return oDataField.$Type === "com.sap.vocabularies.UI.v1.ConnectedFieldsType";
  };

  _exports.isSemanticallyConnectedFields = isSemanticallyConnectedFields;
  return _exports;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRhdGFGaWVsZEZvcm1hdHRlcnMudHMiXSwibmFtZXMiOlsiZ2V0RGF0YUZpZWxkIiwib0NvbnRleHQiLCJvSW50ZXJmYWNlIiwic1BhdGgiLCJjb250ZXh0IiwiZ2V0UGF0aCIsIkVycm9yIiwiaXNQYXRoIiwiaGFzT3duUHJvcGVydHkiLCIka2luZCIsIm9Db252ZXJ0ZXJDb250ZXh0IiwiZ2V0Q29udmVydGVyQ29udGV4dCIsIiR0YXJnZXQiLCJnZXREYXRhRmllbGRPYmplY3RQYXRoIiwiaW52b2x2ZWREYXRhTW9kZWxPYmplY3RzIiwiZ2V0SW52b2x2ZWREYXRhTW9kZWxPYmplY3RzIiwidGFyZ2V0T2JqZWN0IiwidHlwZSIsImVuaGFuY2VEYXRhTW9kZWxQYXRoIiwicGF0aCIsImVuZHNXaXRoIiwiaXNTZW1hbnRpY2FsbHlDb25uZWN0ZWRGaWVsZHMiLCJvRGF0YUZpZWxkIiwiJFR5cGUiXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQUdPLE1BQU1BLFlBQVksR0FBRyxVQUMzQkMsUUFEMkIsRUFFM0JDLFVBRjJCLEVBR2lCO0FBQzVDLFFBQU1DLEtBQUssR0FBR0QsVUFBVSxDQUFDRSxPQUFYLENBQW1CQyxPQUFuQixFQUFkOztBQUNBLFFBQUksQ0FBQ0osUUFBTCxFQUFlO0FBQ2QsWUFBTSxJQUFJSyxLQUFKLENBQVUsNkJBQTZCSCxLQUF2QyxDQUFOO0FBQ0E7O0FBQ0QsUUFBSUksTUFBTSxHQUFHLEtBQWI7O0FBQ0EsUUFBSSxPQUFPTixRQUFQLEtBQW9CLFFBQXBCLEtBQWlDQSxRQUFRLENBQUNPLGNBQVQsQ0FBd0IsT0FBeEIsS0FBb0NQLFFBQVEsQ0FBQ08sY0FBVCxDQUF3QixpQkFBeEIsQ0FBckUsQ0FBSixFQUFzSDtBQUNySEQsTUFBQUEsTUFBTSxHQUFHLElBQVQ7QUFDQSxLQUZELE1BRU8sSUFBSSxPQUFPTixRQUFQLEtBQW9CLFFBQXBCLElBQWdDQSxRQUFRLENBQUNPLGNBQVQsQ0FBd0IsT0FBeEIsQ0FBaEMsSUFBb0VQLFFBQVEsQ0FBQ1EsS0FBVCxLQUFtQixVQUEzRixFQUF1RztBQUM3RyxZQUFNLElBQUlILEtBQUosQ0FBVSw2REFBNkRMLFFBQVEsQ0FBQ1EsS0FBaEYsQ0FBTjtBQUNBOztBQUNELFFBQUlDLGlCQUFpQixHQUFHQyxtQkFBbUIsQ0FBQ1YsUUFBRCxFQUFXQyxVQUFYLENBQTNDOztBQUNBLFFBQUlLLE1BQUosRUFBWTtBQUNYRyxNQUFBQSxpQkFBaUIsR0FBSUEsaUJBQUQsQ0FBMkJFLE9BQS9DO0FBQ0E7O0FBQ0QsV0FBT0YsaUJBQVA7QUFDQSxHQW5CTTs7OztBQXFCQSxNQUFNRyxzQkFBc0IsR0FBRyxVQUNyQ1osUUFEcUMsRUFFckNDLFVBRnFDLEVBR2Y7QUFDdEIsUUFBTUMsS0FBSyxHQUFHRCxVQUFVLENBQUNFLE9BQVgsQ0FBbUJDLE9BQW5CLEVBQWQ7O0FBQ0EsUUFBSSxDQUFDSixRQUFMLEVBQWU7QUFDZCxZQUFNLElBQUlLLEtBQUosQ0FBVSw2QkFBNkJILEtBQXZDLENBQU47QUFDQTs7QUFDRCxRQUFJLE9BQU9GLFFBQVAsS0FBb0IsUUFBcEIsSUFBZ0NBLFFBQVEsQ0FBQ08sY0FBVCxDQUF3QixPQUF4QixDQUFoQyxJQUFvRVAsUUFBUSxDQUFDUSxLQUFULEtBQW1CLFVBQTNGLEVBQXVHO0FBQ3RHLFlBQU0sSUFBSUgsS0FBSixDQUFVLDREQUE0REwsUUFBUSxDQUFDUSxLQUEvRSxDQUFOO0FBQ0E7O0FBQ0QsUUFBSUssd0JBQXdCLEdBQUdDLDJCQUEyQixDQUFDYixVQUFVLENBQUNFLE9BQVosQ0FBMUQ7O0FBQ0EsUUFBSVUsd0JBQXdCLENBQUNFLFlBQXpCLElBQXlDRix3QkFBd0IsQ0FBQ0UsWUFBekIsQ0FBc0NDLElBQXRDLEtBQStDLE1BQTVGLEVBQW9HO0FBQ25HSCxNQUFBQSx3QkFBd0IsR0FBR0ksb0JBQW9CLENBQUNKLHdCQUFELEVBQTJCQSx3QkFBd0IsQ0FBQ0UsWUFBekIsQ0FBc0NHLElBQWpFLENBQS9DO0FBQ0E7O0FBQ0QsUUFBSUwsd0JBQXdCLENBQUNFLFlBQXpCLElBQXlDRix3QkFBd0IsQ0FBQ0UsWUFBekIsQ0FBc0NDLElBQXRDLEtBQStDLGdCQUE1RixFQUE4RztBQUM3R0gsTUFBQUEsd0JBQXdCLEdBQUdJLG9CQUFvQixDQUFDSix3QkFBRCxFQUEyQkEsd0JBQXdCLENBQUNFLFlBQXBELENBQS9DO0FBQ0E7O0FBQ0QsUUFBSWIsS0FBSyxDQUFDaUIsUUFBTixDQUFlLE9BQWYsS0FBMkJqQixLQUFLLENBQUNpQixRQUFOLENBQWUsaUJBQWYsQ0FBL0IsRUFBa0U7QUFDakVOLE1BQUFBLHdCQUF3QixHQUFHSSxvQkFBb0IsQ0FBQ0osd0JBQUQsRUFBMkJiLFFBQTNCLENBQS9DO0FBQ0E7O0FBQ0QsV0FBT2Esd0JBQVA7QUFDQSxHQXRCTTs7OztBQXdCQSxNQUFNTyw2QkFBNkIsR0FBRyxVQUFTcEIsUUFBVCxFQUFxQ0MsVUFBckMsRUFBdUY7QUFDbkksUUFBTW9CLFVBQXFELEdBQUd0QixZQUFZLENBQUNDLFFBQUQsRUFBV0MsVUFBWCxDQUExRTtBQUNBLFdBQVFvQixVQUFELENBQXlDQyxLQUF6QyxxREFBUDtBQUNBLEdBSE0iLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXB1dGVkQW5ub3RhdGlvbkludGVyZmFjZSwgZ2V0Q29udmVydGVyQ29udGV4dCwgTWV0YU1vZGVsQ29udGV4dCB9IGZyb20gXCJzYXAvZmUvY29yZS90ZW1wbGF0aW5nL1VJRm9ybWF0dGVyc1wiO1xuaW1wb3J0IHsgQ29ubmVjdGVkRmllbGRzVHlwZVR5cGVzLCBEYXRhRmllbGRUeXBlcywgVUlBbm5vdGF0aW9uVHlwZXMgfSBmcm9tIFwiQHNhcC11eC92b2NhYnVsYXJpZXMtdHlwZXNcIjtcbmltcG9ydCB7IERhdGFNb2RlbE9iamVjdFBhdGgsIGVuaGFuY2VEYXRhTW9kZWxQYXRoIH0gZnJvbSBcInNhcC9mZS9jb3JlL3RlbXBsYXRpbmcvRGF0YU1vZGVsUGF0aEhlbHBlclwiO1xuaW1wb3J0IHsgZ2V0SW52b2x2ZWREYXRhTW9kZWxPYmplY3RzIH0gZnJvbSBcInNhcC9mZS9jb3JlL2NvbnZlcnRlcnMvTWV0YU1vZGVsQ29udmVydGVyXCI7XG5cbmV4cG9ydCBjb25zdCBnZXREYXRhRmllbGQgPSBmdW5jdGlvbihcblx0b0NvbnRleHQ6IE1ldGFNb2RlbENvbnRleHQsXG5cdG9JbnRlcmZhY2U6IENvbXB1dGVkQW5ub3RhdGlvbkludGVyZmFjZVxuKTogRGF0YUZpZWxkVHlwZXMgfCBDb25uZWN0ZWRGaWVsZHNUeXBlVHlwZXMge1xuXHRjb25zdCBzUGF0aCA9IG9JbnRlcmZhY2UuY29udGV4dC5nZXRQYXRoKCk7XG5cdGlmICghb0NvbnRleHQpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJVbnJlc29sdmVkIGNvbnRleHQgcGF0aCBcIiArIHNQYXRoKTtcblx0fVxuXHRsZXQgaXNQYXRoID0gZmFsc2U7XG5cdGlmICh0eXBlb2Ygb0NvbnRleHQgPT09IFwib2JqZWN0XCIgJiYgKG9Db250ZXh0Lmhhc093blByb3BlcnR5KFwiJFBhdGhcIikgfHwgb0NvbnRleHQuaGFzT3duUHJvcGVydHkoXCIkQW5ub3RhdGlvblBhdGhcIikpKSB7XG5cdFx0aXNQYXRoID0gdHJ1ZTtcblx0fSBlbHNlIGlmICh0eXBlb2Ygb0NvbnRleHQgPT09IFwib2JqZWN0XCIgJiYgb0NvbnRleHQuaGFzT3duUHJvcGVydHkoXCIka2luZFwiKSAmJiBvQ29udGV4dC4ka2luZCAhPT0gXCJQcm9wZXJ0eVwiKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiQ29udGV4dCBkb2VzIG5vdCByZXNvbHZlIHRvIGEgRGF0YUZpZWxkIG9iamVjdCBidXQgdG8gYSBcIiArIG9Db250ZXh0LiRraW5kKTtcblx0fVxuXHRsZXQgb0NvbnZlcnRlckNvbnRleHQgPSBnZXRDb252ZXJ0ZXJDb250ZXh0KG9Db250ZXh0LCBvSW50ZXJmYWNlKSBhcyBEYXRhRmllbGRUeXBlcztcblx0aWYgKGlzUGF0aCkge1xuXHRcdG9Db252ZXJ0ZXJDb250ZXh0ID0gKG9Db252ZXJ0ZXJDb250ZXh0IGFzIGFueSkuJHRhcmdldDtcblx0fVxuXHRyZXR1cm4gb0NvbnZlcnRlckNvbnRleHQ7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RGF0YUZpZWxkT2JqZWN0UGF0aCA9IGZ1bmN0aW9uKFxuXHRvQ29udGV4dDogTWV0YU1vZGVsQ29udGV4dCB8IHN0cmluZyxcblx0b0ludGVyZmFjZTogQ29tcHV0ZWRBbm5vdGF0aW9uSW50ZXJmYWNlXG4pOiBEYXRhTW9kZWxPYmplY3RQYXRoIHtcblx0Y29uc3Qgc1BhdGggPSBvSW50ZXJmYWNlLmNvbnRleHQuZ2V0UGF0aCgpO1xuXHRpZiAoIW9Db250ZXh0KSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVW5yZXNvbHZlZCBjb250ZXh0IHBhdGggXCIgKyBzUGF0aCk7XG5cdH1cblx0aWYgKHR5cGVvZiBvQ29udGV4dCA9PT0gXCJvYmplY3RcIiAmJiBvQ29udGV4dC5oYXNPd25Qcm9wZXJ0eShcIiRraW5kXCIpICYmIG9Db250ZXh0LiRraW5kICE9PSBcIlByb3BlcnR5XCIpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJDb250ZXh0IGRvZXMgbm90IHJlc29sdmUgdG8gYSBQcm9wZXJ0eSBvYmplY3QgYnV0IHRvIGEgXCIgKyBvQ29udGV4dC4ka2luZCk7XG5cdH1cblx0bGV0IGludm9sdmVkRGF0YU1vZGVsT2JqZWN0cyA9IGdldEludm9sdmVkRGF0YU1vZGVsT2JqZWN0cyhvSW50ZXJmYWNlLmNvbnRleHQpO1xuXHRpZiAoaW52b2x2ZWREYXRhTW9kZWxPYmplY3RzLnRhcmdldE9iamVjdCAmJiBpbnZvbHZlZERhdGFNb2RlbE9iamVjdHMudGFyZ2V0T2JqZWN0LnR5cGUgPT09IFwiUGF0aFwiKSB7XG5cdFx0aW52b2x2ZWREYXRhTW9kZWxPYmplY3RzID0gZW5oYW5jZURhdGFNb2RlbFBhdGgoaW52b2x2ZWREYXRhTW9kZWxPYmplY3RzLCBpbnZvbHZlZERhdGFNb2RlbE9iamVjdHMudGFyZ2V0T2JqZWN0LnBhdGgpO1xuXHR9XG5cdGlmIChpbnZvbHZlZERhdGFNb2RlbE9iamVjdHMudGFyZ2V0T2JqZWN0ICYmIGludm9sdmVkRGF0YU1vZGVsT2JqZWN0cy50YXJnZXRPYmplY3QudHlwZSA9PT0gXCJBbm5vdGF0aW9uUGF0aFwiKSB7XG5cdFx0aW52b2x2ZWREYXRhTW9kZWxPYmplY3RzID0gZW5oYW5jZURhdGFNb2RlbFBhdGgoaW52b2x2ZWREYXRhTW9kZWxPYmplY3RzLCBpbnZvbHZlZERhdGFNb2RlbE9iamVjdHMudGFyZ2V0T2JqZWN0KTtcblx0fVxuXHRpZiAoc1BhdGguZW5kc1dpdGgoXCIkUGF0aFwiKSB8fCBzUGF0aC5lbmRzV2l0aChcIiRBbm5vdGF0aW9uUGF0aFwiKSkge1xuXHRcdGludm9sdmVkRGF0YU1vZGVsT2JqZWN0cyA9IGVuaGFuY2VEYXRhTW9kZWxQYXRoKGludm9sdmVkRGF0YU1vZGVsT2JqZWN0cywgb0NvbnRleHQgYXMgc3RyaW5nKTtcblx0fVxuXHRyZXR1cm4gaW52b2x2ZWREYXRhTW9kZWxPYmplY3RzO1xufTtcblxuZXhwb3J0IGNvbnN0IGlzU2VtYW50aWNhbGx5Q29ubmVjdGVkRmllbGRzID0gZnVuY3Rpb24ob0NvbnRleHQ6IE1ldGFNb2RlbENvbnRleHQsIG9JbnRlcmZhY2U6IENvbXB1dGVkQW5ub3RhdGlvbkludGVyZmFjZSk6IGJvb2xlYW4ge1xuXHRjb25zdCBvRGF0YUZpZWxkOiBEYXRhRmllbGRUeXBlcyB8IENvbm5lY3RlZEZpZWxkc1R5cGVUeXBlcyA9IGdldERhdGFGaWVsZChvQ29udGV4dCwgb0ludGVyZmFjZSk7XG5cdHJldHVybiAob0RhdGFGaWVsZCBhcyBDb25uZWN0ZWRGaWVsZHNUeXBlVHlwZXMpLiRUeXBlID09PSBVSUFubm90YXRpb25UeXBlcy5Db25uZWN0ZWRGaWVsZHNUeXBlO1xufTtcbiJdfQ==