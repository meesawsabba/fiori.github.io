/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/mvc/View","sap/ui/core/Component","sap/m/MessageBox","sap/base/Log","sap/fe/navigation/SelectionVariant","sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/mdc/odata/v4/TypeUtil","sap/fe/core/helpers/StableIdHelper","sap/fe/core/library","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/SemanticDateOperators","sap/fe/core/templating/FilterHelper","sap/ui/mdc/condition/Condition","sap/ui/mdc/enum/ConditionValidated","sap/fe/core/converters/MetaModelConverter","sap/fe/core/converters/ConverterContext","sap/base/util/merge","sap/fe/core/helpers/BindingExpression","sap/fe/core/controls/DataLossOrDraftDiscard/DataLossOrDraftDiscardHandler","sap/ui/core/XMLTemplateProcessor","sap/ui/core/util/XMLPreprocessor","sap/ui/core/Fragment"],function(V,C,M,L,S,F,T,c,d,e,f,g,h,l,m,n,o,B,D,X,p,q){"use strict";var P=d.ProgrammingModel;var v=["Edm.Boolean","Edm.Byte","Edm.Date","Edm.DateTime","Edm.DateTimeOffset","Edm.Decimal","Edm.Double","Edm.Float","Edm.Guid","Edm.Int16","Edm.Int32","Edm.Int64","Edm.SByte","Edm.Single","Edm.String","Edm.Time","Edm.TimeOfDay"];function r(a){var b=a.getProperty("$Type");if(!a.getProperty("$kind")){switch(b){case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":b=undefined;break;case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":b=a.getProperty("Value/$Path/$Type");break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":default:var i=a.getProperty("Target/$AnnotationPath");if(i){if(i.indexOf("com.sap.vocabularies.Communication.v1.Contact")>-1){b=a.getProperty("Target/$AnnotationPath/fn/$Path/$Type");}else if(i.indexOf("com.sap.vocabularies.UI.v1.DataPoint")>-1){b=a.getProperty("Value/$Path/$Type");}else{b=undefined;}}else{b=undefined;}break;}}return b;}function H(a){var b=false;if(a){a.getCurrentContexts().forEach(function(i){if(i&&i.isTransient()){b=true;}});}return b;}function s(a,b){var i=0,j=a.split("/$NavigationPropertyBinding/");for(var k=j[0];i<j.length-1;i++){var $1=t(b,k,j[i+1]);if($1&&$1["SearchRestrictions"]){return $1["SearchRestrictions"];}k=k+"/$NavigationPropertyBinding/"+j[i];}return b.getObject(a+"@Org.OData.Capabilities.V1.SearchRestrictions");}function t(a,b,i){var j=a.getObject(b+"@Org.OData.Capabilities.V1.NavigationRestrictions");var k=j&&j.RestrictedProperties;return(k&&k.find(function($1){return($1&&$1.NavigationProperty&&$1.NavigationProperty.$NavigationPropertyPath===i);}));}function _(a,b,i){var j=false;var k=a.getObject(b+"@Org.OData.Capabilities.V1.FilterRestrictions");if(k&&k.NonFilterableProperties){j=k.NonFilterableProperties.some(function($1){return $1.$NavigationPropertyPath===i||$1.$PropertyPath===i;});}return j;}function u(a,b,i){var j=b+"/"+i,k=j.split("/").splice(0,2),$1=j.split("/").splice(2),_1=false,a2="";b=k.join("/");_1=$1.some(function(b2,c2,d2){if(a2.length>0){a2+="/"+b2;}else{a2=b2;}if(c2===d2.length-2){var e2=t(a,b,b2);var f2=e2&&e2.FilterRestrictions;var g2=f2&&f2.NonFilterableProperties;var h2=d2[d2.length-1];if(g2&&g2.find(function(i2){return i2.$PropertyPath===h2;})){return true;}}if(c2===d2.length-1){_1=_(a,b,a2);}else if(a.getObject(b+"/$NavigationPropertyBinding/"+b2)){_1=_(a,b,a2);a2="";b="/"+a.getObject(b+"/$NavigationPropertyBinding/"+b2);}return _1===true;});return _1;}function w(a,b,i,j){if(typeof i!=="string"){throw new Error("sProperty parameter must be a string",i);}var k;if(a.getProperty(b+"/@com.sap.vocabularies.Common.v1.ResultContext")===true){return true;}var $1=a.createBindingContext(b+"/"+i);if($1.getProperty("@com.sap.vocabularies.UI.v1.Hidden")===true){return false;}if(!j&&$1.getProperty("@com.sap.vocabularies.UI.v1.HiddenFilter")){return false;}if(b.split("/").length===2&&i.indexOf("/")<0){k=!_(a,b,i);}else{k=!u(a,b,i);}if(k&&$1){var _1=r($1);if(_1){k=v.indexOf(_1)!==-1;}else{k=false;}}return k;}function x(a){return K(a).getShellServices();}function y(a,b,i){var j=Z1.getShellServices(a);return j.getLinks({semanticObject:b,params:i});}function z(a){var b=[];var j=Object.keys(a);for(var i=0;i<j.length;i++){var k={"LocalProperty":{"$PropertyPath":j[i]},"SemanticObjectProperty":a[j[i]]};b.push(k);}return b;}function A(a,b,j,k){for(var i=0;i<a.length;i++){var $1=a[i];var _1=$1.intent;var a2=_1.split("-")[1].split("?")[0];if(b&&b.indexOf(a2)===-1){k.push({text:$1.text,targetSemObject:_1.split("#")[1].split("-")[0],targetAction:a2.split("~")[0],targetParams:j});}}}function E(a,b,i,j){if(j&&j.length>0){var k=a.unavailableActions?a.unavailableActions:[];var $1=a.mapping?z(a.mapping):[];var _1={navigationContexts:b,semanticObjectMapping:$1};A(j,k,_1,i);}}function G(b,a,i,k,$1,_1){var a2=x(i),b2={},c2="",d2="";var e2;var f2=[];var g2=[];if(a){if(k&&k.length>0){for(var j=0;j<k.length;j++){var h2=k[j].$PropertyPath;if(!b2[h2]){b2[h2]={value:a[h2]};}}}else{var i2=$1.getObject(_1+"/$Type/$Key");for(var j2 in i2){var k2=i2[j2];if(!b2[k2]){b2[k2]={value:a[k2]};}}}}var l2=N(i).getViewData();var m2=[];if(l2.additionalSemanticObjects){var n2=Object.keys(l2.additionalSemanticObjects);for(var j2=0;j2<n2.length;j2++){y(i,n2[j2],b2).then(E.bind(this,l2.additionalSemanticObjects[n2[j2]],b,m2)).catch(function(p2){L.error("Error while retrieving SO Intents",p2);});}}function o2(){var p2=a2.parseShellHash(document.location.hash);c2=p2.semanticObject;d2=p2.action;return y(i,c2,b2);}o2().then(function(p2){if(p2&&p2.length>0){var q2={};var r2=[];var s2=_1+"@";var t2=_1+"/@";var u2=$1.getObject(s2);e2=I(u2,c2);if(!e2.bHasEntitySetSO){var v2=$1.getObject(t2);e2=I(v2,c2);}g2=e2.aUnavailableActions;g2.push(d2);q2.navigationContexts=b;q2.semanticObjectMapping=e2.aMappings;A(p2,g2,q2,r2);f2=r2.concat(m2);i.getBindingContext("internal").setProperty("relatedApps/visibility",f2.length>0);i.getBindingContext("internal").setProperty("relatedApps/items",f2);}else{i.getBindingContext("internal").setProperty("relatedApps/visibility",false);}}).catch(function(p2){L.error("Cannot read links",p2);});return f2;}function I(a,b){var i={bHasEntitySetSO:false,aUnavailableActions:[],aMappings:[]};var j,k;var $1;for(var _1 in a){if(_1.indexOf("com.sap.vocabularies.Common.v1.SemanticObject")>-1&&a[_1]===b){i.bHasEntitySetSO=true;j="@com.sap.vocabularies.Common.v1.SemanticObjectMapping";k="@com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions";if(_1.indexOf("#")>-1){$1=_1.split("#")[1];j=j+"#"+$1;k=k+"#"+$1;}i.aMappings=i.aMappings.concat(a[j]);i.aUnavailableActions=i.aUnavailableActions.concat(a[k]);break;}}return i;}function U(a){var b=a.getModel().getMetaModel();var i=a.getBindingContext();var j=i&&i.getPath();var k=b.getMetaPath(j);var $1=k+"/"+"@com.sap.vocabularies.Common.v1.SemanticKey";var _1=b.getObject($1);var a2=i.getObject();if(!a2){i.requestObject().then(function(a2){return G(i,a2,a,_1,b,k);}).catch(function(b2){L.error("Cannot update the related app details",b2);});}else{return G(i,a2,a,_1,b,k);}}function J(b){var a=["sap.m.Button","sap.m.OverflowToolbarButton"];if(b&&a.indexOf(b.getMetadata().getName())!==-1&&b.getVisible()&&b.getEnabled()){b.firePress();}}function R(a){if(a==="true"||a===true){return true;}else{return false;}}function K(a){if(a.isA("sap.fe.core.AppComponent")){return a;}var b=C.getOwnerComponentFor(a);if(!b){return a;}else{return K(b);}}function N(a){if(a&&a.isA("sap.ui.core.ComponentContainer")){a=a.getComponentInstance();a=a&&a.getRootControl();}while(a&&!(a instanceof V)){a=a.getParent();}return a;}function O(a,b,i,j,k){var $1=i.getModel();var _1=false;var a2=$1.bindContext(i.getPath()+"/DraftAdministrativeData").getBoundContext();if(i&&i.getObject()&&(!i.getObject().DraftAdministrativeData||i.getObject().IsActiveEntity===true)){a();}else{a2.requestObject().then(function(b2){if(b2){_1=!(b2.CreationDateTime===b2.LastChangeDateTime);if(_1){D.performAfterDiscardorKeepDraft(a,b,j,k);}else{a();}}else{a();}}).catch(function(b2){L.error("Cannot retrieve draftDataContext information",b2);});}}function Q(a,b,i,j){var k=b.getModel("ui").getProperty("/isEditable"),$1=sap.ui.getCore().getLibraryResourceBundle("sap.fe.templates"),_1=$1&&$1.getText("T_COMMON_UTILS_NAVIGATION_AWAY_MSG"),a2=$1&&$1.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CONFIRM_BUTTON"),b2=$1&&$1.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CANCEL_BUTTON");if(i===P.Sticky&&k){return M.warning(_1,{actions:[a2,b2],onClose:function(c2){if(c2===a2){var d2=b&&b.getModel("internal");L.info("Navigation confirmed.");if(d2){d2.setProperty("/sessionOn",false);}else{L.warning("Local UIModel couldn't be found.");}a();}else{L.info("Navigation rejected.");}}});}return a();}function W(a,b){var i=false,j=a.split("/");if(j.length>1){i=b[j[0]]&&b[j[0]].hasOwnProperty(j[1])&&b[j[0]][j[1]]===0;}else{i=b[a]===0;}return i;}function Y(a,b){var k=[];for(var i=0;i<a.length;i++){var $1=a[i].entitySet,_1=a[i].contextData,a2;delete _1["@odata.context"];delete _1["%40odata.context"];delete _1["@odata.metadataEtag"];delete _1["%40odata.metadataEtag"];delete _1["SAP__Messages"];a2=Object.keys(_1);for(var j=0;j<a2.length;j++){var b2=a2[j],c2=b.getObject("/"+$1+"/"+b2+"@");if(c2){if(c2["@com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]||c2["@com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"]||c2["@com.sap.vocabularies.Analytics.v1.Measure"]){delete _1[b2];}else if(c2["@com.sap.vocabularies.Common.v1.FieldControl"]){var d2=c2["@com.sap.vocabularies.Common.v1.FieldControl"];if(d2["$EnumMember"]&&d2["$EnumMember"].split("/")[1]==="Inapplicable"){delete _1[b2];}else if(d2["$Path"]&&Z1.isFieldControlPathInapplicable(d2["$Path"],_1)){delete _1[b2];}}}}k.push(_1);}return k;}function Z(a,k){for(var b in k){if(k[b]!==a[b]){return false;}}return true;}function $(a,b,i){var j=a.getObject(b+"/")||{},k={};for(var $1 in j){if(j.hasOwnProperty($1)&&!/^\$/i.test($1)&&j[$1].$kind&&Z(j[$1],i||{$kind:"Property"})){k[$1]=j[$1];}}return k;}function a1(a,b){var i;if(a&&b){i=a.getObject(b+"@Org.OData.Capabilities.V1.FilterRestrictions/RequiredProperties");}return i;}function b1(a,i){var b=a&&a.getActions();if(b){b.forEach(function(j){if(j.isA("sap.ui.mdc.actiontoolbar.ActionToolbarAction")){j=j.getAction();}if(j.data("IBNData")){i.push(j);}});}return i;}function c1(i,a){var b=this;var j={};var k=function($1){if($1){var _1=Object.keys($1);_1.map(function(a2){if(a2.indexOf("_")!==0&&a2.indexOf("odata.context")===-1){j[a2]={value:$1[a2]};}});}if(i.length){i.forEach(function(a2){var b2=a2.data("IBNData").semanticObject;var c2=a2.data("IBNData").action;b.getShellServices(a).getLinks({semanticObject:b2,action:c2,params:j}).then(function(d2){a2.setVisible(a2.getVisible()&&d2&&d2.length===1);}).catch(function(d2){L.error("Cannot retrieve the links from the shell service",d2);});});}};if(a&&a.getBindingContext()){a.getBindingContext().requestObject().then(function($1){return k($1);}).catch(function($1){L.error("Cannot retrieve the links from the shell service",$1);});}else{k();}}function d1(a,b,i,j){var k=a;if(b){if(j){var $1=e1(b.aCustomBundles,a+"|"+j);k=$1?a+"|"+j:a;}return b.getText(k,i);}b=sap.ui.getCore().getLibraryResourceBundle("sap.fe.core");return b.getText(k,i);}function e1(a,k){if(a.length){for(var i=a.length-1;i>=0;i--){var b=a[i].hasText(k);if(b){return true;}e1(a[i].aCustomBundles,k);}}return false;}function f1(a,b,i,j){i=!i?a.getObject(a.getPath()):i;var k=a.getPath().split("/@")[0];var $1=a.getObject(k).$Type;var _1=g1(a.getModel(),$1);if(_1){k="/"+_1;}if(j){return a.getObject(k+"/"+i+"@Org.OData.Core.V1.OperationAvailable");}if(b){return k+"/"+i;}else{return{sContextPath:k,sProperty:a.getObject(k+"/"+i+"@Org.OData.Core.V1.OperationAvailable/$Path"),sBindingParameter:a.getObject(k+"/"+i+"/@$ui5.overload/0/$Parameter/0/$Name")};}}function g1(a,b){var i=a.getObject("/");for(var k in i){if(typeof i[k]==="object"&&i[k].$Type===b){return k;}}}function h1(a,b){var i=a["@com.sap.vocabularies.Common.v1.Text"],j=i&&((a&&a["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"])||(b&&b["@com.sap.vocabularies.UI.v1.TextArrangement"]));if(j){if(j.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){return"Description";}else if(j.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){return"ValueDescription";}else if(j.$EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"){return"Value";}return"DescriptionValue";}return i?"DescriptionValue":"Value";}function i1(a){var b=a.getModel().getMetaModel();return b.getObject(b.getMetaPath(a.getPath())+"/$Type");}function j1(a,b,i){var j=b,k=a.indexOf("(");if(k>-1){var $1=a.slice(k+1,-1),_1=i1(j);while(_1!==$1){j=j.getBinding().getContext();if(j){_1=i1(j);}else{L.warn("Cannot determine target type to request property value for bound action invocation");return Promise.resolve(undefined);}}}return j.requestObject(i);}function k1(a,b,i,j){var k=i&&i.indexOf("/")===0?N1(i,a.getModel()):j1(b,a,i);return k.then(function($1){return Promise.resolve({vPropertyValue:$1,oSelectedContext:a,sAction:b,sDynamicActionEnabledPath:j});});}function l1(i,a){return Promise.all(a).then(function(b){if(b.length){var j=[],k=[];b.forEach(function($1){if($1){if($1.vPropertyValue){i.getModel().setProperty($1.sDynamicActionEnabledPath,true);j.push($1.oSelectedContext);}else{k.push($1.oSelectedContext);}}});m1(i,b[0].sAction,j,k);}}).catch(function(b){L.trace("Cannot retrieve property value from path",b);});}function m1(i,a,b,j){var k=i.getPath()+"/dynamicActions/"+a,$1=i.getModel();$1.setProperty(k+"/aApplicable",b);$1.setProperty(k+"/aNotApplicable",j);}function n1(a,b,j){var k=[];for(var $1 in b){a.setProperty("dynamicActions/"+$1,{bEnabled:false,aApplicable:[],aNotApplicable:[]});var _1=[],a2=[],b2=b[$1],c2=a.getPath()+"/dynamicActions/"+$1+"/bEnabled";if(typeof b2==="object"&&b2!==null&&b2!==undefined){for(var i=0;i<j.length;i++){var d2=j[i];if(d2){var e2=d2.getObject();var f2=B.transformRecursively(b2,"Binding",function(i2){return B.constant(e2[i2.path]);},true);var g2=B.compileBinding(f2);if(g2==="true"){a.getModel().setProperty(c2,true);_1.push(d2);}else{a2.push(d2);}}}m1(a,$1,_1,a2);}else{var h2=[];for(var i=0;i<j.length;i++){var d2=j[i];if(d2){var e2=d2.getObject();if(b2===null&&!!e2["#"+$1]){a.getModel().setProperty(c2,true);break;}else{h2.push(k1(d2,$1,b2,c2));}}}k.push(l1(a,h2));}}return Promise.all(k);}function o1(a){var b=T.getDataTypeClassName(a);var i=T.getBaseType(b);return F.getOperatorsForType(i);}function p1(a,b){var i=a.filter(function(j){return b.indexOf(j)>-1;});return i.toString()||undefined;}function q1(i){var j=Z1.AllowedExpressionsPrio;i.sort(function(a,b){return j.indexOf(a)-j.indexOf(b);});return i[0];}function r1(a,b,i,j,k,$1){var _1=Z1.getFilterRestrictionsByPath(b,i);var a2=["EQ"];var b2=["EQ","GE","LE","LT","GT","BT","NOTLE","NOTLT","NOTGE","NOTGT"];var c2=["EQ","GE","LE","LT","GT","BT","NE","NOTBT","NOTLE","NOTLT","NOTGE","NOTGT"];var d2=["Contains","NotContains","StartsWith","NotStartsWith","EndsWith","NotEndsWith"];var e2=f.getSupportedOperations();var f2=k==="true"||k===true;var g2=[];var h2=typeof $1==="string"?JSON.parse($1).customData:$1;if(i.getObject(b+"/@com.sap.vocabularies.Common.v1.ResultContext")===true){return a2.toString();}if(h2&&h2.operatorConfiguration&&h2.operatorConfiguration.length>0){g2=f.getFilterOperations(h2.operatorConfiguration);}else{g2=f.getSemanticDateOperations();}var i2=o1(j);if(_1&&_1.FilterAllowedExpressions&&_1.FilterAllowedExpressions[a]){if(f2){i2=e2.concat(i2);}var j2=Z1.getSpecificAllowedExpression(_1.FilterAllowedExpressions[a]);var k2;switch(j2){case"SingleValue":k2=p1(i2,a2);break;case"MultiValue":k2=p1(i2,a2);break;case"SingleRange":var l2=p1(i2,j==="Edm.Date"&&f2?g2:b2);k2=l2?l2:"";break;case"MultiRange":k2=p1(i2,c2);break;case"SearchExpression":k2=p1(i2,d2);break;case"MultiRangeOrSearchExpression":k2=p1(i2,d2.concat(c2));break;default:break;}return k2;}else if(j==="Edm.Date"){g2=f.getSemanticDateOperations();var m2=i2.filter(function(n2){return g2.indexOf(n2)<0;});return m2.toString();}}function s1(a,b){var i=b.substring(0,b.lastIndexOf("/"));var j=a.getObject(i+"/@com.sap.vocabularies.Common.v1.ResultContext");var k={};if(j&&i!==b){k.contextPath=i;k.parameterProperties=Z1.getContextPathProperties(a,i);}return k;}function t1(a,b,i,j){var k=g.getConditions(j,a);if(k){if(!b||b.indexOf(k.operator)>-1){i.push(k);}}return i;}function u1(a,b,i,j,k,$1,_1,a2,b2){var c2=[],d2,e2;if(b2||Z1.isPropertyFilterable(a2,a,$1,true)){d2=b.getSelectOption(i);e2=b2?["EQ"]:Z1.getOperatorsForProperty($1,a,a2);var f2=_1[$1];c2=b2?t1(f2,e2,c2,d2[0]):d2.reduce(t1.bind(null,f2,e2),c2);if(c2.length){if(k){j[k+$1]=j.hasOwnProperty(k+$1)?j[k+$1].concat(c2):c2;}else{j[$1]=j.hasOwnProperty($1)?j[$1].concat(c2):c2;}}}}function v1(a,b,i,j){var k=a.getSelectOptionsPropertyNames(),$1=Z1.getContextPathProperties(i,j),_1=Object.keys($1),a2=Z1.getParameterInfo(i,j),b2=a2.contextPath,c2=a2.parameterProperties,d2=!!a2.contextPath&&c2&&Object.keys(c2).length>0;if(d2){var e2=Object.keys(c2);e2.forEach(function(f2){var g2;if(k.includes("$Parameter."+f2)){g2="$Parameter."+f2;}else if(k.includes(f2)){g2=f2;}else if(f2.startsWith("P_")&&k.includes("$Parameter."+f2.slice(2,f2.length))){g2="$Parameter."+f2.slice(2,f2.length);}else if(f2.startsWith("P_")&&k.includes(f2.slice(2,f2.length))){g2=f2.slice(2,f2.length);}else if(k.includes("$Parameter.P_"+f2)){g2="$Parameter.P_"+f2;}else if(k.includes("P_"+f2)){g2="P_"+f2;}if(g2){u1(b2,a,g2,b,undefined,f2,c2,i,true);}});}_1.forEach(function(f2){var g2;if(k.includes(f2)){g2=f2;}else if(f2.startsWith("P_")&&k.includes(f2.slice(2,f2.length))){g2=f2.slice(2,f2.length);}else if(k.includes("P_"+f2)){g2="P_"+f2;}if(g2){u1(j,a,g2,b,undefined,f2,$1,i,false);}});k.forEach(function(f2){if(f2.indexOf(".")>0&&!f2.includes("$Parameter")){var g2=("/"+f2.replaceAll(".","/")).startsWith(j)?"/"+f2.replaceAll(".","/"):j+"/"+f2.replaceAll(".","/");if(i.getObject(g2.replace("P_",""))){w1(g2,j,a,f2,i,b);}}});return b;}function w1(a,b,j,k,$1,_1){var a2=k.split(".");if(("/"+k.replaceAll(".","/")).startsWith(b)){var b2=("/"+k).replaceAll(".","/"),c2=b2.replace(b+"/","");a2=c2.split("/");}var d2="";var e2=a2[a2.length-1];for(var i=0;i<a2.length-1;i++){if($1.getObject(b+"/"+a2[i].replace("P_","")).$isCollection){d2=d2+a2[i]+"*/";}else{d2=d2+a2[i]+"/";}b=b+"/"+a2[i];}var f2=a.slice(0,a.lastIndexOf("/")),g2=Z1.getContextPathProperties($1,f2),h2=j.getSelectOptionsPropertyNames();var i2=e2;if(g2[e2]){i2=e2;}else if(e2.startsWith("P_")&&g2[e2.replace("P_","")]){i2=e2.replace("P_","");}else if(g2["P_"+e2]&&h2.includes("P_"+e2)){i2="P_"+e2;}if(e2.startsWith("P_")&&_1[d2+i2]){return;}else if(!e2.startsWith("P_")&&_1[d2+i2]){delete _1[d2+i2];u1(f2,j,k,_1,d2,i2,g2,$1,false);}else{u1(f2,j,k,_1,d2,i2,g2,$1,false);}}function x1(a,b,i){var j=Z1.getAppComponent(i);var k=j.getNavigationService();return k.mixAttributesAndSelectionVariant(b,a.toJSONString());}function y1(a,b,i){var j,k="",$1=null;var _1=function(e2,f2,g2){var h2={option:"",sign:"I",low:f2,high:g2};switch(e2){case"Contains":h2.option="CP";break;case"StartsWith":h2.option="CP";h2.low+="*";break;case"EndsWith":h2.option="CP";h2.low="*"+h2.low;break;case"BT":case"LE":case"LT":case"GT":case"NE":case"EQ":h2.option=e2;break;case"EEQ":h2.option="EQ";break;case"Empty":h2.option="EQ";h2.low="";break;case"NotContains":h2.option="CP";h2.sign="E";break;case"NOTBT":h2.option="BT";h2.sign="E";break;case"NotStartsWith":h2.option="CP";h2.low+="*";h2.sign="E";break;case"NotEndsWith":h2.option="CP";h2.low="*"+h2.low;h2.sign="E";break;case"NotEmpty":h2.option="NE";h2.low="";break;case"NOTLE":h2.option="LE";h2.sign="E";break;case"NOTGE":h2.option="GE";h2.sign="E";break;case"NOTLT":h2.option="LT";h2.sign="E";break;case"NOTGT":h2.option="GT";h2.sign="E";break;default:L.warning(e2+" is not supported. "+j+" could not be added to the navigation context");}return h2;};var a2=b.filterConditions;var b2=b.filterConditionsWithoutConflict?b.filterConditionsWithoutConflict:{};var c2=i.propertiesWithoutConflict?i.propertiesWithoutConflict:{};var d2=function(a,j,e2){var f2=a2[j];for(var g2 in f2){var h2=f2[g2];k=(h2.values[0]&&h2.values[0].toString())||"";$1=(h2.values[1]&&h2.values[1].toString())||null;var i2=_1(h2.operator,k,$1);if(i2.option){a.addSelectOption(e2?e2:j,i2.sign,i2.option,i2.low,i2.high);}}};for(var j in a2){if(!a.getSelectOption(j)){if(j==="$editState"){continue;}d2(a,j);}else{if(c2&&j in c2){d2(a,j,c2[j]);}if(j in b2){d2(a,j,b2[j]);}}}return a;}function z1(a){var i=e.isStickySessionSupported(a.getModel().getMetaModel());var b=a.getModel("ui").getProperty("/isEditable");return i&&b;}function A1(a,b,j){if(b&&a&&a.length){for(var i=0;i<a.length;i++){var k=b.getSelectOption("DisplayCurrency"),$1=j&&j.getSelectOption("DisplayCurrency");if(a[i].$PropertyPath==="DisplayCurrency"&&(!k||!k.length)&&$1&&$1.length){var _1=$1[0];var a2=_1["Sign"];var b2=_1["Option"];var c2=_1["Low"];var d2=_1["High"];b.addSelectOption("DisplayCurrency",a2,b2,c2,d2);}}}}function B1(a,b){var i=a.getObject(b+"/").$Key;var j=[];var k=a.getObject(b+"/");for(var $1 in k){if(k[$1].$kind&&k[$1].$kind==="Property"){var _1=a.getObject(b+"/"+$1+"@")||{},a2=i.indexOf($1)>-1,b2=a2||_1["@Org.OData.Core.V1.Immutable"],c2=!_1["@Org.OData.Core.V1.Computed"],d2=!_1["@com.sap.vocabularies.UI.v1.Hidden"];if(b2&&c2&&d2){j.push($1);}}}return j;}function C1(a,b,j,k){return new Promise(function($1,_1){var a2=a.getComponentData(),b2=(a2&&a2.startupParameters)||{},c2=a.getShellServices();if(!c2.hasUShell()){b.map(function(i){var d2=k?"/"+i.$Name:i.getPath().slice(i.getPath().lastIndexOf("/")+1);var e2=k?d2.slice(1):d2;if(b2[e2]){j.setProperty(d2,b2[e2][0]);}});return $1(true);}return c2.getStartupAppState(a).then(function(d2){var e2=d2.getData()||{},f2=(e2.selectionVariant&&e2.selectionVariant.SelectOptions)||[];b.map(function(g2){var h2=k?"/"+g2.$Name:g2.getPath().slice(g2.getPath().lastIndexOf("/")+1);var i2=k?h2.slice(1):h2;if(b2[i2]){j.setProperty(h2,b2[i2][0]);}else if(f2.length>0){for(var i in f2){var j2=f2[i];if(j2.PropertyName===i2){var k2=j2.Ranges.length?j2.Ranges[0]:undefined;if(k2&&k2.Sign==="I"&&k2.Option==="EQ"){j.setProperty(h2,k2.Low);}}}}});return $1(true);});});}function D1(a){var b=[];if(a.parameters){var j=Object.keys(a.parameters)||[];if(j.length>0){j.forEach(function(k){var $1=a.parameters[k];if($1.value&&$1.value.value&&$1.value.format==="binding"){var _1={"LocalProperty":{"$PropertyPath":$1.value.value},"SemanticObjectProperty":k};if(b.length>0){for(var i=0;i<b.length;i++){if(b[i]["LocalProperty"]["$PropertyPath"]!==_1["LocalProperty"]["$PropertyPath"]){b.push(_1);}}}else{b.push(_1);}}});}}return b;}function E1(a,b){var i=[];var j={};var k;var $1=a.controlConfiguration;for(var _1 in $1){if(_1.indexOf("@com.sap.vocabularies.UI.v1.DataPoint")>-1||_1.indexOf("@com.sap.vocabularies.UI.v1.Chart")>-1){if($1[_1].navigation&&$1[_1].navigation.targetOutbound&&$1[_1].navigation.targetOutbound.outbound){var a2=$1[_1].navigation.targetOutbound.outbound;var b2=b[a2];if(b2.semanticObject&&b2.action){if(_1.indexOf("Chart")>-1){k=c.generate(["fe","MicroChartLink",_1]);}else{k=c.generate(["fe","HeaderDPLink",_1]);}var i=Z1.getSemanticObjectMapping(b2);j[k]={semanticObject:b2.semanticObject,action:b2.action,semanticObjectMapping:i};}else{L.error("Cross navigation outbound is configured without semantic object and action for "+a2);}}}}return j;}function F1(a,b){var j=typeof b==="string"?JSON.parse(b):b;for(var i=0;i<j.length;i++){var k=(j[i]["LocalProperty"]&&j[i]["LocalProperty"]["$PropertyPath"])||(j[i]["@com.sap.vocabularies.Common.v1.LocalProperty"]&&j[i]["@com.sap.vocabularies.Common.v1.LocalProperty"]["$Path"]);var $1=j[i]["SemanticObjectProperty"]||j[i]["@com.sap.vocabularies.Common.v1.SemanticObjectProperty"];if(a.getSelectOption(k)){var _1=a.getSelectOption(k);a.removeSelectOption(k);a.massAddSelectOption($1,_1);}}return a;}function G1(a,b,i,j){return new Promise(function(k){var $1=a.getObject(b+"@com.sap.vocabularies.Common.v1.SemanticObject");var _1=a.getObject(b+"@com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions");var a2,b2;a2=[{semanticObject:$1}];b2={semanticObject:$1};k({semanticObjectPath:b,semanticObjectForGetLinks:a2,semanticObject:b2,unavailableActions:_1});}).catch(function(k){L.error("Error in fnGetSemanticObjectsFromPath",k);});}function H1(a,b,j,$1){return Promise.all(a).then(function(_1){var a2,b2,c2,d2=[];var e2={};var f2=function(n2,o2){for(var p2 in o2){if(p2===n2){return true;}else{return false;}}};for(var k=0;k<_1.length;k++){a2=_1[k];if(a2&&a2.length>0&&a2[0]!==undefined){var g2={},h2={},i2;for(var i=0;i<a2.length;i++){d2.push([]);var j2=false;var k2=false;for(var l2=0;l2<a2[i][0].length;l2++){b2=a2[i][0][l2];c2=b2&&b2.intent.split("-")[1];if(!(b2&&b2.intent&&b2.intent.indexOf($1)===0)){j2=true;if(!f2(c2,b[k].unavailableActions)){d2[i].push(b2);k2=true;}}}h2={semanticObject:b[k].semanticObject,path:b[k].path,HasTargets:k2,HasTargetsNotFiltered:j2};if(g2[b[k].semanticObject]===undefined){g2[b[k].semanticObject]={};}i2=b[k].path.replace(/\//g,"_");if(g2[b[k].semanticObject][i2]===undefined){g2[b[k].semanticObject][i2]={};}g2[b[k].semanticObject][i2]=Object.assign(g2[b[k].semanticObject][i2],h2);}var m2=Object.keys(g2)[0];if(Object.keys(e2).includes(m2)){e2[m2]=Object.assign(e2[m2],g2[m2]);}else{e2=Object.assign(e2,g2);}d2=[];}}if(Object.keys(e2).length>0){j.setProperty("semanticsTargets",o(e2,j.getProperty("semanticsTargets")));return e2;}}).catch(function(i){L.error("fnUpdateSemanticTargetsModel: Cannot read links",i);});}function I1(a,b,i,j){var k;var $1=e.getEntitySetPath(j),_1=$1,a2=_1?_1.slice(1):_1;var b2=m.getInvolvedDataModelObjects(i.createBindingContext("/"+a2));k=n.createConverterContextForMacro(b2.startingEntitySet.name,i,a&&a.getDiagnostics(),o,b2.contextLocation,undefined);return Z1.getSemanticObjectsFromPath(i,j,b,k);}function J1(a,b){var k=function(j,o2){return $1(j,o2,[]);};var $1=function(j,o2,p2){if(!j){return p2;}if(j instanceof Array){for(var i in j){p2=p2.concat($1(j[i],o2,[]));}return p2;}if(j[o2]){p2.push(j[o2]);}if(typeof j=="object"&&j!==null){var q2=Object.keys(j);if(q2.length>0){for(i=0;i<q2.length;i++){p2=p2.concat($1(j[q2[i]],o2,[]));}}}return p2;};var _1=function(j){return j.filter(function(o2,p2){return j.indexOf(o2)===p2;});};var a2=a.getView();var b2=a2.getBindingContext("internal");if(b2){var c2=[];var d2=a.getOwnerComponent();var e2=sap.ui.core.Component.getOwnerComponentFor(d2);var f2=e2.getMetaModel();var g2=d2.getModel(b).getData();if(JSON.stringify(g2)==="{}"){g2=d2.getModel(b)._getObject("/",undefined);}var h2=k(g2,"semanticObjectPath");h2=_1(h2);var i2=Z1.getShellServices(e2);var j2=i2.hrefForExternal();var k2=[];var l2=[];var m2;var n2;if(j2&&j2.indexOf("?")!==-1){j2=j2.split("?")[0];}for(var i=0;i<h2.length;i++){m2=h2[i];c2.push(Z1.getSemanticObjectPromise(e2,a2,f2,m2));}if(c2.length===0){return Promise.resolve();}else{Promise.all(c2).then(function(o2){var p2=[],q2;var r2=o2.filter(function(s2){if(s2.semanticObject!==undefined&&s2.semanticObject.semanticObject&&typeof s2.semanticObject.semanticObject==="object"){q2=B.compileBinding(B.bindingExpression(s2.semanticObject.semanticObject.$Path));s2.semanticObject.semanticObject=q2;s2.semanticObjectForGetLinks[0].semanticObject=q2;return true;}else if(s2){return s2.semanticObject!==undefined;}else{return false;}});for(var j=0;j<r2.length;j++){n2=r2[j];if(n2&&n2.semanticObject&&!(n2.semanticObject.semanticObject.indexOf("{")===0)){k2.push(n2.semanticObjectForGetLinks);l2.push({semanticObject:n2.semanticObject.semanticObject,unavailableActions:n2.unavailableActions,path:r2[j].semanticObjectPath});p2.push(i2.getLinksWithCache([n2.semanticObjectForGetLinks]));}}return Z1.updateSemanticTargets(p2,l2,b2,j2);}).catch(function(j){L.error("fnGetSemanticTargetsFromTable: Cannot get Semantic Objects",j);});}}else{return Promise.resolve();}}function K1(a,b){var i=Z1.FilterRestrictions;if(b===i.REQUIRED_PROPERTIES||b===i.NON_FILTERABLE_PROPERTIES){var j=[];if(a&&a[b]){j=a[b].map(function($1){return $1.$PropertyPath;});}return j;}else if(b===i.ALLOWED_EXPRESSIONS){var k={};if(a&&a.FilterExpressionRestrictions){a.FilterExpressionRestrictions.forEach(function($1){if(k[$1.Property.$PropertyPath]){k[$1.Property.$PropertyPath].push($1.AllowedExpressions);}else{k[$1.Property.$PropertyPath]=[$1.AllowedExpressions];}});}return k;}return a;}function L1(a,b){var i={},j=Z1.FilterRestrictions,k=a?b.getObject(a+"@Org.OData.Capabilities.V1.FilterRestrictions"):{};i[j.REQUIRED_PROPERTIES]=K1(k,j.REQUIRED_PROPERTIES)||[];i[j.NON_FILTERABLE_PROPERTIES]=K1(k,j.NON_FILTERABLE_PROPERTIES)||[];i[j.ALLOWED_EXPRESSIONS]=K1(k,j.ALLOWED_EXPRESSIONS)||{};var $1=a.split("/");if($1.length>2){var _1=$1[$1.length-1];$1.splice(-1,1);var a2=$1.join("/");var b2=Z1.getNavigationRestrictions(b,a2,_1);var c2=b2&&b2["FilterRestrictions"];i[j.REQUIRED_PROPERTIES].concat(K1(c2,j.REQUIRED_PROPERTIES)||[]);i[j.NON_FILTERABLE_PROPERTIES].concat(K1(c2,j.NON_FILTERABLE_PROPERTIES)||[]);i[j.ALLOWED_EXPRESSIONS]=o({},K1(c2,j.ALLOWED_EXPRESSIONS)||{},i[j.ALLOWED_EXPRESSIONS]);}return i;}function M1(a,b,i,j){i=i||{};if(j){return j.templateControlFragment(a,b,i.view).then(function(k){return j.targets==="xmlTree"&&k.length>0?k[0]:k;});}else{return P1().then(function(){return p.process(X.loadTemplate(a,"fragment"),{name:a},b);}).then(function(k){var $1=k.firstElementChild;if(!!i.isXML&&$1){return $1;}return q.load({id:i.id,definition:k,controller:i.controller});});}}function N1(a,b){if(!a||!b){return Promise.resolve(null);}var i=b.getMetaModel();var j=a.split("/").filter(Boolean),k=j.pop(),$1=j.join("/"),_1=$1&&i.getObject("/"+$1);if(_1&&_1.$kind==="Singleton"){var a2=j[j.length-1],b2=b.bindProperty("/"+a2+"/"+k);return b2.requestValue();}return Promise.resolve(null);}function O1(a,b,i){var j;var k=function(){if(j){if(!j.events){j.events={};}if(!j.events[b]){j.events[b]=i;}else{var $1=j.events[b];j.events[b]=function(){i.apply(this,arguments);$1.apply(this,arguments);};}}};if(a.isA("sap.ui.mdc.ChartNew")){a.innerChartBound().then(function(){j=a.getControlDelegate()._getChart(a).getBindingInfo("data");k();}).catch(function($1){L.error($1);});}else{j=a.data("rowsBindingInfo");k();}}function P1(){return new Promise(function(a,b){sap.ui.require(["sap/fe/macros/macroLibrary"],function(){a();});});}function Q1(a,b,i,j){var k=b.startsWith("/")?b:"/"+b,$1=i.startsWith("/")?i:"/"+i,_1=function(b2,c2){return b2===c2||(j==="includingDependents"&&b2.startsWith(c2));},a2=function(b2){var c2=e.getEntitySetPath(b2);var d2=c2.indexOf("$NavigationPropertyBinding")>-1&&a.getObject(c2);return d2?"/"+d2:b2;};if(!_1(k,$1)){k=a2(k);if(!_1(k,$1)){$1=a2($1);}else{return true;}}return _1(k,$1);}function R1(a,b){var i=[],j=a.getModel().getMetaModel(),k=a.getModel("internal"),$1=k.getProperty("/refreshStrategyOnAppRestore")||{};if(b){b.forEach(function(_1){var a2=_1.data("targetCollectionPath");for(var b2 in $1){var c2=$1[b2];if(Z1.isPathApplicableToContextPath(j,a2,b2,c2)){i.push(_1);}}});}return i;}function S1(a,b){var i=a.getModel().getMetaModel(),j=a.getModel("internal"),k=j.getProperty("/refreshStrategyOnAppRestore"),$1;if(b){for(var _1 in k){var a2=k[_1];if(Z1.isPathApplicableToContextPath(i,b,_1,a2)){$1=a2;if($1==="includingDependents"){break;}}}}return $1;}function T1(a){var b=a.getViewData(),i=b&&(b.contextPath||"/"+b.entitySet);return Z1.getControlRefreshStrategyForContextPath(a,i);}function U1(a){var b=a&&a.getModel&&a.getModel(),i=b&&b.getMetaModel&&b.getMetaModel(),j=a&&a.getPath&&a.getPath();return i&&j&&i.getMetaPath&&i.getMetaPath(j);}function V1(a,b){var i=a.getModel().getMetaModel(),j;if(b&&typeof b==="object"){var k=b;var $1=k.getRootBinding();if(k===$1){j=i.getMetaPath(k.getPath());}else{var _1=$1.getPath();var a2=k.getPath();j=i.getMetaPath(_1+"/"+a2);}}else if(typeof b==="string"){if(b.startsWith("/")){j=i.getMetaPath(b);}else{var b2=a.getBindingContext();var c2=b2.getPath();j=i.getMetaPath(c2+"/"+b);}}return j;}function W1(a,b,i){return((a.intents&&((b&&i&&a.intents[b+"-"+i])||(b&&a.intents[b])))||a["defaultBehavior"]||a["_feDefault"]);}function X1(a,b){if(a&&a.getModel("viewData")&&a.getModel("internal")){var i=a.getModel("viewData");var j=i.getObject("/refreshStrategyOnAppRestore");if(j){var k=a.getModel("internal");var $1=Z1.getRefreshStrategyForIntent(j,b&&b.semanticObject,b&&b.action);k.setProperty("/refreshStrategyOnAppRestore",$1);}}}function Y1(a){var i=a.getBindingContext("internal");var b=a.getController();var j=b.viewState;var k=Promise.resolve();if(i.getProperty("restoreStatus")==="pending"){if(j.refreshViewBindings){k=j.refreshViewBindings();k.then(function(){L.info("FE V4: Refresh was triggered successfull: "+a.getId());}).catch(function($1){L.warning("FE V4: Refresh was unsuccessfull: "+a.getId(),$1);});}k.then(function(){j.onRestore();i.setProperty("restoreStatus","done");}).catch(function($1){L.warning("FE V4: Restore was unsuccessfull: "+a.getId());});}return k;}var Z1={isPropertyFilterable:w,isFieldControlPathInapplicable:W,removeSensitiveData:Y,fireButtonPress:J,getTargetView:N,hasTransientContext:H,updateRelatedAppsDetails:U,resolveStringtoBoolean:R,getAppComponent:K,processDataLossConfirmation:Q,getMandatoryFilterFields:a1,getContextPathProperties:$,getParameterInfo:s1,updateDataFieldForIBNButtonsVisibility:c1,getTranslatedText:d1,getEntitySetName:g1,getActionPath:f1,computeDisplayMode:h1,setActionEnablement:n1,isStickyEditMode:z1,getOperatorsForProperty:r1,addSelectionVariantToConditions:v1,addExternalStateFiltersToSelectionVariant:y1,addPageContextToSelectionVariant:x1,addDefaultDisplayCurrency:A1,getNonComputedVisibleFields:B1,setUserDefaults:C1,getShellServices:x,getIBNActions:b1,getHeaderFacetItemConfigForExternalNavigation:E1,getSemanticObjectMapping:D1,setSemanticObjectMappings:F1,getSemanticObjectPromise:I1,getSemanticTargetsFromPageModel:J1,getSemanticObjectsFromPath:G1,updateSemanticTargets:H1,getPropertyDataType:r,getNavigationRestrictions:t,getSearchRestrictions:s,getFilterRestrictionsByPath:L1,getSpecificAllowedExpression:q1,requestSingletonProperty:N1,templateControlFragment:M1,addEventToBindingInfo:O1,FilterRestrictions:{REQUIRED_PROPERTIES:"RequiredProperties",NON_FILTERABLE_PROPERTIES:"NonFilterableProperties",ALLOWED_EXPRESSIONS:"FilterAllowedExpressions"},AllowedExpressionsPrio:["SingleValue","MultiValue","SingleRange","MultiRange","SearchExpression","MultiRangeOrSearchExpression"],fnProcessDataLossOrDraftDiscardConfirmation:O,isPathApplicableToContextPath:Q1,getControlsForRefresh:R1,getViewRefreshInfo:T1,getMetaPathForContext:U1,getAbsoluteMetaPathForListBinding:V1,getControlRefreshStrategyForContextPath:S1,getRefreshStrategyForIntent:W1,storeControlRefreshStrategyForHash:X1,restoreView:Y1};return Z1;});
