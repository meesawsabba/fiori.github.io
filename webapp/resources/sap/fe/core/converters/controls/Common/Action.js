/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/helpers/StableIdHelper","sap/fe/core/helpers/BindingExpression","sap/fe/core/formatters/FPMFormatter","sap/fe/core/converters/helpers/BindingHelper"],function(M,C,I,S,B,f,a){"use strict";var _={};var b=a.bindingContextPathVisitor;var g=B.greaterOrEqual;var c=B.and;var d=B.ifElse;var e=B.equal;var r=B.resolveBindingString;var h=B.isConstant;var j=B.formatResult;var k=B.or;var l=B.compileBinding;var m=B.bindingExpression;var p=B.annotationExpression;var q=S.replaceSpecialChars;var s=I.CustomActionID;var P=C.Placement;var A=M.ActionType;function t(i){return x(i)||w(i)||v(i)||u();}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function v(o,i){if(!o)return;if(typeof o==="string")return y(o,i);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(o,i);}function w(i){if(typeof Symbol!=="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i);}function x(i){if(Array.isArray(i))return y(i);}function y(n,o){if(o==null||o>n.length)o=n.length;for(var i=0,O=new Array(o);i<o;i++){O[i]=n[i];}return O;}var z;(function(z){z["Accept"]="Accept";z["Attention"]="Attention";z["Back"]="Back";z["Critical"]="Critical";z["Default"]="Default";z["Emphasized"]="Emphasized";z["Ghost"]="Ghost";z["Negative"]="Negative";z["Neutral"]="Neutral";z["Reject"]="Reject";z["Success"]="Success";z["Transparent"]="Transparent";z["Unstyled"]="Unstyled";z["Up"]="Up";})(z||(z={}));_.ButtonType=z;function D(i,n,o){var O;var Q={};var R=[];var T=function(U){var V=i[U];if(V.type===A.Menu){var W,X;var Y=[];var Z=false;var $=(W=(X=V.menu)===null||X===void 0?void 0:X.map(function(a1){var b1,c1,d1;var e1=n.find(function(e1){return e1.key===a1;});if(!e1){e1=i[a1];}if(((b1=e1)!==null&&b1!==void 0&&b1.visible||((c1=e1)===null||c1===void 0?void 0:c1.type)===A.DataFieldForAction||((d1=e1)===null||d1===void 0?void 0:d1.type)===A.DataFieldForIntentBasedNavigation)&&!o.find(function(f1){return f1.key===a1;})){Z=l(k(r(e1.visible,"boolean"),r(Z,"boolean")));Y.push(e1);}return a1;}))!==null&&W!==void 0?W:[];if(Y.length){V.visible=Z;V.menu=Y;}else{$=[U];}R=[].concat(t(R),t($));}if(o.find(function(a1){return a1.key===U;})){V.visible=false;}Q[U]=V;};for(var U in i){T(U);}(O=R)===null||O===void 0?void 0:O.forEach(function(U){return delete Q[U];});return Q;}var E=function(i){var o={};i.forEach(function(n){var O;if(n!==null&&n!==void 0&&(O=n.menu)!==null&&O!==void 0&&O.length){n.menu.reduce(function(Q,R){var T=R.key;if(T&&!Q[T]){Q[T]=true;}return Q;},o);}});return i.filter(function(n){return!o[n.key];});};_.removeDuplicateActions=E;var F=function(i,n,o){if(n&&i.enabled===undefined){return undefined;}return H(i,o);};function G(i,n,o,O,Q,R,T){var U={};var V=function(W){var X,Y,Z;var $=i[W];var a1=((X=$.press)===null||X===void 0?void 0:X.lastIndexOf("."))||-1;var b1=(o===null||o===void 0?void 0:o.some(function(c1){return c1.key===W;}))||false;if($.facetName){T=$.facetName;}U[W]={id:o!==null&&o!==void 0&&o.some(function(c1){return c1.key===W;})?W:s(W),visible:$.visible===undefined?"true":$.visible,enabled:F($,b1,n),handlerModule:$.press&&$.press.substring(0,a1).replace(/\./gi,"/"),handlerMethod:$.press&&$.press.substring(a1+1),press:$.press,type:$.menu?A.Menu:A.Default,text:$.text,noWrap:$.__noWrap,key:q(W),enableOnSelect:$.enableOnSelect,defaultValuesExtensionFunction:$.defaultValuesFunction,position:{anchor:(Y=$.position)===null||Y===void 0?void 0:Y.anchor,placement:$.position===undefined?P.After:$.position.placement},isNavigable:L($,O,Q),requiresSelection:$.requiresSelection===undefined?false:$.requiresSelection,enableAutoScroll:N($),menu:(Z=$.menu)!==null&&Z!==void 0?Z:[],facetName:$.inline?T:undefined};};for(var W in i){V(W);}return D(U,o!==null&&o!==void 0?o:[],R!==null&&R!==void 0?R:[]);}_.getActionsFromManifest=G;function H(i,n){var o=r(i.enabled,"boolean");var O;if(h(o)&&o.value===undefined){O=true;}else if(h(o)&&typeof o.value==="boolean"){O=o.value;}else if(o._type!=="EmbeddedBinding"&&o._type!=="EmbeddedExpressionBinding"){var Q=o.value;O=j([m("/","$view"),Q,m("selectedContexts","internal")],f.customIsEnabledCheck,n.getEntityType());}else{O=o;}return l(d(i.requiresSelection===true,c(g(m("numberOfSelectedContexts","internal"),1),O),O));}function J(i,n){var o;if((n===null||n===void 0?void 0:n.isBound)!==true){return true;}if(n!==null&&n!==void 0&&(o=n.parameters)!==null&&o!==void 0&&o.length){var O,Q;var R=n===null||n===void 0?void 0:n.parameters[0].fullyQualifiedName,T=p(n===null||n===void 0?void 0:(O=n.annotations.Core)===null||O===void 0?void 0:O.OperationAvailable,[],undefined,function(U){return b(U,i,R);});if((n===null||n===void 0?void 0:(Q=n.annotations.Core)===null||Q===void 0?void 0:Q.OperationAvailable)!==undefined){return l(e(T,true));}}return true;}_.getEnabledForAnnotationAction=J;function K(i){var n=[];i.forEach(function(o){var O={"LocalProperty":{"$PropertyPath":o.LocalProperty.value},"SemanticObjectProperty":o.SemanticObjectProperty};n.push(O);});return n;}_.getSemanticObjectMapping=K;function L(i,n,o){var O,Q;var R=true;if(o){var T=n&&(n.detail||n.display);R=T!==null&&T!==void 0&&T.route?true:false;}if(i&&i.afterExecution&&(((O=i.afterExecution)===null||O===void 0?void 0:O.navigateToInstance)===false||((Q=i.afterExecution)===null||Q===void 0?void 0:Q.enableAutoScroll)===true)||!R){return false;}return true;}_.isActionNavigable=L;function N(i){var n;return(i===null||i===void 0?void 0:(n=i.afterExecution)===null||n===void 0?void 0:n.enableAutoScroll)===true;}_.enableAutoScroll=N;return _;},false);
