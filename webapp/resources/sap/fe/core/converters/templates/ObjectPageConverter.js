/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["../ManifestSettings","../controls/ObjectPage/SubSection","../controls/ObjectPage/HeaderFacet","../helpers/ID","../helpers/ConfigurableObject","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/objectPage/HeaderAndFooterAction","../controls/ObjectPage/Avatar","sap/fe/core/helpers/BindingExpression"],function(M,S,H,I,C,A,a,b,B){"use strict";var _={};var c=B.constant;var d=B.ifElse;var n=B.not;var e=B.equal;var f=B.compileBinding;var g=B.bindingExpression;var h=B.annotationExpression;var j=b.getAvatar;var k=a.getHiddenHeaderActions;var l=a.getFooterDefaultActions;var m=a.getHeaderDefaultActions;var r=A.removeDuplicateActions;var o=A.getActionsFromManifest;var P=C.Placement;var p=C.insertCustomElements;var q=I.SectionID;var E=I.EditableHeaderSectionID;var s=I.CustomSectionID;var t=H.getHeaderFacetsFromManifest;var u=H.getHeaderFacetsFromAnnotations;var v=S.createCustomHeaderFacetSubSections;var w=S.createSubSections;var x=S.createCustomSubSections;var T=M.TemplateType;function y(i,Z){var $=Object.keys(i);if(Object.getOwnPropertySymbols){var a1=Object.getOwnPropertySymbols(i);if(Z){a1=a1.filter(function(b1){return Object.getOwnPropertyDescriptor(i,b1).enumerable;});}$.push.apply($,a1);}return $;}function z(Z){for(var i=1;i<arguments.length;i++){var $=arguments[i]!=null?arguments[i]:{};if(i%2){y(Object($),true).forEach(function(a1){D(Z,a1,$[a1]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(Z,Object.getOwnPropertyDescriptors($));}else{y(Object($)).forEach(function(a1){Object.defineProperty(Z,a1,Object.getOwnPropertyDescriptor($,a1));});}}return Z;}function D(i,Z,$){if(Z in i){Object.defineProperty(i,Z,{value:$,enumerable:true,configurable:true,writable:true});}else{i[Z]=$;}return i;}var F=function(i,Z){var $,a1;return(($=i.ID)===null||$===void 0?void 0:$.toString())||((a1=i.Label)===null||a1===void 0?void 0:a1.toString())||Z;};function G(Z,$){var a1,b1;var c1=E();var d1=(a1=Z.getEntityType().annotations)===null||a1===void 0?void 0:(b1=a1.UI)===null||b1===void 0?void 0:b1.HeaderFacets;var e1=d1?w(d1,Z,true):[];var f1=v(Z);var g1=[];if(f1.length>0){var i=0;$.forEach(function(i1){while(e1.length>i&&e1[i].visible==="false"){g1.push(e1[i]);i++;}if(e1.length>i&&(i1.key===e1[i].key||i1.key.slice(i1.key.lastIndexOf("::")+2)===e1[i].key.slice(e1[i].key.lastIndexOf("::")+2))){g1.push(e1[i]);i++;}else{f1.forEach(function(j1){if(i1.key===j1.key){g1.push(j1);}});}});}else{g1=e1;}var h1={id:c1,key:"EditableHeaderContent",title:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_HEADER_SECTION}",visible:"{= ${ui>/editMode} === 'Editable' }",subSections:g1};return h1;}_.createEditableHeaderSection=G;function J(i){var Z,$,a1;var b1=i.getEntityType();var c1=((Z=b1.annotations)===null||Z===void 0?void 0:($=Z.UI)===null||$===void 0?void 0:(a1=$.Facets)===null||a1===void 0?void 0:a1.map(function(d1){return K(d1,i);}))||[];return c1;}function K(i,Z){var $,a1,b1;var c1=q({Facet:i});var d1={id:c1,key:F(i,c1),title:f(h(i.Label)),showTitle:!!i.Label,visible:f(n(e(h(($=i.annotations)===null||$===void 0?void 0:(a1=$.UI)===null||a1===void 0?void 0:(b1=a1.Hidden)===null||b1===void 0?void 0:b1.valueOf()),true))),subSections:w([i],Z)};return d1;}function L(i,Z){var $={};Object.keys(i).forEach(function(a1){$[a1]=N(i[a1],a1,Z);});return $;}function N(i,Z,$){var a1=i.id||s(Z);var b1=i.position;if(!b1){b1={placement:P.After};}var c1;if(!i.subSections){c1=D({},Z,z(z({},i),{},{position:undefined,visible:true}));}else{c1=i.subSections;}var d1=x(c1,$);var e1={id:a1,key:Z,title:i.title,showTitle:!!i.title,visible:i.visible!==undefined?i.visible:true,position:b1,subSections:d1};return e1;}var O=function(i){var Z=m(i);var $=i.getManifestWrapper();var a1=p(Z,o($.getHeaderActions(),i,Z,undefined,undefined,k(i)),{isNavigable:"overwrite",enabled:"overwrite",defaultValuesExtensionFunction:"overwrite"});return r(a1);};_.getHeaderActions=O;var Q=function(i){var Z=i.getManifestWrapper();var $=l(Z.getViewLevel(),i);var a1=p($,o(Z.getFooterActions(),i,$),{isNavigable:"overwrite",enabled:"overwrite",defaultValuesExtensionFunction:"overwrite"});return a1;};_.getFooterActions=Q;var R=function(i){var Z=i.getManifestWrapper();var $=p(J(i),L(Z.getSections(),i),{"title":"overwrite","visible":"overwrite","subSections":{"actions":"merge","title":"overwrite","sideContent":"overwrite"}});$.forEach(function(a1){var b1;(b1=a1.subSections)===null||b1===void 0?void 0:b1.forEach(function(c1){if(c1.type==="Mixed"&&c1.sideContent!=undefined&&c1.content&&c1.content.length>0){if(c1.sideContent){c1.content[0].sideContent=c1.sideContent;c1.sideContent=undefined;}if(c1.actions.length>0){c1.content[0].actions=c1.actions;c1.actions=[];}}});});return $;};_.getSections=R;function U(i){var Z,$;var a1=i.getManifestWrapper();return(((Z=i.getEntityType().annotations)===null||Z===void 0?void 0:($=Z.UI)===null||$===void 0?void 0:$.HeaderFacets)||[]).length>0||Object.keys(a1.getHeaderFacets()).length>0;}function V(i){var Z=i.getManifestWrapper();return d(!U(i),c(false),d(e(Z.isHeaderEditable(),false),c(true),n(e(g("/editMode","ui"),"Editable"))));}var W=function(i){return f(V(i));};_.getShowHeaderContent=W;var X=function(i){return f(n(V(i)));};_.getExpandedImageVisible=X;var Y=function(i){var Z,$;var a1=i.getManifestWrapper();var b1;var c1=i.getEntityType();var d1=p(u(i),t(a1.getHeaderFacets()));var e1=O(i);var f1=Q(i);if(a1.isHeaderEditable()&&((Z=c1.annotations.UI)!==null&&Z!==void 0&&Z.HeaderFacets||($=c1.annotations.UI)!==null&&$!==void 0&&$.HeaderInfo)){b1=G(i,d1);}var g1=R(i);return{template:T.ObjectPage,header:{visible:a1.getShowObjectPageHeader(),section:b1,facets:d1,actions:e1,showContent:W(i),hasContent:U(i),avatar:j(i),title:{expandedImageVisible:X(i)}},sections:g1,footerActions:f1,showAnchorBar:a1.getShowAnchorBar(),useIconTabBar:a1.useIconTabBar()};};_.convertPage=Y;return _;},false);
