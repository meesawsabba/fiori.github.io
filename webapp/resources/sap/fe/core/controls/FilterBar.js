/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/mdc/FilterBar","sap/ui/mdc/filterbar/FilterBarBaseRenderer","sap/ui/mdc/filterbar/aligned/FilterItemLayout","sap/fe/core/controls/filterbar/VisualFilterContainer","sap/fe/core/controls/filterbar/FilterContainer"],function(M,F,a,V,b){"use strict";var c=M.extend("sap.fe.core.controls.FilterBar",{metadata:{properties:{initialLayout:{type:"string",defaultValue:"compact"}},associations:{toggleControl:{type:"sap.m.SegmentedButton",multiple:false}}},renderer:F});c.prototype.setToggleControl=function(t){if(typeof t==="string"){this._oSegmentedButton=sap.ui.getCore().byId(t);}else{this._oSegmentedButton=t;}if(this.getToggleControl()&&this._oSegmentedButton){this._oSegmentedButton.detachEvent("select",this._toggleLayout.bind(this));}if(this._oSegmentedButton){this._oSegmentedButton.attachEvent("select",this._toggleLayout.bind(this));}this.setAssociation("toggleControl",t,true);};c.prototype._toggleLayout=function(){if(!this._oSecondaryFilterBarLayout){this._oSecondaryFilterBarLayout=new V();}if(this._oSecondaryFilterBarLayout.isA("sap.fe.core.controls.filterbar.VisualFilterContainer")){this.setShowAdaptFiltersButton(false);}else{this.setShowAdaptFiltersButton(true);}var C=this._oFilterBarLayout;var f=this.getFilterItems();var d=C.getAllFilterFields();var s=this.getSortedFilterFields(f,d);var B=C.getAllButtons();var v=C.getAllVisualFilterFields&&C.getAllVisualFilterFields();if(this._oSecondaryFilterBarLayout.isA("sap.fe.core.controls.filterbar.VisualFilterContainer")){this._oSecondaryFilterBarLayout.setAllFilterFields(s,v);}this._oFilterBarLayout=this._oSecondaryFilterBarLayout;var t=this;d.forEach(function(o,i){C.removeFilterField(o);t._oFilterBarLayout.insertFilterField(o,i);});B.forEach(function(o){C.removeButton(o);t._oFilterBarLayout.addButton(o);});this._oSecondaryFilterBarLayout=C;this.setAggregation("layout",t._oFilterBarLayout,true);this._oFilterBarLayout.rerender();};c.prototype.getSortedFilterFields=function(f,d){var e=[];f.forEach(function(o){e.push(o.getId());});d.sort(function(g,s){var h,S;g.getContent().forEach(function(i){if(i.isA("sap.ui.mdc.FilterField")){h=i.getId();}});s.getContent().forEach(function(i){if(i.isA("sap.ui.mdc.FilterField")){S=i.getId();}});return e.indexOf(h)-e.indexOf(S);});return d;};c.prototype._createInnerLayout=function(){this._oFilterBarLayout=new b();this._cLayoutItem=a;this._oFilterBarLayout.getInner().addStyleClass("sapUiMdcFilterBarBaseAFLayout");this._addButtons();var i=this._oFilterBarLayout.getInner(),t=this;var f={onBeforeRendering:function(){if(t.getInitialLayout()==="visual"){t._toggleLayout();}i.removeEventDelegate(f);}};i.addEventDelegate(f);this.setAggregation("layout",this._oFilterBarLayout,true);};c.prototype.exit=function(){M.prototype.exit.apply(this,arguments);if(this._oSegmentedButton){this._oSegmentedButton.detachEvent("select",this._toggleLayout);delete this._oSegmentedButton;}};return c;});
