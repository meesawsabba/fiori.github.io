// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/isEmptyObject","sap/base/util/ObjectPath","sap/ui/thirdparty/jquery","sap/ushell/utils","sap/ushell/resources","sap/ushell_abap/pbServices/ui2/ODataWrapper","sap/ushell_abap/pbServices/ui2/ODataService"],function(i,O,q,u,r,a,b){"use strict";return function(){function c(j){var C;if(j&&!i(j)){C=JSON.stringify(j);return C.replace(/\{|\}|\\n|,/g,"\n");}return"";}this.createTicket=function(s){var d,B="/sap/opu/odata/UI2/INTEROP/",R="Messages",U,h,C,D,o=sap.ushell.Container;if(!s.text){throw new u.Error("Support Ticket data does not contain text member");}U=O.get("clientContext.navigationData.applicationInformation.url",s);h=O.get("clientContext.navigationData.navigationHash",s);C=O.get("clientContext.navigationData.tileDebugInfo",s);U=typeof U==="string"?U:"";h=typeof h==="string"?h:"";C=typeof C==="string"&&C.length>0?JSON.parse(C).catalogId||"":"";s.url=U;s.catalogId=C;s.subject=r.i18n.getText("contactSupport.Subject",[o.getLogonSystem().getName()+"-"+o.getLogonSystem().getClient(),o.getUser().getId()]).substring(0,40);s.hash=h;s.clientContext=c(s.clientContext);d=new q.Deferred();var e={baseUrl:B,"sap-language":o.getUser().getLanguage(),"sap-client":o.getLogonSystem().getClient()};D=new a.createODataWrapper(e);b.call(this,D,function(){return false;});D.create(R,s,function(f){d.resolve(f.messageNumber);},function(E){d.reject(E);});return d.promise();};};},true);
