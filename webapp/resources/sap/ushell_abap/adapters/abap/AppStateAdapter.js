// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/ObjectPath","sap/ui/thirdparty/jquery","sap/base/Log","sap/ushell/utils","sap/ushell_abap/pbServices/ui2/ODataWrapper","sap/ushell_abap/pbServices/ui2/Error","sap/ushell_abap/pbServices/ui2/ODataService"],function(O,q,L,u,a,S,b){"use strict";var A=function(s,p,c){this._oConfig=c&&c.config;var d=(O.get("services.appState.baseUrl",c)||"/sap/opu/odata/UI2/INTEROP")+"/";var o={baseUrl:d,"sap-language":sap.ushell.Container.getUser().getLanguage(),"sap-client":sap.ushell.Container.getLogonSystem().getClient()};this._oWrapper=a.createODataWrapper(o);function D(m){throw new S(m,"sap.ushell_abap.adapters.abap.AppStateAdapter");}b.call(this,this._oWrapper,D);};A.prototype.saveAppState=function(k,s,v,c,C){var d=new q.Deferred(),r="GlobalContainers",p={id:k,sessionKey:s,component:C,appName:c,value:v};this._oWrapper.create(r,p,function(){d.resolve();},function(e){d.reject(e);L.error(e);});return d.promise();};A.prototype.loadAppState=function(k){var d=new q.Deferred(),r="GlobalContainers(id='"+encodeURIComponent(k)+"')";if(!k){throw new u.Error("The sKey is mandatory to read the data from the persistence layer");}this._oWrapper.openBatchQueue();this._oWrapper.read(r,function(c){d.resolve(c.id,c.value);},function(e){L.error(e);d.reject(e);},false);this._oWrapper.submitBatchQueue(function(){},function(e){L.error(e);d.reject(e);});return d.promise();};return A;},true);
