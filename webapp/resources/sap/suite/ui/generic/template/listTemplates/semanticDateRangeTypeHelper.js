sap.ui.define(["sap/suite/ui/generic/template/genericUtilities/FeError","sap/base/util/deepExtend","sap/base/util/extend","sap/base/util/isEmptyObject"],function(F,d,e,i){"use strict";var c="listTemplates.semanticDateRangeTypeHelper";function g(){var o={useDateRange:{type:"boolean",defaultValue:false},selectedValues:{type:"string",defaultValue:""},exclude:{type:"boolean",defaultValue:true},customDateRangeImplementation:{type:"string",defaultValue:""},defaultValue:{type:"object",properties:{operation:{type:"string"}}},filter:{type:"array",arrayEntries:{type:"object",properties:{path:{type:"string"},equals:{type:"string"},contains:{type:"string"},exclude:{type:"boolean",defaultValue:false}}}}};var G=e({fields:{type:"object",mapEntryProperties:o}},o);return{type:"object",properties:G};}function a(p){return(((p.type==="Edm.DateTime"&&p["sap:display-format"]==="Date")||(p.type==="Edm.String"&&p["com.sap.vocabularies.Common.v1.IsCalendarDate"]&&p["com.sap.vocabularies.Common.v1.IsCalendarDate"].Bool==="true"))&&p["sap:filter-restriction"]==="interval");}function b(D){var C;if(D.customDateRangeImplementation){C=D.customDateRangeImplementation;}else if(D.filter){C=JSON.stringify({module:"sap.ui.comp.config.condition.DateRangeType",operations:{filter:D.filter}});}else if(D.selectedValues){var o={path:"key",contains:D.selectedValues,exclude:D.exclude===undefined||D.exclude};C=JSON.stringify({module:"sap.ui.comp.config.condition.DateRangeType",operations:{filter:[o]}});}else if(D.defaultValue){C=JSON.stringify({module:"sap.ui.comp.config.condition.DateRangeType"});}else{throw new F(c,"Wrong Date Range configuration set in manifest");}return C;}function f(D,p){var r=e({},D.fields&&D.fields[p.name]||D);delete r.fields;return a(p)&&!i(r);}function h(p,l){if(!p.filterSettings||!p.filterSettings.dateSettings){return[];}if(p.filterSettings.dateSettings.useDateRange){if(p.filterSettings.dateSettings.fields){throw new F(c,"Setting 'useDateRange' property as True and maintaining property level configuration for date ranges in Date Settings are mutually exclusive, resulting in error. Change one of these settings in manifest.json as per your requirement.");}}else{return l.property.filter(f.bind(null,p.filterSettings.dateSettings)).map(function(P){return{key:P.name,conditionType:b(p.filterSettings.dateSettings.fields&&p.filterSettings.dateSettings.fields[P.name]||p.filterSettings.dateSettings,P)};});}}function j(S,C){var p=C.getSettings();if(!p.filterSettings||!p.filterSettings.dateSettings){return true;}if(p.filterSettings.dateSettings.useDateRange){return false;}var k=S.getFiltersWithValues();var D=S.getModel().getMetaModel().getODataEntityType(S.getEntityType()).property.filter(f.bind(null,p.filterSettings.dateSettings));return!k.some(function(o){return D.some(function(l){return o.getName()===l.name;});});}function s(p,o,S,u){if(p.filterSettings&&p.filterSettings.dateSettings&&p.filterSettings.dateSettings.fields){var D=p.filterSettings.dateSettings.fields;Object.entries(D).forEach(function(k){var n=-1;if(S&&S.Dates){n=S.Dates.findIndex(function(l){return l.PropertyName===k[0];});}if((n===-1||Object.keys(u).indexOf(k[0])===-1)&&k[1].defaultValue){o.getConditionTypeByKey(k[0]).setOperation(k[1].defaultValue.operation);}});}}return{getDateSettingsMetadata:g,getDateRangeFieldSettings:h,isServiceUrlAllowedBySemanticDateRangeFilter:j,setSemanticDateRangeDefaultValue:s};});
