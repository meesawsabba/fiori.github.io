sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/genericUtilities/controlHelper","sap/suite/ui/generic/template/genericUtilities/testableHelper","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/ObjectPage/controller/SideContentHandler","sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI","sap/suite/ui/generic/template/js/AnnotationHelper","sap/m/Table","sap/ui/layout/DynamicSideContent","sap/suite/ui/generic/template/lib/ShareUtils","sap/ui/dom/jquery/Selectors","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/suite/ui/generic/template/ObjectPage/controller/MultipleViewsHandler","sap/suite/ui/generic/template/lib/MessageUtils","sap/ui/events/KeyCodes","sap/base/util/merge","sap/ui/model/FilterProcessor","sap/suite/ui/generic/template/js/StableIdHelper","sap/uxap/ObjectPageSubSection","sap/ui/core/MessageType","sap/base/util/extend","sap/base/util/UriParameters","sap/base/util/isEmptyObject","sap/ui/dom/getFirstEditableInput","sap/ui/dom/jquery/Focusable","sap/suite/ui/generic/template/genericUtilities/FeError","sap/suite/ui/generic/template/lib/CreateWithDialogHandler","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/Device"],function(C,M,F,S,a,c,t,d,b,E,A,R,D,f,g,h,l,m,K,n,o,p,O,q,r,U,s,u,v,w,y,z,B){"use strict";var G="ObjectPage.controller.ControllerImplementation";var L=new h(G).getLogger();var H=20;var T={};function I(e){e.setSelectedSection(null);}function J(e){return e.data("inlineCreate")==="true";}function N(e){var i=e.getBlocks().concat(e.getMoreBlocks()).concat(e.getActions());return i;}function P(e,j){if(e.getBindings){var k=e.getBindings();for(var i=0;i<k.length;i++){P(k[i],j);}}else{var x=e.getType();e.setType(x,j);}}var Q=/[A-Za-z].*[A-Za-z]/;var V={getMethods:function(W,X,Y){var Z={};var $=d.getControllerBase(W,X,Y);W.oController=Y;var _;var a1;var b1=new b(Y,X,X.oComponentUtils.stateChanged);var c1;var d1;var e1;var f1;var g1;var h1=Object.create(null);var i1=null;var j1=[];var k1=null;var l1=null;var m1=null;var n1;var o1;var p1;function q1(e){var i=e.getParameter("bindingParams");i.parameters=i.parameters||{};i.parameters.usePreliminaryContext=true;i.parameters.bCanonicalRequest=X.oServices.oApplication.mustRequireRequestsCanonical();i.parameters.batchGroupId="facets";return i;}function r1(){L.info("Activate object");var e=X.oServices.oCRUDManager.activateDraftEntity();var i=_.getModel("ui");var j=i.getProperty("/createMode");e.then(function(x){F1();if(j){m.showSuccessMessageIfRequired(X.oCommonUtils.getText("OBJECT_CREATED"),X.oServices);}else{m.showSuccessMessageIfRequired(X.oCommonUtils.getText("OBJECT_SAVED"),X.oServices);}var a3=Y.getOwnerComponent();X.oServices.oViewDependencyHelper.setAllPagesDirty([a3.getId()]);X.oServices.oViewDependencyHelper.unbindChildren(a3);X.oServices.oApplication.invalidatePaginatorInfo();var b3=a3.getNavToListOnSave();X.oServices.oApplication.navigateAfterActivation(!b3&&x.context);},Function.prototype);e.catch(function(){X.oCommonUtils.executeForAllInformationObjects("smartTable",function(x){x.onSaveWithError();});});var k={activationPromise:e};X.oComponentUtils.fire(Y,"AfterActivate",k);}function s1(e){var i=Y.getView();var j=i.getModel();var k=X.oComponentUtils.isComponentDirty();var x=j.getPendingChanges();var a3=Object.create(null);if(x){for(var b3 in x){if(x.hasOwnProperty(b3)){var c3=j.getContext("/"+b3);a3[b3]={context:c3,change:x[b3]};}}}X.oCommonEventHandlers.submitChangesForSmartMultiInput();var d3=X.oServices.oCRUDManager.saveEntity();d3.then(function(f3){if(!e){var g3=X.oComponentUtils.getTemplatePrivateModel();g3.setProperty("/objectPage/displayMode",1);var g3=X.oComponentUtils.getTemplatePrivateModel();var h3=g3.getProperty("/objectPage/mHandleEnabledTableToolbar");for(var i3 in h3){if(h3[i3]){X.oCommonUtils.setEnabledToolbarButtons(Y.byId(i3));delete h3[i3];}}W.setEditable(false);}t1(f3,i,k,a3,e);});d3.catch(function(){X.oCommonUtils.executeForAllInformationObjects("smartTable",function(f3){f3.onSaveWithError();});});var e3={saveEntityPromise:d3};X.oComponentUtils.fire(Y,"AfterSave",e3);}function t1(e,i,j,k,x){var a3=_.getModel("ui");var b3=a3.getProperty("/createMode");var c3=Y.getOwnerComponent();X.oServices.oViewDependencyHelper.setParentToDirty(c3,c3.getEntitySet(),1);X.oServices.oViewDependencyHelper.unbindChildren(c3);var d3=c3.getNavToListOnSave();var e3=!d3||x;if(e3){if(b3){X.oComponentUtils.adaptUrlAfterNonDraftCreateSaved(i.getBindingContext(),x);}t2(_);}else{W.navigateUp();}var f3;if(b3){f3="OBJECT_CREATED";}else{f3=j?"OBJECT_SAVED":"OBJECT_NOT_MODIFIED";}m.showSuccessMessageIfRequired(X.oCommonUtils.getText(f3),X.oServices);for(var g3 in k){var h3=k[g3];var i3=h3.context;var j3=h3.change;var k3=Object.keys(j3)||[];var l3=k3.indexOf("__metadata");if(l3>-1){k3.splice(l3,1);}X.oServices.oApplicationController.executeSideEffects(i3,k3);}}function u1(e){var i=e.getSource().getId();v1("SaveAndContEdit",i);}function v1(e,i){var j=function(e,i){var x;var a3;var b3;if(X.oComponentUtils.isDraftEnabled()){x=1;a3=r1;b3="activate";}else{x=3;if(e==="SaveAndContEdit"){a3=s1.bind(null,true);b3=i;}else{a3=s1.bind(null,false);b3="save";}}var c3=X.oComponentUtils.getCRUDActionHandler();X.oCommonUtils.executeIfControlReady(c3.handleCRUDScenario.bind(null,x,a3),b3);};var k=Promise.resolve(Y.beforeSaveExtension());k.then(j.bind(null,e,i),jQuery.noop());}function w1(e){var i=e.getSource();if(J(i)){var j=e.getParameter("bindingParams");if(j.filters&&j.filters.length){var k=o.groupFilters(j.filters);if(!e.getParameter("messageFilterActive")){j.filters=new F({filters:[new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:true}),k],and:true}),new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:false}),new F({filters:[k,new F({path:"HasActiveEntity",operator:"EQ",value1:false})],and:false})],and:true})],and:false});}else{j.filters=k;}}var x=j.sorter[0]&&j.sorter[0].getGroupFunction();var a3=x&&function(e3){var f3=e3.getObject();if(f3.IsActiveEntity||f3.HasActiveEntity){var g3=r({},x(e3));g3.key=g3.key.charAt(0)==="ยง"?"ยง"+g3.key:g3.key;return g3;}return{key:"ยง",text:X.oCommonUtils.getText("NEW_ENTRY_GROUP")};};if(i.data("disableInlineCreateSort")==="false"){var b3=X.oCommonUtils.getMetaModelEntityType(i.getEntitySet());var c3="DraftEntityCreationDateTime";var d3=b3.property.some(function(e3){return e3.name===c3;});if(!d3){c3="HasActiveEntity";}j.sorter.unshift(new S(c3,d3,a3));}}}function x1(){return _.getHeaderTitle();}function y1(e){var i=X.oComponentUtils.getTemplatePrivateModel();var j={shareEmailPressed:function(){var k=i.getProperty("/objectPage/headerInfo/objectTitle");var x=i.getProperty("/objectPage/headerInfo/objectSubtitle");if(x){k=k+" - "+x;}var a3=X.oServices.oApplication.getBusyHelper();if(a3.isBusy()){return;}var b3=Y.getView().getBindingContext();var c3=b3.getObject().IsActiveEntity;var d3=f.getCurrentUrl().then(function(e3){if(c3||c3===undefined){sap.m.URLHelper.triggerEmail(null,k,e3);}else{var f3=X.oServices.oApplication.getDraftSiblingPromise(b3);var g3=sap.ushell.services&&new sap.ushell.services.URLParsing();a3.setBusy(f3.then(function(h3){var i3=g3?e3.split(g3.getHash(e3))[0]+g3.getShellHash(e3)+"&"+h3.sDeepPath:e3;sap.m.URLHelper.triggerEmail(null,k,i3);}));}});a3.setBusy(d3);},shareJamPressed:function(){f.openJamShareDialog(i.getProperty("/objectPage/headerInfo/objectTitle")+" "+i.getProperty("/objectPage/headerInfo/objectSubtitle"));},getModelData:function(){var k=Y.getView().getBindingContext();var x=k.getObject().IsActiveEntity;if(!x){var a3=X.oServices.oApplication.getDraftSiblingPromise(k);var b3=new sap.ushell.services.URLParsing();return a3.then(function(c3){var d3="#"+b3.getShellHash(document.URL)+"&"+c3.sDeepPath;return{serviceUrl:"",title:i.getProperty("/objectPage/headerInfo/objectTitle"),subtitle:i.getProperty("/objectPage/headerInfo/objectSubtitle"),customUrl:d3};});}else{return Promise.resolve().then(function(){return{serviceUrl:"",title:i.getProperty("/objectPage/headerInfo/objectTitle"),subtitle:i.getProperty("/objectPage/headerInfo/objectSubtitle"),customUrl:f.getCustomUrl()};});}}};f.openSharePopup(X.oCommonUtils,e,j);}function z1(){return X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.RelatedAppsSheet",{buttonPressed:function(e){var i=e.getSource();var j=i.getBindingContext("buttons");var k=j.getProperty("link");var x=j.getProperty("param");var a3=k.intent;var b3=a3.split("#")[1].split("-")[0];var c3=a3.split("-")[1].split("?")[0].split("~")[0];var d3={semanticObject:b3,action:c3,parameters:x};X.oCommonUtils.fnProcessDataLossOrDraftDiscardConfirmation(function(){var e3=Y.getView().getBindingContext();X.oCommonEventHandlers.onRelatedAppNavigation(d3,e3);},Function.prototype,"LeaveApp");}},"buttons");}var A1;function B1(){A1=function(e){var i=e.getSource().getParent();var j=X.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=Y.getOwnerComponent();var x=k.getModel("_templPrivGlobal");var a3={objectPage:{currentEntitySet:k.getProperty("entitySet")}};x.setProperty("/generic/multipleViews",a3);var b3=X.oServices.oCRUDManager.deleteEntity();var c3=k.getBindingContext().getPath();var d3=Object.create(null);d3[c3]=b3;var e3={deleteEntityPromise:b3};X.oComponentUtils.fire(Y,"AfterDelete",e3);i.close();};return X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(e){var i=e.getSource().getParent();i.close();},onDelete:function(e){A1(e);}},"delete",Function.prototype,true);}function C1(){var i;var e=X.oServices.oApplication.getBusyHelper();if(e.isBusy()){return;}var j=X.oComponentUtils.getTemplatePrivateModel();var k=(j.getProperty("/objectPage/headerInfo/objectTitle")||"").trim();var x=j.getProperty("/objectPage/headerInfo/objectSubtitle");var a3=X.oComponentUtils.getViewLevel();var i=a3>1;var b3={};b3.title=X.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");b3.text=X.oCommonEventHandlers.getDeleteText(k,x,!i,i);var c3=Promise.resolve(Y.beforeDeleteExtension());c3.then(function(d3){r(b3,d3);B1().then(function(e3){var f3=e3.getModel("delete");f3.setData(b3);e3.open();});},Function.prototype);}function D1(e){var i=e.getParameter("columnInfos");var j=i&&i.length-1;while(j>=0){if(i[j].ignore){i.splice(j,1);}j-=1;}var k=i.reduce(function(a3,b3){if(!b3.type&&!b3.customParseFunction){a3.push(b3);}return a3;},[]);if(k.length>0){var x=X.oCommonUtils.getText("DATA_PASTE_UNSUPPORTED_FORMAT_MESSAGE");M.show(x,{icon:M.Icon.ERROR,title:X.oCommonUtils.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE]});}}function E1(e){var j;var k=e.getSource();var x=k.getId();var a3=x.split("::Table")[0]+"::addEntry";var b3=Y.byId(a3);if(!b3){return;}var c3=e.getParameter("result");if(c3){if(c3.errors){var d3=c3.errors.map(function(m3){return m3.message;});var e3=X.oCommonUtils.getText("DATA_PASTE_ERROR_MESSAGE",[d3.length]);var f3=X.oCommonUtils.getText("DATA_PASTE_ERROR_CORRECTION_MESSAGE");var g3=X.oCommonUtils.getText("DATA_PASTE_ERROR_CORRECTION_NOTE");d3.unshift("");d3.unshift(g3);d3.unshift(f3);M.show(e3,{icon:M.Icon.ERROR,title:X.oCommonUtils.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],details:d3.join("<br>")});}else if(c3.parsedData){j=c3.parsedData;if(j&&j.length){var h3=j.length;var i3;var j3,k3=[];var l3=sap.m.DraftIndicatorState.Saved;for(var i=0;i<h3;i++){i3=i<h3-1;j3=X.oCommonEventHandlers.addEntry(b3,true,undefined,j[i],i3);k3.push(j3);}Promise.all(k3).then(function(){var m3=X.oComponentUtils.getTemplatePrivateGlobalModel();m3.setProperty("/generic/draftIndicatorState",l3);});}}}}function F1(){var e=X.oComponentUtils.getTemplatePrivateModel();var i=e.getProperty("/objectPage/aPasteAttachedTables");var j=i.length;var k;var x;while(j>=0){k=i[j];x=Y.byId(k+"::Table");if(x&&x.isA("sap.ui.comp.smarttable.SmartTable")&&x.hasListeners("paste")){x.detachBeforePaste(D1);x.detachPaste(E1);i.splice(j,1);}j-=1;}}function G1(e){X.oCommonUtils.executeIfControlReady(C1,"delete");}function H1(e,i){var j,k;if(e){k=e.context||(e.targetSiblingKey?e.draftAdministrativeData:e);if(X.oServices.oDraftController.getDraftContext().hasDraft(k)){X.oServices.oViewDependencyHelper.setRootPageToDirty();j=k.context||k;}}if(j){X.oServices.oApplication.invalidatePaginatorInfo();X.oServices.oApplication.switchToDraft(j,e.targetSiblingKey);}else{var x=X.oComponentUtils.getTemplatePrivateModel();x.setProperty("/objectPage/displayMode",2);t2(_);}W.setEditable(true);}var I1;function J1(e){e=!!e&&typeof e==="boolean";var i=X.oServices.oCRUDManager.editEntity(e);i.then(function(j){if(j.draftAdministrativeData){I1(j.draftAdministrativeData.CreatedByUserDescription||j.draftAdministrativeData.CreatedByUser);}else{H1(j,false);}});}I1=function(e){var i;X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:function(){i.close();J1(true);},onCancel:function(){i.close();}},"Dialog").then(function(j){i=j;var k=X.oComponentUtils.getMainComponentUtils();var x=X.oServices.oApplication.getBusyHelper();x.setBusy(k);k.then(function(a3){var b3=a3.getText("DRAFT_LOCK_EXPIRED",[e]);var c3=i.getModel("Dialog");c3.setProperty("/unsavedChangesQuestion",b3);i.open();});});};function K1(){var j="{\"SelectionVariantID\":\"\"}";var k=Y.getOwnerComponent();var a3=k.getEntitySet();var b3=k.getModel();var c3=b3.getMetaModel();var d3=c3.getODataEntitySet(a3);var e3=c3.getODataEntityType(d3.entityType);var f3=e3.property;var g3=[];for(var x in f3){var h3=f3[x];var i3=h3["com.sap.vocabularies.Common.v1.FieldControl"]&&h3["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(i3&&g3.indexOf(i3)<0){g3.push(i3);}}var j3=Y.getView().getBindingContext();var k3=j3.getObject();var l3=new a();for(var i in f3){var m3=f3[i].type;var n3=f3[i].name;var o3=k3[f3[i].name];if(g3.indexOf(n3)>-1){continue;}if(n3&&(o3||m3==="Edm.Boolean")){if(m3==="Edm.Time"&&o3.ms!==undefined){o3=o3.ms;}if(typeof o3!=="string"){try{o3=o3.toString();}catch(e){o3=o3+"";}}l3.addParameter(n3,o3);}}j=l3.toJSONString();return j;}function L1(e,i){var j=true;var k=i.getModel();i=i instanceof R?i.getParent():i;var x=X.oCommonUtils.getDeleteRestrictions(i);var a3=x&&x.Deletable&&x.Deletable.Path;if(a3){j=k.getProperty(a3,e);}return j;}var M1;function N1(e,j,k){var x=[];M1=function(a3){var b3=X.oServices.oApplication.getBusyHelper();var c3=a3.getSource().getParent();x=[];var d3;var e3;var f3=Y.getView().getModel().getObject(j[0].getPath());for(var i=0;i<j.length;i++){if(L1(j[i],e)){x.push(j[i].getPath());}}var g3=X.oServices.oCRUDManager.deleteEntities({pathes:x});b3.setBusy(g3);X.oServices.oApplicationController.executeSideEffects(e.getBindingContext(),[],[e.getTableBindingPath()]);g3.then(function(i3){X.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(e).refresh();if(f3.IsActiveEntity===false){e3=0;}else{e3=i3.length;}d3=x.length-e3;var j3="";if(d3>0){if(c.isUiTable(e.getTable())){var k3=e.getTable().getPlugin("sap.ui.table.plugins.SelectionPlugin");if(k3){k3.clearSelection();}}if(d3>1){j3=X.oCommonUtils.getContextText("DELETE_SUCCESS_PLURAL_WITH_COUNT",e.getId(),null,[d3]);}else{if(e3>0){j3=X.oCommonUtils.getContextText("DELETE_SUCCESS_WITH_COUNT",e.getId(),null,[d3]);}else{j3=X.oCommonUtils.getContextText("ITEM_DELETED",e.getId());}}}if(e3>0){if(e3>1){j3+=j3&&j3+"\n";j3+=X.oCommonUtils.getContextText("DELETE_ERROR_PLURAL_WITH_COUNT",e.getId(),null,[e3]);}else{if(d3>0){j3+="\n";j3+=X.oCommonUtils.getContextText("DELETE_ERROR_WITH_COUNT",e.getId(),null,[e3]);}else{j3+=X.oCommonUtils.getContextText("DELETE_ERROR",e.getId());}}}if(j3){if(e3>0){var l3=!X.oComponentUtils.isDraftEnabled()&&x.length!==1;if(l3){m.removeTransientMessages();M.error(j3);}}else{m.showSuccessMessageIfRequired(j3,X.oServices);}}});var h3={deleteEntitiesPromise:g3,sUiElementId:k,aContexts:j};X.oComponentUtils.fire(Y,"AfterLineItemDelete",h3);c3.close();};return X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(i){var a3=i.getSource().getParent();a3.close();},onDelete:function(i){M1(i);}},"delete",Function.prototype,true);}function O1(e){var i=X.oCommonUtils.getOwnerControl(e);if(!c.isSmartTable(i)){i=i.getParent();}var j=X.oCommonUtils.getSelectedContexts(i);var k=e.getParent().getParent().getId();P1(i,j,k);}function P1(e,j,k){if(j.length===0){M.error(X.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:X.oCommonUtils.getContentDensityClass()});return;}var x=[];var a3;var b3=[];if("getMode"in e.getTable()){a3=e.getTable().getMode();}for(var i=0;i<j.length;i++){if(L1(j[i],e)){x.push(j[i].getPath());}else{b3.push(j[i]);}}var c3={};c3.undeletableCount=0;c3.tableMode=a3;if(j.length>1){c3.title=X.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[j.length]);c3.text=X.oCommonUtils.getContextText("DELETE_SELECTED_ITEMS",e.getId());}else{c3.title=X.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");c3.text=X.oCommonEventHandlers.getSelectedItemContextForDeleteMessage(e,j[0],true);}if(b3.length>0){c3.undeletableText=X.oCommonUtils.getContextText("DELETE_UNDELETABLE_ITEMS",e.getId(),null,[b3.length,j.length]);if(a3==='Delete'){c3.undeletableCount=b3.length;c3.undeletableText=undefined;c3.text=X.oCommonUtils.getText("DELETE_UNDELETABLE_ITEM");}}var d3={sUiElementId:k,aContexts:j};var e3=Promise.resolve(Y.beforeLineItemDeleteExtension(d3));e3.then(function(f3){r(c3,f3);N1(e,j,k).then(function(g3){if(!b3.length){c3.undeletableText=undefined;}var h3=g3.getModel("delete");h3.setData(c3);g3.open();});},Function.prototype);}function Q1(){var i=Y.byId("imageDialog");var e=i?Promise.resolve(i):X.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.ImageDialog",{onImageDialogClose:function(){i.close();}},"headerImage");e.then(function(j){i=j;});return e;}function R1(){var e=X.oComponentUtils.getTemplatePrivateModel();e.setProperty("/objectPage/isHeaderExpanded",true);var i=Y.getView().byId("template::ObjectPage::ObjectPageHeader");i.attachStateChange(function(j){var k=j.getParameter("isExpanded");e.setProperty("/objectPage/isHeaderExpanded",k);});}function S1(){var e;var j=X.oComponentUtils.getTemplatePrivateModel();var k=function(i){return function(x){var a3=x.getSource();var b3=a3.getExternalValue();j.setProperty("/objectPage/headerInfo/"+i,b3);if(i==="objectTitle"){X.oComponentUtils.setText(b3);if(!b3){var c3=X.oComponentUtils.getHeaderDataAvailablePromise();c3.then(function(d3){b3=a3.getExternalValue();if(b3){return;}var e3=Y.getView();var f3=d3.getObject();var g3=e3.getModel("ui");var h3=g3.getProperty("/createMode");if(h3&&f3&&(f3.IsActiveEntity===undefined||f3.IsActiveEntity===false||f3.HasActiveEntity===false)){e=e||X.oCommonUtils.getText("NEW_OBJECT");j.setProperty("/objectPage/headerInfo/objectTitle",e);X.oComponentUtils.setText(e);}});}}};};_.getCustomData().forEach(function(x){var a3=x.getKey();if(a3==="objectTitle"||a3==="objectSubtitle"){var b3=x.getBinding("value");var c3=!b3&&x.getBindingInfo("value");if(!b3&&!c3){j.setProperty("/objectPage/headerInfo/"+a3,x.getValue());return;}var d3=k(a3);if(b3){b3.attachChange(d3);P(b3,"string");}else{c3.events={change:d3};for(var i=0;i<c3.parts.length;i++){c3.parts[i].targetType="string";}}}});}function T1(e){e.preventDefault();var i=X.oCommonUtils.getControlInformation(e,null,true);if(i){if(X.oComponentUtils.isDraftEnabled()){i.navigate();}else{X.oCommonUtils.fnProcessDataLossOrDraftDiscardConfirmation(i.navigate,Function.prototype);}}}function U1(e,j){var k=p1[e];if(k){j.some(function(e3,i){if(e3!==k.controlIds[i]){k=null;return true;}return e3===k.controlId;});}if(!k){k={};var x=Object.create(null);var a3=function(i,h3,i3){if(i3){x[i3.getId()]=h3;}};k.controlId=X.oCommonUtils.getPositionableControlId(j,true,a3);var b3=[];var c3,d3;for(var e3=k.controlId;e3;){b3.push(e3);var f3=x[e3];c3=c3||(f3&&c.isObjectPageSection(f3)&&f3);d3=d3||(f3&&c.isSmartTable(f3)&&f3);e3=f3&&f3.getId();}b3.reverse();k.pathToControlId=b3;if(k.controlId){var g3=Y.byId(k.controlId);if(!c3){d3=null;c3=c.isObjectPageSection(g3)&&g3;}else{d3=d3||(c.isSmartTable(g3)&&g3);}}k.groupers=c3?[c3]:[];if(d3){k.groupers.push(d3);}k.controlIds=j;p1[e]=k;}return k;}function V1(e,i){if(!p1){return"";}var j=U1(e,i);var k=j.groupers;switch(k.length){case 0:return X.oCommonUtils.getText("GENERIC_MESSAGE_GROUP_NAME");case 1:return k[0].getTitle();default:var x=k[0].getTitle();var a3=k[1];var b3=a3.getHeader();return X.oCommonUtils.getText("MESSAGE_GROUP_TABLE",[x,b3]);}}var W1=new S("msg>");function X1(e){switch(e){case q.Error:return 1;case q.Warning:return 2;case q.Success:return 3;case q.Information:return 4;case q.None:return 5;default:return 6;}}function Y1(e,i,j){if(!i){return j?1:0;}if(!j){return-1;}return c.sortChildControls(e,i,j);}W1.fnCompare=function(e,j){var k=U1(e.id,e.controlIds);var x=U1(j.id,j.controlIds);var a3=k.groupers.length===x.groupers.length&&k.groupers.every(function(g3,i){return x.groupers[i]===g3;});if(a3){var b3=X1(e.type)-X1(j.type);if(b3||!(k.controlId||x.controlId)){return b3;}}if(!a3&&(k.groupers.length===1||x.groupers.length===1)&&k.groupers[0]===x.groupers[0]){return k.groupers.length-x.groupers.length;}var c3=k.pathToControlId;var d3=x.pathToControlId;var e3=Math.max(c3.length,d3.length);var f3=sap.ui.getCore();for(var i=0;i<e3;i++){if(c3[i]!==d3[i]){if(i===0){return Y1(_,k.groupers[0],x.groupers[0]);}return Y1(f3.byId(c3[i-1]),(i<c3.length)&&f3.byId(c3[i]),(i<d3.length)&&f3.byId(d3[i]));}}return 0;};function Z1(e){var i=_.getUseIconTabBar();if(!i){return;}var j=U1(e.id,e.controlIds);var k=j.groupers;var x=k.find(function(b3){return c.isObjectPageSection(b3);});var i1=x&&x.getId();var a3=i1&&_.getSelectedSection();if(i1!==a3){_.setSelectedSection(i1);}}function $1(e,i){L.info("Set binding context to "+e,"Subsection: "+i.getId());var j=N(i);j.forEach(function(k){k.setBindingContext(e);});}function _1(e,i,j,k,x,a3){var b3={bWaitForViewportEnter:i,waitFor:{bLayoutFinished:e,bStateApplied:j,bRebindCompleted:k},activeHandler:x||function(c3,d3){if(N(c3).length&&N(c3)[0].getBindingContext()===null){$1(undefined,c3);d3.refresh(null,true,true);}},inActiveHandler:a3||function(c3,d3){$1(null,c3);}};return b3;}function a2(e){var i=e.getBlocks()[0];X.oComponentUtils.onVisibilityChangeOfReuseComponent(true,i);}function b2(e){var i=e.getBlocks()[0];X.oComponentUtils.onVisibilityChangeOfReuseComponent(false,i);}var c2={lazyLoading:_1(false,true,false,true),lazyLoadingAfterHeader:_1(true,true,false,true),activateAfterHeaderDataReceived:_1(true,false,false,true),activateWithBindingChange:_1(false,false,false,true),reuseComponent:_1(true,true,false,true,a2,b2)};function d2(e,i,j,k){if(k instanceof D){k=k.getMainContent()[0];}else if(!k.getContent){return;}k.getContent().forEach(function(x){if(c.isSmartTable(x)){if(i||e[x.getEntitySet()]){if(x.isInitialised()){X.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(x).refresh(null,j);}else{x.attachInitialise(X.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(x).refresh.bind(null,null,j));}if(!i&&Y.getOwnerComponent().getBindingContext()){X.oServices.oApplicationController.executeSideEffects(Y.getOwnerComponent().getBindingContext(),[],[x.getTableBindingPath()]);}}}});}function e2(e){return X.oCommonUtils.getControlInformation(e);}function f2(e){j1.push(e);X.oCommonUtils.getControlInformation(e,function(i,j){var k=N(e);b1.initSideContentInfoObject(k[0]);i.refresh=function(b3,c3,d3){var e3=d2.bind(null,b3,c3,d3);k.forEach(e3);};var x=X.oCommonUtils.getElementCustomData(e).loadingStrategy;var a3=c2[x];i.loadingStrategy=a3||_1(false,false,false,false,Function.prototype,Function.prototype);j.push("subSection");if(!i.loadingStrategy.bWaitForViewportEnter){j.push("subSectionNotWaitingForViewPort");}});}function g2(e){var j=[];for(var i=0;i<e.length;i++){if(e[i].getVisible()){j.push(e[i]);}}return j;}function h2(e){var i=e?e.getSubSections():_.getSections();var j=g2(i);return j.length===1&&!!(e||h2(j[0]));}function i2(e,i){var j=e.getParent();var k="sapSmartTemplatesObjectPageSubSectionGridExpand",x="sapUxAPObjectPageSubSectionFitContainer";while(j){if(j.isA("sap.ui.layout.Grid")){i?j.addStyleClass(k):j.removeStyleClass(k);}else if(j.isA("sap.uxap.ObjectPageSubSection")){i?j.addStyleClass(x):j.removeStyleClass(x);e.setFitContainer(i);return null;}else{L.warning("Unexpected parent "+j.toString()+" in fnHandleUiTableExpand method");}j=j.getParent();}}function j2(e,i){var j="sapUiSizeCompact",k="sapUiSizeCondensed",x;x=document.body;if(!e.bCondensedTableLayout||!(e.bSetFitContainer||i.hasStyleClass("sapUiSizeCondensed"))){return null;}else if(e.bSetFitContainer&&x.classList.contains(j)){i.addStyleClass(k);}else{i.removeStyleClass(k);}}function k2(e,i,j){if(i.isA("sap.m.Table")){i.setGrowingThreshold(j.growingThreshold);i.setGrowingScrollToLoad(j.bGrowingScrollOnLoad);}else if(i.isA("sap.ui.table.Table")){i2(e,j.bSetFitContainer);j2(j,i);}}function l2(e,i,j){var k={growingThreshold:T[i.getId()],bSetFitContainer:false,bGrowingScrollOnLoad:false};var x=Y.getOwnerComponent().mProperties;k.bCondensedTableLayout=x.condensedTableLayout;if(x&&x.sections){var a3=x.sections[j];if(a3&&a3.hasOwnProperty("condensedTableLayout")){k.bCondensedTableLayout=a3.condensedTableLayout;}}var b3;if(_.getUseIconTabBar()){b3=i.getParent();while(b3&&b3.sParentAggregationName!=="sections"){b3=b3.getParent();}}if(h2(b3)){k.growingThreshold=H;k.bGrowingScrollOnLoad=true;k.bSetFitContainer=true;}k2(e,i,k);}function m2(e){var j=_.getSections().filter(function(c3){return(c3.getTitle()==="Header"||!c3._bInternalVisible)?false:true;});var k;for(var i=0;i<j.length;i++){var x=j[i];var a3=x.getId();var b3=_.getSelectedSection();if(a3===b3){k=(e)?j[(i+1===j.length)?0:i+1]:j[(i===0)?j.length-1:i-1];var i1=k.getId();_.setSelectedSection(i1);o2(i1);break;}}}function n2(e){var i=e&&e.getParameter("section");var j=i?i.getId():_.getSelectedSection();var k=e&&e.getParameter("subSection");var x=k&&k.getId();if(j!==i1||x!==k1){L.info("Selected Section: "+j+" and SubSection: "+j);}return{sNewSectionId:j,sNewSubSectionId:x};}function o2(e,i){i1=e;k1=i;X.oComponentUtils.stateChanged();}function p2(e){var i=n2(e);o2(i.sNewSectionId,i.sNewSubSectionId);}function q2(e,i,j,k,x){var a3=A.createP13NColumnKey(x);var b3=A.getBindingForHiddenPath(x);if(b3==="{= !${} }"){e.push(a3);}if(typeof(b3)==="string"){var c3=b3.match(Q)&&b3.match(Q)[0];if(c3&&c3.indexOf("/")>0&&k.navigationProperty){var d3=Y.getOwnerComponent().getEntitySet();var e3=c3.split("/",1)[0];if(j.getODataAssociationSetEnd(k,e3).entitySet===d3){i[a3]=c3.split("/").slice(1).join("/");}}}else if(!b3){e.push(a3);}}function r2(_){var e=_.getModel("ui");var i=X.oComponentUtils.getTemplatePrivateModel();var j=i.getProperty("/objectPage/displayMode");var k=e.getProperty("/createMode")||j===4;var x=e.getProperty("/editable")||j===2;var a3;if(k){a3="Create";}else if(x){a3="Edit";}else{a3="Display";}return a3;}function s2(_,e){if(e==="Display"){var j=_.getHeaderTitle();var k=j.getActions();for(var i=0;i<k.length;i++){if(k[i].getVisible&&k[i].getVisible()&&k[i].getEnabled&&k[i].getEnabled()){return k[i];}}}else{var x=_.getSelectedSection();var a3=_.getUseIconTabBar();if(e1&&!a3){_.setSelectedSection(null);return u(_.getDomRef());}var b3=function(f3,g3){_.setSelectedSection(f3);f3.setSelectedSubSection(g3);$2(g3);var h3=g3.getDomRef();var i3=u(h3);if(i3&&i3.type!=="checkbox"){return i3;}return v(h3).firstFocusableDomRef();};var c3=_.getSections();var d3,e3;c3.some(function(f3){var g3=!!(f3.getId()===x);e3=e3||g3;if(!e3||!f3.getVisible()){return false;}var h3=0;var j1=f3.getSubSections();if(g3){var i3=f3.getSelectedSubSection();var j3=i3&&sap.ui.getCore().byId(i3);h3=(j3&&f3.indexOfSubSection(j3))||0;}for(var i=h3;!d3&&i<j1.length;i++){d3=j1[i].getVisible()&&b3(f3,j1[i]);}return d3;});return d3;}}function t2(_){var e=Y.getOwnerComponent().getModel("_templPrivGlobal");var g1=e.getProperty("/generic/FCL/FCLActionButton");if(!g1){var i=r2(_);if(document.readyState=='complete'){setTimeout(function(){var j=s2(_,i);if(j){j.focus();}},0);}}}function u2(e,j,k,x,a3,b3){var c3=[];var d3=Object.create(null);for(var i=0;i<b3.length;i++){var e3=b3[i];q2(c3,d3,x,a3,e3);}if(!s(d3)||c3.length){j.columnHideInfos={staticHiddenColumns:c3,columnKeyToHiddenPath:d3};k.push("smartTableWithColumnHide");}}function v2(e){return e instanceof O?e:e.getParent&&v2(e.getParent());}function w2(e,j,k){j.push("smartTable");j.push("smartControl");e.oControlStateWrapper=X.oCommonUtils.getControlStateWrapper(k);e.oControlStateWrapper.attachStateChanged(X.oComponentUtils.stateChanged);e.subSection=v2(k);if(k.getUseVariantManagement()){j.push("smartControlWithVariantManagement");e2(e.subSection).loadingStrategy.waitFor.bStateApplied=true;e.afterVariantInitialisePromise=new Promise(function(f3){e.afterVariantInitialiseResolve=f3;});}var x=Y.getOwnerComponent().getModel().getMetaModel();var a3=x.getODataEntitySet(k.getEntitySet());var b3=x.getODataEntityType(a3.entityType);var c3=b3["com.sap.vocabularies.UI.v1.LineItem"];var d3=k.getCustomData();for(var i=0;i<d3.length;i++){if(d3[i].getKey()==="lineItemQualifier"){c3=b3["com.sap.vocabularies.UI.v1.LineItem#"+d3[i].getValue()];break;}}u2(k,e,j,x,b3,c3||[]);var e3=k.getDataStateIndicator();e.onSaveWithError=function(){var f3=e3.isFiltering();if(f3){e3.refresh();}};}function x2(e){return X.oCommonUtils.getControlInformation(e,w2);}function y2(e){var i;var j=e.getSource();if(c.isSmartTable(j)){i=x2(j);}else if(c.isSmartChart(j)){i=A2(j);}if(!m1&&!i.afterVariantInitalisedResolve&&!i.bApplyingVariantFromState){X.oComponentUtils.stateChanged();}}function z2(e,i,j){i.push("smartChart");i.push("smartControl");e.oControlStateWrapper=X.oCommonUtils.getControlStateWrapper(j);e.oControlStateWrapper.attachStateChanged(X.oComponentUtils.stateChanged);if(j&&j.getUseVariantManagement()){i.push("smartControlWithVariantManagement");e.afterVariantInitialisePromise=new Promise(function(k){e.afterVariantInitialiseResolve=k;});}}function A2(e){return X.oCommonUtils.getControlInformation(e,z2);}function B2(e,i,j){i.push("searchField");var k=j.getParent().getParent();var x=c.isMTable(k)?k.getParent():k;e.table=x;var a3=x2(x);a3.searchField=j;}function C2(e){return X.oCommonUtils.getControlInformation(e,B2);}function D2(e){C2(e);}function E2(e){var i=C2(e);i.searchString=e.getSource().getValue();i.table.rebindTable();X.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(i.table).refresh();}function F2(e,i){i.setValue("");if(e.searchString){e.searchString="";e.table.rebindTable();X.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(e.table).refresh();}}function G2(){X.oCommonUtils.executeForAllInformationObjects("searchField",F2);}function H2(e,i){var j=e.getPath();var k=true;for(var x=0;k;x++){var a3=i.getContextByIndex(x);var b3=a3&&a3.getPath();if(b3===j){return x;}else if(!a3){return-1;}}}function I2(e,j){var k=j.getFirstVisibleRow();var x=j.getVisibleRowCount();var a3=e.getPath();for(var i=0;i<x;i++){if(j.getContextByIndex(k+i).getPath()===a3){return j.getRows()[i];}}}function J2(e,i){var j=e.getTable();if(c.isMTable(j)){return;}function k(){var x=H2(i,j);if(x!==-1){j.setFirstVisibleRow(x);setTimeout(function(){var a3=I2(i,j);var b3=a3&&u(a3.getDomRef());if(b3){b3.focus();}},0);}}e.attachEventOnce("dataReceived",k);}function K2(e,i){X.oCommonEventHandlers.addEntry(e,true).then(J2.bind(null,i));}t.testable(J2,"setFocusOnTableRow");t.testable(I2,"getGridTableRow");t.testable(H2,"getGridTableRowIndexFromContext");function L2(e,i){var j=X.oServices.oCRUDManager.getDefaultValues(i,e);if(j instanceof Promise){var k=function(x){M2(x,i);};j.then(k,k);}else{M2(e,i);}}function M2(e,i){var j=X.oCommonUtils.getOwnerControl(i);j=c.isMTable(j)?j.getParent():j;var k=J(j);if(!k){e1=false;f1=true;}if(!i.data("CrossNavigation")&&k){K2(i,j);return;}else if(!i.data("CrossNavigation")&&X.oComponentUtils.isDraftEnabled()){X.oCommonEventHandlers.addEntry(i,false);return;}X.oCommonUtils.fnProcessDataLossOrDraftDiscardConfirmation(function(){X.oCommonEventHandlers.addEntry(i,false,undefined,e);},Function.prototype,"LeaveApp");}function N2(e){var i=p.getStableId({type:"ObjectPageAction",subType:"Create",sFacet:e});X.oCommonUtils.executeIfControlReady(function(j){var k=p.getStableId({type:"ObjectPageAction",subType:"CreateWithDialog",sFacet:e});var x=k&&Y.byId(k);if(x){d1.createWithDialog(x,j);}else{L2(null,j);}},i);}function O2(e,i){var j=i.getId();if(!h1[j]){h1[j]=i.getDataStateIndicator?i.getDataStateIndicator():i.getParent().getDataStateIndicator();}var k=_.getModel("ui");return k.getProperty("/editable");}function P2(){var e=Y.getOwnerComponent().getModel("ui");e.bindProperty("/editable").attachChange(function(){var i=h1;h1=Object.create(null);for(var k in i){var j=i[k];j.refresh();}});}function Q2(e){R2(e);}function R2(e){var i=e.getId();var j="";var k={search:false,filter:false};var x=e.fetchVariant();var a3=false;if(x&&x.filter&&x.filter.filterItems.length>0){k.filter=true;}var b3=e.getToolbar().getContent().filter(function(f3){return f3.sId===e.getToolbar().getId()+'::SearchField';});if(b3.length>0&&b3[0].getValue().trim()!==""){k.search=true;}var c3=X.oComponentUtils.getSettings();for(var d3 in c3.sections){var e3=c3.sections[d3];if(e3.entitySet===e.getEntitySet()&&e3.quickVariantSelection){a3=true;break;}}if(a3){j=X.oCommonUtils.getContextText("NOITEMS_SMARTTABLE_WITH_FILTER_FOR_SEGMENTEDBUTTON",i);}else if(k.search||k.filter){j=X.oCommonUtils.getContextText("NOITEMS_SMARTTABLE_WITH_FILTER",i);}else{j=X.oCommonUtils.getContextText("NOITEMS_SMARTTABLE",i);}e.setNoData(j);}function S2(e){var i=[];if(e.fetchVariant()&&e.fetchVariant().filter&&e.fetchVariant().filter.filterItems){i=e.fetchVariant().filter.filterItems;}var j=e.getId();var k="";var x={search:false,filter:false};if(i&&i.length){x.filter=true;}var a3=e.getToolbar().getContent().filter(function(b3){return b3.sId===e.getToolbar().getId()+'::SearchField';});if(a3.length>0&&a3[0].getValue().trim()!==""){x.search=true;}if(x.search||x.filter){k=X.oCommonUtils.getContextText("NOITEMS_SMARTCHART_WITH_FILTER",j);}else{k=X.oCommonUtils.getContextText("NOITEMS_SMARTCHART",j);}e.getChartAsync().then(function(b3){b3.setCustomMessages({NO_DATA:k});});}W.refreshFacets=function(e){var i=function(j){var k=e2(j);k.refresh(e,false);};_.getSections().forEach(function(j){j.getSubSections().forEach(i);});};W.onComponentActivate=$.onComponentActivate;W.getCurrentState=function(){var e=Object.create(null);var i=X.oServices.oApplication.getStatePreservationMode()==="persistence";function j(f3){return{data:f3,lifecycle:{permanent:true,pagination:i,page:i,session:true}};}if(i1){e.section=j(i1);}if(k1){e.subSection=j(k1);}var k={};X.oCommonUtils.executeForAllInformationObjects("smartControl",function(f3,g3){k[g3.getId()]=f3.oControlStateWrapper.getState();});if(!s(k)){e.smartControls=j(k);}var x=b1.getCurrentState();if(x){e.sideContent=j(x);}var a3=c1.getCurrentState();if(a3){e.multipleViews=j(a3);}e.objectPageLayout=j(a1.getState());var b3=Object.create(null);Y.provideCustomStateExtension(b3);for(var c3 in b3){e["$custom$"+c3]=b3[c3];}var d3=true;var e3=function(f3,g3){if(!(f3 instanceof C)){throw new w(G,"State must always be set with respect to a ControllerExtension");}if(!d3){throw new w(G,"State must always be provided synchronously");}var h3=f3.getMetadata().getNamespace();if(g3){for(var i3 in g3){e["$extension$"+h3+"$"+i3]=g3[i3];}}};Y.templateBaseExtension.provideExtensionStateData(e3);d3=false;return e;};function T2(){n1={bLayoutFinished:false,bStateApplied:false,bRebindCompleted:false};o1=true;}function U2(e){n1[e]=true;W2();}function V2(e){var i=true;for(var j in e.waitFor){if(e.waitFor[j]&&!n1[j]){i=false;break;}}return i;}function W2(){var e=o1?"subSectionNotWaitingForViewPort":"subSection";X.oCommonUtils.executeForAllInformationObjects(e,function(i,j){var k=V2(i.loadingStrategy);if(k){i.loadingStrategy.activeHandler(j,i);}});if(o1){_._triggerVisibleSubSectionsEvents();}}function X2(){if(m1){m1();m1=null;U2("bStateApplied");}}function Y2(){U2("bLayoutFinished");}function Z2(){I(_);Y2();}function $2(e){var i=e2(e);var j=i.loadingStrategy;var k=V2(i.loadingStrategy);if(k){j.activeHandler(e,i);}}W.applyState=function(Z,e){var k=X.oComponentUtils.getHeaderDataAvailablePromise()||Promise.resolve();k.then(function(){var a3=null;var b3=Object.create(null);var c3=Object.create(null);for(var d3 in Z){if(d3.indexOf("$custom$")===0){b3[d3.substring(8)]=Z[d3];}else if(d3.indexOf("$extension$")===0){var e3=d3.substring(11,d3.indexOf("$",11));var f3=c3[e3];if(!f3){f3=Object.create(null);c3[e3]=f3;}var g3=d3.substring(d3.indexOf("$",11)+1,d3.length);f3[g3]=Z[d3];}}Y.applyCustomStateExtension(b3,e);var h3=true;var i3=function(p3){if(!(p3 instanceof C)){throw new w(G,"State must always be retrieved with respect to a ControllerExtension");}if(!h3){throw new w(G,"State must always be restored synchronously");}var e3=p3.getMetadata().getNamespace();return c3[e3];};Y.templateBaseExtension.restoreExtensionStateData(i3,e);h3=false;var j3=Y.getOwnerComponent();var k3=j3.getAppComponent().getObjectPageHeaderType();var l3=j3.getModel("_templPrivGlobal");g1=l3.getProperty("/generic/FCL/FCLActionButton");if(g1===1){var m3=_.getHeaderTitle();var n3=(k3==="Dynamic"?m3.getNavigationActions():m3.getActions());if(n3&&n3.length){for(var i=0;i<n3.length;i++){if(n3[i].getId&&n3[i].getId().indexOf("template::FCLActionButtons")>0){var o3=n3[i].getItems();for(var j=0;j<o3.length;j++){if((o3[j].getId().toUpperCase().indexOf("FULLSCREEN")>0)&&o3[j].getVisible&&o3[j].getVisible()){a3=o3[j];}}}}}setTimeout(function(){l3.setProperty("/generic/FCL/FCLActionButton",0);g1=l3.getProperty("/generic/FCL/FCLActionButton");if(a3){a3.focus();}},0);}});b1.applyState(Z.sideContent,e);c1.applyState(Z.multipleViews,e);a1.setState(Z.objectPageLayout);X.oCommonUtils.executeForAllInformationObjects("smartControl",function(i,j){i.oControlStateWrapper.setState(Z.smartControls&&Z.smartControls[j.getId()]);});if(e){if(i1!==(Z.section||"")){X.oComponentUtils.stateChanged();}X2();Y2();return;}G2();if(Z.section){i1=Z.section;L.info("Restoring Selected Section: "+i1);_.setSelectedSection(i1);if(Z.subSection){var x;j1.some(function(i){if(i.getId()===Z.subSection){x=i;return true;}return false;});if(x){x.getParent().setSelectedSubSection(x);}k1=Z.subSection;L.info("Restoring Selected Subsection: "+k1);}Y2();}else{Promise.all([k,X.oComponentUtils.getNavigationFinishedPromise()]).then(Z2);i1="";}X2();};W.beforeRebind=function(e){p1=Object.create(null);T2();e.then(function(){U2("bRebindCompleted");});if(!m1){l1=new Promise(function(i){m1=i;});}X.oCommonUtils.executeForAllInformationObjects("subSection",function(i,j){i.loadingStrategy.inActiveHandler(j);});};W.afterRebind=function(){L.info("Call of _triggerVisibleSubSectionsEvents (afterRebind)");_._triggerVisibleSubSectionsEvents();};W.applyHeaderContextToSmartTablesDynamicColumnHide=function(e){var i=e.getModel();var j=function(k,x,a3){if(s(x.columnHideInfos.columnKeyToHiddenPath)){return;}var b3=x.columnHideInfos.staticHiddenColumns.slice();var c3=k&&j.bind(null,false,x,a3);for(var d3 in x.columnHideInfos.columnKeyToHiddenPath){var e3=x.columnHideInfos.columnKeyToHiddenPath[d3];if(e.getProperty(e3)){b3.push(d3);}if(c3){var f3=i.bindProperty(e3,e);f3.attachChange(c3);}}a3.deactivateColumns(b3);};X.oCommonUtils.executeForAllInformationObjects("smartTableWithColumnHide",j.bind(null,true));};var J1=t.testable(J1,"editEntity");var L1=t.testable(L1,"isEntryDeletable");var r1=t.testable(r1,"onActivateImpl");var s1=t.testable(s1,"onSaveImpl");t.testable(function(){return l1;},"getStateAppliedPromise");var _2={onInit:function(){_=Y.byId("objectPage");a1=X.oCommonUtils.getControlStateWrapper(_);a1.attachStateChanged(X.oComponentUtils.stateChanged);P2();var e=Y.getOwnerComponent();l1=new Promise(function(i){m1=i;});T2();var j=_.getSections();for(var k=0;k<j.length;k++){var x=j[k];var j1=x.getSubSections();j1.forEach(f2);}var a3=x1();var b3=e.getAppComponent();var c3=b3.getObjectPageHeaderType()==="Dynamic";W.aBreadCrumbs=a3&&(c3?a3.getBreadcrumbs().getLinks():a3.getBreadCrumbsLinks());(W.aBreadCrumbs||[]).forEach(function(i3,i){X.oComponentUtils.registerAncestorTitleUpdater(i3,"text",i+1);});if(c3){R1();}var d3=function(){o1=false;W2();};$.onInit(null,d3,W1,V1,Z1);S1();X.oCommonUtils.executeGlobalSideEffect();_.attachEvent("subSectionEnteredViewPort",function(i){var i3=i.getParameter("subSection");L.info("Viewport entered ","Subsection: "+i3.getId());$2(i3);});d1=new y(Z,Y,X);Z.oCreateWithDialogHandler=d1;c1=new l(Y,X,X.oComponentUtils.stateChanged);Z.oMultipleViewsHandler=c1;var e3=X.oComponentUtils.getTemplatePrivateModel();e3.setProperty("/objectPage/aPasteAttachedTables",[]);e3.setProperty("/objectPage/mHandleEnabledTableToolbar",[]);X.oComponentUtils.attach(Y,"PageDataLoaded",function(i){if(_&&!g1){var i3=r2(_);if(i3==="Create"&&f1!==true){e1=true;}else if((X.oComponentUtils.isDraftEnabled()&&i3==="Create"&&f1===true)||(!X.oComponentUtils.isDraftEnabled()&&i3==="Display"&&f1===true)){f1=false;}t2(_);}X.oComponentUtils.hidePlaceholder();});function f3(i){if(i.tableSettings){var i3=Y.byId(p.getStableId({type:"ObjectPageTable",subType:"SmartTable",sFacet:i.additionalData.facetId}));if(i3){x2(i3);}}else if(i.chartSettings){var j3=Y.byId(i.additionalData.facetId+"::Chart");if(j3){A2(j3);}}}function g3(i){var i3=Y.byId(i);if(i3){z.waitForChanges({element:i3}).then(function(){X.oCommonUtils.setPrivateModelControlProperty(i,'visible',i3.getGroups().length>0);});}}var h3=X.oComponentUtils.getParameterModelForTemplating().getObject("/templateSpecific/sections");h3.forEach(function(i){i.subSections.forEach(function(i3){i3.blocks.forEach(f3);i3.moreBlocks.forEach(f3);g3(i3.dummyFormId);g3(i3.dummyFormIdMoreBlocks);});});},handlers:{onEditAndActiveToggle:function(e,i){X.oServices.oApplication.performAfterSideEffectExecution(function(){var j=X.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=e.getBindingContext();var x=X.oServices.oApplication.getDraftSiblingPromise(k);j.setBusy(x.then(function(a3){if(i){L.info("Navigating to draft entity");H1(a3,true);}else{L.info("Navigating to active entity");X.oServices.oApplication.navigateToSubContext(a3,true,1);}g(':focus').blur();}));});},onAfterVariantInitialise:function(e){var i=e.getSource();var j;if(c.isSmartTable(i)){j=x2(i);}else if(c.isSmartChart(i)){j=A2(i);}if(j.afterVariantInitialiseResolve){j.afterVariantInitialiseResolve();delete j.afterVariantInitialiseResolve;}},onAfterVariantSave:function(e){y2(e);},onAfterVariantApply:function(e){y2(e);},addEntry:N2,onCancelCreateWithPopUpDialog:function(){d1.onCancelPopUpDialog();},onSaveCreateWithPopUpDialog:function(e){d1.onSavePopUpDialog(e);},submitChangesForSmartMultiInput:function(){if(X.oComponentUtils.isDraftEnabled()){X.oCommonEventHandlers.submitChangesForSmartMultiInput();}},contextEditableChanged:function(e){var i=e.getSource();var j=i.getBindingInfo('editable');if(j&&j.binding&&j.binding.getValue&&!j.binding.getValue()){i.setEditable(false);}},deleteEntry:function(e){var i=e.getParameter('listItem');var j=i.getBindingContext();var k=X.oCommonUtils.getOwnerControl(e.getSource());if(!c.isSmartTable(k)){k=k.getParent();}var x=[j];var a3=e.getSource().getId();P1(k,x,a3);},deleteEntries:function(e){var i=p.getStableId({type:"ObjectPageAction",subType:"Delete",sFacet:e});X.oCommonUtils.executeIfControlReady(O1,i);},onSelectionChange:function(e){var i=X.oComponentUtils.getTemplatePrivateModel();var j=i.getProperty("/objectPage/mHandleEnabledTableToolbar");if(!j[e.getSource().getId()]){j[e.getSource().getId()]=true;}X.oCommonUtils.setEnabledToolbarButtons(e.getSource());},checkUpdateFinished:function(e){X.oCommonUtils.setEnabledToolbarButtons(e.getSource());},onMultiSelectionChange:function(e){X.oCommonEventHandlers.onMultiSelectionChange(e);},onCancel:function(e){var i=e.getSource();var j=$.state.onCancel(i);j.then(function(){F1();if(!X.oComponentUtils.isDraftEnabled()){t2(_);var k=X.oComponentUtils.getTemplatePrivateModel();var x=k.getProperty("/objectPage/mHandleEnabledTableToolbar");for(var a3 in x){if(x[a3]){X.oCommonUtils.setEnabledToolbarButtons(Y.byId(a3));delete x[a3];}}}},Function.prototype);},onContactDetails:function(e){X.oCommonEventHandlers.onContactDetails(e);},onSmartFieldInitialise:function(e){var i=this.getView().getId();X.oCommonEventHandlers.onSmartFieldInitialise(e,i);},onPressDraftInfo:function(e){var i=Y.getView().getBindingContext();var j=sap.ui.getCore().byId(e.getSource().getId()+(e.getId()==="markChangesPress"?"-changes":"-lock"));X.oCommonUtils.showDraftPopover(i,j);},onPressDraftInfoObjectPageDynamicHeaderTitle:function(e){var i=Y.getView().getBindingContext();var j=Y.byId("template::ObjectPage::ObjectMarkerObjectPageDynamicHeaderTitle");X.oCommonUtils.showDraftPopover(i,j);},onShareObjectPageActionButtonPress:function(e){X.oCommonUtils.executeIfControlReady(y1,"template::Share");},onRelatedApps:function(e){var x,a3,b3,c3,d3,e3,f3;var g3,h3,i3,j3,k3;var l3=[];x=e.getSource();i3=sap.ushell&&sap.ushell.Container;a3=i3&&i3.getService("URLParsing");b3=a3.parseShellHash(document.location.hash);j3=b3.semanticObject;k3=b3.action;c3=Y.getView&&Y.getView().getBindingContext();var m3=X.oComponentUtils.getSettings();var n3=Y.getOwnerComponent().getModel().getMetaModel();var o3=c3.getObject();var p3=o3.__metadata.type;var q3=n3.getODataEntityType(p3);var r3=q3["com.sap.vocabularies.Common.v1.SemanticKey"];var s3={};if(r3&&r3.length>0){for(var j=0;j<r3.length;j++){var t3=r3[j].PropertyPath;if(!s3[t3]){s3[t3]=o3[t3];}}}else{for(var k in q3.key.propertyRef){var u3=q3.key.propertyRef[k].name;if(!s3[u3]){s3[u3]=o3[u3];}}}d3=Y.getOwnerComponent().getAppComponent();e3=i3&&i3.getService("CrossApplicationNavigation");if(m3.relatedAppsSettings&&Object.keys(m3.relatedAppsSettings).length>0){var v3=[{semanticObject:j3}];l3.push(v3);for(var i=0;i<Object.keys(m3.relatedAppsSettings).length;i++){if(m3.relatedAppsSettings[i].semanticObject!==j3){v3=[{semanticObject:m3.relatedAppsSettings[i].semanticObject}];l3.push(v3);}}f3=e3.getLinks(l3);}else{f3=e3.getLinks({semanticObject:j3,params:s3,ui5Component:d3});}z1().then(function(w3){g3=w3;h3=g3.getModel("buttons");h3.setProperty("/buttons",[]);g3.openBy(x);f3.done(function(x3){var y3=[],z3=[],A3;var B3=q3["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"];var C3=[];if(B3){for(var i=0;i<B3.length;i++){C3.push(B3[i].String);}}for(var i=0;i<q3.property.length;i++){if(q3.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]){var D3=q3.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"].length;for(var j=0;j<D3;j++){C3.push(q3.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"][j].String);}}}A3=X.oComponentUtils.getSettings().relatedAppsSettings;if(A3&&Object.keys(A3).length>0){for(var i=0;i<x3.length;i++){for(var j=0;j<x3[i].length;j++){for(var k=0;k<x3[i][j].length;k++){z3.push(x3[i][j][k]);}}}x3=z3;}x3.sort(function(I3,J3){if(I3.text<J3.text){return-1;}if(I3.text>J3.text){return 1;}return 0;});for(var i=0;i<x3.length;i++){var E3=x3[i];var F3=E3.intent;var G3=F3.split("-")[0].split("#")[1];var H3=F3.split("-")[1].split("?")[0];if((G3===j3?H3!==k3:true)&&C3.indexOf(H3)==-1){y3.push({enabled:true,text:E3.text,link:E3,param:s3});}}if(y3.length===0){y3.push({enabled:false,text:X.oCommonUtils.getText("NO_RELATED_APPS")});}h3.setProperty("/buttons",y3);});});},onEdit:function(e){var j=Y.byId("edit");var _=Y.byId("objectPage");var k=_.getSelectedSection();var x=_.getSections()||[];for(var i=0;i<x.length;i++){if(x[i].getVisible()&&x[i]._bInternalVisible!==false){if(x[i].getId()===k){e1=true;}else{e1=false;}break;}}if(j.data("CrossNavigation")){X.oCommonEventHandlers.onEditNavigateIntent(j);return;}X.oCommonUtils.executeIfControlReady(J1,"edit");},onSave:v1,onSaveAndContinueEdit:u1,onBreadCrumbUrlPressed:T1,onDelete:G1,onCallActionFromToolBar:function(e){X.oCommonEventHandlers.onCallActionFromToolBar(e,$.state);},onCallAction:function(e,i,j){X.oServices.oApplication.performAfterSideEffectExecution(function(){var k=Y.getView().getBindingContext();if(k){X.oServices.oDataLossHandler.performIfNoDataLoss(function(){var x=Y.getOwnerComponent();var a3=x.getEntitySet();var b3={functionImportPath:e,contexts:[k],sourceControlHandler:"",label:i,operationGrouping:j};X.oServices.oCRUDManager.callAction(b3).then(function(c3){var d3=c3&&c3[0];if(d3&&d3.context&&(!d3.actionContext||d3.actionContext&&d3.context.getPath()!==d3.actionContext.getPath())){X.oServices.oViewDependencyHelper.setParentToDirty(x,a3,1);}});},Function.prototype,"Proceed",true);}},true);},onDataFieldForIntentBasedNavigation:function(e){e=n({},e);X.oServices.oApplication.performAfterSideEffectExecution(function(){X.oCommonUtils.fnProcessDataLossOrDraftDiscardConfirmation(function(){X.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,$.state);},Function.prototype,"LeaveApp");},true);},onDataFieldWithIntentBasedNavigation:function(e){X.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(e,$.state);},onDataFieldWithNavigationPath:function(e){X.oCommonEventHandlers.onDataFieldWithNavigationPath(e);},onChartInit:function(e){var i=e.getSource();A2(i);i.getChartAsync().then(function(j){if(B.browser.safari){i.setHeight("50vH");}var k=Y._templateEventHandlers.onSelectionChange;j.attachSelectData(k).attachDeselectData(k);X.oCommonUtils.checkToolbarIntentsSupported(i);});},onDataRequested:function(i){L.info("Data requested (SmartTable: "+i+")");c1.onDataRequested(i);},onDataReceived:function(e){X.oCommonEventHandlers.onDataReceived(e);},onBeforeRebindDetailTable:function(e){var i=e.getSource();e.mParameters.bindingParams.events["dataReceived"]=Q2.bind(null,i);i.setNoData(X.oCommonUtils.getText("WAITING_SMARTTABLE"));var j=q1(e);var k=x2(i);var x=k.searchField;if(x){var a3=X.oCommonUtils.getControlInformation(x);if(a3.searchString){j.parameters.custom={search:a3.searchString};}}X.oCommonEventHandlers.onBeforeRebindTable(e,{ensureExtensionFields:Y.templateBaseExtension.ensureFieldsForSelect,addExtensionFilters:Y.templateBaseExtension.addFilters,isFieldControlRequired:true,isPopinWithoutHeader:true,isDataFieldForActionRequired:true,isFieldControlsPathRequired:true,isMandatoryFiltersRequired:true});Y.onBeforeRebindTableExtension(e);c1.onRebindContentControl(i.getId(),j);w1(e);if(c.isAnalyticalTable(i.getTable())){j.parameters.entitySet=i.getEntitySet();}},onListNavigate:function(e){X.oCommonEventHandlers.onListNavigate(e,$.state);},onBeforeSemanticObjectLinkPopoverOpens:function(e){var i=K1();X.oCommonUtils.semanticObjectLinkNavigation(e,i,Y,Z);},onBeforeSemanticObjectLinkNavigationCallback:function(e){return X.oCommonEventHandlers.onBeforeSemanticObjectLinkNavigationCallback(e);},onSemanticObjectLinkNavigationPressed:function(e){var i=e.getParameters();var j=e.getSource();X.oCommonEventHandlers.onSemanticObjectLinkNavigationPressed(j,i);},onSemanticObjectLinkNavigationTargetObtained:function(e){var i=e.getParameters();var j=e.getSource();X.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(j.getEntitySet(),j.getFieldSemanticObjectMap(),i,$.state);},onSemanticObjectLinkNavigationTargetObtainedSmartLink:function(e){var i,j;i=e.getParameters();j=e.getSource();while(j.getMetadata().getName()!=="sap.ui.comp.smarttable.SmartTable"&&j.getParent()){j=j.getParent();}X.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(j.getEntitySet(),{},i,$.state);},onHeaderImagePress:function(e){if(e.getSource().getSrc()===""){return;}var i=e.getSource().getId();var j=e.getSource().getSrc();Q1().then(function(k){if(k.getAriaLabelledBy()&&k.getAriaLabelledBy().indexOf(i)===-1){k.addAriaLabelledBy(i);}var x=k.getModel("headerImage");x.setProperty("/src",j);if(sap.ui.Device.system.phone){k.setProperty("stretch",true);}k.open();});},sectionChange:p2,onSwitchTabs:m2,onInlineDataFieldForAction:function(e){X.oCommonEventHandlers.onInlineDataFieldForAction(e);},onInlineDataFieldForIntentBasedNavigation:function(e){X.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(e.getSource(),$.state);},onDeterminingDataFieldForAction:function(e){X.oCommonEventHandlers.onDeterminingDataFieldForAction(e);},onBeforeRebindChart:function(e){q1(e);var i=e.getSource();S2(i);i.getChartAsync().then(function(k){i.oModels=k.oPropagatedProperties.oModels;});var j={ensureExtensionFields:Function.prototype,addExtensionFilters:Y.templateBaseExtension.addFilters,isFieldControlRequired:true,isMandatoryFiltersRequired:true};X.oCommonUtils.onBeforeRebindTableOrChart(e,j);},onToggleDynamicSideContent:b1.onToggleDynamicSideContent,sideContentBreakpointChanged:b1.sideContentBreakpointChanged,onTableInit:function(e,i){var j=e.getSource();var k=j.getTable();var x=x2(j);if(x.columnHideInfos){j.deactivateColumns(x.columnHideInfos.staticHiddenColumns);}X.oCommonUtils.checkToolbarIntentsSupported(j);var a3=function(){if(k.isA("sap.m.Table")||k.isA("sap.ui.table.Table")){if(k.isA("sap.m.Table")&&!T[k.getId()]){T[k.getId()]=k.getGrowingThreshold&&k.getGrowingThreshold();}l2(j,k,i);}};_.attachEvent("subSectionVisibilityChange",a3);a3();if(J(j)&&!j.data("CrossNavigation")){k.addEventDelegate({onkeyup:function(e){if(e.ctrlKey&&e.keyCode===K.ENTER&&j.getEditable()){K2(j,j);e.preventDefault();e.setMarked();}}});}var b3=X.oComponentUtils.getTemplatePrivateModel();if(J(j)){k.addEventDelegate({onAfterRendering:function(e){var c3;if(j.getEditable()&&!j.hasListeners("paste")){j.attachBeforePaste(D1);j.attachPaste(E1);c3=b3.getProperty("/objectPage/aPasteAttachedTables");if(c3){c3.push(i);}}}});}},onSearchObjectPage:E2,onSearchLiveChange:D2,onSmartTablePaste:E1,onUITableExpand:i2,onSingleSectionOrSubsectionVisible:h2,dataStateFilter:O2},formatters:{sideContentActionButtonText:b1.formatSideContentActionButtonText,setNoDataTextForSmartTable:function(e){if(X.oCommonUtils&&e){var i=X.oCommonUtils.getContextText("WAITING_SMARTTABLE",e);if(i!=="WAITING_SMARTTABLE"){return i;}return"";}},setVMVisibilityForVendor:function(){var e=new U(window.location.href);if(e.mParams["sap-ui-layer"]){var j=e.mParams["sap-ui-layer"];for(var i=0;i<j.length;i++){if(j[i].toUpperCase()==="VENDOR"){return true;}}}return false;},formatItemTextForMultipleView:function(i){return i&&c1?c1.formatItemTextForMultipleView(i):"";}},extensionAPI:new E(X,Y,$,Z)};_2.handlers=r($.handlers,_2.handlers);return _2;}};return V;});
