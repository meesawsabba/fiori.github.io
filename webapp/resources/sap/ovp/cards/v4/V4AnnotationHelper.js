sap.ui.define(["sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/v4/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources","sap/base/strings/formatMessage","sap/base/util/isPlainObject","sap/base/util/each","sap/ovp/cards/MetadataAnalyser","sap/base/security/encodeURL","sap/base/util/merge","sap/ovp/cards/ovpLogger","sap/base/util/isEmptyObject","sap/ovp/app/OVPUtils"],function(N,D,C,O,F,a,o,S,b,f,c,e,M,d,m,g,h,l){"use strict";var n={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};var L=new g("OVP.cards.V4AnnotationHelper");function p(i,j){var k=i.getSetting('ovpCardProperties');var q3=k.getProperty('/showLabelText');if(q3==="true"){var r3=j.Address[0];if(typeof r3.country!=="undefined"){return"{path:'"+r3.country.Path+"'}";}else if(typeof r3.locality!=="undefined"){return"{path:'"+r3.locality.Path+"'}";}else if(typeof r3.street!=="undefined"){return"{path:'"+r3.street.Path+"'}";}else if(typeof r3.code!=="undefined"){return"{path:'"+r3.code.Path+"'}";}}else{return null;}}p.requiresIContext=true;function q(i,j){if(!j){return"";}if(j.Label){return j.Label;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var q3=k&&k.getProperty("/metaModel");var r3=k&&k.getProperty("/entityType");if(!q3||!r3){return"";}var s3;if(j.Value){s3=j.Value.$Path;}if(j.Target){var t3="/"+J(r3.$Type,j);var u3=t3&&q3.getProperty(t3);s3=u3&&u3.Value.$Path;}if(!s3||!s3.length>0||s3===" "){return"";}var v3=q3.getData()["$Annotations"][r3.$Type+"/"+s3];if(!v3){return"";}var w3=v3["sap:label"]||(v3["@com.sap.vocabularies.Common.v1.Label"]||"")||"";return w3;}q.requiresIContext=true;function s(i){if(i.EdmType==="Edm.DateTime"||i.EdmType==="Edm.DateTimeOffset"){return'Right';}return'Left';}s.requiresContext=true;function r(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function t(i,k,j){if(i.getSetting){var q3=i.getSetting("_ovpCache");if(q3){q3[k]=j;}}}function u(i,j){var k;if(j){k=j.None;if(i&&i.$EnumMember){var q3=i.$EnumMember;if(w(q3,'Negative')){k=j.Negative;}else if(w(q3,'Critical')){k=j.Critical;}else if(w(q3,'Positive')){k=j.Positive;}}}return k;}function v(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function w(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function x(i,j,k,q3,r3,s3,t3){if(typeof i=="string"){i=N.getIntegerInstance().parse(i);}var u3={};u3.$EnumMember="None";var v3=Number.NEGATIVE_INFINITY;var w3=Number.POSITIVE_INFINITY;if((!r3&&r3!==0)&&(k||k===0)){r3=k;}if((!s3&&s3!==0)&&(q3||q3===0)){s3=q3;}if(!k&&k!==0){k=v3;}if(!q3&&q3!==0){q3=w3;}if(i!==undefined){i=Number(i);if(w(j,"Minimize")||w(j,"Minimizing")){if((s3||s3===0)&&(q3||q3===0)){if(i<=parseFloat(s3)){u3.$EnumMember="Positive";}else if(i>parseFloat(q3)){u3.$EnumMember="Negative";}else{u3.$EnumMember="Critical";}}}else if(w(j,"Maximize")||w(j,"Maximizing")){if((r3||r3===0)&&(k||k===0)){if(i>=parseFloat(r3)){u3.$EnumMember="Positive";}else if(i<parseFloat(k)){u3.$EnumMember="Negative";}else{u3.$EnumMember="Critical";}}}else if(w(j,"Target")){if((s3||s3===0)&&(q3||q3===0)&&(r3||r3===0)&&(k||k===0)){if(i>=parseFloat(r3)&&i<=parseFloat(s3)){u3.$EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(q3)){u3.$EnumMember="Negative";}else{u3.$EnumMember="Critical";}}}}return u(u3,t3);}function y(i,j,k,q3){if(typeof i=="string"){i=N.getIntegerInstance().parse(i);}if(!i||!j){return;}i=Number(i);if(!q3&&(i-j>=0)){return"Up";}if(!k&&(i-j<=0)){return"Down";}if(j&&q3&&(i-j>=q3)){return"Up";}if(j&&k&&(i-j<=k)){return"Down";}}function z(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var q3=r(i,k);if(!q3){var r3=B(i,j);var s3=r3.map(function(t3){return t3.Value.$Path;});s3=s3.filter(function(t3){return!!t3;});q3=j.filter(function(t3){if(t3.$Type==="com.sap.vocabularies.UI.v1.DataField"&&s3.indexOf(t3.Value.$Path)===-1){return true;}return false;});q3=P(q3);t(i,k,q3);}return q3;}z.requiresIContext=true;function B(j,k,q3){var r3=j.getPath(0)+"-DataPoints-Sorted";var s3=r(j,r3);if(!s3){if(q3){s3=k.filter(G);}else{s3=k.filter(E);}s3=P(s3);var t3;for(var i=0;i<s3.length;i++){t3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);s3[i]=j.getModel(0).getProperty(J(t3,s3[i]));t3="";}t(j,r3,s3);}return s3;}B.requiresIContext=true;function E(i){if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.$AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function G(i){if((i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.$AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.$AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function H(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function J(i,j){return i+j.Target.$AnnotationPath;}function K(i){var j,k;if(i["@com.sap.vocabularies.UI.v1.Importance"]){j=i["@com.sap.vocabularies.UI.v1.Importance"].$EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function P(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var q3=i.slice(j,i.length);return Q(P(k),P(q3));}function Q(i,j){var k=[];while(i.length&&j.length){var q3=K(i[0]),r3=K(j[0]);if(q3<=r3){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function R(i,j,k){var q3=z(i,j)[k];if(q3){return $(i,q3);}return"";}function U(i,j,k){var q3=z(i,j)[k];return q(i,q3);}function V(i,j,k){var q3=B(i,j)[k];if(q3&&q3.Title){return q3.Title.String;}return"";}function W(i,j,k){var q3=j.filter(E);q3=P(q3);if(!q3||!q3.length||!q3.length>0){return"";}return q(i,q3[0]);}function X(i,j,k,q3){var r3=B(i,j)[k];if(!r3){return"";}var s3=i.getSetting('ovpCardProperties');var t3=s3.getProperty("/entityType");var u3=s3.getProperty("/metaModel");return _(i,r3,t3,u3,q3);}function Y(i,j,k){var q3=B(i,j)[k];if(q3&&q3.Criticality){return true;}}function Z(i,j,k){var q3=B(i,j)[k];var r3=q3.Criticality.Path;return"{path:'"+r3+"'}";}function _(i,j,k,q3,r3){if(!j||!j.Value){return"";}var s3=i.getSetting('ovpCardProperties');var t3=false;if(s3){var u3=s3.getProperty("/ignoreSapText");t3=u3==undefined?t3:u3;}var v3=q3.getData()["$Annotations"][k.$Type+"/"+j.Value.$Path];var w3=false;if(t3==true){if(v3&&(v3["@com.sap.vocabularies.Analytics.v1.Measure"]||v3["sap:aggregation-role"]=="measure")){w3=true;}}if(!w3&&v3){var x3;if(v3["com.sap.vocabularies.Common.v1.Text"]){x3=v3["com.sap.vocabularies.Common.v1.Text"]?v3["com.sap.vocabularies.Common.v1.Text"]:v3["com.sap.vocabularies.Common.v1.Text"].$Path;}else if(v3["sap:text"]){x3=v3["sap:text"];}if(x3){j={Value:{$Path:x3}};}}return $(i,j,r3);}function $(i,j,k,q3){if(j.Value.Apply){return O.format(i,j.Value);}var r3=i.getSetting('ovpCardProperties');var s3=r3.getProperty("/entityType");var t3=r3.getProperty("/metaModel");return b1(i,j,s3,t3,k,q3);}$.requiresIContext=true;function a1(i,j,k,q3){if((!k)||(typeof q3!=='string')){return q3;}var r3=k["@"+A.TEXT];if(!r3){return q3;}var s3,t3;s3=k["@"+A.TEXT+"@"+A.TEXT_ARRANGEMENT];t3=s3&&s3.$EnumMember;if(!t3){s3=r3&&r3["@"+A.TEXT_ARRANGEMENT];t3=s3&&s3.$EnumMember;}if(!t3){s3=j&&j[A.TEXT_ARRANGEMENT];t3=s3&&s3.$EnumMember;}if(!t3){return q3;}var u3=O.format(r3,{context:i});if(!u3||u3===" "){return q3;}var v3;switch(t3){case T.TEXT_FIRST:v3=u3+" ("+q3+")";break;case T.TEXT_LAST:v3=q3+" ("+u3+")";break;case T.TEXT_ONLY:v3=u3;break;case T.TEXT_SEPARATE:v3=q3+" ("+u3+")";break;default:v3=q3;break;}return v3;}function b1(j,k,q3,r3,s3,t3,u3){if(k.Value.Apply){return O.format(j,k.Value);}var v3=k.Value.$Path?k.Value.$Path:k.Value.String;var w3=c1(r3,q3,k.Value.$Path),x3="",y3,z3;var A3=j.getSetting("ovpCardProperties");var B3=A3&&A3.getProperty("/contentFragment");if(!t3){if(k.Value.$Path&&k.Value.$Path.split("/").length>1){w3=h1(r3,q3,k.Value.$Path);}if(!w3){return"";}if(w3&&(w3.$Type==='Edm.DateTime'||w3.$Type==='Edm.DateTimeOffset')){var C3={'relative':true,'relativeScale':'auto'},D3=A3&&A3.getProperty("/showDateInRelativeFormat");if(D3!==undefined&&!D3){C3={'style':'medium'};}z3={dateFormat:C3,bUTC:w3.$Type==='Edm.DateTime'?true:false};y3="sap.ovp.cards.AnnotationHelper.formatDate";x3=d1([k.Value.$Path?k.Value.$Path:v3.split("/")[v3.split("/").length-1]],y3,z3);}else if((k.ValueFormat&&(k.ValueFormat.NumberOfFractionalDigits>=0))||w3["scale"]){var E3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits:0,F3;var G3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.$Decimal);if(w3["@Org.OData.Measures.V1.ISOCurrency"]){F3=w3["@Org.OData.Measures.V1.ISOCurrency"].$Path?w3["@Org.OData.Measures.V1.ISOCurrency"].$Path:w3["@Org.OData.Measures.V1.ISOCurrency"];}else if(w3["@Org.OData.Measures.V1.Unit"]){F3=w3["@Org.OData.Measures.V1.Unit"].$Path?w3["@Org.OData.Measures.V1.Unit"].$Path:w3["@Org.OData.Measures.V1.Unit"];}else if(w3["@sap:unit"]){F3=w3["@sap:unit"];}var H3=F3?r3.getProperty("/"+q3.$Type)[F3]:null,I3=[k.Value.$Path?k.Value.$Path:v3.split("/")[v3.split("/").length-1]];if(E3>2){E3=2;}z3={numberOfFractionalDigits:E3,scaleFactor:G3};if(w3["@Org.OData.Measures.V1.ISOCurrency"]){var J3=w3["@Org.OData.Measures.V1.ISOCurrency"];if(J3.$Path){y3="sap.ovp.cards.v4.V4AnnotationHelper.formatCurrency";I3.push(J3.$Path);}else if(J3.String){z3.currencyString=J3.String;y3="sap.ovp.cards.v4.V4AnnotationHelper.formatCurrency";}}else if(H3&&(H3["Org.OData.Measures.V1.ISOCurrency"]||H3["sap:semantics"]==="currency-code")){y3="sap.ovp.cards.v4.V4AnnotationHelper.formatCurrency";I3.push(F3);}else{y3="sap.ovp.cards.v4.V4AnnotationHelper.formatNumberCalculation";}x3=d1(I3,y3,z3);}else{if(u3){x3=O.format(k.Value,{context:j});}else{var K3=O.format(k.Value,j.getModel()?{context:j}:{context:j.getInterface(0)});var L3=K3.split(",");var M3=[];if(L3.length>1){for(var i=0;i<L3.length;i++){if(L3[i].indexOf("path:")>=0||L3[i].indexOf("type:")>=0){M3.push(L3[i]);}}if(M3.length>0){x3=x3+M3.join(',');if(x3.substring(x3.length-1)!=="}"){x3=x3+"}";}}}else{x3=K3;}}}if(B3){x3=a1(j,q3,w3,x3);}if(w3&&w3["@Org.OData.Measures.V1.Unit"]){var N3=w3["@Org.OData.Measures.V1.Unit"];if(N3.Path){x3+=(" "+d1([N3.Path]));}else if(N3.String){if(N3.String!=="%"){x3+=" ";}x3+=N3.String;}}}if(!s3){if(w3["@Org.OData.Measures.V1.ISOCurrency"]){var J3=w3["@Org.OData.Measures.V1.ISOCurrency"];if(J3.$Path){x3+=(" "+d1([J3.$Path]));}else if(J3){x3+=(" "+J3);}}}if(x3[0]===" "){x3=x3.substring(1);}x3=x3.replace("\\","");x3=x3.replace("\\","");x3=x3.replace("Unsupported: ","");x3=x3.replace("$P","p");return x3;}function c1(i,j,k){var q3=i.getData().$Annotations[j.$Type+"/"+k];var r3=i.getObject("/"+j.$Type.split(".")[1]+"/"+k);var s3=l.merge(true,{},q3,r3);return s3;}function d1(j,k,q3,r3){var s3="",t3=j.length;if(t3>1||q3){s3="{parts:[";for(var i=0;i<t3;i++){if(r3){s3+=("{path: '"+j[i]+"',type:'sap.ui.model.odata.type.Decimal'}"+(((i===t3-1)&&!q3)?"]":", "));}else{s3+=("{path: '"+j[i]+"'}"+(((i===t3-1)&&!q3)?"]":", "));}}if(q3){var u3="{value:"+JSON.stringify(q3)+", model: 'ovpCardProperties'}";s3+=u3+"]";}}else{s3="{path: '"+j[0]+"'";}s3+=(k?(", formatter: '"+k+"'"):"")+"}";return s3;}function e1(){var i=arguments[arguments.length-1],j=arguments[0];var k=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:i.scaleFactor,minFractionDigits:i.numberOfFractionalDigits,maxFractionDigits:i.numberOfFractionalDigits});if(typeof j=="string"){j=N.getIntegerInstance().parse(j);}return k.format(Number(j));}function f1(){var i=arguments[arguments.length-1],j=arguments[0];var k=D.getInstance(i.dateFormat);if(!j){j="";return j;}return k.format(new Date(j),i.bUTC);}function g1(){var i=arguments[arguments.length-1],j=arguments[0],k=arguments[1];var q3="";var r3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:i.scaleFactor,minFractionDigits:i.numberOfFractionalDigits,maxFractionDigits:i.numberOfFractionalDigits});if(typeof j=="string"){j=N.getIntegerInstance().parse(j);}if(k){q3=r3.format(j,k);}else{q3=i.currencyString?r3.format(j,i.currencyString):r3.format(j);}return q3;}function h1(j,k,q3){var r3=q3.split("/");if(r3.length>1){for(var i=0;i<(r3.length-1);i++){k=j.getProperty("/"+k.$Type)[r3[i]];}return c1(j,k,r3[r3.length-1]);}}function i1(i,j,k){var q3=B(i,j);var r3=n.StateValues;var s3=q3[k];if(!s3){return r3.None;}if(s3.Criticality){return m1(i,s3,r3);}return o1(i,s3,r3);}function j1(i,j,k){var q3=B(i,j);if(q3&&q3.length){var r3=q3[0];if(r3&&(r3.Criticality||r3.CriticalityCalculation)){return true;}}return false;}function k1(i,j,k){if(j1(i,j,k)){return'';}return'sapUiChartPaletteQualitativeHue1';}k1.requiresIContext=true;function l1(i,j,k){var q3=B(i,j),r3=n.ColorValues;var s3=r3.None;if(q3.length>k){var t3=q3[k];if(t3&&t3.Criticality){s3=m1(i,t3,r3);}else{s3=o1(i,t3,r3);}}return s3;}function m1(i,j,k){var q3=k.None;var r3;var s3=j.Criticality;if(s3){r3="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(s3.$Path){var t3='$'+O.format(s3,{context:i});q3=f(r3,t3);}else if(s3.$EnumMember){var u3="'"+s3.$EnumMember+"'";q3=f(r3,u3);}else{L.warning("Case not supported, returning the default Neutral state");}}else{L.warning("Case not supported, returning the default Neutral state");}return q3;}function n1(i,j,k){var q3=B(i,j);var r3="None";if(q3.length>k){var s3=q3[k];if(s3&&s3.Criticality&&s3.Criticality.Path){r3=Z(i,j,k);}else{r3=o1(i,s3,n.StateValues);r3=v(r3);}}return r3;}function o1(i,j,k,q3){var r3=k.None;if(j.Criticality){r3=u(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.$Path){r3=p1(i,j,k,q3);}return r3;}function p1(i,j,k,q3){var r3=H1(j.Value,q3);var s3=j.CriticalityCalculation.ImprovementDirection.$EnumMember;var t3=H1(j.CriticalityCalculation.DeviationRangeLowValue,q3);var u3=H1(j.CriticalityCalculation.DeviationRangeHighValue,q3);var v3=H1(j.CriticalityCalculation.ToleranceRangeLowValue,q3);var w3=H1(j.CriticalityCalculation.ToleranceRangeHighValue,q3);var x3=r1(t3);var y3=r1(u3);var z3=r1(v3);var A3=r1(w3);var B3={"deviationLow":t3,"deviationHigh":u3,"toleranceLow":v3,"toleranceHigh":w3,"bIsDeviationLowBinding":x3,"bIsDeviationHighBinding":y3,"bIsToleranceLowBinding":z3,"bIsToleranceHighBinding":A3,"sImprovementDirection":s3,"oCriticalityConfigValues":k};var C3="{value:"+JSON.stringify(B3)+", model: 'ovpCardProperties'}";var D3="parts: ["+r3;D3+=x3?","+t3:"";D3+=y3?","+u3:"";D3+=z3?","+v3:"";D3+=A3?","+w3:"";D3+=","+C3;D3+="]";var E3="sap.ovp.cards.v4.V4AnnotationHelper.formatColor";return"{"+D3+", formatter: '"+E3+"'}";}function q1(){var i=arguments[arguments.length-1];var j=1;return x(arguments[0],i.sImprovementDirection,i.bIsDeviationLowBinding?parseFloat(arguments[j++].split(",").join("")):i.deviationLow,i.bIsDeviationHighBinding?parseFloat(arguments[j++].split(",").join("")):i.deviationHigh,i.bIsToleranceLowBinding?parseFloat(arguments[j++].split(",").join("")):i.toleranceLow,i.bIsToleranceHighBinding?parseFloat(arguments[j++].split(",").join("")):i.toleranceHigh,i.oCriticalityConfigValues);}function r1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function s1(i,j,k){var q3="";var r3=k.split("/");if(r3.length>1){r3.pop();q3=r3.join("/");}return q3;}function t1(i){var j;if(i&&typeof i.getData==='function'){var k=i.getData();if(k.tabs){var q3=0;var r3=k.selectedKey;if(r3&&k.tabs.length>=r3){q3=r3-1;}j=k.tabs[q3].mFilterPreference;}else{j=k.mFilterPreference;}}return!!j;}function u1(j,k){var q3=j.getSetting('ovpCardProperties');var r3=q3.getProperty("/addODataSelect");var s3=q3.getProperty("/metaModel");var t3=s3.getData();var u3=k;var v3,w3,x3,y3;if(q3.getProperty('/selectionAnnotationPath')){v3="@"+q3.getProperty('/selectionAnnotationPath');w3=t3["$Annotations"][u3.$Type][v3];}if(q3.getProperty('/presentationAnnotationPath')){x3=q3.getProperty('/presentationAnnotationPath');x3="@"+x3;y3=t3["$Annotations"][u3.$Type][x3];}var z3="/"+q3.getProperty("/entitySet");var A3=Array.prototype.slice.call(arguments,2);var B3=j.getSetting('ovpCardProperties'),C3=B3.getProperty('/parameters');if(w3||!!C3){if((w3&&w3.Parameters&&w3.Parameters.length>0)||!!C3){z3=E2(j.getSetting('dataModel'),k,w3,C3);}}if(q3.getProperty("/cardLayout")&&q3.getProperty("/cardLayout/noOfItems")){var D3="{path: '"+z3+"', length: "+ +(q3.getProperty("/cardLayout/noOfItems"));}else{var D3="{path: '"+z3+"', length: "+I1(q3);}var E3=[];if(r3){E3=w1(j,s3,u3,A3);var F3=q3.getProperty("/template");if(F3!="sap.ovp.cards.charts.analytical"&&F3!="sap.ovp.cards.charts.smart.chart"){var G3=z1(y3);for(var i=0;i<G3.length;i++){if(E3.indexOf(G3[i])===-1){E3.push(G3[i]);}}}}var H3=v1(s3,u3.$Type,A3);var I3=t1(q3);if(I3||E3.length>0||H3.length>0){D3=D3+", parameters: {";}if(E3.length>0||H3.length>0){if(E3.length>0){D3=D3+"select: '"+E3.join(',')+"'";}if(H3.length>0){if(E3.length>0){D3=D3+", ";}D3=D3+"$expand: '"+H3.join(',')+"'";}if(I3){D3=D3+", ";}}if(I3){D3=D3+"custom: {cardId: '"+q3.getProperty("/cardId")+"'}";}if(I3||E3.length>0||H3.length>0){D3=D3+", $count: true}";}else{D3=D3+", parameters: {$count:true}";}var J3=y1(q3,y3);if(J3.length>0){D3=D3+", sorter:"+JSON.stringify(J3);}var K3=D1(q3,w3);if(K3.length>0){D3=D3+", filters:"+JSON.stringify(K3);}D3=D3+"}";return D3;}u1.requiresIContext=true;function v1(k,q3,r3){var s3=[];var t3,u3;for(var i=0;i<r3.length;i++){if(!r3[i]){continue;}t3=k.getData()["$Annotations"][q3]["@"+r3[i]];t3=t3?t3:[];for(var j=0;j<t3.length;j++){if(t3[j].Value&&t3[j].Value.$Path){u3=s1(k,q3,t3[j].Value.$Path);if(u3&&s3.indexOf(u3)===-1){s3.push(u3);}}}}return s3;}function w1(q3,r3,s3,t3){var u3=[];var v3,w3,x3;for(var i=0;i<t3.length;i++){if(!t3[i]){continue;}v3=s3.$Type.split(".")[1]+"/@"+t3[i];w3=q3.getModel(0);var y3={};if(q3&&q3.bDummyContext){m(y3,q3,w3,true);}else{y3=q3;}x3=w3.getObject("/"+v3);if(!x3){x3=[];}else if(c(x3)){if(x3.Data){x3=x3.Data;}else{x3=[];}}var z3;var A3;var B3;var C3;for(var j=0;j<x3.length;j++){A3=[];z3=x3[j];B3="";C3=z3.$Type;if(C3==="com.sap.vocabularies.UI.v1.DataField"){B3=b1(y3.getInterface(0),z3,s3,r3,undefined,undefined,true);}else if(C3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var D3=J(s3.$path,z3);B3=_(y3,r3.getProperty(D3),s3,r3);var E3=H(r3.getProperty(D3));if(E3&&E3.length>0){B3+=E3;}}else if(C3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&z3.Url){var F3;if(!z3.Url.UrlRef){F3=O.format(y3,z3.Url);}if(F3&&F3.substring(0,2)==="{="){B3=F3;}}if(B3){var G3=O.format(z3.Value,{context:y3.getInterface(0)});if(B3.indexOf("(")<0&&B3!==G3){B3=[].concat(G3,B3).join(" ");}A3=x1(B3);}if(A3&&A3.length>0){var H3;for(var k=0;k<A3.length;k++){H3=A3[k];if(!u3[H3]){u3[H3]=true;var I3={};I3[H3]=c1(r3,s3,H3);var J3=N2(H3,I3);if(J3&&J3!==H3){u3[J3]=true;}var K3=g3(r3,s3,H3);if(K3&&K3!==H3){u3[K3]=true;}}}}}}return Object.keys(u3);}function x1(j){var i,k=0,q3=j.length,r3="",s3;for(i=0;i<q3;i++){s3=j.charAt(i);if(!s3){return;}switch(s3){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}r3+=s3;}j=r3;var t3=/\${([a-zA-Z0-9\_|\/]*)/g;var u3=/[^[{]*[a-zA-Z0-9\_]/g;var v3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var w3,x3,y3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");j=j.replace("]","");j=j.replace(j.lastIndexOf("}",""));}if(j.substring(0,2)==="{="){w3=t3;x3=1;}else if(j.indexOf("path")!==-1){if(j.indexOf("{value")>0){var z3=0;var i=j.indexOf("{value")+5;var A3;while(i<q3){if(j[i]==="}"&&z3===0){A3=i;break;}if(j[i]==="{"){z3+=1;}if(j[i]==="}"){z3-=1;}i++;}j=j.slice(0,j.indexOf("{value"))+j.slice(A3);}var B3=u3.exec(j);while(B3){if(B3[0].indexOf("path")===-1&&B3[0].indexOf("@i18n")!==0&&B3[0].indexOf("model: 'ovpCardProperties'")<=-1){y3.push(B3[0]);}B3=u3.exec(j);}w3=v3;x3=1;}else{w3=u3;x3=0;}var C3=w3.exec(j);while(C3){if(C3[x3]&&C3[x3].indexOf("@i18n")!==0){y3.push(C3[x3]);}C3=w3.exec(j);}return y3;}function y1(j,k){var q3=[];var r3,s3;var t3=j.getProperty("/sortBy");if(t3){var u3=j.getProperty('/sortOrder');if(u3&&u3.toLowerCase()!=='descending'){s3=false;}else{s3=true;}r3={path:t3,descending:s3};q3.push(r3);}var v3=k&&k.SortOrder||undefined;var w3,t3;if(v3){for(var i=0;i<v3.length;i++){w3=v3[i];t3=w3.Property.$PropertyPath;s3=E1(w3.Descending,true);r3={path:t3,descending:s3};q3.push(r3);}}return q3;}function z1(j){var k=[];var q3=j&&j.RequestAtLeast||undefined;if(q3){for(var i=0;i<q3.length;i++){if(q3[i].PropertyPath){k.push(q3[i].PropertyPath);}}}return k;}function A1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:D1(i,k),parameters:C1(k)};}function B1(j){if(!j){return;}var k=j.getProperty('/entityType');var q3=k[j.getProperty('/presentationAnnotationPath')];var r3=y1(j,q3);var s3=[];var i,t3=r3.length;for(i=0;i<t3;i++){if(!r3[i].path){continue;}s3.push({Property:r3[i].path,Descending:r3[i].descending});}if(s3.length>0){return{SortOrder:s3};}}function C1(j){var k,q3=[];if(!j||!j.Parameters){return q3;}var r3=j.Parameters.length;for(var i=0;i<r3;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){L.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}q3[q3.length]={path:k.PropertyName.PropertyPath,value:G1(k.PropertyValue)};}return q3;}function D1(k,q3){var r3=[];var s3;var t3=k.getProperty("/filters");if(t3){r3=r3.concat(t3);}if(q3&&q3.SelectOptions){s3=q3.SelectOptions;}else{s3=q3;}var u3,v3,w3;if(s3){for(var i=0;i<s3.length;i++){u3=s3[i];v3=u3.PropertyName.$PropertyPath;for(var j=0;j<u3.Ranges.length;j++){w3=u3.Ranges[j];if(w3.Sign.$EnumMember){var x3={path:v3,operator:w3.Option.$EnumMember.split("/")[1],value1:G1(w3.Low),value2:G1(w3.High),sign:w3.Sign.$EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(x3.sign==="E"&&x3.operator!==F.EQ){L.error("Exclude sign is supported only with EQ operator");continue;}if(x3.sign==="E"&&x3.operator===F.EQ){x3.operator=F.NE;x3.sign="I";}if(x3.operator==="CP"&&x3.sign==="I"){var y3=F.Contains;var z3=x3.value1;if(z3){var A3=z3.indexOf('*');var B3=z3.lastIndexOf('*');if(A3>-1){if((A3===0)&&(B3!==(z3.length-1))){y3=F.EndsWith;z3=z3.substring(1,z3.length);}else if((A3!==0)&&(B3===(z3.length-1))){y3=F.StartsWith;z3=z3.substring(0,z3.length-1);}else{z3=z3.substring(1,z3.length-1);}}}x3.operator=y3;x3.value1=z3;}r3.push(x3);}}}}return r3;}function E1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function F1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.$Decimal){j=Number(i.$Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}else if(typeof i==="number"){return i;}}return j;}function G1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(typeof(i)=="string"){j=i;}else if(i.Boolean||i.Bool){j=E1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=F1(i);}}return j;}function H1(i,j){if(i){if(i.$Path){return j?"{path:'"+i.$Path+"Agg"+"', type:'sap.ui.model.odata.type.Decimal'}":"{path:'"+i.$Path+"'}";}else{return G1(i);}}else{return"";}}function I1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var q3=i.getProperty('/listFlavor');var r3;var s3="desktop";if(a.system.phone){s3="phone";}else if(a.system.tablet){s3="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(q3=="bar"){r3=I["List_extended_bar"];}else{r3=I["List_extended"];}}else if(q3=="bar"){r3=I["List_condensed_bar"];}else{r3=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){r3=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){r3=I["Stack_complex"];}else{r3=I["Stack_simple"];}}if(r3){return r3[s3];}return 5;}function J1(i){var j=i.getObject();var k=B(i,j,true);var q3=k.map(function(r3){if(r3&&r3.Value&&r3.Value.$Path){return r3.Value.$Path;}else if(r3&&r3.fn&&r3.fn.$Path){return r3.fn.$Path;}});j.filter(function(r3,s3){if(r3.$Type==="com.sap.vocabularies.UI.v1.DataField"&&q3.indexOf(r3.Value.$Path)>-1){j.splice(s3,1);}});return i.sPath;}J1.requiresIContext=true;function K1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}K1.requiresIContext=true;function L1(i,j){var k=B(i,j);return k.length;}L1.requiresIContext=true;function M1(i,j){return O1(i,j,0);}M1.requiresIContext=true;function N1(i,j){return O1(i,j,1);}N1.requiresIContext=true;function O1(i,j,k){var q3=B(i,j),r3=q3[k];if(r3&&r3.Value&&r3.Value.$Path){return r3.Value.$Path;}return"";}function P1(i,j){return U(i,j,0);}P1.requiresIContext=true;function Q1(i,j){return U(i,j,1);}Q1.requiresIContext=true;function R1(i,j){return U(i,j,2);}R1.requiresIContext=true;function S1(i,j){return U(i,j,3);}S1.requiresIContext=true;function T1(i,j){return U(i,j,4);}T1.requiresIContext=true;function U1(i,j,k){return R(i,j,k);}U1.requiresIContext=true;function V1(i,j,k){return X(i,j,k);}V1.requiresIContext=true;function W1(i,j,k,q3){var r3=L1(i,j);if(r3>0){return V1(i,j,k);}else{return U1(i,j,q3);}}W1.requiresIContext=true;function X1(i,j,k){return q2(i,j,k);}X1.requiresIContext=true;function Y1(i,j){return V(i,j,0);}Y1.requiresIContext=true;function Z1(i,j){return V(i,j,1);}Z1.requiresIContext=true;function $1(i,j){return V(i,j,2);}$1.requiresIContext=true;function _1(i,j){return W(i,j,0);}_1.requiresIContext=true;function a2(j,k){for(var i=0;i<k.length;i++){var q3=k[i];if(q3.$Type==="com.sap.vocabularies.UI.v1.DataField"){if(q3.IconUrl&&q3.IconUrl.String){return q3.IconUrl.String;}if(q3.IconUrl&&q3.IconUrl.$Path){return O.format(q3.IconUrl,{context:j});}}}}a2.requiresIContext=true;function b2(i,j,k){var q3="";var r3;if(Array.isArray(j)){r3=B(i,j)[k];}else{var s3=Object.assign({},j);var t3=Object.assign({},i);r3=o2(t3,s3);}if(!r3||!r3.Value){return q3;}var u3=i.getSetting('ovpCardProperties');var v3=u3&&u3.getProperty("/entityType");var w3=u3&&u3.getProperty("/metaModel");var x3=w3&&w3.getData()["$Annotations"][v3.$Type+"/"+r3.Value.$Path];var y3=x3&&x3["@Org.OData.Measures.V1.ISOCurrency"];if(y3&&y3.$Path){q3+=(" "+d1([y3.$Path]));}else if(y3){q3+=(" "+y3);}return q3;}b2.requiresIContext=true;function c2(i,j,k,q3){return X(i,j,k,q3);}c2.requiresIContext=true;function d2(i,j){return i1(i,j,0);}d2.requiresIContext=true;function e2(i,j){return l1(i,j,0);}e2.requiresIContext=true;function f2(i,j){return i1(i,j,1);}f2.requiresIContext=true;function g2(i,j){return i1(i,j,2);}g2.requiresIContext=true;function h2(i,j){return n1(i,j,0);}h2.requiresIContext=true;function i2(i){var j={};j.$EnumMember="None";if(Number(i)===1){j.$EnumMember="Negative";}else if(Number(i)===2){j.$EnumMember="Critical";}else if(Number(i)===3){j.$EnumMember="Positive";}return u(j,n.ColorValues);}function j2(i,j){if(j&&j.Criticality&&j.Criticality.$Path){return"{parts: [{path:'"+j.Criticality.$Path+"Agg', type:'sap.ui.model.odata.type.Decimal'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.kpiValueCriticality'}";}else{return o1(i,j,n.ColorValues,true);}}j2.requiresIContext=true;function k2(i,j){return Y(i,j,0);}k2.requiresIContext=true;function l2(i,j){var k=B(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}l2.requiresIContext=true;function m2(i,j){return Y(i,j,1);}m2.requiresIContext=true;function n2(i,j){return Y(i,j,2);}n2.requiresIContext=true;function o2(i,j){var k=i.getPath(0);var q3=k.slice(0,k.lastIndexOf("/"));q3=q3.slice(0,q3.lastIndexOf("/"));var r3=J(q3,j);j=i.getModel(0).getProperty(r3);return j;}function p2(i,j){if(!j){return"";}return $(i,j);}p2.requiresIContext=true;function q2(i,j,k,q3){var r3;var s3=q3==undefined?k:z(i,k)[q3];var t3=i.getSetting('ovpCardProperties');var u3=t3.getProperty("/metaModel");var v3=j.$Type;var w3=u3.getData()["$Annotations"][v3+"/"+s3.Value.$Path];if(w3){r3=w3["@com.sap.vocabularies.Common.v1.SemanticObject"];if(r3){return O.format(r3,i.getModel()?{context:i}:{context:i.getInterface(0)});}else{return"";}}}function r2(i,j,k){var q3=k===undefined?j.Value.$Path:j[k].Value.$Path;var r3=(q3.indexOf("/")!=-1)?q3.split('/')[0]:"";return r3;}r2.requiresIContext=true;function s2(i,j){var k=i.getSetting('ovpCardProperties');var q3=k.getProperty("/metaModel");var r3=q3.getData()["$Annotations"][j.$Type];if(r3["@com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}s2.requiresIContext=true;function t2(i,j,k){if(!j){return"";}var q3=i.getSetting('ovpCardProperties');var r3=q3.getProperty("/entityType");var s3=q3.getProperty("/metaModel");var t3=Object.assign({},j);var u3=Object.assign({},i);j=o2(u3,t3);return _(i,j,r3,s3,k);}t2.requiresIContext=true;function u2(i,j){var k=Object.assign({},j);var q3=Object.assign({},i);var r3="None",s3=n.StateValues;j=o2(q3,k);if(j&&j.Criticality){r3=m1(i,j,s3);}else{r3=o1(i,j,s3);}return r3;}u2.requiresIContext=true;function v2(i,j){var k=Object.assign({},j);var q3=Object.assign({},i);j=o2(q3,k);if(j&&j.Criticality){return true;}}v2.requiresIContext=true;function w2(i,j){var k=Object.assign({},j);var q3=Object.assign({},i);var r3=i.getSetting('ovpCardProperties');var s3=r3.getProperty("/entityType");var t3=r3.getProperty("/metaModel");j=o2(q3,k);if(!j){return;}var u3=t3.getProperty("/"+s3.$Type)[j.Value.$Path];if(j&&u3&&u3.$Type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return'Center';}if(u3&&((u3.$Type=="Edm.DateTime")||(u3.$Type=="Edm.DateTimeOffset"))){return'Right';}}w2.requiresIContext=true;function x2(i,j){var k=Object.assign({},j);var q3=Object.assign({},i);j=o2(q3,k);var r3="None";if(j&&j.Criticality&&j.Criticality.Path){r3="{path:'"+j.Criticality.Path+"'}";}else{r3=o1(i,j,n.StateValues);r3=v(r3);}return r3;}x2.requiresIContext=true;function y2(j,k){var q3;for(var i=0;i<k.length;i++){q3=k[i];if(q3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||q3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||q3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}y2.requiresIContext=true;function z2(i,j){var k=B(i,j)[0];if(k&&k.Value&&k.Value.$Path){var q3=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var r3=i.getModel(0);var s3=r3.getData(k.Value.$Path);var t3=q3.substr(1,q3.length-2);if(s3&&s3[t3][k.Value.$Path]["Org.OData.Measures.V1.Unit"]){return s3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}z2.requiresIContext=true;function A2(i){var j=i.getObject();var k=i.getModel();var q3=k.getProperty("/metaModel");var r3="/"+k.getProperty("/entitySet");var s3=q3.getObject(r3);j="/"+s3.$Type+"/@"+j;return q3.createBindingContext(j);}function B2(i,j){if(i==='Edm.String'){var k=j.PropertyValue.String;return k;}return j.PropertyValue.String;}function C2(i,j,k,q3){var r3="";var s3=[];if(q3&&q3.Parameters){i.parameters.forEach(function(u3){q3.Parameters.forEach(function(v3){var w3=v3.PropertyName.PropertyPath.split("/");w3=w3[w3.length-1];if(w3===u3){var x3=B2(i['parameterType'][u3],v3);x3=d(j.formatValue(x3,i['parameterType'][u3]));s3.push(w3+'='+x3);}});});}else{r3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return r3;}try{r3='/'+i.entitySetName+'('+s3.join(',')+')/'+i.navPropertyName;}catch(t3){r3="/"+k.name;L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+t3||t3.message);}return r3;}function D2(j,k,q3,r3,s3){var t3="";var u3=new o.Model(o.Model.ReferenceByModel(j));var v3=u3.findQueryResultByName(k.name);var w3=new o.QueryResultRequest(v3);var x3=v3.getParameterization();if(!x3){t3="/"+k.name;return t3;}if(s3){var y3=s3.getAnalyticalParameters();}if(x3){var z3;w3.setParameterizationRequest(new o.ParameterizationRequest(x3));if(q3&&q3.Parameters){e(q3.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){z3=this.PropertyNameFrom.PropertyPath.split("/");w3.getParameterizationRequest().setParameterValue(z3[z3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{z3=this.PropertyName.PropertyPath.split("/");w3.getParameterizationRequest().setParameterValue(z3[z3.length-1],this.PropertyValue.String);}});}else if(r3){e(r3,function(){w3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(y3&&y3.length>0){var A3=s3&&s3.getUiState({allFilters:false});var B3=A3?JSON.stringify(A3.getSelectionVariant()):"{}";var q3=new S(B3);for(var C3 in x3.getAllParameters()){for(var i=0;i<y3.length;i++){if(y3[i]&&(y3[i].name==C3)){var D3=y3[i].name;var E3=q3.getParameter(D3);if(!E3){var F3=q3.getSelectOption(D3);E3=F3&&F3[0]&&F3[0].Low;}w3.getParameterizationRequest().setParameterValue(C3,E3);}}}}else{t3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return t3;}}try{t3=w3.getURIToQueryResultEntitySet();}catch(G3){v3=w3.getQueryResult();t3="/"+v3.getEntitySet().getQName();L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+G3||G3.message);}return t3;}function E2(i,j,k,q3,r3){var s3="";if(M.checkAnalyticalParameterisedEntitySet(i,j.name)){s3=D2(i,j,k,q3,r3);}else{var t3=M.getParametersByEntitySet(i,j.name);var u3=M.getPropertyOfEntitySet(i,j.name);var v3={};if(t3){t3['parameters'].forEach(function(w3){u3.forEach(function(x3){if(x3['name']==w3){v3[w3]=x3['type'];}});});t3['parameterType']=v3;s3=C2(t3,i,j,k);}else{s3="/"+j.name;}}return s3;}function F2(j,k,ns){var q3=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<q3.length;i++){if(ns+"."+q3[i].name===k){return q3[i];}}}function G2(i,j){var k=i.filter(function(r3){if(r3.$Type==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var q3=P(k);if(q3){return q3[j];}return;}function H2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=G2(k,0);return q2(i,j,k);}H2.requiresIContext=true;function I2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=G2(k,1);return q2(i,j,k);}I2.requiresIContext=true;function J2(i,j){var k=i.filter(function(r3){if(r3.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&r3.Target.$AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var q3=P(k);if(q3){return q3[j];}return;}function K2(i){if(!i||!i.length||i.length===0){return false;}var j=J2(i,0);if(j){return true;}return false;}function L2(i,j,k,q3){var r3;if(k&&k.Value&&k.Value.$Path){r3=k.Value.$Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.$Path){r3=k.Description.Value.$Path;}var s3="";var t3=q3&&q3.Parameters;var u3="";var v3=i.getSetting('ovpCardProperties'),w3=v3.getProperty('/parameters');t3=t3||!!w3;var x3=i.getSetting("dataModel");if(t3){var y3=E2(x3,j,q3,w3);s3+="{path: '"+y3+"'";}else{s3+="{path: '/"+j.$Type.split(".")[1]+"'";}s3+=", length: 1";var z3=i.getSetting('ovpCardProperties');var A3=z3.getProperty("/entityType");var B3=i.getModel(0);var C3=B3.getObject("/"+j.$Type.split(".")[1]+"/");var D3,E3;for(D3 in C3){if(D3.startsWith("$")){continue;}E3=A3.$Type.concat("/",D3);C3[D3].annotations=B3.getData(D3).$Annotations[E3];}var F3=D1(z3,q3);if(F3.length>0){u3+=", filters: "+JSON.stringify(F3);}var G3=[];var H3=x3.oMetaModel.getData().$Annotations;var I3=M2(r3,H3,j.$Type);G3.push("'"+r3+"Agg' : { 'name' : '"+r3+"', 'with' : '"+I3+"'}");if(k&&k.Criticality&&k.Criticality.$Path){I3=M2(k.Criticality.$Path,H3,j.$Type);G3.push("'"+k.Criticality.$Path+"Agg' : { 'name' : '"+k.Criticality.$Path+"', 'with' : '"+I3+"'}");}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.$Path){I3=M2(k.CriticalityCalculation.DeviationRangeLowValue.$Path,H3,j.$Type);G3.push("'"+k.CriticalityCalculation.DeviationRangeLowValue.$Path+"Agg' : { 'name' : '"+k.CriticalityCalculation.DeviationRangeLowValue.$Path+"', 'with' : '"+I3+"'}");}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.$Path){var I3=M2(k.CriticalityCalculation.ToleranceRangeLowValue.$Path,H3,j.$Type);G3.push("'"+k.CriticalityCalculation.ToleranceRangeLowValue.$Path+"Agg' : { 'name' : '"+k.CriticalityCalculation.ToleranceRangeLowValue.$Path+"', 'with' : '"+I3+"'}");}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.$Path){var I3=M2(k.CriticalityCalculation.DeviationRangeHighValue.$Path,H3,j.$Type);G3.push("'"+k.CriticalityCalculation.DeviationRangeHighValue.$Path+"Agg' : { 'name' : '"+k.CriticalityCalculation.DeviationRangeHighValue.$Path+"', 'with' : '"+I3+"'}");}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.$Path){var I3=M2(k.CriticalityCalculation.ToleranceRangeHighValue.$Path,H3,j.$Type);G3.push("'"+k.CriticalityCalculation.ToleranceRangeHighValue.$Path+"Agg' : { 'name' : '"+k.CriticalityCalculation.ToleranceRangeHighValue.$Path+"', 'with' : '"+I3+"'}");}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.$Path){var I3=M2(k.TrendCalculation.ReferenceValue.$Path,H3,j.$Type);G3.push("'"+k.TrendCalculation.ReferenceValue.$Path+"Agg' : { 'name' : '"+k.TrendCalculation.ReferenceValue.$Path+"', 'with' : '"+I3+"'}");}var J3=t1(v3);var K3=J3?", custom: {cardId: '"+v3.getProperty("/cardId")+"'}":"";var L3="parameters:{'$$aggregation' : {'aggregate' : {"+G3.join(",")+"}}"+K3+"}";return s3+", "+L3+u3+"}";}L2.requiresIContext=true;function M2(i,j,k){var q3=j[k+"/"+i];if(q3["@Org.OData.Aggregation.V1.default"]){return q3["@Org.OData.Aggregation.V1.default"].$EnumMember.split("/")[1].toLowerCase();}return"sum";}function N2(i,j,k){var q3;var r3,s3,t3;for(t3 in j){if(t3!==i){continue;}if(j[t3].annotations&&j[t3].annotations.hasOwnProperty("@Org.OData.Measures.V1.ISOCurrency")){r3=j[t3].annotations["@Org.OData.Measures.V1.ISOCurrency"].$Path;s3=j[t3].annotations["@Org.OData.Measures.V1.ISOCurrency"].$String;if(r3){return r3;}else{return(k?s3:"");}}if(j[t3].annotations&&j[t3].annotations.hasOwnProperty("@Org.OData.Measures.V1.Unit")){r3=j[t3].annotations.hasOwnProperty("@Org.OData.Measures.V1.Unit").$Path;s3=j[t3].annotations["@Org.OData.Measures.V1.Unit"].$String;if(r3){q3=r3;}else{q3=k?s3:"";}if(q3&&q3!="%"){return q3;}else{return null;}}if(j[t3].annotations&&j[t3].annotations.hasOwnProperty("sap:unit")){return j[t3].annotations["sap:unit"];}break;}return null;}function O2(i){if(!i||!i.Value||!i.Value.$Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var q3=j.getProperty("/metaModel");var r3=c1(q3,k,i.Value.$Path);if(r3["Org.OData.Measures.V1.Unit"]){var s3=r3["Org.OData.Measures.V1.Unit"];if(s3.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits;}var t3={NumberOfFractionalDigits:this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits?this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits:0,percentageAvailable:this.getModel("ovpCardProperties").oData.percentageAvailable?this.getModel("ovpCardProperties").oData.percentageAvailable:false};var u3='sap.ovp.cards.v4.V4AnnotationHelper.KpiValueFormatter';var v3=[i.Value.$Path+"Agg"];return d1(v3,u3,t3,true);}function P2(){var i=arguments[arguments.length-1],k=arguments[0];k=k?parseInt(k.split(",").join(""),10):null;var j=N.getFloatInstance({minFractionDigits:i.NumberOfFractionalDigits,maxFractionDigits:i.NumberOfFractionalDigits,style:"short",showScale:true,shortRefNumber:k});if(i.percentageAvailable){return j.format(Number(k))+" %";}else{return j.format(Number(k));}}function Q2(i,j){if(!j||!j.Value||!j.Value.$Path||!j.TrendCalculation){return"";}var k=H1(j.Value,true);var q3=H1(j.TrendCalculation.ReferenceValue,true);var r3=H1(j.TrendCalculation.DownDifference,true);var s3=H1(j.TrendCalculation.UpDifference,true);var t3=r1(q3);var u3=r1(r3);var v3=r1(s3);var w3={"referenceValue":q3,"downDifference":r3,"upDifference":s3,"bIsRefValBinding":t3,"bIsDownDiffBinding":u3,"bIsUpDiffBinding":v3};var x3="{value:"+JSON.stringify(w3)+", model: 'ovpCardProperties'}";var y3="parts: ["+k;y3+=t3?","+q3:"";y3+=u3?","+r3:"";y3+=v3?","+s3:"";y3+=","+x3;y3+="]";var z3="sap.ovp.cards.v4.V4AnnotationHelper.formatTrendIcon";return"{"+y3+", formatter: '"+z3+"'}";}Q2.requiresIContext=true;function R2(){var i=arguments[arguments.length-1];var j=1;return y(arguments[0],i.bIsRefValBinding?arguments[j++]:i.referenceValue,i.bIsDownDiffBinding?arguments[j++]:i.downDifference,i.bIsUpDiffBinding?arguments[j++]:i.upDifference);}function S2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits;}if(i.TrendCalculation.ReferenceValue.$Path){return"{parts: [{path:'"+i.Value.$Path+"Agg', type:'sap.ui.model.odata.type.Decimal'}, {path:'"+i.TrendCalculation.ReferenceValue.$Path+"'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.$Path+"Agg', type:'sap.ui.model.odata.type.Decimal'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.returnPercentageChange'}";}}function T2(k,i){var j,q3,r3,s3,t3=false;if(typeof k=="string"){k=N.getIntegerInstance().parse(k);}if(isNaN(+k)){return"";}if(k==0){s3=i;}else{s3=k;}q3=this.getModel('ovpCardProperties');if(q3.getProperty("/iNumberOfFractionalDigits")){r3=+(q3.getProperty("/iNumberOfFractionalDigits"));}if(q3.getProperty("/bPercentageAvailableForTarget")){t3=true;}if(i){j=i;}else{if(q3.getProperty("/sManifestTargetValue")){j=q3.getProperty("/sManifestTargetValue");}}if(!r3||r3<0){r3=0;}else if(r3>2){r3=2;}if(j){var u3=N.getFloatInstance({minFractionDigits:r3,maxFractionDigits:r3,style:"short",showScale:true,shortRefNumber:s3});if(t3){return u3.format(+(j))+" %";}else{return u3.format(+(j));}}}function U2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.$Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var q3=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.$Path){var r3=c1(q3,k,i.TrendCalculation.ReferenceValue.$Path);if(r3["Org.OData.Measures.V1.Unit"]){var s3=r3["Org.OData.Measures.V1.Unit"];if(s3.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.$Path+"Agg', type:'sap.ui.model.odata.type.Decimal'},{path:'"+i.TrendCalculation.ReferenceValue.$Path+"Agg', type:'sap.ui.model.odata.type.Decimal'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue);return"{parts: [{path:'"+i.Value.$Path+"Agg', type:'sap.ui.model.odata.type.Decimal'}], formatter: 'sap.ovp.cards.v4.V4AnnotationHelper.TargetValueFormatter'}";}}}function V2(k,i){var j,q3,r3;if(typeof k=="string"){k=N.getIntegerInstance().parse(k);}if(isNaN(+k)){return"";}k=+(k);r3=this.getModel('ovpCardProperties');if(r3.getProperty("/iNumberOfFractionalDigits")){j=+(r3.getProperty("/iNumberOfFractionalDigits"));}if(i){q3=+(i);}else{if(r3.getProperty("/sManifestTargetValue")){q3=+(r3.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(q3){var s3=((k-q3)/q3);var t3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return t3.format(s3);}}function W2(i){if(i&&i.GroupBy&&!(h(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('$PropertyPath')){return true;}else{return false;}}function X2(j,k){var q3;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){q3=j[i];break;}}return q3?q3.name:null;}function Y2(i,k){return X2(i,k);}function Z2(i,k){var j=X2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function $2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var q3=this.getModel('ovpCardProperties').getProperty("/metaModel");var r3=this.getModel('ovpCardProperties').getProperty("/entityType");var s3;if(i.GroupBy.constructor===Array){s3=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{s3=i.GroupBy.Collection;}var t3;e(s3,function(){t3=f3(q3,r3,this.$PropertyPath);if(!t3){return;}j+=t3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function _2(i,j,k){var q3=true;var r3=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][r3].PropertyName.PropertyPath){q3=false;}j=[j];var s3=i.getSetting('ovpCardProperties');var t3=s3.getProperty("/entityType");var u3=s3.getProperty("/metaModel");var v3=D1(s3,j);if(v3.length==0){return"";}var w3;var x3;w3=v3[0].path;x3=g3(u3,t3,w3);if(x3!==w3){return"";}var y3=u3.getODataProperty(t3,j[0].PropertyName.PropertyPath)["type"];var z3=d3(v3,y3);if(q3===true){return z3+", ";}return z3;}_2.requiresIContext=true;function a3(i,j,k){var q3=!(j.index===(k.length-1));var r3=i.getSetting('ovpCardProperties');var s3=r3.getProperty("/metaModel");var t3=r3.getProperty("/entityType");var u3=s3.getODataProperty(t3,k[j.index].path)["type"];var v3=d3([k[j.index]],u3);if(q3===true){return v3+", ";}return v3;}a3.requiresIContext=true;function b3(i){return i.id;}function c3(i){return i.id;}function d3(j,k){var q3=[];for(var i=0;i<j.length;i++){q3.push(e3(j[i],k));}return q3.join(', ');}function e3(i,j){var k=false;var q3,r3=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){q3=r3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){q3=r3.format(new Date(i.value1),true);}else{q3=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){q3+=" - "+r3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){q3+=" - "+r3.format(new Date(i.value1),true);}else{q3+=" - "+i.value1;}}if(k){q3=b.getText("kpiHeader_Filter_NotOperator",[q3]);}return q3;}function f3(i,j,k){return h3(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function g3(i,j,k){return h3(i,j,k,"sap:text");}function h3(i,j,k,q3){var r3={};r3[k]=c1(i,j,k);if(!r3){L.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}if(r3[k].annotations){var s3=r3[k].annotations["@"+q3];}if(s3){return s3;}return Object.keys(r3)[0];}function i3(i){if(!i||!i.Value||!i.Value.$Path){return"";}var j={NumberOfFractionalDigits:this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits?this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits:0,percentageAvailable:this.getModel("ovpCardProperties").oData.percentageAvailable?this.getModel("ovpCardProperties").oData.percentageAvailable:false};var k='sap.ovp.cards.v4.V4AnnotationHelper.KpiValueFormatter';var q3=[i.Value.$Path];return d1(q3,k,j);}function j3(i,j){if(j.hasOwnProperty(i)){return true;}return false;}function k3(i,j){var k;if(j[i].customDateRangeImplementation){return j[i].customDateRangeImplementation;}else if(j[i].filter){k={module:'sap.ui.comp.config.condition.DateRangeType',operations:{filter:j[i].filter}};return JSON.stringify(k);}else if(j[i].selectedValues){k={module:'sap.ui.comp.config.condition.DateRangeType',operations:{filter:[{path:'key',contains:j[i].selectedValues,exclude:j[i].exclude}]}};return JSON.stringify(k);}else if(j[i].defaultValue){k={module:'sap.ui.comp.config.condition.DateRangeType'};return JSON.stringify(k);}}function l3(i){if(i){return undefined;}return"_BASIC";}function m3(j,k){for(var i=0;i<k.length;i++){if(k[i].type.$EnumMember.indexOf('ContactInformationType/work')>=0){var q3=O.format(k[i].address,{context:j});return q3;}}return"";}m3.requiresIContext=true;function n3(j,k){for(var i=0;i<k.length;i++){if(k[i].type.$EnumMember.indexOf('PhoneType/work')>=0){var q3=O.format(k[i].uri,{context:j});return q3;}}return"";}n3.requiresIContext=true;function o3(j,k){for(var i=0;i<k.length;i++){if(k[i].type.$EnumMember.indexOf('PhoneType/cell')>=0){var q3=O.format(k[i].uri,{context:j});return q3;}}return"";}o3.requiresIContext=true;function p3(j,k){for(var i=0;i<k.length;i++){if(k[i].type.$EnumMember.indexOf('PhoneType/fax')>=0){var q3=O.format(k[i].uri,{context:j});return q3;}}return"";}p3.requiresIContext=true;return{getGroupID:l3,getConditionTypeForDateProperties:k3,isDateRangeType:j3,criticalityConstants:n,TextArrangementType:T,getLabelForDataItem:q,colorPaletteForComparisonMicroChart:k1,formatField:$,checkFilterPreference:t1,formatItems:u1,getCardSelections:A1,getCardSorters:B1,getFilters:D1,getPrimitiveValue:G1,getAnnotationLabel:Y2,getApplicationName:Z2,removeDuplicateDataField:J1,formatUrl:K1,getDataPointsCount:L1,getFirstDataPointValue:M1,getFirstDataFieldName:P1,getSecondDataFieldName:Q1,getRequestFields:z1,getThirdDataFieldName:R1,formatDataFieldValueOnIndex:U1,formatDataPointValueOnIndex:V1,formatDataPointOrField:W1,formatsemanticObjectOfDataFieldGeneric:X1,getLabelForFirstDataPoint:_1,formatImageUrl:a2,formatUnit:b2,formatObjectNumber:c2,formatFirstDataPointState:d2,formatFirstDataPointColor:e2,formatSecondDataPointState:f2,formatThirdDataPointState:g2,formatFirstDataPointStateForSmartField:h2,formatKPIHeaderState:j2,isFirstDataPointCriticality:k2,isFirstDataPointCriticalityForTableStatus:l2,getSortedDataFields:z,getSortedDataPoints:B,formatDataFieldValueGeneric:p2,formatDataPointValue:t2,formatDataPointStateGeneric:u2,checkCriticalityGeneric:v2,checkCriticalityGenericForTableStatus:w2,formatDataPointStateForSmartFieldGeneric:x2,hasActions:y2,isFirstDataPointPercentageUnit:z2,resolveEntityTypePath:A2,resolveParameterizedEntitySet:E2,getAssociationObject:F2,semanticObjectOfFirstDataField:H2,semanticObjectOfSecondDataField:I2,isFirstContactAnnotation:K2,getAggregateNumber:L2,KpiValueFormatter:P2,kpiValueCriticality:i2,formThePathForAggregateNumber:O2,formThePathForTrendIcon:Q2,formPathForPercentageChange:S2,TargetValueFormatter:T2,formPathForTargetValue:U2,returnPercentageChange:V2,isPresentationVarientPresent:W2,listGroupBy:$2,formTheFilterByString:_2,formTheFilterByStringNotFromSelVar:a3,formTheIdForFilter:b3,formTheIdForFilterNotFromSelVar:c3,_criticality2state:u,_calculateCriticalityState:x,_calculateTrendDirection:y,_getPropertiesFromBindingString:x1,sortCollectionByImportance:P,checkNavTargetForContactAnno:r2,checkForContactAnnotation:s2,getKPIHeaderAggregateNumber:i3,formatColor:q1,formatTrendIcon:R2,formatNumberCalculation:e1,formatCurrency:g1,formatDate:f1,getEmail:m3,getPhone:n3,getDevice:o3,getPhoneType:p3};},true);
