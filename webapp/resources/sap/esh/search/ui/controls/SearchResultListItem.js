/*!
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["../i18n","sap/esh/search/ui/controls/SearchText","sap/esh/search/ui/controls/SearchLink","sap/esh/search/ui/controls/twitter/SearchTweet","sap/esh/search/ui/SearchHelper","sap/esh/search/ui/controls/SearchRelatedObjectsToolbar","sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Text","sap/m/CheckBox","sap/m/ListType","sap/ui/core/Icon","sap/ui/core/IconPool","sap/ui/core/InvisibleText",],function(a,S,b,c,e,f,B,g,L,T,C,h,I,j,l){"use strict";var n="\u2013";return sap.ui.core.Control.extend("sap.esh.search.ui.controls.SearchResultListItem",{metadata:{properties:{dataSource:"object",itemId:"string",title:"string",titleDescription:"string",titleNavigation:"object",titleIconUrl:"string",titleInfoIconUrl:"string",geoJson:"object",type:"string",imageUrl:"string",imageFormat:"string",imageNavigation:"object",attributes:{type:"object",multiple:true,},navigationObjects:{type:"object",multiple:true,},selected:"boolean",expanded:"boolean",parentListItem:"object",additionalParameters:"object",positionInList:"int",resultSetId:"string",layoutCache:"object",totalCountHiddenElement:"object",},aggregations:{_titleLink:{type:"sap.esh.search.ui.controls.SearchLink",multiple:false,visibility:"hidden",},_titleLinkDescription:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden",},_titleDelimiter:{type:"sap.m.Text",multiple:false,visibility:"hidden",},_typeText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden",},_typeLink:{type:"sap.esh.search.ui.controls.SearchLink",multiple:false,visibility:"hidden",},_typeLinkAriaDescription:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden",},_multiLineDescriptionText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden",},_multiLineDescriptionTweet:{type:"sap.esh.search.ui.controls.twitter.SearchTweet",multiple:false,visibility:"hidden",},_selectionCheckBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden",},_expandButton:{type:"sap.m.Button",multiple:false,visibility:"hidden",},_attributeLabels:{type:"sap.m.Label",multiple:true,visibility:"hidden",},_attributeValues:{type:"sap.ui.core.Control",multiple:true,visibility:"hidden",},_attributeValuesWithoutWhyfoundHiddenTexts:{type:"sap.ui.core.InvisibleText",multiple:true,visibility:"hidden",},_relatedObjectActionsToolbar:{type:"sap.esh.search.ui.controls.SearchRelatedObjectsToolbar",multiple:false,visibility:"hidden",},_titleLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden",},_attributesLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden",},_expandStateLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden",},},},init:function(){var t=this;if(sap.ui.core.Control.prototype.init){sap.ui.core.Control.prototype.init.apply(this,arguments);}t.setAggregation("_titleLink",new b({}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-Title").addStyleClass("sapUshellSearchResultListItem-MightOverflow").attachPress(function(E){var p=t._getPhoneSize();var w=$(window).width();if(w<=p){E.preventDefault();E.cancelBubble();t._performTitleNavigation();}else{t._performTitleNavigation({trackingOnly:true,});}}));t.setAggregation("_titleLinkDescription",new S({}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));var d=new T({text:"|",});d.addEventDelegate({onAfterRendering:function(){$(this.getDomRef()).attr("aria-hidden","true");}.bind(d),});t.setAggregation("_titleDelimiter",d.addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleDelimiter").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));t.setAggregation("_typeText",new S().addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleCategory").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));t.setAggregation("_typeLinkAriaDescription",new l({text:a.getText("result_list_item_type_link_description"),}));t.setAggregation("_typeLink",new b({}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleCategoryLink").addStyleClass("sapUshellSearchResultListItem-MightOverflow").addAriaDescribedBy(t.getAggregation("_typeLinkAriaDescription")));t.setAggregation("_multiLineDescriptionText",new S({maxLines:5,}).addStyleClass("sapUshellSearchResultListItem-MultiLineDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow").data("islongtext","true",true));t.setAggregation("_multiLineDescriptionTweet",new c({}).addStyleClass("sapUshellSearchResultListItem-MultiLineDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow").data("islongtext","true",true));t.setAggregation("_selectionCheckBox",new C({select:function(E){t.setProperty("selected",E.getParameters().selected,true);t.getModel().updateMultiSelectionSelected();},}));t.setAggregation("_expandButton",new B({type:g.Transparent,press:function(){t.toggleDetails();},}));t.setAggregation("_relatedObjectActionsToolbar",new f().addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar"));t.setAggregation("_titleLabeledByText",new l());t.setAggregation("_attributesLabeledByText",new l());t.setAggregation("_expandStateLabeledByText",new l());},renderer:function(r,o){o._renderer(r);},_renderer:function(r){this._registerItemPressHandler();this._resetPrecalculatedValues();this._renderContainer(r);this._renderAccessibilityInformation(r);},_renderContainer:function(r){var t=this;r.write("<div");r.writeControlData(t);r.addClass("sapUshellSearchResultListItem-Container");if(t.getImageUrl()){r.addClass("sapUshellSearchResultListItem-WithImage");}if(t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail"){r.addClass("sapUshellSearchResultListItem-Document");}r.writeClasses();r.write(">");t._renderContentContainer(r);t._renderExpandButtonContainer(r);r.write("</div>");},_renderContentContainer:function(r){r.write('<div class="sapUshellSearchResultListItem-Content">');this._renderTitleContainer(r);this._renderAttributesContainer(r);r.write("</div>");},_renderExpandButtonContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-ExpandButtonContainer">');r.write('<div class="sapUshellSearchResultListItem-ExpandButton">');var i,d;var k=t.getProperty("expanded");if(k){i=j.getIconURI("slim-arrow-up");d=a.getText("hideDetailBtn_tooltip");}else{i=j.getIconURI("slim-arrow-down");d=a.getText("showDetailBtn_tooltip");}var m=t.getAggregation("_expandButton");m.setIcon(i);m.setTooltip(d);m.addEventDelegate({onAfterRendering:function(){t.setAriaExpandedState();},});r.renderControl(m);r.write("</div>");r.write("</div>");},_renderTitleContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-TitleAndImageContainer">');r.write('<div class="sapUshellSearchResultListItem-TitleContainer">');t._renderCheckbox(r);var d="";var i;var k=t.getAggregation("_titleLink");var m=t.getTitle();if(!m||m.trim().length===0){m=n;}else{var o=t.getTitleNavigation();if(o){d=o.getHref();i=o.getTarget();}k.setHref(d);if(i){k.setTarget(i);}}k.setText(m);if(d.length===0){k.setEnabled(false);}k.addEventDelegate({onAfterRendering:function(){t.forwardEllipsis($(k.getDomRef()));},});if(t.getTitleIconUrl&&t.getTitleIconUrl()){var p=new I({src:t.getTitleIconUrl(),});k.setAggregation("icon",p);}r.renderControl(k);if(t.getTitleInfoIconUrl()){var q=new I({src:t.getTitleInfoIconUrl(),}).addStyleClass("sapUshellSearchResultListItem-TitleInfoIcon");r.renderControl(q);}var s=t.getTitleDescription();if(s&&s.trim().length>0){var u=t.getAggregation("_titleLinkDescription");u.setText(s);r.renderControl(u);}var v=t.getAggregation("_titleDelimiter");r.renderControl(v);if(!t.getModel().config._eshClickableObjectType||t.getModel().getDataSource()===t.getDataSource()){var w=t.getAggregation("_typeText");w.setText(t.getType());r.renderControl(w);}else{var x=this.getModel().getProperty("/uiFilter").clone();x.setDataSource(t.getDataSource());var y=t.getModel().searchUrlParser.renderFromParameters(this.getModel().boTopDefault,x,true);var z=t.getAggregation("_typeLink");z.setText(t.getType());z.setHref(y);z.setTooltip(a.getText("searchInDataSourceTooltip",[t.getDataSource().labelPlural]));r.renderControl(t.getAggregation("_typeLinkAriaDescription"));r.renderControl(z);}r.write("</div>");t._renderImageForPhone(r);r.write("</div>");},_renderCheckbox:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-CheckboxExpandContainer">');r.write('<div class="sapUshellSearchResultListItem-CheckboxContainer">');r.write('<div class="sapUshellSearchResultListItem-CheckboxAlignmentContainer">');var d=t.getAggregation("_selectionCheckBox");var s=t.getProperty("selected");d.setSelected(s);r.renderControl(d);r.write("</div>");r.write("</div>");r.write("</div>");},_renderImageForPhone:function(r){var t=this;if(t.getImageUrl()){r.write('<div class="sapUshellSearchResultListItem-TitleImage');if(this.getImageFormat()==="round"){r.write(" sapUshellSearchResultListItem-ImageContainerRound");}r.write('">');r.write('<div class="sapUshellSearchResultListItem-ImageContainerAlignmentHelper"></div>');r.write('<img class="sapUshellSearchResultListItem-Image" src="');r.write(t.getImageUrl());r.write('">');r.write("</div>");}},_renderImageForDocument:function(r){var t=this;if(t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail"){var i=this.getImageNavigation();var d=i?i.getHref():"";var k,m;if(d&&d.length>0){k='<a href="'+d+'"';m="</a>";}else{k="<div";m="</div>";}r.write('<div class="sapUshellSearchResultListItem-DocumentThumbnailContainer">');r.write(k+' class="sapUshellSearchResultListItem-DocumentThumbnailBorder">');r.write('<div class="sapUshellSearchResultListItem-DocumentThumbnail-DogEar"></div>');var z=new I({src:j.getIconURI("search"),useIconTooltip:false,});z.addStyleClass("sapUshellSearchResultListItem-DocumentThumbnailZoomIcon");r.renderControl(z);var o=t.getImageUrl();if(o&&o.length>0){r.write('<img class="sapUshellSearchResultListItem-DocumentThumbnail" src="');r.write(t.getImageUrl());r.write('">');}r.write(m);r.write("</div>");}},_cutDescrAttributeOutOfAttributeList:function(){var d=this.getAttributes();for(var i=0;i<d.length;i++){var k=d[i];if(k.longtext){d.splice(i,1);this.setAttributes(d);return k;}}return undefined;},_renderMultiLineDescription:function(r){var t=this;if(t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail"){var d=this._cutDescrAttributeOutOfAttributeList();if(d&&d.value&&d.value.length>0){var i;if(this._isTweet(d)){i=t.getAggregation("_multiLineDescriptionTweet");}else{i=t.getAggregation("_multiLineDescriptionText");}i.setText(d.value);if(d.whyfound){i.data("ishighlighted","true",true);}else{i.data("ishighlighted","false",true);}if(d.valueWithoutWhyfound){var k=new l({});k.setText(d.valueWithoutWhyfound);i.data("tooltippedBy",k.getId(),true);i.addEventDelegate({onAfterRendering:function(){var m=$(i.getDomRef());m.attr("aria-describedby",m.attr("data-tooltippedby"));},});t.addAggregation("_attributeValuesWithoutWhyfoundHiddenTexts",k,true);r.renderControl(k);}r.renderControl(i);}else{r.write('<div class="sapUshellSearchResultListItem-MultiLineDescription"></div>');}}},_renderAttributesContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-AttributesExpandContainer');var d=t.getProperty("expanded");if(d){r.write(" sapUshellSearchResultListItem-AttributesExpanded");}r.write('">');r.write('<div class="sapUshellSearchResultListItem-AttributesAndActions">');t._renderImageForDocument(r);t._renderMultiLineDescription(r);r.write('<ul class="sapUshellSearchResultListItem-Attributes">');var i=t.getAttributes();t._renderImageAttribute(r,i.length===0);t._renderAllAttributes(r,i);r.write('<li class="sapUshellSearchResultListItem-ExpandSpacerAttribute" aria-hidden="true"></li>');r.write("</ul>");t._renderRelatedObjectsToolbar(r);r.write("</div>");r.write("</div>");},_renderAllAttributes:function(r,d){var t=this;if(d.length===0){r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-MainAttribute sapUshellSearchResultListItem-EmptyAttributePlaceholder" aria-hidden="true"></li>');return;}var m;var o;var v;var p;var q,s,u;var w;var x;var y=this.getLayoutCache()||{};this.setLayoutCache(y,true);if(!y.attributes){y.attributes={};}var i=0,k,z=0;var A=4;var D=3;var E=[0,0,0];var F=[0,0,0,0];var G=2;var H=2;var J;var K=t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail";var M=t.getImageUrl()&&!K;if(K){A=D=2;E=F=[0,0];G=H=4;}var N=A*E.length;var O=D*F.length;if(M){N--;O--;E[0]++;F[0]++;}t.destroyAggregation("_attributeLabels");t.destroyAggregation("_attributeValues");t.destroyAggregation("_attributeValuesWithoutWhyfoundHiddenTexts");var P=function(X){return function(){var Y=$(this.getDomRef());Y.attr("aria-describedby",Y.attr("data-tooltippedby"));}.bind(X);};for(;!(G<=0&&H<=0)&&i<d.length;i++){m=d[i];if(K&&z>=4){break;}if(m.isTitle){continue;}if(N<=0&&O<=0&&!m.whyfound){continue;}o=m.name;v=m.value;if(o===undefined||v===undefined){continue;}if(!v||v.trim().length===0){v=n;}if(m.longtext===undefined||m.longtext===null||m.longtext===""){u=false;}else{u=true;}p=m.valueWithoutWhyfound;var _=-1,Q=-1,R={desktop:1,tablet:1,};var U=y.attributes[m.key]||{};y.attributes[m.key]=U;r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-MainAttribute');if(u){J=U.longTextColumnNumber||t._howManyColumnsToUseForLongTextAttribute(p);U.longTextColumnNumber=J;R=J;r.write(" sapUshellSearchResultListItem-LongtextAttribute");}if(N<=0){if(m.whyfound&&G>0){r.write(" sapUshellSearchResultListItem-WhyFoundAttribute-Desktop");G--;}else{r.write(" sapUshellSearchResultListItem-DisplayNoneAttribute-Desktop");}}if(O<=0){if(m.whyfound&&H>0){r.write(" sapUshellSearchResultListItem-WhyFoundAttribute-Tablet");H--;}else{r.write(" sapUshellSearchResultListItem-DisplayNoneAttribute-Tablet");}}if(u&&M&&E[0]===1){Q=0;J=U.longTextColumnNumber.desktop<A?U.longTextColumnNumber.desktop:A-1;E[0]+=J;N-=J;}else{for(k=0;k<E.length;k++){if(E[k]+R.desktop<=A){E[k]+=R.desktop;N-=R.desktop;Q=k;break;}}}if(Q<0){Q=E.length;}if(u&&M&&F[0]===1){_=0;J=U.longTextColumnNumber.tablet<D?U.longTextColumnNumber.tablet:D-1;F[0]+=J;O-=J;}else{for(k=0;k<F.length;k++){if(F[k]+R.tablet<=D){F[k]+=R.tablet;O-=R.tablet;_=k;break;}}}if(_<0){_=F.length;}r.write(" sapUshellSearchResultListItem-OrderTablet-"+_);r.write(" sapUshellSearchResultListItem-OrderDesktop-"+Q);r.write('"');if(u){r.write(' data-sap-searchresultitem-attributeweight-desktop="'+R.desktop+'"');r.write(' data-sap-searchresultitem-attributeweight-tablet="'+R.tablet+'"');}r.write(">");q=new L({displayOnly:true,});q.setText(o);q.addStyleClass("sapUshellSearchResultListItem-AttributeKey");q.addStyleClass("sapUshellSearchResultListItem-MightOverflow");r.renderControl(q);r.write('<span class="sapUshellSearchResultListItem-AttributeValueContainer">');x=undefined;if(m.iconUrl){x=new I({src:m.iconUrl,});x.addStyleClass("sapUshellSearchResultListItem-AttributeIcon");}if(m.defaultNavigationTarget){s=new b();s.setHref(m.defaultNavigationTarget.getHref());s.setTarget(m.defaultNavigationTarget.getTarget());s.addStyleClass("sapUshellSearchResultListItem-AttributeLink");if(x){s.setAggregation("icon",x);}}else if(this._isTweet(m)){s=new c();}else{s=new S();if(x){s.setAggregation("icon",x);}}s.setText(v);s.addStyleClass("sapUshellSearchResultListItem-AttributeValue");s.addStyleClass("sapUshellSearchResultListItem-MightOverflow");if(m.whyfound){s.data("ishighlighted","true",true);s.addStyleClass("sapUshellSearchResultListItem-AttributeValueHighlighted");}if(u){s.data("islongtext","true",true);}if(p){w=new l({});w.addStyleClass("sapUshellSearchResultListItem-AttributeValueContainer-HiddenText");w.setText(p);s.data("tooltippedBy",w.getId(),true);s.addEventDelegate({onAfterRendering:P(s),});t.addAggregation("_attributeValuesWithoutWhyfoundHiddenTexts",w,true);r.renderControl(w);}r.renderControl(s);r.write("</span>");r.write("</li>");t.addAggregation("_attributeLabels",q,true);t.addAggregation("_attributeValues",s,true);z++;}if(M){var V=A-E[0];var W=D-F[0];if(V>0||W>0){r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-MainAttribute');r.write(" sapUshellSearchResultListItem-OrderTablet-0 sapUshellSearchResultListItem-OrderDesktop-0");r.write('"');r.write(' data-sap-searchresultitem-attributeweight-desktop="'+V+'"');r.write(' data-sap-searchresultitem-attributeweight-tablet="'+W+'"');r.write("></li>");}}},_isTweet:function(i){var m=this.getModel();return m.config._tweetAttribute===i.key;},_howManyColumnsToUseForLongTextAttribute:function(d){if(d.length<50){return{tablet:1,desktop:1,};}if(d.length<85){return{tablet:2,desktop:2,};}if(d.length<135){return{tablet:3,desktop:3,};}return{tablet:3,desktop:4,};},_renderImageAttribute:function(r,i){var t=this;if(!t.getImageUrl()||(t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail")){return;}r.write('<li class="sapUshellSearchResultListItem-GenericAttribute sapUshellSearchResultListItem-ImageAttribute');if(i){r.write(" sapUshellSearchResultListItem-LonelyImageAttribute");}r.write('">');r.write('<div class="sapUshellSearchResultListItem-ImageContainer');if(this.getImageFormat()==="round"){r.write(" sapUshellSearchResultListItem-ImageContainerRound");}r.write('">');if(t.getImageUrl()){r.write('<img class="sapUshellSearchResultListItem-Image');if(this.getImageFormat()==="round"){}r.write('" src="');r.write(t.getImageUrl());r.write('">');}if(this.getImageFormat()!=="round"){r.write('<div class="sapUshellSearchResultListItem-ImageContainerAlignmentHelper"></div>');}r.write("</div>");r.write("</li>");},_renderRelatedObjectsToolbar:function(r){var t=this;var d=t.getNavigationObjects();if(!d||d.length===0){return;}t._showExpandButton=true;var i=t.getAggregation("_relatedObjectActionsToolbar");i.setProperty("navigationObjects",d);i.setProperty("positionInList",this.getPositionInList());r.renderControl(i);},_renderAccessibilityInformation:function(r){var t=this;var p=t.getProperty("parentListItem");if(p){t._renderAriaDescriptionElementForTitle(r,true,true);t._renderAriaDescriptionElementForAttributes(r,true);t._renderAriaDescriptionElementForCollapsedOrExpandedState(r,true);p.addEventDelegate({onAfterRendering:function(){var d=$(p.getDomRef());t._addAriaDescriptionToParentListElement(p,true);d.on("focusin",function(i){var k=$(i.relatedTarget);if(k.hasClass("sapUshellSearchResultListItem")||(k.closest(".sapUshellSearchResultListItemApps").length>0&&!k.hasClass("sapUshellResultListMoreFooter"))){t._renderAriaDescriptionElementForTitle(r,false,false);t._renderAriaDescriptionElementForAttributes(r,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(r,false);t._addAriaDescriptionToParentListElement(p,false);}else{t._renderAriaDescriptionElementForTitle(r,true,false);t._renderAriaDescriptionElementForAttributes(r,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(r,false);t._addAriaDescriptionToParentListElement(p,true);}});},onsapspace:function(E){if(E.target===E.currentTarget){t.toggleDetails();}},onsapenter:function(E){if(E.target===E.currentTarget){var d=t.getTitleNavigation();if(d){d.performNavigation();}}},});}},getAccessibilityInfo:function(){var d={};if(sap.ui.core.Control.prototype.getAccessibilityInfo){d=sap.ui.core.Control.prototype.getAccessibilityInfo.apply(this,arguments)||d;}d.description="";return d;},_renderAriaDescriptionElementForTitle:function(r,w,d){var t=this;t._searchResultListPrefix=t._searchResultListPrefix||a.getText("result_list_announcement_screenreaders");var i=t.getTitle()+", "+t.getType()+".";if(w){i=t._searchResultListPrefix+" "+i;}var k=t.getAggregation("_titleLabeledByText");if(k){k.setText(i);}if(d&&r){r.renderControl(k);}},_renderAriaDescriptionElementForAttributes:function(r,d){var t=this;var i=t.getAggregation("_attributesLabeledByText");var k=$(t.getDomRef()).find(".sapUshellSearchResultListItem-Attributes").find(".sapUshellSearchResultListItem-MainAttribute");var m;if(k.length===0){m=a.getText("result_list_item_aria_no_attributes");}else{m=a.getText("result_list_item_aria_has_attributes");k.each(function(){var o=$(this);if(o.is(":visible")&&o.attr("aria-hidden")!=="true"){var p=o.find(".sapUshellSearchResultListItem-AttributeKey").text();var q=o.find(".sapUshellSearchResultListItem-AttributeValueContainer");var s=q.find(".sapUshellSearchResultListItem-AttributeValueContainer-HiddenText");if(s.length===0){s=q.find(".sapUshellSearchResultListItem-AttributeValue");}var u=s.text();m+=a.getText("result_list_item_aria_attribute_and_value",[p,u,]);}});}if(i){i.setText(m);}if(d&&r){r.renderControl(i);}},_renderAriaDescriptionElementForCollapsedOrExpandedState:function(r,d){var t=this;var i=t.getAggregation("_expandStateLabeledByText");var k;var m=t.getAggregation("_expandButton");if(!m){return;}var o=$(m.getDomRef());if(o.css("visibility")!=="hidden"){if(t.isShowingDetails()){k=a.getText("result_list_item_aria_expanded");var p=this.getNavigationObjects();if(p&&p.length>0){k=a.getText("result_list_item_aria_has_links")+k;}}else{k=a.getText("result_list_item_aria_collapsed");}}i.setText(k);if(d&&r){r.renderControl(i);}},_addAriaDescriptionToParentListElement:function(p,i){var t=this.getAggregation("_titleLabeledByText");if(!t){return;}var d=t.getId();if(i){var k=this.getTotalCountHiddenElement();if(k){d+=" "+k.getId();}}var m=this.getAggregation("_attributesLabeledByText");d+=" "+m.getId();var o=this.getAggregation("_expandStateLabeledByText");d+=" "+o.getId();var q=$(p.getDomRef());q.attr("aria-labelledby",d);},_getExpandAreaObjectInfo:function(){var t=this;var r=$(t.getDomRef());r.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");var d=r.find(".sapUshellSearchResultListItem-AttributesExpandContainer");var i=r.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");var k=false;if(i.css("display")==="none"){i.css("display","block");k=true;}var m=d.height();var o=r.find(".sapUshellSearchResultListItem-AttributesAndActions").height();r.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");if(k){i.css("display","");}var p=this._getElementsInExpandArea();var q=200;var s=q/10;var u={resultListItem:r,attributesExpandContainer:d,currentHeight:m,expandedHeight:o,elementsToFadeInOrOut:p,expandAnimationDuration:q,fadeInOrOutAnimationDuration:s,relatedObjectsToolbar:i,};return u;},_getElementsInExpandArea:function(){var t=this;var d=$(t.getDomRef());var i=[];d.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");var k=d.find(".sapUshellSearchResultListItem-GenericAttribute:not(.sapUshellSearchResultListItem-ImageAttribute)");if(k.length>0){var m=k.position().top;k.each(function(){if($(this).position().top>m){i.push(this);}});}d.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");return i;},isShowingDetails:function(){var d=this._getExpandAreaObjectInfo();if(d.currentHeight<d.expandedHeight){return false;}return true;},showDetails:function(){var t=this;if(t.isShowingDetails()){return;}var d=this._getExpandAreaObjectInfo();d.relatedObjectsToolbar.css("opacity",0);d.relatedObjectsToolbar.css("display","block");var r=t.getAggregation("_relatedObjectActionsToolbar");if(r){r._layoutToolbarElements();}t.forwardEllipsis($(t.getDomRef()).find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultListItem-AttributeKey, .sapUshellSearchResultListItem-AttributeValueHighlighted"));$(t.getDomRef()).addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");var i,s=false;var k=d.attributesExpandContainer.animate({height:d.expandedHeight,},{duration:d.expandAnimationDuration,progress:function(m,p,o){if(!s&&p>0.5){i=d.relatedObjectsToolbar.animate({opacity:1,},o).promise();s=true;jQuery.when(k,i).done(function(){t.setProperty("expanded",true,true);$(this).addClass("sapUshellSearchResultListItem-AttributesExpanded");$(this).css("height","");$(d.elementsToFadeInOrOut).css("opacity","");$(t.getDomRef()).removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");var q=j.getIconURI("slim-arrow-up");var u=t.getAggregation("_expandButton");u.setTooltip(a.getText("hideDetailBtn_tooltip"));u.setIcon(q);u.rerender();d.relatedObjectsToolbar.css("display","");d.relatedObjectsToolbar.css("opacity","");t._renderAriaDescriptionElementForAttributes(undefined,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false);}.bind(this));}},}).promise();$(d.elementsToFadeInOrOut).animate({opacity:1,},d.fadeInOrOutAnimationDuration);},hideDetails:function(){var t=this;var r=$(t.getDomRef());if(!t.isShowingDetails()){return;}var d=this._getExpandAreaObjectInfo();d.relatedObjectsToolbar.css("opacity",1);d.relatedObjectsToolbar.animate({opacity:0,},d.expandAnimationDuration/2);var i=r.find(".sapUshellSearchResultListItem-MainAttribute").outerHeight(true)+r.find(".sapUshellSearchResultListItem-ExpandSpacerAttribute").outerHeight(true);var s=false;var k=d.attributesExpandContainer.animate({height:i,},{duration:d.expandAnimationDuration,progress:function(m,p,o){if(!s&&o<=d.fadeInOrOutAnimationDuration){s=true;var q=$(d.elementsToFadeInOrOut).animate({opacity:0,},d.fadeInOrOutAnimationDuration).promise();jQuery.when(k,q).done(function(){t.setProperty("expanded",false,true);d.attributesExpandContainer.removeClass("sapUshellSearchResultListItem-AttributesExpanded");$(d.elementsToFadeInOrOut).css("opacity","");d.relatedObjectsToolbar.css("opacity","");var u=j.getIconURI("slim-arrow-down");var v=t.getAggregation("_expandButton");v.setTooltip(a.getText("showDetailBtn_tooltip"));v.setIcon(u);v.rerender();t._renderAriaDescriptionElementForAttributes(undefined,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false);});}},}).promise();},toggleDetails:function(d){var i;var m=this.getModel();if(this.isShowingDetails()){i=m.eventLogger.ITEM_HIDE_DETAILS;this.hideDetails(d);}else{i=m.eventLogger.ITEM_SHOW_DETAILS;this.showDetails(d);}m.eventLogger.logEvent({type:i,itemPosition:this.getPositionInList(),executionId:this.getResultSetId(),});},isSelectionModeEnabled:function(){var t=this;var i=false;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");if(s){i=s.css("opacity")>0;}return i;},enableSelectionMode:function(){var t=this;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-innerContainer");var d=s.find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");var i=200;var k=false;s.animate({width:"2rem",},{duration:i,progress:function(m,p){if(!k&&p>0.5){d.css("display","");d.animate({opacity:"1.0",},i/2);k=true;}},});},disableSelectionMode:function(){var t=this;var s=$(t.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-innerContainer");var d=s.find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");var i=200;d.animate({opacity:"0.0",},i/2,function(){d.css("display","none");});s.animate({width:"0",},i);},toggleSelectionMode:function(d){if(this.isSelectionModeEnabled()){this.disableSelectionMode(d);}else{this.enableSelectionMode(d);}},onAfterRendering:function(){var t=this;var d=$(t.getDomRef());t._showOrHideExpandButton();t._setListItemStatusBasedOnWindowSize();t._renderAriaDescriptionElementForTitle(undefined,false);t._renderAriaDescriptionElementForAttributes(undefined,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false);t.forwardEllipsis(d.find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultListItem-AttributeKey, .sapUshellSearchResultListItem-AttributeValueHighlighted"));e.attachEventHandlersForTooltip(t.getDomRef());},resizeEventHappened:function(){var t=this;var d=$(t.getDomRef());t._showOrHideExpandButton();t._setListItemStatusBasedOnWindowSize();t.getAggregation("_titleLink").rerender();t.forwardEllipsis(d.find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultListItem-AttributeKey, .sapUshellSearchResultListItem-AttributeValueHighlighted"));},_getPhoneSize:function(){return 767;},_resetPrecalculatedValues:function(){this._visibleAttributes=undefined;this._detailsArea=undefined;this._showExpandButton=false;},_setListItemStatusBasedOnWindowSize:function(){var w=window.innerWidth;var p=this.getParentListItem();if(this.getTitleNavigation()&&w<=this._getPhoneSize()){p.setType(h.Active);}else{p.setType(h.Inactive);}},_showOrHideExpandButton:function(){var t=this;var d=$(t.getDomRef());var i=d.find(".sapUshellSearchResultListItem-ExpandButtonContainer");var k=i.css("visibility")!=="hidden";var s=false;var m=t.getImageFormat()&&t.getImageFormat().toLowerCase()==="documentthumbnail";if(!m){var o=d.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");s=o.length>0;}if(!m&&!s){var p=t._getElementsInExpandArea();if(p.length>0){s=true;}}if(k&&!s){i.css("visibility","hidden");i.attr("aria-hidden","true");t.setAriaExpandedState();}else if(!k&&s){i.css("visibility","");i.removeAttr("aria-hidden");t.setAriaExpandedState();}},setAriaExpandedState:function(){var t=this;var d=t.getAggregation("_expandButton");if(!d){return;}var i=$(d.getDomRef());var k=$(t.getDomRef());var m=t.getParentListItem()?$(t.getParentListItem().getDomRef()):k.closest("li");var o=k.find(".sapUshellSearchResultListItem-ExpandButtonContainer");if(o.css("visibility")==="hidden"){i.removeAttr("aria-expanded");m.removeAttr("aria-expanded");}else{var p=t.getProperty("expanded");if(p){i.attr("aria-expanded","true");m.attr("aria-expanded","true");}else{i.attr("aria-expanded","false");m.attr("aria-expanded","false");}}},_registerItemPressHandler:function(){var t=this;var p=t.getParentListItem();if(p){p.attachPress(function(){t._performTitleNavigation();});t._registerItemPressHandler=function(){};}},_performTitleNavigation:function(p){var t=(p&&p.trackingOnly)||false;var d=this.getTitleNavigation();if(d){d.performNavigation({trackingOnly:t,});}},forwardEllipsis:function(o){var k=$(this.getDomRef());k.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");o.each(function(i,d){e.forwardEllipsis4Whyfound(d);});k.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");},});});
