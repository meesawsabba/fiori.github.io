/*!
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["../i18n","sap/m/Text","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/ToolbarDesign","sap/ui/core/Icon",],function(a,T,b,c,d,I){"use strict";return sap.m.Toolbar.extend("sap.esh.search.ui.controls.SearchFilterBar",{constructor:function(o){var t=this;o=jQuery.extend({},{design:d.Info,},o);sap.m.Toolbar.prototype.constructor.apply(t,[o]);t.addStyleClass("sapUshellSearchFilterContextualBar");t.filterFormatter=t.filterFormatter.bind(t);t.filterText=new T("",{text:{parts:["/uiFilter/rootCondition","/facets"],formatter:t.filterFormatter,},tooltip:{parts:["/uiFilter/rootCondition","/facets"],formatter:t.filterFormatter,},}).addStyleClass("sapUshellSearchFilterText");t.filterText.setMaxLines(1);t.filterText.clampText();t.addContent(t.filterText);t.addContent(new c());t.resetButton=new I("",{src:"sap-icon://clear-filter",tooltip:a.getText("resetFilterButton_tooltip"),}).addStyleClass("sapUshellSearchFilterResetButton");t.addContent(t.resetButton);},filterFormatter:function(r,f){if(!r||!r.hasFilters()){return"";}r=this.sortConditions(r,f);var e=[];for(var i=0;i<r.conditions.length;++i){var g=r.conditions[i];var l=[];for(var j=0;j<g.conditions.length;++j){var h=g.conditions[j];if(j===0){l.push(h.attributeLabel," (");}else{l.push(", ");}l.push(this._formatLabel(h.valueLabel||h.value,h.operator));}l.push(")");e.push(l.join(""));}return a.getText("filtered_by",[e.join(", ")]);},_formatLabel:function(l,o){var e;switch(o){case this.getModel().sinaNext.ComparisonOperator.Bw:e=l+"*";break;case this.getModel().sinaNext.ComparisonOperator.Ew:e="*"+l;break;case this.getModel().sinaNext.ComparisonOperator.Co:e="*"+l+"*";break;default:e=l;break;}return e;},sortConditions:function(r,f){if(f.length===0){return r;}var g=function(h){var j=h.conditions[0];if(j.attribute){return j.attribute;}return j.conditions[0].attribute;};var e=function(l,j,v){for(var i=0;i<l.length;++i){var k=l[i];if(k[j]===v){return i;}}};r=r.clone();r.conditions.sort(function(j,k){var l=g(j);var m=e(f,"dimension",l);var n=g(k);var o=e(f,"dimension",n);return m-o;});var s=function(h){var j=g(h);var k=e(f,"dimension",j);if(!k){return;}var l=f[k];if(l.facetType==="hierarchy"){return;}var v=function(m,n){return(e(l.items,"label",m.valueLabel)-e(l.items,"label",n.valueLabel));};h.conditions.sort(v);};for(var i=0;i<r.conditions.length;++i){var h=r.conditions[i];s(h);}return r;},renderer:"sap.m.ToolbarRenderer",onAfterRendering:function(){var t=this;t.resetButton.attachPress(function(){var m=t.getModel();m.eventLogger.logEvent({type:m.eventLogger.CLEAR_ALL_FILTERS,});m.resetFilterConditions(true);});var $=jQuery(".sapUshellSearchFilterText");$.attr("aria-label",a.getText("filtered_by_aria_label"));},});});
