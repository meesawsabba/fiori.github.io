/*!
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define([],function(){var d="$$dummy$$";var c=function(p){var f=p.facet;var a=null;var S=function(){this.init.apply(this,arguments);};S.prototype={init:function(p){this.id=p.id;this.label=p.label;this.count=p.count;this.expanded=p.expanded||false;this.hasFilter=false;this.childNodes=[];},_setParentNode:function(b){a=b;},getParentNode:function(){return a;},addChildNode:function(b){this.childNodes.push(b);b._setParentNode(this);},addChildNodeAtPosition:function(i,b){this.childNodes.splice(i,0,b);b._setParentNode(this);},removeChildNode:function(b){var i=this.childNodes.indexOf(b);this.childNodes.splice(i,1);b._setParentNode(null);},getChildNodeById:function(b){for(var i=0;i<this.childNodes.length;++i){var e=this.childNodes[i];if(e.id===b){return e;}}return null;},delete:function(){if(a){a.removeChildNode(this);}delete f.nodeMap[this.id];this.deleteChildNodes();},deleteChildNodes:function(){for(var i=0;i<this.childNodes.length;++i){var b=this.childNodes[i];if(b.id===d){this.childNodes.splice(i,1);i--;continue;}b.delete();i--;}},visitChildNodesRecursively:function(b){for(var i=0;i<this.childNodes.length;++i){var e=this.childNodes[i];if(e.id===d){continue;}b(e);e.visitChildNodesRecursively(b);}},visitParentNodesRecursively:function(b){var a=this.getParentNode();if(a){b(a);a.visitParentNodesRecursively(b);}},hasChildNodes:function(){for(var i=0;i<this.childNodes.length;++i){var b=this.childNodes[i];if(b.id===d){continue;}return true;}return false;},isVisible:function(){var i=function(n){if(!n.expanded){return false;}var a=n.getParentNode();if(!a){return true;}return i(a);};var a=this.getParentNode();if(!a){return true;}return i(a);},toggleExpand:function(e){if(e){this.expanded=true;this.fetchChildNodesFromServer().then(function(h){this.update(h.node);f.mixinFilterNodes();f.refreshUI();}.bind(this));}else{this.expanded=false;this.deleteChildNodes();this.childNodes.push({id:d,label:" "});f.mixinFilterNodes();f.refreshUI();}},toggleFilter:function(){if(this.selected){if(this.partiallySelected){this.setFilter(true);this.visitParentNodesRecursively(function(n){n.setFilter(false);});this.visitChildNodesRecursively(function(n){n.setFilter(false);});}else{this.setFilter(false);}}else{this.setFilter(true);this.visitParentNodesRecursively(function(n){n.setFilter(false);});}f.activateFilters();},setFilter:function(s){var b=f.sina.createSimpleCondition({operator:f.sina.ComparisonOperator.Eq,attribute:f.attributeId,attributeLabel:f.title,value:this.id,valueLabel:this.label,});var u=f.model.getProperty("/uiFilter");if(s){u.autoInsertCondition(b);}else{u.autoRemoveCondition(b);}},fetchChildNodesFromServer:function(){var b=f.filter.clone();b.rootCondition.removeAttributeConditions(f.attributeId);return f.sina.createHierarchyQuery({attributeId:f.attributeId,nodeId:this.id,filter:b,}).getResultSetAsync().then(function(h){f.updateStructureTree(h.node);return h;});},hasExpandedChildNode:function(){for(var i=0;i<this.childNodes.length;++i){var b=this.childNodes[i];if(b.id===d){continue;}if(b.expanded||b.hasExpandedChildNode()){return true;}}return false;},updateFromServer:function(){return this.fetchChildNodesFromServer().then(function(h){this.update(h.node);var b=[];for(var i=0;i<this.childNodes.length;++i){var e=this.childNodes[i];if(e.id===d){continue;}if(!e.expanded){continue;}b.push(e.updateFromServer());}return Promise.all(b);}.bind(this));},update:function(s){this.label=s.label;this.count=s.count;this.selected=false;if(this.childNodes.length===1&&this.childNodes[0].id===d){this.childNodes.splice(0,1);}var b;for(var i=0;i<s.childNodes.length;++i){var e=s.childNodes[i];if(i<=this.childNodes.length-1){b=this.childNodes[i];if(b.id===e.id){}else{b=this.getChildNodeById(e.id);if(b){this.removeChildNode(b);this.addChildNodeAtPosition(i,b);}else{b=f.createNode({id:e.id,label:e.label,count:e.count,});this.addChildNodeAtPosition(i,b);}}}else{b=f.createNode({id:e.id,label:e.label,count:e.count,});this.addChildNode(b);}b.update(e);}while(this.childNodes.length>s.childNodes.length){b=this.childNodes[this.childNodes.length-1];b.delete();}if(this.childNodes.length===0&&s.hasChildren){this.childNodes.push({id:d,label:" "});}},};return new S(p);};return{createNode:c};});
