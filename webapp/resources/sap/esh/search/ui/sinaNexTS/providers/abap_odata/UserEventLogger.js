/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["require","exports","./ajaxTemplates","../../core/util"],function(r,e,a,u){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.UserEventLogger=e.UserEventType=void 0;var U;(function(U){U["ITEM_NAVIGATE"]="ITEM_NAVIGATE";U["SUGGESTION_SELECT"]="SUGGESTION_SELECT";U["SEARCH_REQUEST"]="SEARCH_REQUEST";U["RESULT_LIST_ITEM_NAVIGATE_CONTEXT"]="RESULT_LIST_ITEM_NAVIGATE_CONTEXT";U["SUGGESTION_REQUEST"]="SUGGESTION_REQUEST";U["TILE_NAVIGATE"]="TILE_NAVIGATE";U["SHOW_MORE"]="SHOW_MORE";U["BROWSER_CLOSE"]="BROWSER_CLOSE";U["LEAVE_PAGE"]="LEAVE_PAGE";U["SESSION_START"]="SESSION_START";U["RESULT_LIST_ITEM_NAVIGATE"]="RESULT_LIST_ITEM_NAVIGATE";U["OBJECT_SUGGESTION_NAVIGATE"]="OBJECT_SUGGESTION_NAVIGATE";U["DROPDOWN_SELECT_DS"]="DROPDOWN_SELECT_DS";U["DATASOURCE_CHANGE"]="DATASOURCE_CHANGE";U["FACET_FILTER_ADD"]="FACET_FILTER_ADD";U["FACET_FILTER_DEL"]="FACET_FILTER_DEL";U["ITEM_SHOW_DETAILS"]="ITEM_SHOW_DETAILS";U["ITEM_HIDE_DETAILS"]="ITEM_HIDE_DETAILS";U["CLEAR_ALL_FILTERS"]="CLEAR_ALL_FILTERS";U["FACET_SHOW_MORE"]="FACET_SHOW_MORE";U["FACET_SHOW_MORE_CLOSE"]="FACET_SHOW_MORE_CLOSE";})(U=e.UserEventType||(e.UserEventType={}));var b=(function(){function b(p){this.provider=p;this.sina=p.sina;this.delayedConsumer=new u.DelayedConsumer({timeDelay:2000,consumer:this.processEvents,consumerContext:this,});}b.prototype.logUserEvent=function(c){c.timeStamp=new Date().getTime();if(c.type!=="ITEM_NAVIGATE"){this.delayedConsumer.add(c);}if(c.type==="ITEM_NAVIGATE"&&c.sourceUrlArray.length!==0){this.incrementClickCounter(c.targetUrl,c.systemAndClient);}};b.prototype.processEvents=function(c){var d={ID:1,SessionID:this.provider.sessionId,Events:[],};for(var i=0;i<c.length;++i){var f=c[i];var t="\\/Date("+f.timeStamp+")\\/";var o={ID:i+1,Type:f.type,Timestamp:t,ExecutionID:f.executionId,Parameters:[],};for(var n in f){if(n==="type"||n==="timeStamp"){continue;}var v=f[n];if(typeof v==="undefined"){continue;}if(typeof v!=="object"){v=v.toString();}else{v=JSON.stringify(v);}o.Parameters.push({Name:n,Value:v,});}d.Events.push(o);}var g=this.provider.buildQueryUrl(this.provider.requestPrefix,"/InteractionEventLists");return this.provider.ajaxClient.postJson(g,d);};b.prototype.incrementClickCounter=function(t,s){if(!t){return undefined;}if(t.indexOf("#")===-1){return undefined;}var g=function(H){return H.split("-")[0];};var c=function(H){return H.split("-")[1].split("&")[0];};var d=function(p){var n=p;var o=[];for(var i=0,q=n.length;i<q;i++){var v=n[i];if(v.indexOf("sap-system")!==-1){continue;}var w=v.split("=")[0];var x=v.split("=")[1];o.push({Name:w,Value:x,});}return o;};var h=t.split("?");var f=g(h[0]).split("#")[1];var j=c(h[0]);var k=h[1]!==undefined?d(h[1].split("&")):[];var l=JSON.parse(JSON.stringify(a.navigationEvent));l.SemanticObjectType=f;l.Intent=j;if(s.systemId.length===0||s.client.length===0){delete l.System;delete l.Client;}else{l.System=s.systemId;l.Client=s.client;}l.Parameters=k;var m=this.provider.buildQueryUrl(this.provider.requestPrefix,"/NavigationEvents");return this.provider.ajaxClient.postJson(m,l);};return b;}());e.UserEventLogger=b;});})();
