/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){var _=(this&&this.__extends)||(function(){var e=function(d,b){e=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p];};return e(d,b);};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(d,b);function a(){this.constructor=d;}d.prototype=b===null?Object.create(b):(a.prototype=b.prototype,new a());};})();sap.ui.define(["require","exports","./errors"],function(r,a,b){"use strict";Object.defineProperty(a,"__esModule",{value:true});a.LabelCalculator=void 0;var D=(function(c){_(D,c);function D(p){var d;var e=this;p.message=(d=p.message)!==null&&d!==void 0?d:"Duplicate node";e=c.call(this,{message:p.message,name:"DuplicateException",})||this;e.node=p.node;return e;}return D;}(b.ESHClientError));var N=(function(){function N(p,n,l){this.parent=p;this.nodeId=n;this.labelCalculator=l;this.childMap={};this.children=[];}N.prototype.insert=function(k,o){if(k.length===0){this.data=this.labelCalculator.options.data(o);this.obj=o;this.calculateLabel();return;}var c=k[0];var s=this.childMap[c];if(k.length===1&&s){throw new D({node:s,});}if(!s){s=new N(this,c,this.labelCalculator);this.childMap[c]=s;this.children.push(s);if(this.children.length===2){this.children[0].recalculateLabels();}}s.insert(k.slice(1),o);};N.prototype.recalculateLabels=function(){var l=[];this.collectLeafs(l);for(var i=0;i<l.length;++i){l[i].calculateLabel();}};N.prototype.collectLeafs=function(l){if(this.isLeaf()){l.push(this);return;}for(var i=0;i<this.children.length;++i){this.children[i].collectLeafs(l);}};N.prototype.isLeaf=function(){return this.children.length===0;};N.prototype.hasSibling=function(){return this.parent&&this.parent.children.length>=2;};N.prototype.isChildOfRoot=function(){return this.parent&&this.parent.nodeId==="__ROOT";};N.prototype.collectPath=function(k,f){if(!this.parent){return;}if(f||this.hasSibling()||this.isChildOfRoot()){k.push(this.nodeId);f=true;}if(this.parent){this.parent.collectPath(k,f);}};N.prototype.calculateLabel=function(){var k=[];this.collectPath(k);k.reverse();this.labelCalculator.options.setLabel(this.obj,k,this.data);};return N;}());var L=(function(){function L(o){this.options=o;this.rootNode=new N(null,"__ROOT",this);}L.prototype.calculateLabel=function(o){var k=this.options.key(o);try{this.rootNode.insert(k,o);}catch(e){if(e.name==="DuplicateException"){this.options.setFallbackLabel(e.node.obj,e.node.data);this.options.setFallbackLabel(o,this.options.data(o));return;}throw e;}};return L;}());a.LabelCalculator=L;});})();
