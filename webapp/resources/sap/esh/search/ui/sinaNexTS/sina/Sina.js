/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){var a=(this&&this.__awaiter)||function(t,_,P,g){function c(v){return v instanceof P?v:new P(function(r){r(v);});}return new(P||(P=Promise))(function(r,d){function f(v){try{s(g.next(v));}catch(e){d(e);}}function h(v){try{s(g["throw"](v));}catch(e){d(e);}}function s(e){e.done?r(e.value):c(e.value).then(f,h);}s((g=g.apply(t,_||[])).next());});};var b=(this&&this.__generator)||function(c,d){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1];},trys:[],ops:[]},f,y,t,g;return g={next:h(0),"throw":h(1),"return":h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this;}),g;function h(n){return function(v){return s([n,v]);};}function s(o){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=o[0]&2?y["return"]:o[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,o[1])).done)return t;if(y=0,t)o=[o[0]&2,t.value];switch(o[0]){case 0:case 1:t=o;break;case 4:_.label++;return{value:o[1],done:false};case 5:_.label++;y=o[1];o=[0];continue;case 7:o=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(o[0]===6||o[0]===2)){_=0;continue;}if(o[0]===3&&(!t||(o[1]>t[0]&&o[1]<t[3]))){_.label=o[1];break;}if(o[0]===6&&_.label<t[1]){_.label=t[1];t=o;break;}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(o);break;}if(t[2])_.ops.pop();_.trys.pop();continue;}o=d.call(c,_);}catch(e){o=[6,e];y=0;}finally{f=t=0;}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true};}};sap.ui.define(["require","exports","../core/core","../core/errors","../core/util","./AttributeType","./AttributeFormatType","./AttributeGroupTextArrangement","./DataSourceType","./MatchingStrategy","./LogicalOperator","./ComparisonOperator","./FacetType","./SuggestionCalculationMode","./SuggestionType","./SortOrder","./ConditionType","../providers/tools/cds/CDSAnnotationsParser","../providers/tools/sors/NavigationTargetGenerator","./SearchResultSet","./SearchResultSetItem","./SearchResultSetItemAttribute","./ObjectSuggestion","./SearchQuery","./ChartQuery","./SuggestionQuery","./DataSourceQuery","./Filter","./ComplexCondition","./SimpleCondition","./AttributeMetadata","./AttributeGroupMetadata","./AttributeGroupMembership","./SearchResultSetItemAttributeGroup","./SearchResultSetItemAttributeGroupMembership","./SearchTermSuggestion","./SearchTermAndDataSourceSuggestion","./DataSourceSuggestion","./SuggestionResultSet","./ChartResultSet","./DataSourceResultSet","./ChartResultSetItem","./DataSourceResultSetItem","./Capabilities","./Configuration","./NavigationTarget","./formatters/Formatter","./DataSource","./UserCategoryDataSource","../providers/abap_odata/ItemPostParser","../providers/tools/fiori/SuvNavTargetResolver","../providers/tools/fiori/NavigationTargetForIntent","../providers/tools/fiori/FioriIntentsResolver","./formatters/ResultValueFormatter","./formatters/NavtargetsInResultSetFormatter","./formatters/ConfigSearchResultSetFormatter","./formatters/ConfigMetadataFormatter","./FilteredDataSource","../providers/inav2/Provider","../providers/abap_odata/Provider","./HierarchyQuery","./HierarchyNode","./HierarchyResultSet","../providers/inav2/typeConverter","./HierarchyNodePath"],function(r,e,c,d,u,A,f,g,D,M,L,C,F,S,h,k,l,m,N,n,o,p,O,q,s,t,v,w,x,y,z,B,E,G,H,I,J,K,P,Q,R,T,U,V,W,X,Y,Z,$,_,a1,b1,c1,d1,e1,f1,g1,h1,i1,j1,k1,l1,m1,n1,o1){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.Sina=void 0;var p1=(function(){function p1(i){this.core=c;this.errors=d;this.util=u;this.inav2TypeConverter=n1;this.provider=i;this.createSearchQuery=this.createSinaObjectFactory(q.SearchQuery);this.createChartQuery=this.createSinaObjectFactory(s.ChartQuery);this.createHierarchyQuery=this.createSinaObjectFactory(k1.HierarchyQuery);this.createSuggestionQuery=this.createSinaObjectFactory(t.SuggestionQuery);this.createDataSourceQuery=this.createSinaObjectFactory(v.DataSourceQuery);this.createFilter=this.createSinaObjectFactory(w.Filter);this.createComplexCondition=this.createSinaObjectFactory(x.ComplexCondition);this.createSimpleCondition=this.createSinaObjectFactory(y.SimpleCondition);this.createHierarchyNode=this.createSinaObjectFactory(l1.HierarchyNode);this.createHierarchyNodePath=this.createSinaObjectFactory(o1.HierarchyNodePath);this._createAttributeMetadata=this.createSinaObjectFactory(z.AttributeMetadata);this._createAttributeGroupMetadata=this.createSinaObjectFactory(B.AttributeGroupMetadata);this._createAttributeGroupMembership=this.createSinaObjectFactory(E.AttributeGroupMembership);this._createSearchResultSetItemAttribute=this.createSinaObjectFactory(p.SearchResultSetItemAttribute);this._createSearchResultSetItemAttributeGroup=this.createSinaObjectFactory(G.SearchResultSetItemAttributeGroup);this._createSearchResultSetItemAttributeGroupMembership=this.createSinaObjectFactory(H.SearchResultSetItemAttributeGroupMembership);this._createSearchResultSetItem=this.createSinaObjectFactory(o.SearchResultSetItem);this._createSearchResultSet=this.createSinaObjectFactory(n.SearchResultSet);this._createSearchTermSuggestion=this.createSinaObjectFactory(I.SearchTermSuggestion);this._createSearchTermAndDataSourceSuggestion=this.createSinaObjectFactory(J.SearchTermAndDataSourceSuggestion);this._createDataSourceSuggestion=this.createSinaObjectFactory(K.DataSourceSuggestion);this._createObjectSuggestion=this.createSinaObjectFactory(O.ObjectSuggestion);this._createSuggestionResultSet=this.createSinaObjectFactory(P.SuggestionResultSet);this._createChartResultSet=this.createSinaObjectFactory(Q.ChartResultSet);this._createHierarchyResultSet=this.createSinaObjectFactory(m1.HierarchyResultSet);this._createDataSourceResultSet=this.createSinaObjectFactory(R.DataSourceResultSet);this._createChartResultSetItem=this.createSinaObjectFactory(T.ChartResultSetItem);this._createDataSourceResultSetItem=this.createSinaObjectFactory(U.DataSourceResultSetItem);this._createCapabilities=this.createSinaObjectFactory(V.Capabilities);this._createConfiguration=this.createSinaObjectFactory(W.Configuration);this._createNavigationTarget=this.createSinaObjectFactory(X.NavigationTarget);this._createSorsNavigationTargetGenerator=this.createSinaObjectFactory(N.NavigationTargetGenerator);this._createFioriIntentsResolver=this.createSinaObjectFactory(c1.FioriIntentsResolver);this._createNavigationTargetForIntent=this.createSinaObjectFactory(b1.NavigationTargetForIntent);this._createCDSAnnotationsParser=this.createSinaObjectFactory(m.CDSAnnotationsParser);this._createItemPostParser=this.createSinaObjectFactory(_.ItemPostParser);this._createSuvNavTargetResolver=this.createSinaObjectFactory(a1.SuvNavTargetResolver);this.searchResultSetFormatters=[];this.suggestionResultSetFormatters=[];this.metadataFormatters=[];this.dataSources=[];this.dataSourceMap={};this.allDataSource=this.createDataSource({id:"All",label:"All",type:D.DataSourceType.Category,});this.searchResultSetFormatters.push(new e1.NavtargetsInResultSetFormatter());this.searchResultSetFormatters.push(new d1.ResultValueFormatter());this.DataSourceType=D.DataSourceType;this.DataSourceSubType=D.DataSourceSubType;this.AttributeGroupTextArrangement=g.AttributeGroupTextArrangement;this.AttributeType=A.AttributeType;this.AttributeFormatType=f.AttributeFormatType;this.FacetType=F.FacetType;this.SuggestionType=h.SuggestionType;this.ConditionType=l.ConditionType;this.SuggestionCalculationMode=S.SuggestionCalculationMode;this.SortOrder=k.SortOrder;this.MatchingStrategy=M.MatchingStrategy;this.ComparisonOperator=C.ComparisonOperator;this.LogicalOperator=L.LogicalOperator;}p1.prototype._initAsync=function(i){return a(this,void 0,void 0,function(){var j;return b(this,function(_a){switch(_a.label){case 0:this.configuration=i;this.isDummyProvider=i.provider.indexOf("dummy")>-1;this.provider.label=i.label;return[4,this._evaluateConfigurationAsync(i)];case 1:_a.sent();i.sina=this;return[4,this.provider._initAsync(i)];case 2:j=_a.sent();j=j||{capabilities:null,};this.capabilities=j.capabilities||this._createCapabilities({sina:this});return[4,this._formatMetadataAsync()];case 3:_a.sent();if(!i.initAsync)return[3,5];return[4,i.initAsync(this)];case 4:_a.sent();_a.label=5;case 5:if(this.getBusinessObjectDataSources().length===0&&!this.isDummyProvider){throw new d.ESHNotActiveError("Not active - no datasources");}return[2];}});});};p1.prototype._formatMetadataAsync=function(){return c.executeSequentialAsync(this.metadataFormatters,function(i){return i.formatAsync({dataSources:this.dataSources,});}.bind(this));};p1.prototype._evaluateConfigurationAsync=function(q1){return a(this,void 0,void 0,function(){var r1,i,s1,i,t1,j,u1;return b(this,function(_a){r1=[];if(q1.searchResultSetFormatters){for(i=0;i<q1.searchResultSetFormatters.length;++i){s1=q1.searchResultSetFormatters[i];if(!(s1 instanceof Y.Formatter)&&!s1.formatAsync){s1=new f1.ConfigSearchResultSetFormatter(s1);}this.searchResultSetFormatters.push(s1);if(s1.initAsync){r1.push(s1.initAsync());}}}if(q1.suggestionResultSetFormatters){for(i=0;i<q1.suggestionResultSetFormatters.length;++i){t1=q1.suggestionResultSetFormatters[i];this.suggestionResultSetFormatters.push(t1);if(t1.initAsync){r1.push(t1.initAsync());}}}if(q1.metadataFormatters){for(j=0;j<q1.metadataFormatters.length;++j){u1=q1.metadataFormatters[j];if(!(u1 instanceof Y.Formatter)&&!u1.formatAsync){u1=new g1.ConfigMetadataFormatter(u1);}this.metadataFormatters.push(u1);if(u1.initAsync){r1.push(u1.initAsync());}}}return[2,Promise.all(r1)];});});};p1.prototype.loadMetadata=function(i){return a(this,void 0,void 0,function(){return b(this,function(j){if(this.provider instanceof i1.Provider){if(this.provider.loadMetadata){return[2,this.provider.loadMetadata(i)];}}return[2,Promise.resolve()];});});};p1.prototype.createDataSourceMap=function(j){var q1={};for(var i=0;i<j.length;++i){var r1=j[i];q1[r1.id]=r1;}return q1;};p1.prototype.createSinaObjectFactory=function(i){return function(j){j=j!==null&&j!==void 0?j:{sina:this};j.sina=this;return new i(j);};};p1.prototype.createDataSource=function(i){i.sina=this;var j;switch(i.type){case D.DataSourceType.BusinessObject:switch(i.subType){case D.DataSourceSubType.Filtered:j=new h1.FilteredDataSource(i);break;default:j=new Z.DataSource(i);}break;case D.DataSourceType.UserCategory:j=new $.UserCategoryDataSource(i);break;default:j=new Z.DataSource(i);}if(this.dataSourceMap[j.id]){throw new d.CanNotCreateAlreadyExistingDataSourceError('cannot create an already existing datasource: "'+j.id+'"');}this._addDataSource(j);return j;};p1.prototype._createDataSource=function(i){return this.createDataSource(i);};p1.prototype._addDataSource=function(j){if(j.type===D.DataSourceType.BusinessObject&&j.subType===D.DataSourceSubType.Filtered){var q1=-1;for(var i=this.dataSources.length-1;i>=1;--i){var r1=this.dataSources[i];if(r1.type===D.DataSourceType.BusinessObject&&r1.subType===D.DataSourceSubType.Filtered){q1=i;break;}}if(q1>=0){this.dataSources.splice(q1+1,0,j);}else{this.dataSources.push(j);}}else{this.dataSources.push(j);}this.dataSourceMap[j.id]=j;};p1.prototype.getAllDataSource=function(){return this.allDataSource;};p1.prototype.getBusinessObjectDataSources=function(){var j=[];for(var i=0;i<this.dataSources.length;++i){var q1=this.dataSources[i];if(!q1.hidden&&q1.type===D.DataSourceType.BusinessObject){j.push(q1);}}return j;};p1.prototype.getDataSource=function(i){return this.dataSourceMap[i];};p1.prototype.getConfigurationAsync=function(i){if(i===void 0){i={};}return a(this,void 0,void 0,function(){return b(this,function(j){if(this.provider instanceof i1.Provider||this.provider instanceof j1.Provider){if(this.configurationPromise&&!i.forceReload){return[2,this.configurationPromise];}this.configurationPromise=this.provider.getConfigurationAsync();return[2,this.configurationPromise];}return[2,Promise.resolve(this._createConfiguration({personalizedSearch:false,isPersonalizedSearchEditable:false,}))];});});};p1.prototype.logUserEvent=function(i){if(this.provider instanceof i1.Provider||this.provider instanceof j1.Provider){this.provider.logUserEvent(i);}};p1.prototype.getDebugInfo=function(){return this.provider.getDebugInfo();};p1.prototype.parseDataSourceFromJson=function(j){var i=this.getDataSource(j.id);if(i){return i;}if(j.type!==D.DataSourceType.Category){throw new d.DataSourceInURLDoesNotExistError("Datasource in URL does not exist "+j.id);}i=this._createDataSource(j);return i;};p1.prototype.parseSimpleConditionFromJson=function(j){var i;if(c.isObject(j.value)){i=u.dateFromJson(j.value);}else{i=j.value;}var q1;if(j.userDefined){q1=true;}else{q1=false;}return this.createSimpleCondition({operator:j.operator,attribute:j.attribute,value:i,attributeLabel:j.attributeLabel,valueLabel:j.valueLabel,userDefined:q1,});};p1.prototype.parseComplexConditionFromJson=function(j){var q1=[];for(var i=0;i<j.conditions.length;++i){var r1=j.conditions[i];q1.push(this.parseConditionFromJson(r1));}var s1;if(j.userDefined){s1=true;}else{s1=false;}return this.createComplexCondition({operator:j.operator,conditions:q1,attributeLabel:j.attributeLabel,valueLabel:j.valueLabel,userDefined:s1,});};p1.prototype.parseConditionFromJson=function(j){switch(j.type){case l.ConditionType.Simple:return this.parseSimpleConditionFromJson(j);case l.ConditionType.Complex:return this.parseComplexConditionFromJson(j);default:throw new d.UnknownConditionTypeError('unknown condition type "'+j.type+'"');}};p1.prototype.parseFilterFromJson=function(j){var i=this.parseConditionFromJson(j.rootCondition);if(i instanceof x.ComplexCondition){return this.createFilter({searchTerm:j===null||j===void 0?void 0:j.searchTerm,rootCondition:i,dataSource:this.parseDataSourceFromJson(j.dataSource),});}else{throw new d.UnknownConditionTypeError("Only complex condition is allowed in Filter JSON");}};return p1;}());e.Sina=p1;});})();
