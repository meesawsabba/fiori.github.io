/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){var a=(this&&this.__extends)||(function(){var e=function(d,b){e=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p];};return e(d,b);};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(d,b);function _(){this.constructor=d;}d.prototype=b===null?Object.create(b):(_.prototype=b.prototype,new _());};})();var c=(this&&this.__awaiter)||function(t,_,P,g){function b(v){return v instanceof P?v:new P(function(r){r(v);});}return new(P||(P=Promise))(function(r,d){function f(v){try{s(g.next(v));}catch(e){d(e);}}function i(v){try{s(g["throw"](v));}catch(e){d(e);}}function s(e){e.done?r(e.value):b(e.value).then(f,i);}s((g=g.apply(t,_||[])).next());});};var h=(this&&this.__generator)||function(b,d){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1];},trys:[],ops:[]},f,y,t,g;return g={next:i(0),"throw":i(1),"return":i(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this;}),g;function i(n){return function(v){return s([n,v]);};}function s(o){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=o[0]&2?y["return"]:o[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,o[1])).done)return t;if(y=0,t)o=[o[0]&2,t.value];switch(o[0]){case 0:case 1:t=o;break;case 4:_.label++;return{value:o[1],done:false};case 5:_.label++;y=o[1];o=[0];continue;case 7:o=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(o[0]===6||o[0]===2)){_=0;continue;}if(o[0]===3&&(!t||(o[1]>t[0]&&o[1]<t[3]))){_.label=o[1];break;}if(o[0]===6&&_.label<t[1]){_.label=t[1];t=o;break;}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(o);break;}if(t[2])_.ops.pop();_.trys.pop();continue;}o=d.call(b,_);}catch(e){o=[6,e];y=0;}finally{f=t=0;}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true};}};sap.ui.define(["require","exports","../core/core","../core/util","./SinaObject","./Filter","./DataSourceType","./LogicalOperator","../core/errors"],function(r,e,b,u,S,F,D,L,d){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.Query=void 0;var Q=(function(_){a(Q,_);function Q(p){var f,g,i,j,k;var l=_.call(this,p)||this;l.requestTimeout=false;l.top=(f=p.top)!==null&&f!==void 0?f:10;l.skip=(g=p.skip)!==null&&g!==void 0?g:0;l.sortOrder=(i=p.sortOrder)!==null&&i!==void 0?i:[];l.filter=(k=(j=p.filter)!==null&&j!==void 0?j:l.filter)!==null&&k!==void 0?k:new F.Filter({sina:l.sina});l.icon=p.icon;l.label=p.label;if(p.dataSource){l.filter.setDataSource(p.dataSource);}if(p.searchTerm){l.filter.setSearchTerm(p.searchTerm);}if(p.rootCondition){l.filter.setRootCondition(p.rootCondition);}if(l.requestTimeout){}l._execute=u.refuseOutdatedResponsesDecorator(l._execute);return l;}Q.prototype.setTop=function(t){if(t===void 0){t=10;}this.top=t;};Q.prototype.setSkip=function(s){if(s===void 0){s=0;}this.skip=s;};Q.prototype.setSortOrder=function(s){this.sortOrder=s;};Q.prototype._execute=function(){var f=[];for(var g=0;g<arguments.length;g++){f[g]=arguments[g];}return c(this,void 0,void 0,function(){return h(this,function(i){return[2,Promise.resolve()];});});};Q.prototype.clone=function(){return;};Q.prototype.equals=function(o){return(o instanceof Q&&this.icon===o.icon&&this.label===o.label&&this.top===o.top&&this.skip===o.skip&&this.filter.equals(o.filter)&&b.equals(this.sortOrder,o.sortOrder));};Q.prototype.abort=function(){};Q.prototype.getResultSetAsync=function(){return c(this,void 0,void 0,function(){var f;return h(this,function(g){if(this._lastQuery){if(this.equals(this._lastQuery)){return[2,this._resultSetPromise];}if(!this.filter.equals(this._lastQuery.filter)){this.setSkip(0);}}this._lastQuery=this._createReadOnlyClone();this._resultSetPromise=Promise.resolve().then(function(){return this._execute(this._lastQuery);}.bind(this)).then(function(R){f=R;return this._formatResultSetAsync(f);}.bind(this)).then(function(){return f;}.bind(this));return[2,this._resultSetPromise];});});};Q.prototype._genericFilteredQueryTransform=function(q){if(q.filter.dataSource.type!==D.DataSourceType.BusinessObject||q.filter.dataSource.subType!==D.DataSourceSubType.Filtered||!q.filter.dataSource.filterCondition){return q;}var t=q.clone();var f;if(q.filter.rootCondition.conditions.length>0){f=this.sina.createComplexCondition({operator:L.LogicalOperator.And,conditions:[q.filter.dataSource.filterCondition,q.filter.rootCondition],});}else{f=q.filter.dataSource.filterCondition;}var g=this.sina.createFilter({dataSource:q.filter.dataSource.dataSource,searchTerm:q.filter.searchTerm,rootCondition:f,});t.filter=g;return t;};Q.prototype._formatResultSetAsync=function(f){return Promise.resolve();};Q.prototype._setResultSet=function(f){this._lastQuery=this._createReadOnlyClone();this._resultSetPromise=Promise.resolve().then(function(){return this._formatResultSetAsync(f);}.bind(this)).then(function(){return f;});return this._resultSetPromise;};Q.prototype._createReadOnlyClone=function(){var q=this.clone();q.getResultSetAsync=function(){throw new d.QueryIsReadOnlyError("this query is readonly");};return q;};Q.prototype.resetResultSet=function(){this._lastQuery=null;this._resultSetPromise=null;};Q.prototype.getSearchTerm=function(){return this.filter.searchTerm;};Q.prototype.getDataSource=function(){return this.filter.dataSource;};Q.prototype.getRootCondition=function(){return this.filter.rootCondition;};Q.prototype.setSearchTerm=function(s){this.filter.setSearchTerm(s);};Q.prototype.setDataSource=function(f){this.filter.setDataSource(f);};Q.prototype.setRootCondition=function(f){this.filter.setRootCondition(f);};Q.prototype.resetConditions=function(){this.filter.resetConditions();};Q.prototype.autoInsertCondition=function(f){this.filter.autoInsertCondition(f);};Q.prototype.autoRemoveCondition=function(f){this.filter.autoRemoveCondition(f);};Q.prototype.setFilter=function(f){if(!this.filter.equals(f)){this.setSkip(0);}this.filter=f;};return Q;}(S.SinaObject));e.Query=Q;});})();
