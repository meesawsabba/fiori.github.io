/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){var a=(this&&this.__extends)||(function(){var e=function(d,b){e=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p];};return e(d,b);};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(d,b);function _(){this.constructor=d;}d.prototype=b===null?Object.create(b):(_.prototype=b.prototype,new _());};})();var c=(this&&this.__awaiter)||function(t,_,P,g){function b(v){return v instanceof P?v:new P(function(r){r(v);});}return new(P||(P=Promise))(function(r,d){function f(v){try{s(g.next(v));}catch(e){d(e);}}function i(v){try{s(g["throw"](v));}catch(e){d(e);}}function s(e){e.done?r(e.value):b(e.value).then(f,i);}s((g=g.apply(t,_||[])).next());});};var h=(this&&this.__generator)||function(b,d){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1];},trys:[],ops:[]},f,y,t,g;return g={next:i(0),"throw":i(1),"return":i(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this;}),g;function i(n){return function(v){return s([n,v]);};}function s(o){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=o[0]&2?y["return"]:o[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,o[1])).done)return t;if(y=0,t)o=[o[0]&2,t.value];switch(o[0]){case 0:case 1:t=o;break;case 4:_.label++;return{value:o[1],done:false};case 5:_.label++;y=o[1];o=[0];continue;case 7:o=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(o[0]===6||o[0]===2)){_=0;continue;}if(o[0]===3&&(!t||(o[1]>t[0]&&o[1]<t[3]))){_.label=o[1];break;}if(o[0]===6&&_.label<t[1]){_.label=t[1];t=o;break;}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(o);break;}if(t[2])_.ops.pop();_.trys.pop();continue;}o=d.call(b,_);}catch(e){o=[6,e];y=0;}finally{f=t=0;}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true};}};sap.ui.define(["require","exports","../core/core","./Query","./SuggestionType","./SuggestionCalculationMode","./DataSourceType","../core/errors"],function(r,e,b,Q,S,d,D,f){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.SuggestionQuery=void 0;var g=(function(_){a(g,_);function g(p){var i,j;var k=_.call(this,p)||this;k.calculationModes=[d.SuggestionCalculationMode.Data,d.SuggestionCalculationMode.History,];k.types=[S.SuggestionType.DataSource,S.SuggestionType.Object,S.SuggestionType.SearchTerm,];k.types=(i=p.types)!==null&&i!==void 0?i:k.types;k.calculationModes=(j=p.calculationModes)!==null&&j!==void 0?j:k.calculationModes;return k;}g.prototype._formatResultSetAsync=function(i){return c(this,void 0,void 0,function(){var q;return h(this,function(j){q=i.query;if(q.types.indexOf(S.SuggestionType.Object)>=0&&q.filter.dataSource.type===q.sina.DataSourceType.BusinessObject){return[2,b.executeSequentialAsync(this.sina.suggestionResultSetFormatters,function(k){return k.formatAsync(i);})];}return[2,i];});});};g.prototype.setTypes=function(t){this.types=t;};g.prototype.setCalculationModes=function(i){this.calculationModes=i;};g.prototype._createReadOnlyClone=function(){var q=this.clone();q.getResultSetAsync=function(){throw new f.QueryIsReadOnlyError("this query is readonly");};return q;};g.prototype.clone=function(){var i=new g({label:this.label,icon:this.icon,skip:this.skip,top:this.top,filter:this.filter.clone(),sortOrder:this.sortOrder,sina:this.sina,types:this.types,calculationModes:this.calculationModes,});i.types=this.types.slice();i.calculationModes=this.calculationModes.slice();return i;};g.prototype.equals=function(o){if(!(o instanceof g)){return false;}if(!_.prototype.equals.call(this,o)){return false;}if(!o){return false;}return(b.equals(this.types,o.types,false)&&b.equals(this.calculationModes,o.calculationModes,false));};g.prototype._execute=function(q){return c(this,void 0,void 0,function(){return h(this,function(i){return[2,this._doExecuteSuggestionQuery(q)];});});};g.prototype._doExecuteSuggestionQuery=function(q){return c(this,void 0,void 0,function(){var t,i;return h(this,function(j){switch(j.label){case 0:t=this._filteredQueryTransform(q);return[4,this.sina.provider.executeSuggestionQuery(t)];case 1:i=j.sent();return[2,this._filteredQueryBackTransform(q,i)];}});});};g.prototype._filteredQueryTransform=function(q){return this._genericFilteredQueryTransform(q);};g.prototype._filteredQueryBackTransform=function(q,i){if(q.filter.dataSource.type!==D.DataSourceType.BusinessObject||q.filter.dataSource.subType!==D.DataSourceSubType.Filtered){return i;}i.query=q;var j;for(var k=0,l=i.items;k<l.length;k++){var s=l[k];switch(s.type){case S.SuggestionType.SearchTerm:j=q.filter.clone();j.searchTerm=s.filter.searchTerm;s.filter=j;break;case S.SuggestionType.Object:break;default:throw"program error, not supported suggestion type "+s.type;}}return i;};return g;}(Q.Query));e.SuggestionQuery=g;});})();
