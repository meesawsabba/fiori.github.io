/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){var _=(this&&this.__extends)||(function(){var e=function(d,b){e=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p];};return e(d,b);};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");e(d,b);function a(){this.constructor=d;}d.prototype=b===null?Object.create(b):(a.prototype=b.prototype,new a());};})();sap.ui.define(["require","exports","../../core/core","./Configurator"],function(r,e,c,C){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.ListConfigurator=void 0;var L=(function(a){_(L,a);function L(){return a!==null&&a.apply(this,arguments)||this;}L.prototype.initAsync=function(){this.elements=[];this.cache={};var p=[];for(var i=0;i<this.configuration.length;++i){var b=this.configuration[i];p.push(this.createElementConfiguratorAsync(this.type,b,i));}return Promise.all(p);};L.prototype.isSuitable=function(o){if(o.typeContext&&o.typeContext.multiple&&c.isList(o.configuration)){return true;}};L.prototype.createElementConfiguratorAsync=function(t,b,i){return this.createConfiguratorAsync({type:t,configuration:b,}).then(function(d){this.elements.push({configuration:b,configurator:d,id:i,});}.bind(this));};L.prototype.getElement=function(l){var b=this.typeContext.getElementId(l);var d=this.cache[b];if(d){return d;}for(var i=0;i<this.elements.length;++i){d=this.elements[i];if(this.matchId(l,d)){this.cache[b]=d;return d;}}};L.prototype.matchId=function(l,b){var d=this.typeContext.getElementId(l);var f=this.typeContext.getElementId(b.configuration);var m;if(c.isObject(f)&&Object.prototype.hasOwnProperty.call(f,"regExp")){if(!f.regExpObj){f.regExpObj=new RegExp(f.regExp,f.regExpFlags);}m=f.regExpObj.test(d);}else{m=d===f;}return m;};L.prototype.createEmptyUsedElements=function(){var u=[];for(var i=0;i<this.elements.length;++i){u.push(false);}return u;};L.prototype.configure=function(l,b){if(!l){l=[];}b=this.createContext(b,l);var u=this.createEmptyUsedElements();var d,f,n;for(var i=0;i<l.length;++i){f=l[i];d=this.getElement(f);if(!d){continue;}var g=d.configurator.configure(f,b);if(g!==f){l[i]=g;}u[d.id]={index:i,};}var h;var k=0;if(this.typeContext.createElement){for(var j=0;j<u.length;++j){var m=u[j];d=this.elements[j];if(m){h=m;continue;}var t=this.typeContext.createElement(d.configuration,b);n=d.configurator.configure(t,b);var o=(h?h.index:-1)+k+1;l.splice(o,0,n);k++;if(this.typeContext.postProcessCreatedElement){this.typeContext.postProcessCreatedElement(n,b);}}}return l;};L.prototype.configureAsync=function(l,b){if(!l){l=[];}b=this.createContext(b,l);var u=this.createEmptyUsedElements();var d;var n=0;var f=function(h){if(h>=l.length){return null;}var i=l[h];var j=this.getElement(i);if(!j){return f(h+1);}u[j.id]={index:h,};return Promise.resolve().then(function(){return j.configurator.configureAsync(i,b);}).then(function(k){if(k!==i){l[h]=k;}return f(h+1);});}.bind(this);var g=function(h){if(h>=this.elements.length){return null;}var i=this.elements[h];var j=u[h];if(j){d=j;return g(h+1);}var t=this.typeContext.createElement(i.configuration,b);return Promise.resolve().then(function(){return i.configurator.configureAsync(t,b);}).then(function(k){var m=(d?d.index:-1)+n+1;l.splice(m,0,k);n++;if(this.typeContext.postProcessCreatedElement){this.typeContext.postProcessCreatedElement(k,b);}return g(h+1);}.bind(this));}.bind(this);return Promise.resolve().then(function(){return f(0);}).then(function(){if(!this.typeContext.createElement){return null;}return g(0);}.bind(this)).then(function(){return l;});};return L;}(C.Configurator));e.ListConfigurator=L;});})();
