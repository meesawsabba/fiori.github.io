/*!
 * SAPUI5
 * (c) Copyright 2009-2021 SAP SE. All rights reserved.
 */
sap.ui.define(['sap/ui/core/Core','sap/ui/base/EventProvider','sap/base/Log','sap/ui/export/ExportUtils'],function(C,E,L,a){'use strict';var b=E.extend('sap.ui.export.ExportBase',{constructor:function(s){E.call(this,s);this._mSettings={fileName:'Export'};['count','dataSource','fileName','fileType','workbook'].forEach(function(p){if(typeof s[p]!=='undefined'){this._mSettings[p]=p!=='dataSource'?s[p]:this.processDataSource(s[p]);}}.bind(this));}});b.prototype.attachBeforeExport=function(d,h,l){return this.attachEvent('beforeExport',d,h,l);};b.prototype.detachBeforeExport=function(h,l){return this.detachEvent('beforeExport',h,l);};b.prototype.destroy=function(){E.prototype.destroy.apply(this,arguments);this.cancel();this.bIsDestroyed=true;};b.prototype.cancel=function(){throw new Error('Abstract function not implemented');};b.prototype.processDataSource=function(d){throw new Error('Abstract function not implemented');};b.prototype.setDefaultExportSettings=function(s){throw new Error('Abstract function not implemented');};b.prototype.createBuildPromise=function(s){throw new Error('Abstract function not implemented');};b.prototype.build=function(){var p=this._mSettings;if(this.bIsDestroyed){var m=this.getMetadata().getName()+': Cannot trigger build - the object has been destroyed';L.error(m);return Promise.reject(m);}return this.setDefaultExportSettings(p).then(function(){this.fireEvent('beforeExport',{exportSettings:p},false,false);a.validateSettings(p);return this.createBuildPromise(p);}.bind(this));};return b;});
