//@ui5-bundle sap/ui/export/library-preload.js
/*
 * ! SAPUI5
 * (c) Copyright 2009-2021 SAP SE. All rights reserved.
 */
sap.ui.predefine('sap/ui/export/library',['jquery.sap.global','sap/ui/core/library'],function(q,l){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.export",dependencies:["sap.ui.core"],types:["sap.ui.export.EdmType","sap.ui.export.FileType"],interfaces:[],controls:[],elements:[],version:"1.96.0"});sap.ui.export.EdmType={BigNumber:"BigNumber",Boolean:"Boolean",Currency:"Currency",Date:"Date",DateTime:"DateTime",Enumeration:"Enumeration",Number:"Number",Percentage:"Percentage",String:"String",Time:"Time"};sap.ui.export.FileType={CSV:"CSV",PDF:"PDF",XLSX:"XLSX"};q.sap.registerModuleShims({'sap/ui/export/js/XLSXBuilder':{amd:true,exports:'XLSXBuilder'},'sap/ui/export/js/XLSXExportUtils':{amd:true,exports:'XLSXExportUtils'}});return sap.ui.export;});
/*!
 * SAPUI5
 * (c) Copyright 2009-2021 SAP SE. All rights reserved.
 */
sap.ui.predefine('sap/ui/export/ExportBase',['sap/ui/core/Core','sap/ui/base/EventProvider','sap/base/Log','sap/ui/export/ExportUtils'],function(C,E,L,a){'use strict';
var b=E.extend('sap.ui.export.ExportBase',{constructor:function(s){E.call(this,s);this._mSettings={fileName:'Export'};['count','dataSource','fileName','fileType','workbook'].forEach(function(p){if(typeof s[p]!=='undefined'){this._mSettings[p]=p!=='dataSource'?s[p]:this.processDataSource(s[p]);}}.bind(this));}});
b.prototype.attachBeforeExport=function(d,h,l){return this.attachEvent('beforeExport',d,h,l);};
b.prototype.detachBeforeExport=function(h,l){return this.detachEvent('beforeExport',h,l);};
b.prototype.destroy=function(){E.prototype.destroy.apply(this,arguments);this.cancel();this.bIsDestroyed=true;};
b.prototype.cancel=function(){throw new Error('Abstract function not implemented');};
b.prototype.processDataSource=function(d){throw new Error('Abstract function not implemented');};
b.prototype.setDefaultExportSettings=function(s){throw new Error('Abstract function not implemented');};
b.prototype.createBuildPromise=function(s){throw new Error('Abstract function not implemented');};
b.prototype.build=function(){var p=this._mSettings;if(this.bIsDestroyed){var m=this.getMetadata().getName()+': Cannot trigger build - the object has been destroyed';L.error(m);return Promise.reject(m);}return this.setDefaultExportSettings(p).then(function(){this.fireEvent('beforeExport',{exportSettings:p},false,false);a.validateSettings(p);return this.createBuildPromise(p);}.bind(this));};
return b;});
sap.ui.predefine('sap/ui/export/ExportDialog',['sap/ui/core/library','sap/m/library','sap/m/Dialog','sap/m/Button','sap/m/ProgressIndicator','sap/m/Text','sap/m/MessageBox','sap/ui/core/format/NumberFormat'],function(c,M,D,B,P,T,a,N){'use strict';var V=c.ValueState;var b=M.DialogType;var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.export",true);
function d(){return new Promise(function(R,f){var g;r.then(function(o){var h=new B({text:o.getText("CANCEL_BUTTON"),press:function(){if(g&&g.oncancel){g.oncancel();}g.finish();}});var p=new P({displayAnimation:false,displayValue:'0 / 0',showValue:true,height:"0.75rem",state:V.Information});p.addStyleClass("sapUiMediumMarginTop");var m=new T({text:o.getText("PROGRESS_FETCHING_MSG")});g=new D({title:o.getText("PROGRESS_TITLE"),type:b.Message,contentWidth:"500px",content:[m,p],endButton:h,ariaLabelledBy:[m]});g.updateStatus=function(F,t){var i;if(!isNaN(F)&!isNaN(t)){i=F/t*100;}if(i>=100){h.setEnabled(false);m.setText(o.getText("PROGRESS_BUNDLE_MSG"));}p.setPercentValue(i);if(isNaN(t)||t<=0||t>=1048575){t='\u221E';}if(!isNaN(F)){p.setDisplayValue(''+F+' / '+t);}};g.finish=function(){g.close();g.destroy();};R(g);});});}
function s(p){return new Promise(function(R,f){r.then(function(o){var C,w,W,g,n,h;n=N.getIntegerInstance({groupingEnabled:true});C=false;g='';if(!p.rows){g=o.getText("NO_COUNT_WARNING_MSG");}else{h=n.format(p.rows);if(p.sizeLimit){g=o.getText("SIZE_WARNING_MSG",[h,p.columns]);}if(p.cutOff){g+=g===''?'':'\n\n';g+=o.getText("MSG_WARNING_CUT_OFF",[h]);}}W=new T({text:g});w=new D({title:o.getText('PROGRESS_TITLE'),type:b.Message,state:V.Warning,content:W,ariaLabelledBy:W,beginButton:new B({text:o.getText("CANCEL_BUTTON"),press:function(){w.close();}}),endButton:new B({text:o.getText("EXPORT_BUTTON"),press:function(){C=true;w.close();}}),afterClose:function(){w.destroy();C?R():f();}});w.open();});});}
function e(m){r.then(function(R){var f=m||R.getText('PROGRESS_ERROR_DEFAULT');if(m.toLowerCase().indexOf('invalid string length')>-1){f=R.getText('MSG_ERROR_OUT_OF_MEMORY');}a.error(R.getText("PROGRESS_ERROR_MSG")+"\n\n"+f,{title:R.getText("PROGRESS_ERROR_TITLE")});});}
return{getProgressDialog:d,showErrorMessage:e,showWarningDialog:s};},true);
sap.ui.predefine('sap/ui/export/ExportUtils',['sap/ui/core/library','sap/m/library','./library','sap/ui/core/Core','sap/base/Log','sap/base/util/uid','sap/ui/core/Item','sap/ui/core/syncStyleClass','sap/ui/model/json/JSONModel','sap/m/Button','sap/m/CheckBox','sap/m/Dialog','sap/m/Input','sap/m/Label','sap/m/Select','sap/m/Text','sap/m/VBox','sap/ui/VersionInfo','sap/ui/util/openWindow'],function(c,l,a,C,L,u,I,s,J,B,b,D,d,e,S,T,V,f,o){'use strict';var g=l.ButtonType;var h=c.ValueState;var F=a.FileType;var E=a.EdmType;var j=null;var r=C.getLibraryResourceBundle('sap.ui.export',true);var k='sap.ui.export.ExportUtils';var U=/[\\\/\?\*:\[\]]/g;f.load().then(function(v){var M=/^[0-9]+\.[0-9]+/.exec(v.version);j=M?M[0]:null;});
function m(p,R,q){var t;var v={fileName:'Standard',fileType:[{key:'xlsx'}],selectedFileType:'xlsx',splitCells:false,includeFilterSettings:false,addDateTime:false};if(q){v.fileType.push({key:'pdf'});}var w=Object.assign({},v,p||{});for(var i=0;i<w.fileType.length;i++){t=null;if(!w.fileType[i].text){w.fileType[i].text=R.getText(w.fileType[i].key.toUpperCase()+'_FILETYPE');}if(w.fileType[i].key===w.selectedFileType){t=w.fileType[i].key;}}if(!t){w.selectedFileType=w.fileType[0].key;}return w;}
var n={_INTERCEPTSERVICE:'sap/ushell/cloudServices/interceptor/InterceptService',interceptUrl:function(i){var p=sap.ui.require(n._INTERCEPTSERVICE);if(p){var q=p.getInstance();if(q&&q.interceptUrl){i=q.interceptUrl(i);}}return i;},getExportSettingsViaDialog:function(i,O,p,q){return new Promise(function(R,t){var v;r.then(function(w){var x=new J();x.setData(m(i,w,q));var y=u();v=new D({id:y,title:w.getText('EXPORT_SETTINGS_TITLE'),horizontalScrolling:false,verticalScrolling:false,content:[new V({renderType:'Bare',width:'100%',items:[new e({text:w.getText('FILE_NAME'),labelFor:y+'-fileName'}),new d({id:y+'-fileName',value:'{/fileName}',liveChange:function(z){var A=z.getSource();var G=z.getParameter('value');var H=/[\\/:|?"*<>]/;var K=C.byId(y+'-export');var M=H.test(G);if(M){A.setValueState(h.Error);A.setValueStateText(w.getText('FILENAME_ERROR'));}else if(G.length>100){A.setValueState(h.Warning);A.setValueStateText(w.getText('FILENAME_WARNING'));}else{A.setValueState(h.None);A.setValueStateText(null);}K.setEnabled(!M);}}).addStyleClass('sapUiTinyMarginBottom'),new e({text:w.getText('SELECT_FORMAT'),labelFor:y+'-fileType',visible:false}),new S({id:y+'-fileType',width:'100%',selectedKey:'{/selectedFileType}',items:{path:'/fileType',template:new I({key:'{key}',text:'{text}'})}}),new b({id:y+'-splitCells',selected:'{/splitCells}',text:w.getText('SPLIT_CELLS')}),new b({id:y+'-includeFilterSettings',selected:'{/includeFilterSettings}',text:w.getText('INCLUDE_FILTER_SETTINGS')}),new b({id:y+'-addDateTime',selected:'{/addDateTime}',text:w.getText('ADD_DATE_TIME'),visible:false})]}).addStyleClass('sapUiExportSettingsLabel')],endButton:new B({id:y+'-cancel',text:w.getText('CANCEL_BUTTON'),press:function(){v.close();}}),beginButton:new B({id:y+'-export',text:w.getText('EXPORT_BUTTON'),type:g.Emphasized,press:function(){if(v){v._bSuccess=true;v.close();R(x.getData());}}}),afterClose:function(){if(!v._bSuccess){t(null);}v.destroy();v=null;}});v.addStyleClass('sapUiContentPadding sapUiExportSettings');v.setModel(x);if(O){s('sapUiSizeCompact',O,v);}v.open();if(p){p(v);}});});},_getReadableFilterValue:function(i){switch(i.op||i.name){case'==':return'='+i.right.value;case'>':case'<':case'!=':case'<=':case'>=':return i.op+i.right.value;case'between':return i.args[1].value+'...'+i.args[2].value;case'contains':return'*'+i.args[1].value+'*';case'endswith':return'*'+i.args[1].value;case'startswith':return i.args[1].value+'*';default:throw Error('getReadableFilter');}},_parseFilter:function(i){switch(i.type){case'Logical':return n._parseLogical(i);case'Binary':return n._parseBinary(i);case'Unary':return n._parseUnary(i);case'Call':return n._parseCall(i);default:throw Error('Filter type '+i.type+' not supported');}},_parseLogical:function(i){if(i.op=='&&'&&i.left.type==='Binary'&&i.right.type==='Binary'&&i.left.op==='>='&&i.right.op==='<='&&i.left.left.path===i.right.left.path){return n._parseCall({args:[{path:i.left.left.path,type:'Reference'},{type:'Literal',value:i.left.right.value},{type:'Literal',value:i.right.right.value}],name:'between',type:'Call'});}return n._parseFilter(i.left).concat(n._parseFilter(i.right));},_parseBinary:function(i){if(!i.left||i.left.type!='Reference'||!i.right||i.right.type!='Literal'){return[];}return[{key:i.left.path,value:n._getReadableFilterValue(i)}];},_parseUnary:function(i){var p;if(!i.arg){return[];}p=n._parseFilter(i.arg);p[0].value='!'+p[0].value;return p;},_parseCall:function(i){if(!i.args||i.args.length<2){return[];}return[{key:i.args[0].path,value:n._getReadableFilterValue(i)}];},parseFilterConfiguration:function(i,p){return new Promise(function(R,q){r.then(function(t){var v,w;v={name:t.getText('FILTER_HEADER'),items:[]};if(!i||!(i.isA('sap.ui.model.ListBinding')||i.isA('sap.ui.model.TreeBinding'))){L.error('A ListBinding is required for parsing the filter settings');q();return null;}var x=i.getFilterInfo();if(x){v.items=n._parseFilter(x);}if(typeof p==='function'){v.items.forEach(function(y){w=p(y.key);y.key=w&&typeof w==='string'?w:y.key;});}R(v);});});},getAvailableCloudExportTargets:function(){var i=n.getCloudExportService();return i.then(function(p){return p&&p.getSupportedTargets?p.getSupportedTargets():[];}).catch(function(){return[];});},getCloudExportService:function(){return sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getServiceAsync?sap.ushell.Container.getServiceAsync('ProductivityIntegration'):Promise.reject();},saveAsFile:function(i,p){var q,t,v;if(!(i instanceof Blob)){return;}q=document.createElementNS('http://www.w3.org/1999/xhtml','a');t='download'in q;if(t){v=function(w,x){q.download=x;q.href=URL.createObjectURL(w);q.dispatchEvent(new MouseEvent('click'));};}if(typeof v==='undefined'){v=function(w){var x=new FileReader();x.onloadend=function(){var y,z;z=x.result.replace(/^data:[^;]*;/,'data:attachment/file;');y=o(z,'_blank');if(!y){window.location.href=z;}};x.readAsDataURL(w);};}v(i,p);},validateSettings:function(i){var p;n._validateDataSource(i.dataSource);i.fileType=F[i.fileType]?i.fileType:F.XLSX;p='.'+i.fileType.toLowerCase();i.fileName=i.fileName||'export'+p;if(!i.fileName.endsWith(p)){i.fileName+=p;L.warning(k+': fileName was missing the proper file extension - extension has been added');}if(typeof i.showProgress!=='boolean'){i.showProgress=true;}n._validateWorkbook(i.workbook);if(typeof i.worker!=='boolean'){i.worker=true;}n._validateScaleCustomizing(i.customizing,'currency');n._validateScaleCustomizing(i.customizing,'unit');},_validateDataSource:function(i){var p;if(!i||typeof i!=='object'){throw new Error(k+': dataSource has not been specified');}i.type=i.type||'odata';if(i.type==='array'&&!Array.isArray(i.data)){L.warning(k+': Defined type does not match the provided data');}if(Array.isArray(i.data)){i.count=i.data.length;}if(i.type==='odata'&&(typeof i.dataUrl!=='string'||i.dataUrl.length===0)){throw new Error(k+': Unable to export data. No dataUrl provided.');}if(typeof i.count!=='number'||i.count<0||isNaN(i.count)||i.count%1!==0){L.info(k+': Invalid value for dataSource.count - value will be ignored');i.count=null;}if(typeof i.useBatch!=='boolean'){i.useBatch=false;L.info(k+': Parameter useBatch not provided. Applying default value "false"');}else if(i.useBatch===true){if(typeof i.serviceUrl!=='string'||i.serviceUrl.length===0){i.useBatch=false;L.warning(k+': serviceUrl is required for OData batch requests');}if(typeof i.headers!=='object'){i.useBatch=false;L.warning(k+': headers are required for OData batch requests.');}}p=i.sizeLimit;if(!p||isNaN(p)||p%1!==0){var M=5000,q=200;p=i.count?Math.round(i.count/(q*5))*q:q;p=Math.min(M,Math.max(p,q));i.sizeLimit=p;L.info(k+': No valid sizeLimit provided. sizeLimit is set to '+p);}},_validateWorkbook:function(w){if(!(w instanceof Object)||!Array.isArray(w.columns)){throw new Error(k+'column configuration is not provided. Export is not possible');}w.columns=w.columns.filter(function(i,p){var W;if(!(i instanceof Object)){L.error(k+': Column '+p+' skipped due to invalid configuration');return false;}if(Array.isArray(i.property)&&i.type!==E.String&&i.type!=null){L.warning(k+': Type '+i.type+' does not support an array of properties');i.property=i.property[0];}if(typeof i.property!=='string'&&!Array.isArray(i.property)){L.error(k+': Column '+p+' skipped due to missing mandatory property');return false;}i.label=i.label||(i.property instanceof Array?i.property[0]:i.property);W=i.width;if(typeof W==='string'){var q;q=W.toLowerCase();W=parseFloat(q);if(q.indexOf('em')>0){W=W*2;}else if(q.indexOf('px')>0){W=W/8;}}if(isNaN(W)||W<1){W=10;}i.width=Math.round(W);n._validateType(i,p);n._validateString(i,'textAlign');if(i.textAlign){var t=(i.textAlign+'').toLowerCase();if(['begin','end'].indexOf(t)>-1){var v=['left','right'];t=(C.getConfiguration().getRTL()?v.reverse():v)[['begin','end'].indexOf(t)];}if(t!==''&&['left','right','center'].indexOf(t)==-1){L.warning(k+': Incorrect column alignment value '+t+' on column "'+(i.label||i.property)+'". Default alignment is used.');t='';}i.textAlign=t;}['autoScale','delimiter','displayUnit','utc','wrap'].forEach(function(P){n._validateProperty(i,P,'boolean');});['inputFormat','unit','unitProperty','template','trueValue','falseValue'].forEach(function(P){n._validateString(i,P);});if(i.template&&!Array.isArray(i.property)&&typeof i.inputFormat!=='string'){L.warning(k+': Template is not applicable on a single property without inputFormat - value will be discarded on column "'+(i.label||i.property)+'".');delete i.template;}if(i.type===E.Boolean&&(i.trueValue===null||i.falseValue===null)){L.warning(k+': The properties trueValue and falseValue have to be assigned correctly on column "'+(i.label||i.property)+'". Values will be discarded.');delete i.trueValue;delete i.falseValue;}if(i.autoScale===true&&(i.type!==E.Number||(!i.unit&&!i.unitProperty))){L.warning(k+': autoScale cannot be taken into account due to invalid configuration.');delete i.autoScale;}if(i.utc!=null&&(i.type===E.Date||i.type===E.Time)){i.utc=true;}if(i.type===E.DateTime){n._validateProperty(i,'utc','boolean',true);}var x=i.scale;if(i.type===E.Number&&isNaN(x)&&x!=='variable'){L.warning(k+': scale parameter for numerical column configuration is missing.');}if(typeof x==='string'){x=parseInt(x);}if(isNaN(x)){x=null;}i.scale=x;if(i.valueMap&&typeof i.valueMap!=='object'){L.warning(k+': Invalid value for property "valueMap" on column "'+(i.label||i.property)+'". Value will be discarded.');delete i.valueMap;}return true;});n._validateWorkbookContext(w.context);n._validateString(w,'hierarchyLevel');},_validateType:function(i){var t,p;if(typeof i.type!=='string'){i.type=E.String;return;}if(!E[i.type]){p=E.String;for(t in E){if(t.toLowerCase()==i.type.toLowerCase()){p=t;}}L.warning(k+': Unsupported column type '+i.type+' on column "'+(i.label||i.property)+'". EdmType.'+p+' is applied.');i.type=p;}if(i.type===E.Currency&&!i.unitProperty){L.warning(k+': Missing unitProperty for type Currency on column "'+(i.label||i.property)+'". Type is reverted to "String".');i.type=E.String;}else if(i.type===E.Enumeration&&(!i.valueMap||typeof i.valueMap!=='object')){L.warning(k+': Invalid valueMap for type Enumeration on column "'+(i.label||i.property)+'". Type is reverted to "String".');i.type=E.String;}},_validateWorkbookContext:function(i){if(!(i instanceof Object)){return;}n._validateString(i,'application','SAP UI5');n._validateString(i,'version',j);n._validateString(i,'title');n._validateString(i,'modifiedBy');n._validateString(i,'sheetName','SAPUI5 Spreadsheet Export',31,U);n._validateString(i,'metaSheetName','Metadata',31,U);if(i.metainfo){if(!Array.isArray(i.metainfo)){L.warning(k+': Invalid value for property "metainfo". Value will be discarded.');i.metainfo=null;}else{i.metainfo.filter(function(G,p){if(typeof G.name!=='string'||G.name.length===0){L.warning(k+': Invalid name for metainfo group at index '+p+'. Entry will be discarded.');return false;}return true;});}}},_validateString:function(i,p,q,M,R){var v;n._validateProperty(i,p,'string',q);v=i[p];if(typeof v==='string'&&(typeof R==='string'||R instanceof RegExp)){v=v.replace(R,'');}if(typeof v==='string'&&M&&v.length>M){L.warning(k+': The value of '+p+' exceeds the max length of '+M+' and will be truncated.');v=v.slice(0,M);}i[p]=v;},_validateProperty:function(i,p,t,q){var v=i[p];if(v!=null&&typeof v!==t){L.warning(k+': Invalid value for property "'+p+'. Value will be discarded.');v=null;}i[p]=v==null&&q?q:v;},_validateScaleCustomizing:function(i,p){var K,q;if(!i){return;}q=i[p];if(!(q instanceof Object)||Array.isArray(q)){L.warning(k+': Invalid scale customizing for '+p+'.');i[p]={};}else{for(K in q){if(!(q[K]instanceof Object)){L.warning(k+': Key '+K+' has been removed from customizing.');delete q[K];}else if(typeof q[K].scale!=='number'||q[K].scale<0){L.warning(k+': Key '+K+' has been removed from customizing due to invalid scale.');delete q[K];}}}},getExportInstance:function(i){var p,q;q=typeof i.fileType==='string'?i.fileType.toUpperCase():i.fileType;switch(q){case F.PDF:p='sap/ui/export/PortableDocument';break;default:p='sap/ui/export/Spreadsheet';}return new Promise(function(R){sap.ui.require([p],function(t){R(new t(i));});});},getCountFromBinding:function(i){var p;if(typeof i.getCount==='function'){p=i.getCount();}else if(!i.isA('sap.ui.model.TreeBinding')&&typeof i.isLengthFinal==='function'&&i.isLengthFinal()){p=i.getLength();}if(typeof p!=='number'||p<0||isNaN(p)){p=null;}return p;}};return n;},true);
sap.ui.predefine('sap/ui/export/PortableDocument',['sap/base/Log','sap/ui/core/Core','sap/ui/export/ExportBase','sap/ui/export/ExportUtils','sap/ui/model/odata/v4/ODataModel'],function(L,C,E,a,O){'use strict';
var P=E.extend('sap.ui.export.PortableDocument',{constructor:function(s){E.call(this,s);}});
P.prototype.processDataSource=function(d){var D=null;var s=typeof d;if(!d){return null;}if(s!='object'){L.error('Spreadsheet#processDataSource: Unable to apply data source of type '+s);return null;}if(d.dataUrl&&d.serviceUrl){D=d;}if(d.isA&&d.isA(['sap.ui.model.ListBinding','sap.ui.model.TreeBinding'])){D=this.createDataSourceFromBinding(d);}return D;};
P.prototype.createDataSourceFromBinding=function(b){var d=null;if(b.isA('sap.ui.model.ClientListBinding')){L.error('Unable to create dataSource configuration due to not supported Binding: '+b.getMetadata().getName());}if(b.isA('sap.ui.model.ClientTreeBinding')){L.error('Unable to create dataSource configuration due to not supported Binding: '+b.getMetadata().getName());}if(typeof b.getDownloadUrl==='function'){var m=b.getModel(),D=a.interceptUrl(b.getDownloadUrl('json')),s=a.interceptUrl(m.sServiceUrl),v=m.isA('sap.ui.model.odata.v4.ODataModel');var o=new URL(D,document.baseURI);o.hash='';o.search='';d={type:'odata',version:v?4:2,dataUrl:o.toString(),serviceUrl:s.split('/').slice(0,-4).join("/")+"/iwbep/common/0001/",headers:v?m.getHttpHeaders(true):m.getHeaders()};}return d;};
P.prototype._createDocumentDescription=function(w){var d,m;d={"Title":w.context.title,"Format":{"PaperSize":"DIN_A4","Orientation":"LANDSCAPE","FontSize":12},"CoverPage":[],"TableColumns":[]};m=w.context.metaInfo;if(m instanceof Array){m.forEach(function(g){var c={"Title":g.name,"Content":[]};g.items.forEach(function(i){c["Content"].push({"Name":i.key,"Value":i.value});});d["CoverPage"].push(c);});}w.columns.forEach(function(c){d["TableColumns"].push({"Name":c.property,"Header":c.label});});return d;};
P.prototype.setDefaultExportSettings=function(s){var c=s&&s.workbook&&s.workbook.context;if(!(c instanceof Object)){c=s.workbook.context={};}if(typeof c.title==='string'){return Promise.resolve();}return C.getLibraryResourceBundle('sap.ui.export',true).then(function(r){c.title=r.getText('XLSX_DEFAULT_TITLE');});};
P.prototype.createBuildPromise=function(s){var t=this;return new Promise(function(r,R){var b,d,m;d=t._createDocumentDescription(s.workbook);m=new O({serviceUrl:s.dataSource.serviceUrl,synchronizationMode:'None'});b=m.bindList('/MyDocumentDescriptions');b.attachCreateCompleted(function(e){var c=e.getParameter('success');if(c){r(e.getParameter('context').getObject()['Id']);}else{R();}});b.create(d);}).then(function(d){return t.sendRequest(s.dataSource.dataUrl,d).then(function(r){a.saveAsFile(r,s.fileName);});});};
P.prototype.sendRequest=function(u,d){return new Promise(function(r,R){var x=this.request=new XMLHttpRequest();x.open('GET',u);x.responseType='blob';x.setRequestHeader("Accept","application/pdf");x.setRequestHeader("SAP-Document-Description-Id",d);x.addEventListener('abort',function(){R('Request aborted');});x.addEventListener('error',function(){R('Error occured while requesting data');});x.addEventListener('load',function(){var s=x.status;if(s>=200&&s<=400){r(x.response);}else{R(x.response);}});x.send();}.bind(this));};
P.prototype.cancel=function(){if(this.request&&this.request.readyState!=XMLHttpRequest.DONE){this.request.abort();this.request=null;}};
return P;});
sap.ui.predefine('sap/ui/export/Spreadsheet',['sap/ui/core/Core','./ExportDialog','sap/ui/export/ExportBase','sap/ui/Device','sap/ui/export/SpreadsheetExport','sap/base/Log','sap/ui/export/ExportUtils'],function(C,E,a,D,S,L,b){'use strict';var c='sap.ui.export.Spreadsheet';var d=a.extend(c,{constructor:function(s){a.call(this,s);this._mSettings.customizing={};this._mSettings.showProgress=true;this._mSettings.worker=true;['showProgress','worker'].forEach(function(p){if(typeof s[p]!=='undefined'){this._mSettings[p]=s[p];}}.bind(this));this.codeListsPromise=this.codeListsPromise instanceof Promise?this.codeListsPromise:Promise.resolve();}});
function e(s,o,m){if(!(m[s]instanceof Object)){m[s]={};}if(!isNaN(o.digits)){m[s].scale=o.digits;}if(!isNaN(o.UnitSpecificScale)){m[s].scale=o.UnitSpecificScale;}if(isNaN(m[s].scale)){delete m[s];}}
d.prototype.setDefaultExportSettings=function(p){var s,m,u;m=p.customizing.currency={};var o=C.getConfiguration().getFormatSettings().getCustomCurrencies();if(o){for(s in o){e(s,o[s],m);}}return this.codeListsPromise.then(function(f){var g,U,h;if(!Array.isArray(f)){return;}u=p.customizing.unit={};g=f[0];U=f[1];for(h in g){e(h,g[h],m);}for(h in U){e(h,U[h],u);}}).then(function(){return C.getLibraryResourceBundle('sap.ui.export',true);}).then(function(r){var w=p.workbook.context;if(!(w instanceof Object)){w=p.workbook.context={};}if(!w.title){w.title=r.getText('XLSX_DEFAULT_TITLE');}if(!w.sheetName){w.sheetName=r.getText('XLSX_DEFAULT_SHEETNAME');}});};
d.requestCodeLists=function(m){if(!m.isA(['sap.ui.model.odata.ODataMetaModel','sap.ui.model.odata.v4.ODataMetaModel'])){return Promise.resolve([null,null]);}return Promise.all([m.requestCurrencyCodes(),m.requestUnitsOfMeasure()]).catch(function(o){L.warning(c+': Code lists cannot be processed due to the following error - '+o);return Promise.resolve([null,null]);});};
d.prototype.attachBeforeSave=function(o,h,l){return this.attachEvent('beforeSave',o,h,l);};
d.prototype.detachBeforeSave=function(h,l){return this.detachEvent('beforeSave',h,l);};
d.prototype.cancel=function(){if(this.process){this.process.cancel();this.process=null;}return this;};
d.prototype.onprogress=function(f,t){var p;if(isNaN(f)||isNaN(t)){return;}p=Math.round(f/t*100);L.debug('Spreadsheet export: '+p+'% loaded.');};
d.prototype.createDataSourceFromBinding=function(B){var o=[];if(B.isA('sap.ui.model.ClientListBinding')){var f=B.getModel().getProperty(B.getPath());o={data:(f instanceof Array)?f:[],type:'array'};}if(B.isA('sap.ui.model.ClientTreeBinding')){L.error('Unable to create dataSource configuration due to not supported Binding: '+B.getMetadata().getName());}if(typeof B.getDownloadUrl==='function'){var m=B.getModel(),s=B.getDownloadUrl('json'),g=m.sServiceUrl,v=m.isA('sap.ui.model.odata.v4.ODataModel');s=b.interceptUrl(s);g=b.interceptUrl(g);o={type:'odata',dataUrl:s,serviceUrl:g,headers:v?m.getHttpHeaders(true):m.getHeaders(),count:b.getCountFromBinding(B),useBatch:v||m.bUseBatch};if(m.getMetaModel()&&typeof m.getMetaModel().requestCurrencyCodes==='function'&&typeof m.getMetaModel().requestUnitsOfMeasure==='function'){this.codeListsPromise=d.requestCodeLists(m.getMetaModel(),this._mSettings);}}return o;};
d.prototype.processDataSource=function(o){var m=null;var s=typeof o;if(!o){return null;}if(s=='string'){return{count:this._mSettings.count,dataUrl:o,type:'odata',useBatch:false};}if(s!='object'){L.error('Spreadsheet#processDataSource: Unable to apply data source of type '+s);return null;}if(o instanceof Array){m={data:o,type:'array'};}if(o.dataUrl){m=o;}if(o.isA&&o.isA(['sap.ui.model.ListBinding','sap.ui.model.TreeBinding'])){m=this.createDataSourceFromBinding(o);}return m;};
d.prototype.createBuildPromise=function(p){var t=this;return new Promise(function(r,R){var f;var M=1048576;var n=D.system.desktop?2000000:100000;var g=p.dataSource.type=='array'?p.dataSource.data.length:p.dataSource.count;var h=p.workbook.columns.length;function o(m){if(m.progress){if(f){f.updateStatus(m.fetched,m.total);}t.onprogress(m.fetched,m.total);}if(m.finished&&t.process!==null){t.process=null;if(!m.spreadsheet){R('Spreadsheet export: The process was canceled');return;}var j=t.fireEvent('beforeSave',{data:m.spreadsheet},true,true);if(f){window.setTimeout(f.finish,1000);}if(j){b.saveAsFile(new Blob([m.spreadsheet],{type:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'}),p.fileName);}r();}if(typeof m.error!='undefined'){var k=m.error.message||m.error;t.process=null;if(f){f.finish();}R(k);E.showErrorMessage(k);}}function s(){if(!p.showProgress){if(t.process){R('Cannot start export: the process is already running');return;}t.process=S.execute(p,o);return;}E.getProgressDialog().then(function(j){f=j;if(t.process){R('Cannot start export: the process is already running');return;}f.oncancel=function(){return t.process&&t.process.cancel();};f.open();f.updateStatus(0,p.dataSource.count);t.process=S.execute(p,o);});}if(h<=0){R('No columns to export.');}else if(g*h>n||!g||g>=M){var i={rows:g,columns:h,sizeLimit:g*h>n,cutOff:g>=M};E.showWarningDialog(i).then(s).catch(function(){R('Export cancelled by the user.');});}else{s();}});};
return d;});
sap.ui.predefine('sap/ui/export/SpreadsheetExport',['jquery.sap.global','sap/base/Log','sap/ui/Device'],function(q,L,D){'use strict';var a='sap/ui/export/provider/DataProviderBase',b='sap/ui/export/js/XLSXBuilder',c='sap/ui/export/js/libs/JSZip3';
function d(p,C){function f(m){if(m instanceof MessageEvent&&m.data){m=m.data;}return C&&C(m);}function o(F,t){f({progress:true,fetched:F||0,total:t||0});}function g(e){f({error:e.message||e});}function h(A){f({finished:true,spreadsheet:A});}function i(){var s;var e;function l(m,X){e=m.getDataConverter(p);s=new X(p.workbook.columns,p.workbook.context,p.workbook.hierarchyLevel,p.customizing);var r=p.dataSource.data||[];var t=r.length;var R=e(r.slice());s.append(R);o(t,t);s.build().then(h);}sap.ui.require([a,b,c],l);return{cancel:h};}function n(u){if(!u){return u;}try{return new URL(u,document.baseURI).toString();}catch(e){return window.URI(u).absoluteTo(document.baseURI).toString();}}function j(){var s,r;function e(t,X){var u=new t(p);s=new X(p.workbook.columns,p.workbook.context,p.workbook.hierarchyLevel,p.customizing);r=u.requestData(l);}function l(M){if(M.error||typeof M.error==='string'){return g(M.error);}s.append(M.rows);o(M.fetched,M.total);if(M.finished){s.build().then(h);}}function m(){r.cancel();h();}sap.ui.require([a,b,c],e);return{cancel:m};}function k(){var s;var l=q.extend(true,{},p);var w=typeof l.worker==='object'?l.worker:{};var m=function(){s.postMessage({cancel:true});h();};function r(e){var y=new Worker(e);y.onmessage=f;if(navigator.userAgent.indexOf("Firefox")===-1||t(e)){y.onerror=g;}y.postMessage(l);return y;}function t(e){return e.indexOf(window.location.host)>0||/^[^/]+\/[^/].*$|^\/[^/].*$/i.test(e);}function u(){L.warning('Direct worker is not allowed. Load the worker via blob.');var e=window.URI(w.base).absoluteTo("").search("").hash("").toString();w.src=e+w.ref;var y='self.origin = "'+e+'"; '+'importScripts("'+w.src+'")';var z=new Blob([y]);var A=window.URL.createObjectURL(z);return r(A);}function v(){L.warning('Blob worker is not allowed. Use in-process export.');m=j(l).cancel;}function x(){try{s=r(w.src);s.addEventListener('error',function(e){s=u();s.addEventListener('error',function(e){v();e.preventDefault();});e.preventDefault();});}catch(y){try{s=u();}catch(z){v();}}}l.dataSource.dataUrl=n(l.dataSource.dataUrl);l.dataSource.serviceUrl=n(l.dataSource.serviceUrl);w.base=w.base||sap.ui.require.toUrl('sap/ui/export/js/','');w.ref=w.ref||'SpreadsheetWorker.js';w.src=w.base+w.ref;x();return{cancel:function(){m();}};}if(p.dataSource.type==='array'){return i();}else if(p.worker===false||sap.ui.disableExportWorkers===true){return j();}else{return k();}}
return{execute:d};},true);
sap.ui.require.preload({
	"sap/ui/export/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.export","type":"library","embeds":[],"applicationVersion":{"version":"1.96.0"},"title":"UI5 library: sap.ui.export","description":"UI5 library: sap.ui.export","ach":"CA-UI5-TBL","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.96","libs":{"sap.ui.core":{"minVersion":"1.96.0"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":[],"elements":[],"types":["sap.ui.export.EdmType","sap.ui.export.FileType"],"interfaces":[]}}}}',
	"sap/ui/export/provider/DataProviderBase.js":function(){(function(c){'use strict';if(typeof sap!=="undefined"&&typeof sap.ui.define==='function'){sap.ui.define([],c,true);}else{var C;if(typeof window!=="undefined"){C=window;}else if(typeof self!=="undefined"){C=self;}else{C=this;}C.DataProviderBase=c();}})(function(){'use strict';var D=function(s){this.mSettings=s;this.bCanceled=false;this.iAvailableRows=0;this.mRequest=null;this.iTotalRows=Math.min(s.dataSource.count||D.MAX_ROWS,D.MAX_ROWS);this.iBatchSize=Math.min(s.dataSource.sizeLimit||D.MAX_ROWS,this.iTotalRows);this._prepareDataUrl();};D.MAX_ROWS=1048575;D.HTTP_ERROR_MSG='HTTP connection error';D.HTTP_WRONG_RESPONSE_MSG='Unexpected server response:\n';D._createGuid=function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==='x'?r:((r&0x3)|0x8);return v.toString(16);});};D.getColumnsToConvert=function(s){return s.workbook.columns.reduce(function(r,c){var p;p=c.property instanceof Array?c.property:[c.property];if(c.unitProperty){p.push(c.unitProperty);}p.forEach(function(a){var k=a.split('/');if(k.length>1){r.push({property:a,keys:k,type:c.type});}});return r;},[]);};D.getDataConverter=function(s){var c=this.getColumnsToConvert(s);return function(r){return D._convertData(r,c);};};D._convertData=function(r,c){c.forEach(function(a){r.forEach(function(b){b[a.property]=D._getValue(b,a);});});return r;};D._getValue=function(r,c){var v=c.keys.reduce(function(o,k){return o&&o[k];},r);return v;};D.prototype.requestData=function(p){var d=this.mSettings.dataSource;this.fnConvertData=D.getDataConverter(this.mSettings);this.fnProcessCallback=p;this.mRequest={serviceUrl:this._cleanUrl(d.serviceUrl),dataUrl:this._getUrl(0,this.iBatchSize),method:d.useBatch?'BATCH':'GET',headers:d.headers};this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this));return{cancel:function(){this.bCanceled=true;if(this.oPendingXHR instanceof XMLHttpRequest){this.oPendingXHR.abort();}}.bind(this)};};D.prototype.fnOnDataReceived=function(r){var d,n,f,R;var c={};this.oPendingXHR=null;if(this.bCanceled){return;}d=(r&&r.value||(r.d&&(r.d.results||r.d)))||r;d=(Array.isArray(d))?d:[];f=d.length;this.iAvailableRows+=f;R=this.iTotalRows-this.iAvailableRows;c.finished=f===0||R<=0;c.progress=this.iTotalRows;c.total=this.iTotalRows;c.fetched=this.iAvailableRows;n=(r&&r['@odata.nextLink']||(r.d&&r.d.__next))||null;if(!c.finished){this.mRequest.dataUrl=this._getUrl(this.iAvailableRows,Math.min(this.iBatchSize,R),n);this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this));}c.rows=this.fnConvertData(d);this.fnProcessCallback(c);};D.prototype.fnOnError=function(m){this.fnProcessCallback({error:m});};D.prototype._cleanUrl=function(u){var U;if(!u){return'';}U=URI.parse(u);U.path=U.path||'';if(U.path.slice(-1)!=='/'){U.path=U.path+'/';}delete U.query;delete U.hash;delete U.fragment;return(URI.serialize||URI.build)(U);};D.prototype._prepareDataUrl=function(){var d=this.mSettings.dataSource;var m,r=/\$skip\=[0-9]+/,a=/\$top\=[0-9]+/;if(!d.dataUrl){return'';}m=URI.parse(d.dataUrl);m.query=m.query||'';if(!r.test(m.query)){m.query+=(m.query.length?'&':'')+'$skip='+0;}if(!a.test(m.query)){m.query+='&$top='+0;}this.mSettings.dataSource.dataUrl=(URI.serialize||URI.build)(m);};D.prototype._getUrl=function(s,t,n){var d,N;d=URI.parse(this.mSettings.dataSource.dataUrl);if(n){N=URI.parse(n);d.query=N.query;}else{d.query=(d.query||'').replace(/\$skip\=[0-9]+/g,'$skip='+s).replace(/\$top\=[0-9]+/g,'$top='+t);}return(URI.serialize||URI.build)(d);};D.prototype.sendRequest=function(r){var s;if(typeof r!=='object'||r===null||typeof r.dataUrl!=='string'){throw new Error('Unable to send request - Mandatory parameters missing.');}s=(r.method==='BATCH'&&r.serviceUrl?this.sendBatchRequest:this.sendGetRequest).bind(this);return s(r);};D.prototype.sendBatchRequest=function(r){return new Promise(function(R,f){var x=new XMLHttpRequest();var b='batch_'+D._createGuid();var g=r.dataUrl.split(r.serviceUrl)[1];var a=[];var k,v;x.onload=function(){var c,l,E,L,s,h,m;l=this.responseText.split('\r\n');s=0;L=l.length;E=L-1;l.forEach(function(d){m=d.match(/HTTP\/1\.[0|1] ([1-9][0-9]{2})/);if(Array.isArray(m)&&m[1]){h=m[1];}});while(s<L&&l[s].slice(0,1)!=='{'){s++;}while(E>0&&l[E].slice(-1)!=='}'){E--;}l=l.slice(s,E+1);c=l.join('\r\n');if(h&&parseInt(h)>=400){f(D.HTTP_WRONG_RESPONSE_MSG+c);return;}try{R(JSON.parse(c));}catch(e){f(D.HTTP_WRONG_RESPONSE_MSG+c);}};x.onerror=function(){f(D.HTTP_ERROR_MSG);};x.open('POST',r.serviceUrl+'$batch',true);x.setRequestHeader('Accept','multipart/mixed');x.setRequestHeader('Content-Type','multipart/mixed;boundary='+b);a.push('--'+b);a.push('Content-Type: application/http');a.push('Content-Transfer-Encoding: binary');a.push('');a.push('GET '+g+' HTTP/1.1');for(k in r.headers){v=r.headers[k];if(k.toLowerCase()!='accept'){x.setRequestHeader(k,v);}a.push(k+':'+v);}a.push('');a.push('');a.push('--'+b+'--');a.push('');a=a.join('\r\n');x.send(a);this.oPendingXHR=x;}.bind(this));};D.prototype.sendGetRequest=function(r){return new Promise(function(R,f){var h;var x=new XMLHttpRequest();x.onload=function(){if(this.status>=400){f(this.responseText||this.statusText||D.HTTP_ERROR_MSG);return;}try{R(JSON.parse(this.responseText));}catch(e){f(D.HTTP_WRONG_RESPONSE_MSG+this.responseText);}};x.onerror=function(){f(D.HTTP_ERROR_MSG);};x.open('GET',r.dataUrl,true);x.setRequestHeader('accept','application/json');for(h in r.headers){if(h.toLowerCase()!=='accept'){x.setRequestHeader(h,r.headers[h]);}}x.send();this.oPendingXHR=x;}.bind(this));};return D;});
}
},"sap/ui/export/library-preload"
);
//# sourceMappingURL=library-preload.js.map