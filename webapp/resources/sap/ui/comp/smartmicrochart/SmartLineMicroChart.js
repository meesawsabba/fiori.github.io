/*
 * ! SAPUI5
 * (c) Copyright 2009-2021 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/suite/ui/microchart/LineMicroChart","sap/suite/ui/microchart/LineMicroChartLine","sap/suite/ui/microchart/LineMicroChartPoint","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(C,M,a,b,D,m,L,c,d,e,S,f){"use strict";var g=S.extend("sap.ui.comp.smartmicrochart.SmartLineMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartLineMicroChart.designtime"},renderer:f});g.prototype._CHART_TYPE=["Line"];g.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Line",true);this.setAggregation("_chart",new c({showThresholdLine:false}),true);};g.prototype.onBeforeRendering=function(){var o=this.getAggregation("_chart");o.setSize(this.getSize(),true);o.setWidth(this.getWidth(),true);o.setHeight(this.getHeight(),true);};g.prototype.setShowLabel=function(s){var o;if(this.getShowLabel()!==s){o=this.getAggregation("_chart");this.setProperty("showLabel",s,true);o.setProperty("showTopLabels",s,true);o.setProperty("showBottomLabels",s,true);o.invalidate();}return this;};g.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length===0){L.error("DataPoint annotation missing! Cannot create the SmartLineMicroChart");return;}for(var i=0;i<this._aDataPointAnnotations.length;i++){if(!(this._aDataPointAnnotations[i].Value&&this._aDataPointAnnotations[i].Value.Path)){L.error("Value DataPoint annotation missing! Cannot create the SmartLineMicroChart");return;}}var o=this.getAggregation("_chart"),l;this._aDataPointAnnotations.forEach(function(h,I){l=new d(this.getId()+"-line-"+I,{points:{path:this._getBindingPath(),factory:this._pointFactory.bind(this),events:{change:this._onBindingDataChange.bind(this)}}});o.addLine(l);},this);};g.prototype._pointFactory=function(i,o){var x,y,p,l=i.split("-").slice(-2,-1),h=this.getAggregation("_chart").getLines()[l],j=this._aDataPointAnnotations[l],s;x=o.getProperty(this._oChartViewMetadata.dimensionFields[l]);x=this._formatDimension.call(this,x);y=o.getProperty(j.Value.Path);y=Number(y);p=new e({x:x,y:y});if(h&&j.Criticality&&j.Criticality.Path){s=this._mapCriticalityTypeWithColor(o.getProperty(j.Criticality.Path));this.getAggregation("_chart").getLines()[l].setColor(s);}return p;};g.prototype._onBindingDataChange=function(){var p=this.getAggregation("_chart").getLines()[0].getBinding("points");this._updateAssociations(p);this.updateChartLabels.call(this,p);};g.prototype._updateLabel=function(n,o){this.getAggregation("_chart").setProperty(n,o.text,true);};g.prototype._getLabelsMap=function(){return{"leftTop":"leftTopLabel","rightTop":"rightTopLabel","leftBottom":"leftBottomLabel","rightBottom":"rightBottomLabel"};};return g;});
