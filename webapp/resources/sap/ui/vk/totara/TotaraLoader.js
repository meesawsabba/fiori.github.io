sap.ui.define(["sap/base/Log","./SceneContext","./CallbackHandler","./Command","./TotaraUtils","../IncludeUsageIdType","../helpers/WorkerScriptLoader"],function(L,S,C,a,T,I,W){"use strict";var b=T.mark;var d=["annotationId","closed","contentType","entityId","highlightStyleId","materialId","meshId","name","opacity","renderOrder","transform","visible"];var c=["annotation","bounds","highlight","nodes"];var e=function(){this._performanceTimingMsg=[];this._isPostable=true;this._suppressSendRequests=false;this._loadingFinishedSent=false;this.currentSceneInfo={};this.contextMap=new Map();this.tokenContextMap=new Map();this._skipLowLODRendering=true;this._maxUrlLength=2048;this._maxActiveRequests=4;this._meshesBatchSize=1024;this._materialsBatchSize=128;this._geometriesBatchSize=1024;this._geometriesMaxBatchDataSize=10*1024*1024;this._geomMeshesBatchSize=1024;this._parametricsBatchSize=1024;this._geomMeshesMaxBatchDataSize=10*1024*1024;this._annotationsBatchSize=128;this._tracksBatchSize=128;this._sequencesBatchSize=128;this._voxelThreshold=0.03;this.onErrorCallbacks=new C();this.onImageFinishedCallbacks=new C();this.onImageDetailsFinishedCallbacks=new C();this.onMaterialFinishedCallbacks=new C();this.onAnnotationFinishedCallbacks=new C();this.onSetGeometryCallbacks=new C();this.onSetSequenceCallbacks=new C();this.onSetTrackCallbacks=new C();this.onViewGroupUpdatedCallbacks=new C();this.onLoadingFinishedCallbacks=new C();};e.prototype.running=function(){return this._worker!==null&&this._worker!==undefined;};e.prototype.run=function(){if(!this._worker){this._worker=W.loadScript("sap/ui/vk/totara/TotaraLoaderWorker.js");var t=this;this._worker.onmessage=function(i){var j=i.data;j.jsonContent=j.jsonContent||{};if(j.jsonString){var k=JSON.parse(j.jsonString);delete j.jsonString;j.jsonContent=Object.assign(k,j.jsonContent);}var m=t.processCommand(j.name,j.jsonContent,j.binaryContent,j.isInitial);if(m){t.sendRequest(m.requestQueue);}};this._worker.onerror=function(i){};}return Promise.resolve("TotaraLoader is ready");};e.prototype.getUrl=function(){return this._url;};e.prototype.setUrl=function(u){this._url=u;if(!this._url.endsWith("/")){this._url+="/";}return this;};e.prototype.getCorrelationId=function(){return this._correlationId;};e.prototype.setCorrelationId=function(i){this._correlationId=i;return this;};e.prototype.getSkipLowLODRendering=function(){return this._skipLowLODRendering;};e.prototype.setSkipLowLODRendering=function(s){this._skipLowLODRendering=s;return this;};e.prototype.getMaxUrlLength=function(){return this._maxUrlLength;};e.prototype.setMaxUrlLength=function(m){this._maxUrlLength=m;return this;};e.prototype.getMaxActiveRequests=function(){return this._maxActiveRequests;};e.prototype.setMaxActiveRequests=function(m){this._maxActiveRequests=m;this.postMessage({method:a.setMaxActiveRequests,maxActiveRequests:m});};e.prototype.getMeshesBatchSize=function(){return this._meshesBatchSize;};e.prototype.setMeshesBatchSize=function(m){this._meshesBatchSize=m;return this;};e.prototype.getMaterialsBatchSize=function(){return this._materialsBatchSize;};e.prototype.setMaterialsBatchSize=function(m){this._materialsBatchSize=m;return this;};e.prototype.getGeometriesBatchSize=function(){return this._geometriesBatchSize;};e.prototype.setGeometriesBatchSize=function(i){this._geometriesBatchSize=i;return this;};e.prototype.getGeometriesMaxBatchDataSize=function(){return this._geometriesMaxBatchDataSize;};e.prototype.setGeometriesMaxBatchDataSize=function(i){this._geometriesMaxBatchDataSize=i;return this;};e.prototype.getGeomMeshesBatchSize=function(){return this._geomMeshesBatchSize;};e.prototype.setGeomMeshesBatchSize=function(i){this._geomMeshesBatchSize=i;return this;};e.prototype.getParametricsBatchSize=function(){return this._parametricsBatchSize;};e.prototype.setParametricsBatchSize=function(p){this._parametricsBatchSize=p;return this;};e.prototype.getGeomMeshesMaxBatchDataSize=function(){return this._geomMeshesMaxBatchDataSize;};e.prototype.setGeomMeshesMaxBatchDataSize=function(i){this._geomMeshesMaxBatchDataSize=i;return this;};e.prototype.getAnnotationsBatchSize=function(){return this._annotationsBatchSize;};e.prototype.setAnnotationsBatchSize=function(i){this._annotationsBatchSize=i;return this;};e.prototype.getTracksBatchSize=function(){return this._tracksBatchSize;};e.prototype.setTracksBatchSize=function(t){this._tracksBatchSize=t;return this;};e.prototype.getSequencesBatchSize=function(){return this._sequencesBatchSize;};e.prototype.setSequencesBatchSize=function(s){this._sequencesBatchSize=s;return this;};e.prototype.getVoxelThreshold=function(){return this._voxelThreshold;};e.prototype.setVoxelThreshold=function(v){this._voxelThreshold=v;if(this.sceneBuilder){this.sceneBuilder.setVoxelThreshold(v);}return this;};e.prototype.setSceneBuilder=function(s){this.sceneBuilder=s;this.sceneBuilder.setVoxelThreshold(this.getVoxelThreshold());};e.prototype.dispose=function(){this.contextMap.forEach(function(i){i.dispose();});this.contextMap.clear();this.tokenContextMap.clear();this.postMessage({method:"close"});this._worker=undefined;this.currentSceneInfo=null;this.sceneBuilder.cleanup();this.sceneBuilder=null;this.onErrorCallbacks=null;this.onMaterialFinishedCallbacks=null;this.onImageFinishedCallbacks=null;this.onImageDetailsFinishedCallbacks=null;this.onSetGeometryCallbacks=null;this.onSetTrackCallbacks=null;this.onSetSequenceCallbacks=null;this.onAnnotationFinishedCallbacks=null;};e.prototype.cleanup=function(){this.currentSceneInfo={};this.contextMap.clear();this.tokenContextMap.clear();this.sceneBuilder.cleanup();};e.prototype.getSceneBuilder=function(){return this.sceneBuilder;};e.prototype.getContext=function(s){return this.contextMap.get(s);};e.prototype.createContext=function(s,p){var i=new S(s,p,this);this.contextMap.set(s,i);this.tokenContextMap.set(i.requestQueue.token,i);if(i.onActiveCamera){i.onActiveCameraCallbacks.attach(i.onActiveCamera);delete i.onActiveCamera;}if(i.onInitialSceneFinished){i.onInitialSceneFinishedCallbacks.attach(i.onInitialSceneFinished);delete i.onInitialSceneFinished;}if(i.onPartialRetrievalFinished){i.onPartialRetrievalFinishedCallbacks.attach(i.onPartialRetrievalFinished);delete i.onPartialRetrievalFinished;}if(i.onViewFinished){i.onViewFinishedCallbacks.attach(i.onViewFinished);delete i.onViewFinished;}if(i.onSceneCompleted){i.onSceneCompletedCallbacks.attach(i.onSceneCompleted);delete i.onSceneCompleted;}if(i.onProgressChanged){i.setOnProgressChanged(i.onProgressChanged);delete i.onProgressChanged;}if(i.onLoadingFinished){this.onLoadingFinishedCallbacks.detachAll();this.onLoadingFinishedCallbacks.attach(i.onLoadingFinished);delete i.onLoadingFinished;}if(i.onContentChangesProgress){i.onContentChangesProgressCallbacks.attach(i.onContentChangesProgress);delete i.onContentChangesProgress;}if(i.onInitialViewCompleted){i.onInitialViewCompletedCallbacks.attach(i.onInitialViewCompleted);delete i.onInitialViewCompleted;}return i;};e.prototype.isLoadingFinished=function(){var i=this.contextMap.values();var j=i.next();while(!j.done){if(!j.value.isLoadingFinished()){return false;}j=i.next();}return true;};e.prototype.decrementResourceCountersForDeletedTreeNode=function(i,n){if(i){this.sceneBuilder.decrementResourceCountersForDeletedTreeNode(n,i.sceneId);}};function l(i,n){if(i.progressLogger){i.progressLogger.logPerformance(n,i.token);}}e.prototype.request=function(s,i,j){if(!i.root){throw"Context must include root where loaded objects are attached to";}var k=this.createContext(s,i);k.token=k.requestQueue.token;this.currentSceneInfo.id=s;k.retrievalType=S.RetrievalType.Initial;k.authorizationHandler=j;k.initialRequestTime=Date.now();if(k.enableLogger){T.createLogger(s,k,this);}var m;if(sap.ui.Device.browser.msie||sap.ui.Device.browser.edge){m=Math.min(2*1024,this.getMaxUrlLength());}else if(sap.ui.Device.browser.mobile){m=Math.min(8*1024,this.getMaxUrlLength());}else{m=Math.min(64*1024,this.getMaxUrlLength());}var n=h(this.getUrl()+"streaming-http",this.getUrl(),s,this.getCorrelationId(),m);var r=k.requestQueue;r.meshes.setBatchSizeInfo(n[a.getMesh]);r.materials.setBatchSizeInfo(n[a.getMaterial]);r.geometries.setBatchSizeInfo(n[a.getGeometry]);r.geomMeshes.setBatchSizeInfo(n[a.getGeomMesh]);r.annotations.setBatchSizeInfo(n[a.getAnnotation]);r.tracks.setBatchSizeInfo(n[a.getTrack]);r.sequences.setBatchSizeInfo(n[a.getSequence]);r.parametric.setBatchSizeInfo(n[a.getParametric]);var t=this;(j&&j(this.getUrl())||Promise.resolve()).then(function(o){l(k,"modelRequested");b("modelRequested");t.postMessage({method:"useAccessTokenResponse",accessTokenResponse:o});t.postMessage({method:"initializeConnection",url:t.getUrl(),cid:t.getCorrelationId(),maxActiveRequests:t.getMaxActiveRequests()});t.postMessage({method:a.getScene,sceneId:s});});};e.prototype.postMessage=function(m){if(this._worker){this._worker.postMessage(m);}};e.prototype.processSetSceneCommand=function(j){var i=this.getContext(j.veid);if(i){i.defaultViewId=j.defaultViewId;i.defaultViewGroupId=j.defaultViewGroupId;i.sceneThumbnailId=j.imageId;i.dimension=j.dimension;i.defaultRootEntityId=j.defaultRootEntityId;if(i.defaultViewGroupId){i.currentViewGroupId=i.defaultViewGroupId;}var s=i.$select!==undefined?i.$select:d;var k=c;if(i.includeAnimation){k.push("animation");}if(i.includeParametric){k.push("parametric");}if(i.includeUsageId){k=k.concat(I.to$expandQueryParameter(i.includeUsageId));}if(i.pushPMI){k.push("pmi");}var q={hidden:i.includeHidden,metadataFilter:i.metadataFilter,$select:s.join(","),$expand:k.join(",")};var v;if(i.activateView){v=i.activateView;}else if(i.defaultViewId){v=i.defaultViewId;}if(v){i.initialViewId=i.currentViewId=v;i.initialViewDecided=true;}this.postMessage({method:a.getView,parameters:{sceneId:i.sceneId,viewId:v,query:q},pushViewGroups:i.pushViewGroups,isInitial:true});}};e.prototype.update=function(s,i,v){this.currentSceneInfo.id=s;var j=this.getContext(s);if(!j){return Promise.reject("no context for ${sceneVeId}");}var t=this;return new Promise(function(r,k){j.nodeSidsForPartialTree=new Set(i);j.retrievalType=S.RetrievalType.Partial;var m=j.$select!==undefined?j.$select:d;var n=c;if(j.includeParametric){n.push("parametric");}if(j.includeUsageId){n=n.concat(I.to$expandQueryParameter(j.includeUsageId));}if(j.pushPMI){n.push("pmi");}var q={hidden:j.includeHidden,metadataFilter:j.metadataFilter,$select:m.join(","),$expand:n.join(","),breadcrumbs:true};var o=function(){j.onPartialRetrievalFinishedCallbacks.detach(o);l(j,"updateFinished(mesh)");var p=[];var u=[];j.replacedNodes.forEach(function(y,z){u.push(y);p.push(z);});var w=p;var x=u;r({sceneVeId:s,sids:i,replacedNodeRefs:w,replacementNodeRefs:x});};j.onPartialRetrievalFinishedCallbacks.attach(o);l(j,"updateRequested");t.postMessage({method:a.getView,parameters:{sceneId:s,viewId:v,query:q,sids:i},isPartialTree:true});});};e.prototype.requestViewGroup=function(s,v,i){if(!v){return Promise.reject("invalid arg: viewGroupId undefined");}var j=this.getContext(s);if(!j){return Promise.reject("no context for ${sceneVeId}");}if(i!==undefined){j.includeAnimation=i;}var t=this;var p=new Promise(function(r,k){var m=t.sceneBuilder.getViewGroup(v,s);if(m&&m.length){r(m);return;}var n=function(){j.onViewGroupFinishedCallbacks.detach(n);l(j,"onViewGroupFinished");var o=t.sceneBuilder.getViewGroup(v,s);if(o&&o.length){r(o);}else{k("no view ground data");}};j.onViewGroupFinishedCallbacks.attach(n);j.currentViewGroupId=v;t.postMessage({method:"getViewGroups",parameters:{sceneId:s,viewGroupId:v}});});return p;};e.prototype.requestView=function(s,v,i,p,j){this.currentSceneInfo.id=s;if(v!=="static"){return Promise.reject("invalid arg: supported type - static");}if(!i){return Promise.reject("invalid arg: viewId undefined");}var k=this.getContext(s);if(!k){return Promise.reject("no context for ${sceneVeId}");}k.currentViewId=i;var q;var m;if(p&&p.length>0){m=a.getViewAnimations;q={$expand:[]};k.playbackIds=p;}else{m=a.getView;var n=k.$select!==undefined?k.$select:d;var o=c;if(j){o.push("animation");}if(k.includeParametric){o.push("parametric");}if(k.includeUsageId){o=o.concat(I.to$expandQueryParameter(k.includeUsageId));}if(k.pushPMI){o.push("pmi");}q={hidden:k.includeHidden,metadataFilter:k.metadataFilter,$select:n.join(","),$expand:o.join(",")};}this.hasAnimation=false;var t=this;var r=new Promise(function(u,w){k.onSetPlaybackCallbacks.detachAll();var x=function(B){k.onSetPlaybackCallbacks.detach(x);l(k,"onSetPlayback");if(B){u(B);}else{w("no view data");}};k.onSetPlaybackCallbacks.attach(x);k.onViewFinishedCallbacks.detachAll();var y=function(B){k.onViewFinishedCallbacks.detach(y);l(k,"onViewFinished");if(!t.hasAnimation){if(B){u(B);}else{w("no view data");}}else{k.currentView=B;}};k.onViewFinishedCallbacks.attach(y);t.onSetSequenceCallbacks.detachAll();var z=function(){t.onSetSequenceCallbacks.detach(z);l(k,"onSetSequence");if(k.currentView){u(k.currentView);}};t.onSetSequenceCallbacks.attach(z);t.onSetTrackCallbacks.detachAll();var A=function(B){t.onSetTrackCallbacks.detach(A);l(k,"onSetTrack");if(k.currentView){u(k.currentView);}};t.onSetTrackCallbacks.attach(A);l(k,"viewRequested");t.postMessage({method:m,parameters:{sceneId:k.sceneId,viewId:i,query:q}});});return r;};e.prototype.requestMaterial=function(s,r){if(!r){return Promise.reject("invalid arg: requestedMaterial undefined");}var i=this.getContext(s);if(!i){return Promise.reject("no context for ${sceneVeId}");}var t=this;var p=new Promise(function(j,k){var n="";if(typeof r=="string"){n=r;}else if(typeof r=="object"){if(typeof r.getMaterialRef==="function"){j(r.getMaterialRef());return;}else if(r.id){n=r.id;}else if(r.veId){n=r.veId;}else{k("invalid arg: invalid requestedMaterial object");return;}}else{k("invalid arg: requestedMaterial must be an object or a string");return;}var o=i.sceneBuilder.getMaterial(n);if(o){j(o);return;}i.requestQueue.materials.push(n);var q=function(v){var m=t.sceneBuilder.getMaterial(n);if(m&&!m.userData.imageIdsToLoad){t.onImageFinishedCallbacks.detach(q);j(m);}};var u=function(v){if(n!=v){return;}t.onMaterialFinishedCallbacks.detach(u);var m=t.sceneBuilder.getMaterial(n);if(!m){t.onImageFinishedCallbacks.detach(q);k("no material data");}if(m.userData.imageIdsToLoad){return;}t.onImageFinishedCallbacks.detach(q);j(m);};t.onMaterialFinishedCallbacks.attach(u);t.onImageFinishedCallbacks.attach(q);t.sendRequest(i.requestQueue);});return p;};e.prototype.requestAnnotation=function(s,i){if(!i){return Promise.reject("invalid arg: annotationId undefined");}var j=this.getContext(s);if(!j){return Promise.reject("no context for ${sceneVeId}");}var t=this;var p=new Promise(function(r,k){var n=function(m){return j.sceneBuilder.getAnnotation?j.sceneBuilder.getAnnotation(m):null;};var o=n(i);if(o){r(o);return;}j.requestQueue.annotations.push(i);var q;var u;var v=function(x){t.onAnnotationFinishedCallbacks.detach(q);var y=n(i);var m=t.sceneBuilder._getMaterial(y.label.materialId);if(m&&m.userData.imageDetailsToLoad&&!m.userData.imageDetailsToLoad.size){t.onImageDetailsFinishedCallbacks.detach(v);if(m.userData.imageIdsToLoad&&m.userData.imageIdsToLoad.size){return;}r(y);}};var w=function(x){t.onAnnotationFinishedCallbacks.detach(q);var y=n(i);var m=t.sceneBuilder._getMaterial(y.label.materialId);if(m&&m.userData.imageIdsToLoad&&!m.userData.imageIdsToLoad.size){t.onImageFinishedCallbacks.detach(w);if(m.userData.imageDetailsToLoad&&m.userData.imageDetailsToLoad.size){return;}r(y);}};u=function(x){t.onAnnotationFinishedCallbacks.detach(q);var y=n(i);if(y.label.materialId!=x){return;}t.onMaterialFinishedCallbacks.detach(u);if(!t.sceneBuilder.checkMaterialExists(x,false)){t.onImageFinishedCallbacks.detach(w);k("no material data");}var m=t.sceneBuilder._getMaterial(x);if((m.userData.imageIdsToLoad&&m.userData.imageIdsToLoad.size)||(m.userData.imageDetailsToLoad&&m.userData.imageDetailsToLoad.size)){return;}t.onImageFinishedCallbacks.detach(w);t.onImageDetailsFinishedCallbacks.detach(v);r(y);};q=function(m){if(i!==m){return;}t.onAnnotationFinishedCallbacks.detach(q);var x=t.sceneBuilder.getAnnotation?t.sceneBuilder.getAnnotation(i):null;if(!x){t.onMaterialFinishedCallbacks.detach(u);t.onImageFinishedCallbacks.detach(w);t.onImageDetailsFinishedCallbacks.detach(v);k("no annotation data");}t.onMaterialFinishedCallbacks.detach(u);t.onImageFinishedCallbacks.detach(w);t.onImageDetailsFinishedCallbacks.detach(v);r(x);};t.onAnnotationFinishedCallbacks.attach(q);t.onMaterialFinishedCallbacks.attach(u);t.onImageFinishedCallbacks.attach(w);t.onImageDetailsFinishedCallbacks.attach(v);t.sendRequest(j.requestQueue);});return p;};e.prototype.setSuppressSendRequests=function(s){this._suppressSendRequests=s;};e.prototype.sendRequest=function(r){if(!this._worker||this._suppressSendRequests){return false;}var s=false;while(!r.isEmpty()){var n=r.generateRequestCommand();this.postMessage(n);s=true;}return s;};e.prototype.timestamp=function(j){};e.prototype.performanceTiming=function(j){};e.prototype.checkError=function(j){if(!j){return true;}var r=j.result==="failure";if(r){if(j.message){j.error=j.message;delete j.message;}else{j.error="Unknown error";}}return r;};e.prototype.reportError=function(i,j){this.onErrorCallbacks.execute({error:j,context:i});};e.prototype.processContextCommand=function(i,n,j,k,m){if(!i){var o=n+" error: unknown context - "+JSON.stringify(j);this.contextMap.forEach(function(i){i[n].call(i,j,k);});return{error:o};}var r;try{r=i[n].call(i,j,k,m);}catch(p){r={error:p};}return r;};e.prototype.processCommand=function(n,j,i,k){if(this.checkError(j)){if(n===a.setTree){if(j.events&&j.events.length){var m=j.events[0];if(m.values&&m.values.id){this.contextMap.delete(m.values.id);}}}this.onErrorCallbacks.execute(j);return null;}var o=null;if(j.sceneId!==undefined){o=this.getContext(j.sceneId);}else if(j.token!==undefined){o=this.tokenContextMap.get(j.token);}if(o){this.currentSceneInfo.id=o.sceneId;}this.setPerformance(n,j,o?o.sceneId:null);var r;switch(n){case a.setScene:this.processSetSceneCommand(j);break;case a.setTree:case a.setTreeNode:case a.notifyFinishedTree:case a.setView:case a.setViewNode:case a.setViewGroup:case a.notifyFinishedView:case a.setCamera:case a.setMesh:case a.setMaterial:case a.setGeometry:case a.setImage:case a.setAnnotation:case a.setLineStyle:case a.setFillStyle:case a.setTextStyle:case a.setParametric:case a.setPlayback:case a.setHighlightStyle:case a.setSequence:case a.setTrack:case a.suppressSendRequests:case a.unsuppressSendRequests:r=this.processContextCommand(o,n,j,i,k);break;case a.notifyError:r={error:j.errorText};break;case a.timestamp:r=this.timestamp(j);break;case a.performanceTiming:r=this.performanceTiming(j);break;default:r={error:"Unknown command: "+n};break;}if(this.isLoadingFinished()){if(n!==a.setScene&&n!==a.setView&&n!==a.setViewNode&&n!==a.timestamp&&n!==a.performanceTiming&&n!==a.suppressSendRequests&&n!==a.unsuppressSendRequests&&this._loadingFinishedSent===false){this.onLoadingFinishedCallbacks.execute();this._loadingFinishedSent=true;L.info("Loading is finished - all streaming requests are fulfilled.");}}else if(this._loadingFinishedSent){this._loadingFinishedSent=false;}if(r&&r.error){L.error(r.error);this.onErrorCallbacks.execute(r);}return o;};e.prototype.setPerformance=function(n,j,s){var i;switch(n){case a.setGeometry:i=j.id;b("setGeometry-"+i);break;case a.setImage:i=j.id;b("setImage-"+i);break;case a.setView:i=j.viewId;b("setView-"+i);break;case a.setViewGroup:i=j.id;b("setViewGroup-"+i);break;case a.setMesh:b("setMesh-"+s);break;case a.setMaterial:b("setMaterial-"+s);break;case a.setTree:b("setTree-"+s);break;case a.performanceTiming:this._isPostable=true;this.postPerformanceTiming();break;default:break;}};e.prototype.postPerformanceTiming=function(m){if(m){this._performanceTimingMsg.push(m);}if(this._isPostable&&this._performanceTimingMsg.length>0){this.postMessage(this._performanceTimingMsg.shift());this._isPostable=false;}};e.prototype.printLogTokens=function(){this.contextMap.forEach(function(i,s){L.info("log tokens for scene => "+s);L.info("---------------------------------------");if(i.progressLogger){i.progressLogger.getTokens().forEach(function(t){L.info(t);});}L.info("---------------------------------------");});};function g(i,u,j,s,t,m){var k;var n;switch(i){case"getGeometry":n=m-(j+"geometry?id=").length;break;case"getGeomMesh":n=m-(j+"scenes/"+s+"/meshes?ids="+k).length;break;default:k="?request="+encodeURI(i+"["+m+"]"+JSON.stringify({sceneId:s,ids:[],token:t}));n=m-(u+k).length;break;}return n;}function f(i){switch(i){case"getGeometry":return"&id=".length;default:return",".length;}}function h(s,i,j,k,m){s=s.indexOf("?")===-1?s:s.substring(0,s.indexOf("?"));var n=["getAnnotation","getGeometry","getGeomMesh","getMaterial","getMesh","getParametric","getSequence","getTrack"];var o={};n.forEach(function(p){o[p]={maxBatchStringLength:g(p,s,i,j,k,m),separatorLength:f(p)};});return o;}return e;});
