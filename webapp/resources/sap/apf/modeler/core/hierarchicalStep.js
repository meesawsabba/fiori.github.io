/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.define(["sap/apf/modeler/core/step","sap/ui/thirdparty/jquery"],function(s,q){"use strict";sap.apf.modeler.core.HierarchicalStep=function(a,i,d){sap.apf.modeler.core.Step.call(this,a,i,d);var h;var c=this.createRepresentation;if(d){h=d.hierarchyProperty;}this.getType=function(){return"hierarchicalStep";};this.getHierarchyProperty=function(){return h;};this.setHierarchyProperty=function(p){h=p;this.getRepresentationContainer().getElements().forEach(function(r){r.setHierarchyProperty(h);});};this.createRepresentation=function(e){var r=c(e);if(h){r.setHierarchyProperty(h);}return r;};this.getConsumableSortPropertiesForRepresentation=function(r){var t=this;var b=q.Deferred();this.getAvailableProperties().done(function(e){i.instances.metadataFactory.getMetadata(t.getService()).then(function(m){var f=[];e.forEach(function(p){var g=m.getPropertyMetadata(t.getEntitySet(),p);if(g["aggregation-role"]==="measure"){f.push(p);}});b.resolve({available:f,consumable:t.getConsumableProperties(f,t.getSortPropertiesFromRepresentation(r))});},function(){b.resolve({available:[],consumable:[]});});});return b.promise();};this.copy=function(n){var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(this.getDataForCopy());d.hierarchyProperty=h;d.representationContainer=this.getRepresentationContainer().copy((n||this.getId())+"-Representation");return new sap.apf.modeler.core.HierarchicalStep((n||this.getId()),i,d);};};});
