/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/modeler/ui/controller/sortPropertyType","sap/apf/modeler/ui/utils/textManipulator","sap/ui/thirdparty/jquery"],function(s,t,q){"use strict";var T=sap.apf.modeler.ui.utils.textManipulator;var r=sap.apf.modeler.ui.controller.sortPropertyType.extend("sap.apf.modeler.ui.controller.representationSortPropertyType",{onBeforeRendering:function(){var c=this;c.byId("idGridSortLabel").setSpan("L2 M2 S2");c.byId("idGridSortProperty").setSpan("L4 M4 S4");c.byId("idGridSortDirectionLabel").setSpan("L2 M2 S2");c.byId("idGridSortDirection").setSpan("L3 M3 S2");c.byId("idGridIconLayout").setSpan("L1 M1 S1");},disableView:function(){var c=this;if(c.oStepPropertyMetadataHandler.oStep.getTopN()){c.byId("idSortProperty").setEnabled(false);c.byId("idSortDirection").setEnabled(false);c.byId("idAddPropertyIcon").setVisible(false);c.byId("idRemovePropertyIcon").setVisible(false);}},getAllPropertiesAsPromise:function(){var c=this,a,S,p;var d=q.Deferred();c.oStepPropertyMetadataHandler.oStep.getConsumableSortPropertiesForRepresentation(c.oParentObject.getId()).done(function(R){a=R.consumable;S=c.getSelectedSortProperty();if(S!==c.oTextReader("none")&&S!==undefined){p=a.indexOf(S)!==-1?a:a.concat(S);a=R.available.indexOf(S)!==-1?p:a.concat(T.addPrefixText([S],c.oTextReader));S=R.available.indexOf(S)!==-1?S:T.addPrefixText([S],c.oTextReader)[0];}a.splice(0,0,c.oTextReader("none"));d.resolve({aAllProperties:a,sSelectedKey:S});});return d.promise();},updateOfConfigurationObjectOfSubclass:function(S){var c=this;c.oParentObject.removeAllOrderbySpecs();S.forEach(function(o){c.oParentObject.addOrderbySpec(o.property,o.ascending);});},getOrderBy:function(){var c=this;return c.oParentObject.getOrderbySpecifications();},setNextPropertyInParentObject:function(){var c=this;c.updateOfConfigurationObject();c.byId("idSortDirection").setSelectedKey("true");},removePropertyFromParentObject:function(){var c=this;c.oParentObject.removeOrderbySpec(T.removePrefixText(c.byId("idSortProperty").getSelectedKey(),c.oTextReader(sap.apf.modeler.ui.utils.CONSTANTS.texts.NOTAVAILABLE)));},addPropertyAsPromise:function(){var c=this;var d=q.Deferred();var C=sap.apf.modeler.ui.utils.CONSTANTS.events;c.oStepPropertyMetadataHandler.oStep.getConsumableSortPropertiesForRepresentation(c.oParentObject.getId()).done(function(R){c.getView().fireEvent(C.ADDPROPERTY,{"oSourceView":c.getView(),"sProperty":R.consumable[0],"sContext":c.getView().getViewData().oPropertyTypeData.sContext});c.oConfigurationEditor.setIsUnsaved();d.resolve();});return d.promise();}});return r;},true);
